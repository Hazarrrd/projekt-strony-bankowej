var n,epmNtw={};goog.exportSymbol("epmNtw",epmNtw);epmNtw.version="Tue Jan 31 2017 14:54:13 GMT+0100 (\u015arodkowoeuropejski czas stand.)";epmNtw.app=angular.module("epmNtw","ngRoute epmNtw.font-change epmNtw.message-dialog epmNtw.table-toolbar epmNtw.quotes-table epmNtw.alerts pascalprecht.translate epmNtw.quotes-time".split(" "));
epmNtw.Jg=function(){if(!epmNtw.pb){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=epmNtw.ra+"assets/css/epmNtw-base.css";b.id="epmNtwKendoTheme";document.head.appendChild(b)}document.body.setAttribute("oncontextmenu","return false")};epmNtw.utils={arrays:{Jc:function(b,d){for(var c=b.length;c--;)if(b[c]===d)return!0},Jb:function(b,d){for(var c=b.length;c--;)if(b[c]===d){b.splice(c,1);break}},Fg:function(b,d){for(var c=b.length;c--;)if(b[c].pseudoIsin===d){b.splice(c,1);break}},Fd:function(b){var d=[];b&&(d=b.slice(0));return d},Ta:function(b){b&&0<b.length&&b.splice(0,b.length)}},string:{includes:function(b,d){return-1<b.indexOf(d)},toCamelCase:function(b,d){var c="_\\s";!1!==d&&(c+="-");return b.toLowerCase().replace(new RegExp("["+
c+"]+(.)?","g"),function(b,a){return a?a.toUpperCase():""})},pa:function(b){return void 0!=b&&""!=b?!0:!1}},aa:{Ka:function(b,d,c){return function(){b.apply(c,d)}},wb:function(b,d,c){console.debug("Calling external function "+b);var f=(null!==window.opener&&void 0!==window.opener?window.opener:window)[b];if("function"===typeof f)return f.apply(c,d);console.warn("Function "+b+" is not defined!!\nCheck epmNtw.config.externalApiMethods settings")},cg:function(b,d,c,f){console.debug("Calling external SCOPE function "+
d+" with parameters:\n "+c);b=b[d];"function"===typeof b?b.apply(f,c):console.error("Function "+d+" on this scope is not defined!!")},Ta:function(b,d,c,f){(b=angular.element("#table_"+b))?(b=b.scope(),epmNtw.utils.aa.cg(b,d,c,f)):console.warn(elementId+" not found in DOM")},$c:function(b){if(void 0!==b)for(var d=0;d<epmNtw.enums.sc.length;d++){var c=epmNtw.enums.sc[d];if(c.name===b)return c.Hd}else console.error("The config name is not set")},Yf:function(b){oldWindowWidth=window.outerWidth;oldWindowHeight=
window.outerHeight;var d=window.outerWidth,c=window.outerHeight,f=!1;window.outerWidth<b.vb&&(d=b.vb,f=!0);window.outerHeight<b.sb&&(c=b.sb,f=!0);f&&window.resizeTo(d,c);return{resized:f,width:oldWindowWidth,height:oldWindowHeight}},nb:function(b){arrVal=b.toString().split(".");b=2;1<arrVal.length&&2<arrVal[1].length&&(b=arrVal[1].length);return format="n"+b},eg:function(b){return b.clone()},Fb:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("trident")?!0:!1},Jd:function(b){$.map(b,
function(d,c){jQuery.isPlainObject(d)&&(b[c]=$.map(d,function(b){return[b]}))});return b},Td:function(b,d){d||(d=window.location.href);b=b.replace(/[\[\]]/g,"\\$&");var c=(new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)")).exec(d);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null}},ei:{di:{Yg:"CHILDREN",jh:"HTTP",Xg:"AUTOCOMPLETE",ih:"GROUP_SECURITES"},ci:"<span translate='#: item.text #'></span>"}};goog.exportProperty(epmNtw,"utils",epmNtw.utils);
(function(b){b.fn.Eb=function(){return this.get(0).scrollWidth>this.get(0).clientWidth};b.fn.dc=function(){return this.get(0).scrollHeight>this.get(0).clientHeight}})(jQuery);LoadApplication=function(b,d,c,f){this.$rootScope=b;this.$timeout=c;this.$injector=f;this.run=function(){try{c(function(){$.getScript(epmNtw.ra+"assets/libs/kendo/js/messages/kendo.messages."+epmNtw.config.language+".min.js",function(){epmNtw.pb&&(void 0!==epmNtw.windowId&&null!==epmNtw.windowId&&null!==window.windowModel&&void 0!==window.windowModel&&(b.windowType=windowModel.type,b.elementId=windowModel.elementId),b.windowTypeEnum=epmNtw.enums.o,console.log("Ustawianie windowType z openera: "+b.windowType),
window.windowModel.elementId="content",f.get("epmNtw.windowsService").ke(window.windowModel,windowModel.type));f.get("epmNtw.apiService").Zb.resolve(!0)})},0)}catch(a){window.opener=null,epmNtw.pb=!1,epmNtw.ra="epmNtw/core/",epmNtw.Ia="epmNtw/modules/",console.error("Blad")}};b.Kh=function(a,c){b.dg(a,c);b.og=a};b.dg=function(a,f){void 0==f&&0==f&&kendo.ui.progress($("body"),!0);b.og=a;kendo.culture(a);d.use(a).then(function(){c(function(){})})};window.onerror=function(a,b,c,d,f){void 0!=c&&null!=
c&&(a+=" - URL: "+b+":"+c+":"+d);void 0!=f&&null!=f&&void 0!=f.stack&&null!=f.stack&&(a+="\nStackTrace: "+f.stack);"TypeError"===f.__proto__.name?console.warn(a):console.error(a);return!0}};epmNtw.windowId=epmNtw.utils.aa.Td("epmNtwWindowId");
void 0!=window.opener&&void 0!=epmNtw.windowId?(epmNtw.pb=!0,epmNtw.ra="",epmNtw.Ia="../modules/",epmNtw.config=window.opener.epmNtw.config,$("#epmNtwKendoTheme").attr("href",epmNtw.ra+epmNtw.config.themePath),epmNtw.enums=window.opener.epmNtw.enums,window.windowModel=window.opener.angular.element("body").injector().get("epmNtw.windowsService").Zd(parseInt(epmNtw.windowId)).windowModel):(epmNtw.pb=!1,epmNtw.ra="epmNtw/core/",epmNtw.Ia="epmNtw/modules/");
parametersSet=documentLoaded=angularLoaded=!1;epmNtw.pb&&(parametersSet=!0);loadApplicationObject={};bootstrapApplication=function(){angularLoaded&&parametersSet&&documentLoaded&&loadApplicationObject.run()};
epmNtw.app.config(["$translateProvider","$compileProvider",function(b,d){b.useStaticFilesLoader({prefix:epmNtw.ra+"assets/languages/messages-",suffix:".json"});b.determinePreferredLanguage(function(){if(epmNtw.pb)return kendo.culture(epmNtw.config.language),epmNtw.config.language;var b=epmNtw.utils.aa.Td("locale"),d;void 0==b||"pl"===b?d="pl-PL":"en"===b&&(d="en-US");kendo.culture(d);return d});b.fallbackLanguage("pl-PL");b.useSanitizeValueStrategy("escapeParameters");d.debugInfoEnabled(!0)}]);
epmNtw.app.run(["$rootScope","$translate","$timeout","$injector","$compile","$templateCache","$http",function(b,d,c,f,a,e,h){angularLoaded=!0;h.get(epmNtw.ra+"shared/modules/table-toolbar/table-toolbar.view.html",{cache:e});h.get(epmNtw.Ia+"transactions-table/transactions-table.view.html",{cache:e});h.get(epmNtw.Ia+"quotes-table/quotes-table.view.html",{cache:e});h.get(epmNtw.Ia+"alerts/modules/alerts-editor/alerts-editor.view.html",{cache:e});h.get(epmNtw.Ia+"alerts/modules/alerts-list/alerts-list.view.html",
{cache:e});loadApplicationObject=new LoadApplication(b,d,c,f);bootstrapApplication()}]);epmNtw.ze=function(){$("#epmNtwKendoTheme").attr("href",epmNtw.ra+epmNtw.config.themePath);parametersSet=!0;bootstrapApplication()};goog.exportProperty(epmNtw,"setParameters",epmNtw.ze);angular.element(document).ready(function(){documentLoaded=!0;bootstrapApplication();epmNtw.Jg()});epmNtw.enums={Ea:{qf:"EPM_NTW_AUTHENTICATE",Ef:"EXT_EPM_NTW_AUTHENTICATE",sf:"EPM_NTW_NOTOWANIA_REGISTER_002",eh:"EPM_NTW_GET_ISIN_TRANSACTION",rf:"EPM_NTW_GET_SNAPSHOT",fh:"EPM_NTW_REMOVE_ISIN_TRANSACTION",tf:"EPM_NTW_NOTOWANIA_UNREGISTER",Pb:"MSG_TIME"},sh:{dh:"epmplus",bh:"epmNtw"},Qb:{Nf:"OPEN_GADGET_DIV",Of:"OPEN_GADGET_NEW_WINDOW",Pf:"OPEN_KENDO_WINDOW",Qf:"OPEN_TRANSACTIONS_DIV"},CODE_TO_STOCK:{243:"WWA"},oa:{wh:14,INSERT:45,DELETE:46,NUMPAD_PLUS:107,NUMPAD_MINUS:109,He:38,Ge:40,ENTER:13,Kf:189,
nd:187,xc:999,od:61,Lf:173},Ga:{tc:0,wc:1,zc:2},ab:{BASIC:0,QUOTES_TABLE:1},Ma:{kh:{langId:"QUOTES_TABLE.GRID.ISIN",column:"isin"},Tf:{langId:"QUOTES_TABLE.GRID.SHORT_NAME",column:"nazwaSkrocona"},ph:{langId:"QUOTES_TABLE.GRID.NAME",column:"nazwa"},uh:{langId:"QUOTES_TABLE.GRID.PSEUDO_ISIN",column:"pseudoIsin"}},Sd:function(b){for(key in epmNtw.enums.Ma)if(epmNtw.enums.Ma[key].column==b)return epmNtw.enums.Ma[key]},Qc:function(b){return epmNtw.enums.Ma[Object.keys(epmNtw.enums.Ma)[b]]},ba:{rc:"COLUMN_0_NAME_SHORTCUT",
Se:"COLUMN_1_STOCK_CURR",Ze:"COLUMN_2_PREVCLOSE_OPENED",$e:"COLUMN_3_OPEN_LOW_HIGH",af:"COLUMN_4_IMP_IMV",bf:"COLUMN_5_CHANGE_MIN_MAX_COLLAR",cf:"COLUMN_6_B",df:"COLUMN_7_BID_VOL",ef:"COLUMN_8_BID",ff:"COLUMN_9_ASK",Je:"COLUMN_10_ASK_VOL",Ke:"COLUMN_11_A",Le:"COLUMN_12_TRADE_PRICE",Me:"COLUMN_13_TRADE_VOL",Ne:"COLUMN_14_TRADE_TIME",ld:"COLUMN_15_VOL_AUC",Oe:"COLUMN_16_TOTAL",Pe:"COLUMN_17_SESSION_PHASE",Qe:"COLUMN_18_VOL_WPRICE",Re:"COLUMN_19_PREVCLOSE",Te:"COLUMN_20_OPEN",Ue:"COLUMN_21_CHANGE",Ve:"COLUMN_22_TRADE_TIME",
We:"COLUMN_23_MIN",Xe:"COLUMN_24_MAX",Ye:"COLUMN_25_TOTAL_VALUE"},xa:{tb:"NAME_COLUMN",ub:"TRADES_COLUMN",Fa:"OFFER_COLUMN",la:"COMMON_COLUMN"},Jf:[{value:2E3},{value:3E3},{value:4E3},{value:5E3},{value:6E3},{value:7E3},{value:8E3},{value:9E3},{value:1E4},{value:15E3},{value:2E4},{value:3E4}],Ie:[{value:5E3},{value:1E4},{value:15E3},{value:2E4},{value:3E4},{value:4E4},{value:5E4},{value:6E4}],Sf:[{value:2E3},{value:3E3},{value:4E3},{value:5E3},{value:6E3},{value:7E3},{value:8E3},{value:9E3},{value:1E4},
{value:15E3},{value:2E4},{value:3E4},{value:4E4},{value:5E4},{value:6E4}],BUY_SELL:{BUY:"BUY",SELL:"SELL",BUY_CLASS:"BUY_CLASS",SELL_CLASS:"SELL_CLASS"},vh:{Tf:"SHORT_NAME",ah:"CURRENCY",rh:"OTWARTE",lh:"KURS_MAX",Dh:"TWO",Ih:"WID_MAX",mh:"K_LICZBA_OFERT",oh:"K_WOLUMEN",nh:"K_LIMIT",zh:"S_LIMIT",Ah:"S_WOLUMEN",yh:"S_LICZBA_OFERT",Fh:"T_KURS_OST",Gh:"T_WOLUMEN_OST",Eh:"T_CZAS_OST",xh:"STATUS",Hh:"VOL_OCZD",qh:"OBR_OCZD"},QUOTES_TABLE:{Oa:20,Mf:200},Ac:{Ff:{vb:875,sb:540},$g:{vb:1015,sb:550},Ch:{vb:285,
sb:275},Zg:{vb:285,sb:275},rd:645},sd:{Gf:75,If:45},Bc:"ZERO_VALUE"};goog.exportProperty(epmNtw,"enums",epmNtw.enums);epmNtw.enums.o={QUOTES_TABLE:"QUOTES_TABLE",ALERT_EDITOR:"ALERT_EDITOR",DEFINED_ALERTS_LIST:"DEFINED_ALERTS_LIST",COMPLETED_ALERTS_LIST:"COMPLETED_ALERTS_LIST"};epmNtw.enums.sc=[{name:"mBank",Hd:"config/cfgEpmNtw-MBANK.js"}];var B={qc:void 0,ea:function(){void 0===B.qc&&(B.qc=angular.element("body").injector().get("epmNtw.apiService"));return B.qc},externalSystemFunctions:{fillBuySellForm:function(b,d,c,f,a,e,h,l,g,k){B.ea().wf(b,d,c,f,a,e,h,l,g,k)},sessionExpired:function(){B.ea().Cf()},deleteAlert:function(){B.ea().vf()},alertStateChange:function(){B.ea().uf()},openCompletedAlertsWindow:function(){B.ea().zf()},openAlertsList:function(b,d,c,f,a){B.ea().yf(b,d,f,a)},switchAlertsSound:function(b){B.ea().Df(b)},Kb:function(){return B.ea().Af()},
saveTable:function(b,d){return B.ea().Bf(b,d)}},externalApi:{openQuotesTable:function(b,d,c){B.ea().lf(b,d,c)},openQuotesTableWindow:function(b,d,c){B.ea().mf(b,d,c)},openAlertsList:function(b,d,c,f,a,e){B.ea().$a(b,d,c,f,a,e)},openDefinedAlertsList:function(b,d){B.ea().$a(b,null,null,!1,d,"DEFINED_ALERTS_LIST")},openDefinedAlertsListWindow:function(b){B.ea().$a(null,null,null,!0,b,"DEFINED_ALERTS_LIST")},openCompletedAlertsList:function(b,d){B.ea().$a(b,null,null,!1,d,"COMPLETED_ALERTS_LIST")},openCompletedAlertsListWindow:function(b){B.ea().$a(null,
null,null,!0,b,"COMPLETED_ALERTS_LIST")},openAlertEditor:function(b){B.ea().uc(b)},alertAdded:function(b,d){B.ea().hf(b,d)},alertUpdated:function(b){B.ea().kf(b)},alertDeleted:function(b){B.ea().jf(b)},setDefinedAlerts:function(b){B.ea().pf(b)},setAlertNotification:function(b){B.ea().nf(b)},setInitialParameters:function(b,d){$.getScript(epmNtw.ra+epmNtw.enums.sc[0].Hd,function(){epmNtw.ze();null!==d&&void 0!==d&&0<d.length&&(epmNtw.config.epmPlusPushXDPUrl=d);angular.element("body").scope().Uc=b})}}};
goog.exportSymbol("epmNtwApi",B);angular.module("epmNtw.message-dialog",["kendo.directives","kendo.window"]);angular.module("epmNtw.demo",["kendo.directives","kendo.window"]);angular.module("epmNtw.font-change",["kendo.directives","kendo.window"]);angular.module("epmNtw.quotes-time",["kendo.directives"]);epmNtw.ue=function(b){function d(){if(!e&&0===Object.keys(a.handlers).length||h)console.log("Register: "+epmNtw.enums.Ea.Pb),e=!0,h=!1,b.ob.promise.then(function(){b.registerHandler(epmNtw.enums.Ea.Pb,f)})}function c(){e&&0===Object.keys(a.handlers).length&&(console.log("Unregister: "+epmNtw.enums.Ea.Pb),e=!1,b.ob.promise.then(function(){b.unregisterHandler(epmNtw.enums.Ea.Pb,f)}))}function f(b){for(var c in a.handlers)a.handlers[c](b)}var a=this,e=!1,h=!1;if(void 0!=window.opener){var l=window.opener.angular.element("body").injector().get("epmNtw.quotesTimeService");
this.handlers=l.handlers;this.ed=l.ed;this.kd=l.kd;this.gd=l.gd}else this.handlers={},this.ed=function(b,c){d();console.log("registerQuotesTimeCallback for "+b);a.handlers[b]=c},this.kd=function(b){console.log("unregisterQuotesTimeCallback for "+b);delete a.handlers[b];c()},this.gd=function(){console.log("ReInit: time");0<Object.keys(a.handlers).length&&(h=!0,d())},b.Rb(this.gd,"quotesTimeService")};epmNtw.ue.$inject=["epmNtw.eventBusService","$http","$filter","$q"];
angular.module("epmNtw.quotes-time").service("epmNtw.quotesTimeService",epmNtw.ue);epmNtw.te=function(){};epmNtw.te.$inject=["$rootScope","$scope"];angular.module("epmNtw.quotes-time").controller("epmNtw.quotesTimeController",epmNtw.te);epmNtw.yg=function(){return{restrict:"E",replace:"true",controller:"epmNtw.quotesTimeController"}};angular.module("epmNtw.quotes-time").directive("epmNtwQuotesTimeDirective",epmNtw.yg);angular.module("epmNtw.table-toolbar",["kendo.directives","kendo.window"]);angular.module("epmNtw.quotes-table",["kendo.directives","kendo.window"]);epmNtw.Ua=function(b,d,c,f){var a=this;this.maxObservableSecuritiesCount=epmNtw.config.quotesTable.maxObservableSecuritiesCount;this.maxSecuritiesPerTable=epmNtw.config.quotesTable.maxSecuritiesPerTable;this.va=b;if(null!==window.opener&&void 0!==window.opener){var e=window.opener.angular.element("body").injector().get("epmNtw.quotesTableService");this.Xa=e.Xa;this.Db=e.Db;this.Ud=e.Ud;this.Sc=e.Sc;this.Xd=e.Xd;this.bc=e.bc;this.ka=e.ka;this.ia=e.ia;this.za=e.za;this.Ub=e.Ub;this.Ib=e.Ib;this.Ja=
e.Ja;this.jc=e.jc;this.cc=e.cc;this.hd=e.hd;this.getAlertSoundLabel=e.getAlertSoundLabel;this.switchAlertsSound=e.switchAlertsSound;this.Nc=e.Nc;this.ye=e.ye;this.zb=e.zb}else{var h=function(a,b,c){for(var d in b)c&&(a[d+"-oldValue"]=a[d]),a[d]=null===b[d]||void 0===b[d]?"":b[d]},l=function(){return function(b){a.ka[b.isin_adress]?h(a.ka[b.isin_adress],b,!0):(a.Ja[b.isin_adress]||(a.Ja[b.isin_adress]={}),h(a.Ja[b.isin_adress],b));if(a.za.hasOwnProperty(b.isin_adress)&&null==a.Ja[b.isin_adress]){var c=
a.za[b.isin_adress],d;for(d in c)c[d](b.isin_adress,b)}}},g=epmNtw.utils;this.Xa=(new Date).getTime();this.ka={};this.ia={};this.za={};this.Ub={};this.Ib={};this.Ja={};this.va=b;this.zb=[];console.log("W service "+this.Xa);this.Db=function(c,d){var g=f.defer();b.La?a.Wd(g,c,d):b.kc(epmNtw.utils.aa.Ka(a.Wd,[g,c,d]));return g.promise};this.Wd=function(d,f,g){if(void 0===g||null===g)g="nazwa";var e=[],l=0,h;for(h in a.zb)e[l++]=a.zb[h].gielda_address;f=$.param({token:b.ua(),value:f,type:g,displayedMarkets:e.toString()});
c.post(b.ya()+"/securities?"+b.wa(),f,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(a){d.resolve(a)}).error(function(a,c){console.error("Connection to "+b.ya()+" /securities failed."+c);d.reject()})};this.Ud=function(c,d){b.La?a.Vd(c,d):b.kc(epmNtw.utils.aa.Ka(a.Vd,[c,d]))};this.kg=function(a){a=$.param({token:b.ua(),isinList:a});return c.post(b.ya()+"/securitieInfo?"+b.wa(),a,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})};
this.Vd=function(a,d){c.get(b.ya()+"/securitiesForStock?"+b.wa()+"token="+b.ua()+"&gielda="+d).success(function(b){a(b)}).error(function(a,c){console.error("Connection to "+b.ya()+" /securitiesForStock failed."+c)})};this.Xd=function(c){b.La?a.Yd(c):b.kc(epmNtw.utils.aa.Ka(a.Yd,[c]))};this.Yd=function(a){c.get(b.ya()+"/stocks?"+b.wa()+"token="+b.ua()).success(function(b){a(b)}).error(function(a,c){console.error("Connection to "+b.ya()+" /stocks failed."+c)})};this.Sc=function(c,d){b.La?a.cc(c,d):
b.kc(epmNtw.utils.aa.Ka(a.cc,[c,d]))};this.cc=function(a,d){c.get(b.ya()+"/securitiesForGroups?"+b.wa()+"token="+b.ua()+"&grupy="+d).success(function(b){a(b)}).error(function(a,c){console.error("Connection to "+b.ya()+" /getSecForGroups failed."+c)})};this.jc=function(a,c){b.Rb(a,c)};this.wg=function(){a.ka={};a.ia={};a.Ub={};a.Ib={}};this.jc(this.wg,-1);this.bc=function(c,d,f,e,l,h){var v=[];if(d&&0<d.length){if(h)delete a.ia[l];else{h=a.ia[l];if(null!=h)for(var y in d)element=d[y].isin_adress,g.arrays.Jb(h,
element);0==h.length&&c&&0<c.length&&delete a.ia[l]}h=!0;for(y in d){isin=d[y].isin_adress;for(var z in a.ia)if(tabIsin=a.ia[z],g.arrays.Jc(tabIsin,isin)){h=!1;break}g.arrays.Jb(a.za[isin],e);h&&(b.unregisterHandler(d[y].isinOffers,a.Ib[d[y].isinOffers]),delete a.ka[isin],v.push(d[y].isin_adress))}}0<v.length?b.send(epmNtw.enums.Ea.tf,{papiery:v,json:!0},function(){c&&0<c.length?addSeciurietes(c,f,e,l):f([],d)}):c&&0<c.length?addSeciurietes(c,f,e,l):f([])};addSeciurietes=function(c,d,f,e){a.ia[e]&&
(temp=c.slice(),temp.forEach(function(b){g.arrays.Jc(a.ia[e],b)&&g.arrays.Jb(c,b)}));if(!c||0!=c.length){a.ia.hasOwnProperty(e)?a.ia[e]=a.ia[e].concat(c):a.ia[e]=c;var u=[],q={},v;for(v in c)(isin=c[v])&&!a.ka.hasOwnProperty(isin)?u.push(isin):isin&&(q[isin]=a.ka[isin]);if(!a.Vc(u.length))return!1;if(0<u.length){var y=0;b.send(epmNtw.enums.Ea.sf,{papiery:u,json:!0},function(c){var g=c.isinList;y=c.iloscOfert;for(var e in g)c=l(),a.Ib[g[e]]=c,b.registerHandler(g[e],c);b.send(epmNtw.enums.Ea.rf,{papiery:u,
json:!0,iloscOfert:y},function(b){if(null!=b){for(var c in b){var g=b[c];a.Ja[c]&&(h(g,a.Ja[c]),a.Ja[c]=null);a.ka[c]=q[c]=g;null==a.za[c]&&(a.za[c]=[]);a.za[c].push(f)}for(c in q)a.za[c].push(f);d(q)}})})}else{for(v in q)a.za[v].push(f);d(q)}}};this.hd=function(a){b.bb=a};this.getAlertSoundLabel=function(){return b.bb?"CONTEXT_MENU.DISABLE_ALERTS_SOUND":"CONTEXT_MENU.ENABLE_ALERTS_SOUND"};this.switchAlertsSound=function(){b.bb=!b.bb;B.externalSystemFunctions.switchAlertsSound(b.bb)};this.Nc=function(b,
c,d){delete a.ia[b];for(var f in c){var e=c[f];!0!==e.separator&&(isin=e.isin_adress,void 0!==isin&&g.arrays.Jb(a.za[isin],d))}b=angular.element("#table_"+b).scope();void 0!==b&&!1===b.unpinnedWindow&&b.closeTable()}}this.Vc=function(b){console.log("Checking allowedCount:"+a.maxObservableSecuritiesCount+" actualCount: "+Object.keys(a.ka).length+" toAddCount: "+b);return Object.keys(a.ka).length+b<=a.maxObservableSecuritiesCount?!0:!1};this.mg=function(b,c){var d=0;void 0!==a.ia[c]&&(d=Object.keys(a.ia[c]).length);
console.log("Checking allowedCountPerTable:"+a.maxSecuritiesPerTable+" actualCount: "+d+" toAddCount: "+b);return d+b<=a.maxSecuritiesPerTable?!0:!1};this.be=function(b,c,f){console.time("quotesTableService: isAddingTheseSecuritiesAllowed");countIsins2Add=0;for(var g in b)(isin=b[g])&&!a.ka.hasOwnProperty(isin)&&countIsins2Add++;g=!0;var e=a.Vc(countIsins2Add),l=a.mg(b.length,f);e||l?e?l||(g=0,e=a.ia[f],void 0!==e&&(g=Object.keys(a.ia[f]).length),1!=c&&void 0!=c||d.ha("ERROR","TO_MANY_SECURITIES_PER_TABLE",
"300","77",{allowedCount:a.maxSecuritiesPerTable,actualCount:g,toAddCount:b.length}),g=!1):(1!=c&&void 0!=c||d.ha("ERROR","TO_MANY_SECURITIES","300","77",{allowedCount:a.maxObservableSecuritiesCount,actualCount:Object.keys(a.ka).length,toAddCount:countIsins2Add}),g=!1):(g=0,e=a.ia[f],void 0!==e&&(g=Object.keys(a.ia[f]).length),1!=c&&void 0!=c||d.ha("ERROR","TO_MANY_SECURITIES_PER_TABLE_AND_PER_APPLICATION","300","77",{allowedCount:a.maxObservableSecuritiesCount,actualCount:Object.keys(a.ka).length,
toAddCount:countIsins2Add,allowedCountPerTable:a.maxSecuritiesPerTable,actualCountPerTable:g,toAddCountPerTable:b.length}),g=!1);console.timeEnd("quotesTableService: isAddingTheseSecuritiesAllowed");return g};this.ye=function(b){a.zb=b}};epmNtw.Ua.$inject=["epmNtw.eventBusService","epmNtw.messageDialogService","$http","$q"];angular.module("epmNtw").service("epmNtw.quotesTableService",epmNtw.Ua);angular.module("epmNtw.theme-chooser",["kendo.directives"]);epmNtw.Bd=function(b,d){var c=this;this.Da;this.Zb=d.defer();this.Na=function(){var f=d.defer();d.when(c.Zb.promise).then(function(){c.Ua=b.get("epmNtw.quotesTableService");c.Da=b.get("epmNtw.windowsService");c.Aa=b.get("epmNtw.alertsService");var a={};a.Ua=c.Ua;a.Da=c.Da;a.Aa=c.Aa;f.resolve(a)});return f.promise};this.md=function(b,a,d,h,l,g){console.log("Prepare to open new QuotesTable. Parameters- elementId: "+b+" isUnpin: "+h);c.Na().then(function(k){var m=k.Da;k.Ua.be(a,void 0,null)?h?m.ad(b,
null,a,"",d,epmNtw.enums.o.QUOTES_TABLE,l,"",!0,g):m.me(b,null,a,"",d,epmNtw.enums.o.QUOTES_TABLE,l,"",!0,g):h||c.gh(b,window.Ta)})}};epmNtw.Dc=function(b,d){var c=this;epmNtw.Bd.call(this,b,d);this.yf=function(b,a,c,d){this.$a(void 0,b,a,!0,c,d)};this.xf=function(){console.debug("externalSystemFunctions getStoredAlertsMethod");epmNtw.utils.aa.wb(epmNtw.config.externalApiMethods.getStoredAlertsMethod,[])};this.vf=function(){console.debug("externalSystemFunctions deleteAlert")};this.uf=function(){console.debug("externalSystemFunctions alertStateChange")};this.zf=function(){console.debug("externalSystemFunctions openCompletedAlertsWindow");
epmNtw.utils.aa.wb(epmNtw.config.externalApiMethods.openCompletedAlertsWindowMethod,[])};this.Df=function(b){console.debug("externalSystemFunctions switchAlertsSound");epmNtw.utils.aa.wb(epmNtw.config.externalApiMethods.switchAlertsSoundMethod,[b])};this.Af=function(){console.debug("externalSystemFunctions saveAlert")};this.Bf=function(b,a){var c=d.defer();try{localStorage.setItem(b,JSON.stringify(a)),c.resolve()}catch(h){c.reject()}return c};this.lf=function(b,a,d){20<a.length&&(a=a.slice(0,20));
a=a.filter(function(a,b,c){return c.indexOf(a)===b});c.md(b,a,localStorage[b],!1,"",d)};this.mf=function(b,a,d){20<b.length&&(b=b.slice(0,20));b=b.filter(function(a,b,c){return c.indexOf(a)===b});c.md(null,b,localStorage[a],!0,a,d)};this.$a=function(b,a,d,h,l,g){c.Na().then(function(c){h?c.Da.ad(b,a,null,null,d,g,l,null,!1,[]):c.Da.me(b,a,null,null,d,g,l,null,!1,[])})};this.nf=function(b){c.Na().then(function(a){a.Ua.hd(b)})};this.pf=function(b){c.Na().then(function(a){a.Aa.Ig(JSON.parse(b))})};this.uc=
function(b,a,d){console.log("EA_openAlertEditor: "+b+", "+a+", "+JSON.stringify(d));c.Na().then(function(c){var l="ALERT_"+Math.random(),g=JSON.stringify({id_alert:a,security:d});c.Da.ad(l,null,b,null,g,epmNtw.enums.o.ALERT_EDITOR,"ALERTS.EDITOR.TITLE")})};this.hf=function(b,a){c.Na().then(function(c){c.Aa.ic(b,a)})};this.kf=function(b){c.Na().then(function(a){a.Aa.editAlert(b)})};this.jf=function(b){c.Na().then(function(a){a.Aa.alertDeleted(b)})};this.Cf=function(){console.debug("externalSystemFunctions sessionExpired");
epmNtw.utils.aa.wb(epmNtw.config.externalApiMethods.sessionExpiredMethod,[])};this.wf=function(b,a,c,d,l,g,k,m,p,t){console.debug("externalSystemFunctions fillBuySellForm");epmNtw.utils.aa.wb(epmNtw.config.externalApiMethods.fillBuySellFormMethod,[b,a,c,d,l,g,k,m,p,t])}};epmNtw.Dc.prototype=Object.create(epmNtw.Bd.prototype);epmNtw.Dc.$inject=["$injector","$q"];angular.module("epmNtw").service("epmNtw.apiService",epmNtw.Dc);epmNtw.$b=function(b,d,c,f){var a=this;this.cb=[];this.token="test";this.url;this.Lb="local";this.Va=[];this.La=!1;this.rb=[];this.Od=this.xe=!1;this.Nd=epmNtw.enums.Ea.qf;this.Qa={};this.ob=f.defer();var e=epmNtw.config.eventBusPrams.reconnectTimeout;this.bb=epmNtw.config.alerts.alertsSoundNotification;this.qb=function(b){epmNtw.config.Mc||!b?a.connect():c.jsonp(epmNtw.config.Oh+"/epmplus/httpDispatcher/epmProfessional/tokenEpmNtw?ses="+d.Uc+"&callback=JSON_CALLBACK").success(function(b){a.token=
b.token;a.url=b.address+"/eventbus";a.Lb=b.address;a.connect()}).error(function(a){console.error("Parsing token Error on epmPlus: "+a)})};this.connect=function(){a.url&&0!=a.url.length||(a.url=(0<epmNtw.config.epmPlusPushXDPUrl.length?epmNtw.config.epmPlusPushXDPUrl:window.location.protocol+"//"+window.location.hostname+":"+window.location.port)+"/eventbus");a.ta=epmNtw.config.Ph?new vertx.EventBus(a.url+"?"+a.wa(),{transports:["websocket"],debug:!0}):new vertx.EventBus(a.url+"?"+a.wa());a.ta.onopen=
function(){console.log("Nawiazano polaczenie z serwerem epmPlusPushXdp");a.Ec();a.gc(a.bd)};a.ta.onclose=function(){console.log("Zamknieto polaczenie z serwerem epmPlusPushXdp");null==h?h=setInterval(function(){console.log("Nawiazuje ponownie polaczenie z serwerem epmPlusPushXdp");a.qb(!1)},e):console.warn("Reply is undefined");a.ob.reject()};console.log(this.ta)};this.ua=function(){return a.token};this.Ra=function(){return a.Qa};this.ya=function(){return a.Lb};this.kc=function(a){this.rb.push(a)};
this.Ec=function(){a.ta.send(a.Nd,{sessionID:a.token},function(c){if(void 0!==c)if(!0===c.status){console.log("Token authentucation successfull, sessionID: "+c.sessionID);a.ta.sessionID=c.sessionID;a.La=!0;a.Qa.alertsEnable=c.alertsEnable;a.Qa.maxClientAlerts=c.maxClientAlerts;a.Qa.maxAlertConditions=c.maxAlertConditions;a.Qa.sendMsgTime=c.sendMsgTime;console.log("getExternalParams received from PushXDP: "+JSON.stringify(a.Ra()));for(c=0;c<a.Va.length;c++)a.gc(a.Va[c]);if(h)clearInterval(h),h=null,
a.Pd();else{for(var d in a.cb)a.cb[d]();a.cb=[];for(d in a.rb)a.rb[d]();a.rb=[]}a.ob.resolve()}else delete c.sessionID,console.log("Token authentucation failure"),a.Od?(B.externalSystemFunctions.sessionExpired,b.ha("ERROR",3,"300","77")):a.qb(!0);else console.warn("Reply is undefined")})};this.send=function(b,c,d){a.La?(c?c.address=a.ta.sessionID:c={address:a.ta.sessionID},a.hc(b,c,d)):a.cb.push(epmNtw.utils.aa.Ka(a.hc,[b,c,d]))};this.Rb=function(b,c){a.Va[c]=b};this.Pd=function(){for(var b in a.Va)a.Va[b]()};
this.hc=function(c,d,f){replayCallbackWithError=function(a){a?a.error?(console.log("B\u0142\u0105d obsluzony"),b.ha("ERROR",a.error,"300","77")):f?f(a):function(a){"ok"===a.status?console.debug("sendMethod - no reply callback - default status OK"):console.debug("sendMethod - no reply callback - default status FAILURE")}:console.warn("Reply is undefined")};a.ta.send(c,d,replayCallbackWithError)};this.registerHandler=function(b,c){a.ta.registerHandler(b,c?c:function(a){void 0!==a?console.debug("Handler registered on address: "+
b+"(no reply callback)"):console.warn("Reply is undefined")})};this.unregisterHandler=function(b,c){try{a.ta.unregisterHandler(b,c)}catch(d){console.warn("Can't unregist handler because parametr handler is not specified")}};this.bd=function(){console.warn("Refresh handler execution");a.Pd()};this.gc=function(){a.ta.registerHandler("REFRESH",a.bd?a.bd:function(a){void 0!==a?console.debug("Refresh handler registered on address: REFRESH(no reply callback)"):console.warn("Reply is undefined")})};this.wa=
function(){return""};if(null!==window.opener&&void 0!==window.opener){f=window.opener.angular.element("body").injector().get("epmNtw.eventBusBaseService");var h;this.xe=!0;e=epmNtw.config.eventBusPrams.reconnectTimeout;this.token=f.token;this.ta=f.ta;this.La=f.La;this.cb=f.cb;this.ua=f.ua;this.send=f.send;this.registerHandler=f.registerHandler;this.unregisterHandler=f.unregisterHandler;this.hc=f.hc;this.pg=f.pg;this.url=f.url;this.Lb=f.Lb;this.gc=f.gc;this.Bg=f.Bg;this.Va=f.Va;this.connect=f.connect;
this.Rb=f.Rb;this.Ec=f.Ec;this.qb=f.qb;this.rb=f.rb;this.Qa=f.Qa;this.wa=f.wa}else e=epmNtw.config.eventBusPrams.reconnectTimeout};epmNtw.$b.$inject=["epmNtw.messageDialogService","$rootScope","$http","$q"];angular.module("epmNtw").service("epmNtw.eventBusBaseService",epmNtw.$b);epmNtw.va=function(b,d,c,f,a,e){var h=this;epmNtw.$b.call(this,d,c,f,e);this.pc=!1;this.wa=function(){return"sid="+c.Uc+"&"};this.qb=function(b){epmNtw.config.Mc||!b?h.connect():f.jsonp(epmNtw.config.epmPlusPushXDPUrl+"/ssoAutheticate?"+h.wa()+"tjl="+c.Uc+"&callback=JSON_CALLBACK").success(function(b){b.czy_sesja_poprawna?(h.token=b.tpl,h.url=epmNtw.config.epmPlusPushXDPUrl+"/eventbus",h.Lb=epmNtw.config.epmPlusPushXDPUrl,h.connect()):(console.log("Token authentication failure"),e.when(a.Zb.promise).then(function(){c.$broadcast("errorMessage")}),
d.ha("ERROR",3,"300","77"),h.pc=!0)}).error(function(){console.log("Token authentication failure");e.when(a.Zb.promise).then(function(){c.$broadcast("errorMessage")});h.pc=!0;d.ha("ERROR",3,"300","77")})};h.Od=!0;h.Nd=epmNtw.enums.Ea.Ef;!1===this.xe&&this.qb(!0)};epmNtw.va.prototype=Object.create(epmNtw.$b.prototype);epmNtw.va.$inject="epmNtw.eventBusBaseService epmNtw.messageDialogService $rootScope $http epmNtw.apiService $q".split(" ");
angular.module("epmNtw").service("epmNtw.eventBusService",epmNtw.va);epmNtw.Da=function(b,d,c,f,a){var e=this;this.pinnedWindows=[];this.unpinnedWindows=[];this.unpinnedWindowsTemp=[];c.$on("kendoRendered",function(){c.$broadcast("postRender")});this.ha=function(){d.ha("ERROR",3,"300","77")};c.$on("errorMessage",function(){for(var a=0;a<e.unpinnedWindows.length;a++)e.unpinnedWindows[a].windowReference.angular.element("body").injector().get("epmNtw.windowsService").ha()});if(null!==window.opener&&void 0!==window.opener){var h=window.opener.angular.element("body").injector().get("epmNtw.windowsService");
this.pinnedWindows=h.pinnedWindows;this.unpinnedWindows=h.unpinnedWindows;this.unpinnedWindowsTemp=h.unpinnedWindowsTemp}this.WindowModel=function(a,b,c,d,f,e,h,q,v,y,z){this.elementId=a;this.controllerId=b;this.pseudoIsins=c;this.settings=f;this.type=e;this.windowReference=void 0;this.isUnpinned=h;this.securitesGroups=null!==d&&void 0!==d?d:[];this.isSortAlphabetic=!0;this.tableTitle=q;this.epmNtwWindowId=void 0;this.basketName=v;this.isSort=y;this.hiddenColumnsNames=void 0!==z&&0<z.length?z:[]};
this.Xf=function(a,b,c){a=new e.WindowModel(void 0,a,b,null,c,epmNtw.enums.o.QUOTES_TABLE,!1);e.pinnedWindows.push(a)};this.ad=function(a,b,c,h,p,t,u,q,v,y){if(null===b||void 0===b)b=(new Date).getTime();a=new e.WindowModel(a,b,c,h,p,t,!0,u,q,v,y);if(null===u||void 0===u)t===epmNtw.enums.o.QUOTES_TABLE?a.tableTitle=f("translate")("QUOTES_TABLE.TITLE"):t===epmNtw.enums.o.yc?a.tableTitle=c+f("translate")("TRANSACTION_TABLE.TITLE"):t===epmNtw.enums.o.DEFINED_ALERTS_LIST?a.tableTitle=f("translate")("ALERTS.LIST.DEFINED_TITLE"):
t===epmNtw.enums.o.COMPLETED_ALERTS_LIST?a.tableTitle=f("translate")("ALERTS.LIST.COMPLETED_TITLE"):a.tableTitle=""+c;c=e.qg(a,t);null===c||void 0===c?e.bg||(d.ha("WARNING","UNPINNED_WINDOWS_WERE_BLOCKED","300","77"),e.bg=!0):(a.windowReference=c,e.unpinnedWindowsTemp.push(a))};this.me=function(a,b,c,d,f,h,u,q,v,y){if(void 0===a)console.warn("internalApi openQuotesTable: parameter "+a+" is required");else{if(null===b||void 0===b)b=(new Date).getTime();a=new e.WindowModel(a,b,c,d,f,h,!1,u,q,v,y);"QUOTES_TABLE"===
h&&void 0!==f&&null!==f&&(a.rg=!0);e.pinnedWindows.push(a);e.ke(a,h);a.windowReference=window}};this.fd=function(a,b){for(var c=0;c<e.unpinnedWindows.length;c++)if(e.unpinnedWindows[c].controllerId==a){var d=e.unpinnedWindows[c].windowReference;e.unpinnedWindows.splice(c,1);!0===b&&d.close()}};this.ve=function(a){for(var b=0;b<e.pinnedWindows.length;b++)this.pinnedWindows[b].controllerId==a&&e.pinnedWindows.splice(b,1)};this.ke=function(d,f){var e=$("#"+d.elementId);if(e&&0<e.length){var h=c.$new();
h.windowModel=d;h.controllerId=d.controllerId;console.log("Opening new pinned "+f+". Controller id: "+d.controllerId+". Service id: "+b.Xa);f===epmNtw.enums.o.QUOTES_TABLE?e.prepend(a("<epm-ntw-quotes-table-directive></epm-ntw-quotes-table-directive>")(h)):f===epmNtw.enums.o.yc?e.prepend(a("<epm-ntw-transactions-table-directive></epm-ntw-transactions-table-directive>")(h)):f===epmNtw.enums.o.DEFINED_ALERTS_LIST?(console.log("Opening new pinned alertsListWindow. Controller id: "+d.controllerId+". Service id: "+
b.Xa),e.prepend(a("<epm-ntw-alerts-list-directive></epm-ntw-alerts-list-directive>")(h))):f===epmNtw.enums.o.COMPLETED_ALERTS_LIST?(console.log("Opening new pinned alertsListWindow. Controller id: "+d.controllerId+". Service id: "+b.Xa),e.prepend(a("<epm-ntw-alerts-list-directive></epm-ntw-alerts-list-directive>")(h))):f===epmNtw.enums.o.ALERT_EDITOR&&e.prepend(a("<epm-ntw-alerts-editor-directive></epm-ntw-alerts-editor-directive>")(h))}else console.warn("internalApi openQuotesTable: element with id: "+
d.elementId+" is not in DOM")};this.qg=function(a,b){a.epmNtwWindowId=(new Date).getTime();var c,d,f;f=screen.availWidth;var e=window.screenX,h=0;void 0!==a.settings&&null!==a.settings&&b!==epmNtw.enums.o.ALERT_EDITOR?(c=JSON.parse(a.settings),d=void 0!==c&&void 0!==c.width&&null!==c.width?c.width:c.columnSizeSum+17,d<epmNtw.enums.Ac.rd&&(d=epmNtw.enums.Ac.rd),void 0!==c.position&&null!==c.position&&(e=c.position.x,h=c.position.y)):d=b===epmNtw.enums.o.QUOTES_TABLE?epmNtw.config.quotesTable.initialUnpinnedGadgetWidth:
b===epmNtw.enums.o.yc?epmNtw.config.Nb.initialUnpinnedGadgetWidth:b===epmNtw.enums.o.DEFINED_ALERTS_LIST?epmNtw.config.alertsList.initialUnpinnedGadgetWidth:b===epmNtw.enums.o.COMPLETED_ALERTS_LIST?epmNtw.config.alertsList.initialUnpinnedGadgetWidth:b===epmNtw.enums.o.ALERT_EDITOR?epmNtw.config.alertEditor.initialUnpinnedGadgetWidth:epmNtw.config.Nb.initialUnpinnedGadgetWidth;f<d&&(d=f-18);var q;void 0!==c&&void 0!==c.height&&null!==c.height?q=c.height:0!==$("#"+a.elementId).length?q=$("#"+a.elementId).height():
b===epmNtw.enums.o.QUOTES_TABLE?q=epmNtw.config.quotesTable.initialGadgetHeight-13:q=b===epmNtw.enums.o.yc?epmNtw.config.Nb.initialGadgetHeight:b===epmNtw.enums.o.DEFINED_ALERTS_LIST?epmNtw.config.alertsList.initialGadgetHeight:b===epmNtw.enums.o.COMPLETED_ALERTS_LIST?epmNtw.config.alertsList.initialGadgetHeight:b===epmNtw.enums.o.ALERT_EDITOR?epmNtw.config.alertEditor.initialGadgetHeight:epmNtw.config.Nb.initialGadgetHeight;c=window.open(epmNtw.ra+"epmNtw.html?epmNtwWindowId="+a.controllerId,"_blank",
"status=no, titlebar=no, toolbar=no, resizable=yes, location=no, top="+h+"px, left="+e+"px, width="+d+", height="+q);console.log("Opening new unpinned "+b+". Controller id: "+a.controllerId);return c};this.fg=function(){for(var a=e.unpinnedWindows.length-1;0<=a;a--)e.unpinnedWindows[a].windowReference.close();e.unpinnedWindows=[]};this.Zd=function(a){for(var b=0;b<e.unpinnedWindowsTemp.length;b++)if(parseInt(e.unpinnedWindowsTemp[b].controllerId)===parseInt(a))return{index:b,windowModel:e.unpinnedWindowsTemp[b]}};
this.Zc=function(a){console.warn("Moving tempWindowModel");a=e.Zd(a);e.unpinnedWindowsTemp.splice(a.index,1);e.unpinnedWindows.push(a.windowModel);void 0!==b.va.pc&&!0===b.va.pc&&a.windowModel.windowReference.angular.element("body").injector().get("epmNtw.windowsService").ha()};$(window).bind("beforeunload",function(a){null!=a.currentTarget.window.opener&&void 0!=a.currentTarget.window.opener||e.fg()})};
epmNtw.Da.$inject=["epmNtw.quotesTableService","epmNtw.messageDialogService","$rootScope","$filter","$compile"];angular.module("epmNtw").service("epmNtw.windowsService",epmNtw.Da);epmNtw.he=function(b,d){this.utils=epmNtw.utils;this.Xa=(new Date).getTime();this.ha={};this.ha=function(c,f,a,e,h,l){a||(a="auto");e||(e="auto");a=b.open({modal:!0,width:a,height:e,title:d("translate")("MESSAGES."+c+".LABEL"),actions:[],templateUrl:epmNtw.ra+"shared/modules/message-dialog/message-dialog.view.html",controller:"epmNtw.messageDialogController",resolve:{"epmNtw.windowData":function(){return{dialogType:c,msg:"MESSAGES."+c+"."+f,params:h}}}});B.externalSystemFunctions.Gc&&B.externalSystemFunctions.Gc();
a.result.then(function(){void 0!=l&&l();B.externalSystemFunctions.jd&&B.externalSystemFunctions.jd()})}};epmNtw.he.$inject=["$kWindow","$filter"];angular.module("epmNtw.message-dialog").service("epmNtw.messageDialogService",epmNtw.he);epmNtw.Md=function(b,d,c,f,a,e){c.$watch(function(){return c.alternativeView},function(a,b){a!==b&&(epmNtw.config.quotesTable.isRowLineColumn=!epmNtw.config.quotesTable.isRowLineColumn,epmNtw.config.quotesTable.Gb=!epmNtw.config.quotesTable.Gb,epmNtw.config.quotesTable.showPercentageValueArrows=!epmNtw.config.quotesTable.showPercentageValueArrows,epmNtw.config.quotesTable.isSessionPhaseVolume=!epmNtw.config.quotesTable.isSessionPhaseVolume,epmNtw.config.quotesTable.ce=!epmNtw.config.quotesTable.ce)});
c.emptyQuotesTable=function(c,f,g){var k,m="PLPKO0000016 PLJSW0000015 PLINNGN00015 PLABCDT00014 PLABSIN00012 PL4FNMD00013 PL5AVNH00013".split(" "),p=(new Date).getTime(),t={allGroupsInTable:f,isSortAlphabetic:g};k=void 0!=c?c:m;d.Xf(p,m,t);b.Vc(k.length)&&a.open({modal:!1,width:"60%",height:"600px",title:e("translate")("QUOTES_TABLE.TITLE"),templateUrl:"epmNtw/modules/quotesTable/quotesTableView.html",controller:"epmNtw.quotesTableController",actions:["Custom","Close"],resolve:{initData:function(){var a;
f&&(a=0<f.length?f:void 0);return{isinsToAddResult:k,allGroupsInTableResult:a,isSortAlphabetic:g,controllerId:p}}}})};c.emptyQuotesTableInDiv=function(a){B.externalApi.openQuotesTable(a)};c.openSecuritiesCreatorFromApi=function(a){B.externalApi.Wh(a)};c.openSecuritiesCreator=function(){a.open({modal:!0,width:"40%",title:e("translate")("QUOTES_TABLE.TABLE_CREATOR.TITLE"),templateUrl:"epmNtw/modules/securities-creator/securities-creator.view.html",controller:"epmNtw.securitiesCreatorController",resolve:{initData:function(){return{Zh:[],
Qh:[],lastSortingArgs:c.lastSortingArgs}}}}).result.then(function(a){console.debug("openCreatorWithSecurities result:");console.debug(a);a&&c.emptyQuotesTable(a.Uh,a.Jh,a.sortAlphabetic)})};c.openNewQuotesTable=function(){switch(c.selectedWindowOpenMethod){case epmNtw.enums.Qb.Nf:elementId=void 0;pseudoIsins="PLPKO0000016 PLJSW0000015 PLINNGN00015 PLABCDT00014 PLABSIN00012 PL4FNMD00013 PL5AVNH00013".split(" ");settings=void 0;isUnpin=!1;elementId="quotesTableDiv";epmNtw.config.Yb=!1;B.externalApi.openQuotesTable(elementId,
pseudoIsins,settings,isUnpin);break;case epmNtw.enums.Qb.Of:elementId=void 0;pseudoIsins="PLPKO0000016 PLJSW0000015 PLINNGN00015 PLABCDT00014 PLABSIN00012 PL4FNMD00013 PL5AVNH00013".split(" ");settings=void 0;isUnpin=!0;epmNtw.config.Yb=!0;B.externalApi.openQuotesTable(elementId,pseudoIsins,settings,isUnpin);break;case epmNtw.enums.Qb.Pf:c.emptyQuotesTable();break;case epmNtw.enums.Qb.Qf:elementId=void 0,pseudoIsins="PLJSW0000015",settings=void 0,isUnpin=!1,elementId="quotesTableDiv",epmNtw.config.Yb=
!1,B.externalApi.oe(elementId,pseudoIsins,settings,isUnpin)}}};epmNtw.Md.$inject="epmNtw.quotesTableService epmNtw.windowsService $scope $rootScope $kWindow $filter".split(" ");angular.module("epmNtw.demo").controller("epmNtw.demoController",epmNtw.Md);epmNtw.Rd=function(b,d,c){function f(){var c=$("#"+d.controllerIdDemo),f=c.find(".k-grid-header-locked").width();if(null===f||void 0===f)f=0;c.find("td div").attr("style",function(){return"font-weight: "+(d.isBold?"bold":"normal")+" !important; font-size: "+d.fontSizeComboBox.value()+' !important; font-family: "'+d.fontComboBox.value()+'" !important;'});c.find("th").attr("style",function(){return"font-weight: "+(d.isBold?"bold":"normal")+" !important; font-size: "+d.fontSizeComboBox.value()+' !important; font-family: "'+
d.fontComboBox.value()+'" !important;'});c.find("td").attr("style",function(){return"font-weight: "+(d.isBold?"bold":"normal")+" !important; font-size: "+d.fontSizeComboBox.value()+' !important; font-family: "'+d.fontComboBox.value()+'" !important;'});var e=a.element.width()-f;c.find(".k-grid-header-wrap").attr("style",function(){return"width:"+(e-17)+"px !important;"});c.find(".transactionsTable .k-grid-header-wrap").attr("style",function(){return"width: auto !important;"});c.find(".k-grid-content").Eb()?
c.find(".k-grid-content-locked").attr("style",function(){return"bottom: 17px;"}):c.find(".k-grid-content-locked").attr("style",function(){return"bottom: 0px;"});var g=a.sa.height();b.Tc.hasClass("transactionsTable")&&(c.find(".k-grid-content table").attr("style",function(){return"width:"+(e-17)+"px;"}),epmNtw.utils.aa.Fb()&&(g+=1,f=0));c.find(".k-grid-content").attr("style",function(){return"top: "+g+"px;left: "+c.find(".k-grid-header-locked").width()+"px;width:"+e+"px;"});c.find(".k-grid-content-locked").attr("style",
function(){return"top: "+a.sa.height()+"px;width: "+f+"px;"});D(a)}d.controllerIdDemo="table_"+b.controllerId+"_preview";d.isAdjustColumnsWidthToWindowEnabled=!1;var a=new epmNtw.Grid(d.controllerIdDemo,void 0,!1,epmNtw.enums.o.QUOTES_TABLE,d);aa(a,b.Tc.clone(),void 0);a.element.find(".k-grid-toolbar").remove();a.element.find(".k-pager-wrap").remove();a.element.css("height","auto !important");a.content.find(".tr-display:gt(9)").remove();a.lockedContent.find(".tr-display:gt(9)").remove();a.element.find("[role='row']:gt(9)").remove();
ba(a);ca(a);b.Tc.hasClass("transactionsTable")&&(a.element.find("colgroup").remove(),a.sa.find("table").first().width("calc(100% - 17px)"));fontSizeArr=[];for(var e=0;12>e;e++)fontSizeArr.push({value:e+9+"px"});d.fontSizeDataSource=fontSizeArr;d.availableFonts=[];var h=new Detector,l="",g="",k=b.fontFamily;if(b.fontFamily&&(l=b.fontFamily.split(","))&&0<l.length)for(e=0;e<l.length;e++)if(g=l[e].trim().replace(/['"]+/g,""),console.debug("actual font "+g),h.detect(g)){console.debug("obslugiwana! "+
g);break}if(epmNtw.config.fontsToChoose&&0<epmNtw.config.fontsToChoose.length)for(e=0;e<epmNtw.config.fontsToChoose.length;e++)(l=epmNtw.config.fontsToChoose[e].trim())&&h.detect(l)?(d.availableFonts.push({value:l}),l==g&&(k=l)):console.warn("Font "+l+" is not available");else console.error("No fonts in config!");d.$on("kendoRendered",function(){$("#"+d.controllerIdDemo).append(a.element);d.isBold="bold"==b.fontWeight||700==b.fontWeight?!0:!1;d.fontSizeComboBox.value(b.fontSize);d.fontSizeChange({sender:d.fontSizeComboBox});
d.fontComboBox.select(function(a){return a.value==k});f();d.$apply();D(a)});d.$watch(function(){return d.isBold},function(a,b){a!==b&&(console.log(a),f())});d.fontSizeChange=function(){f()};d.fontChange=function(){f()};d.getSecuritiesDesignationDataItem=function(a){return a[b.securitiesDesignation]};d.getSecuritiesDesignationVarString=function(){return epmNtw.enums.Sd(b.Gg).langId.trim()};d.onCancel=function(){c.close(!1)};d.onConfirm=function(){c.close({fontSize:d.fontSizeComboBox.value(),fontWeight:d.isBold?
"bold":"normal",fontFamily:d.fontComboBox.value()})}};epmNtw.Rd.$inject=["epmNtw.inputObject","$scope","$windowInstance"];angular.module("epmNtw.font-change").controller("epmNtw.fontChangeController",epmNtw.Rd);epmNtw.fe=function(b,d,c){d.msg=b.msg;d.dialogType=b.dialogType;d.params={};for(key in b.params)d.params[key]=b.params[key];d.onOK=function(){c.close()}};epmNtw.fe.$inject=["epmNtw.windowData","$scope","$windowInstance"];angular.module("epmNtw.message-dialog").controller("epmNtw.messageDialogController",epmNtw.fe);epmNtw.ag=function(b,d,c,f,a,e){var h=!0===epmNtw.config.quotesTable.isToolbarVisible||!1===epmNtw.config.quotesTable.isToolbarVisible?!epmNtw.config.quotesTable.isToolbarVisible:!0,l=void 0,g=void 0,k=!1,m=!1,p;c.securitiesOptions={template:"<span>${ data.nazwa } (#:data.gielda# (#: data.waluta#))</span>",suggest:!0};var t=$("[toolbar_id='table_"+c.controllerId+"']"),u=$("[toolbar_id='table_"+c.controllerId+"'] .standardToolbar");c.loadToolbarState=function(a){c.isScrollingDisabled=a.isScrollingDisabled;
c.scrollingState=a.scrollingState;c.scrollingTime=a.scrollingTime;c.isAdjustColumnsWidthToWindowEnabled=a.isAdjustColumnsWidthToWindowEnabled;c.isHighlightingDisabled=a.isHighlightingDisabled;c.highlightingTime=a.highlightingTime;c.lineNumbersPerSecurityToDisplayHeaderClick=a.lineNumbersPerSecurityToDisplayHeaderClick;c.addNewRowAlwaysVisible=a.addNewRowAlwaysVisible;c.toolbarType=a.toolbarType;addNewRowToolbarIsVisible=a.ud;h=a.Vb;c.isAutomaticSortingDisabled=a.isAutomaticSortingDisabled;c.automaticSortingTime=
a.automaticSortingTime;c.presentFont=a.presentFont;c.isSortAlphabetic=a.isSortAlphabetic;p=a.securitiesDesignations;e(function(){c.lineNumbersPerSecurityToDisplay=a.lineNumbersPerSecurityToDisplay},0,!0)};void 0!==c.options&&null!==c.options?c.loadToolbarState(c.options.toolbarState):(c.scrollingTime=1E3*epmNtw.config.quotesTable.scrollingTime,c.isAutomaticSortingDisabled=epmNtw.config.quotesTable.isAutomaticSortingDisabled,c.isAdjustColumnsWidthToWindowEnabled=!1,c.isScrollingDisabled=epmNtw.config.quotesTable.isScrollingDisabled,
c.scrollingState=epmNtw.enums.Ga.tc,c.isHighlightingDisabled=epmNtw.config.quotesTable.isHighlightingDisabled,c.lineNumbersPerSecurityToDisplay=epmNtw.config.quotesTable.lineNumbersPerSecurityToDisplay,c.lineNumbersPerSecurityToDisplayHeaderClick=epmNtw.config.quotesTable.lineNumbersPerSecurityToDisplay,addNewRowToolbarIsVisible=c.addNewRowAlwaysVisible=!1,c.presentFont="");if(c.toolbarType==epmNtw.enums.ab.QUOTES_TABLE){c.securitiesDesignationsComboBoxTemplate="{{dataItem.langId | translate}}";c.automaticSortingTimesComboBoxTemplate=
"{{'TOOLBAR.AUTOMATIC_SORTING_TIMES' | translate: getTranslateParam(dataItem.value/1000)}}";c.highlightingTimesComboBoxTemplate="{{'TOOLBAR.HIGHLIGHTING_TIMES' | translate: getTranslateParam(dataItem.value/1000)}}";c.scrollingTimesComboBoxTemplate="{{'TOOLBAR.SCROLLING_TIMES' | translate: getTranslateParam(dataItem.value/1000)}}";c.$on("kendoRendered",function(){k||(console.log("kendoRendered"),c.isScrollingDisabled||c.enableScrolling(!0),c.isAutomaticSortingDisabled||E(),e(function(){c.lc();if(void 0!==
p&&c.toolbarType==epmNtw.enums.ab.QUOTES_TABLE)for(var a=0;a<c.securitiesDesignations.length;a++)if(c.securitiesDesignations[a].column===p){c.securitiesDesignationsComboBox.select(a);break}(!1===h&&c.addNewRowAlwaysVisible||addNewRowToolbarIsVisible)&&c.showOnlyAddRowToolbar()},0,!1),k=!0)});c.Vb=h;c.highlightingTimes=[];c.highlightingTitle=c.isHighlightingDisabled?a("translate")("TOOLBAR.HIGHLIGHTING_DISABLED"):a("translate")("TOOLBAR.HIGHLIGHTING_ENABLED");b=epmNtw.enums.Jf;for(var q in b)if(b[q].value&&
(c.highlightingTimes.push(b[q]),c.highlightingTime==b[q].value))var v=parseInt(q);c.enableHighlighting=function(){c.isHighlightingDisabled=!c.isHighlightingDisabled;c.highlightingTitle=c.isHighlightingDisabled?a("translate")("TOOLBAR.HIGHLIGHTING_DISABLED"):a("translate")("TOOLBAR.HIGHLIGHTING_ENABLED")};c.scrollingTimes=[];b=epmNtw.enums.Sf;c.scrollingTitle=a("translate")("TOOLBAR.SCROLLING_DISABLED");for(q in b)if(b[q].value&&(c.scrollingTimes.push(b[q]),c.scrollingTime==b[q].value))var y=parseInt(q);
c.enableScrolling=function(b){b&&(c.scrollingState=c.scrollingState-1,0>c.scrollingState&&(c.scrollingState=2));c.scrollingState==epmNtw.enums.Ga.tc?(c.isScrollingDisabled=!1,c.scrollingState=epmNtw.enums.Ga.wc,c.scrollingTitle=a("translate")("TOOLBAR.SCROLL_SINGLE_ROW"),l=setInterval(function(){z()},c.scrollingTime)):c.scrollingState==epmNtw.enums.Ga.wc?(c.scrollingState=epmNtw.enums.Ga.zc,c.scrollingTitle=a("translate")("TOOLBAR.SCROLL_WHOLE_AREA"),void 0!==l&&clearInterval(l),l=setInterval(function(){A()},
c.scrollingTime)):c.scrollingState==epmNtw.enums.Ga.zc&&(c.scrollingState=epmNtw.enums.Ga.tc,c.isScrollingDisabled=!0,c.scrollingTitle=a("translate")("TOOLBAR.SCROLLING_DISABLED"),void 0!==l&&clearInterval(l))};c.onScrollingTimeChange=function(){clearInterval(l);l=setInterval(function(){c.scrollingState==epmNtw.enums.Ga.wc?z():(c.scrollingState=epmNtw.enums.Ga.zc)&&A()},c.scrollingTime);console.log("scrolling time changed:"+c.scrollingTime+" state: "+c.scrollingState)};var z=function(){for(var a=
c.tableGrid.table.find("tr"),b=c.tableGrid.lockedContent.height(),d=0,f=c.tableGrid.content.scrollTop(),e=0,g=c.tableGrid.table.height(),h=0;h<a.length;h++){var k=a[h].offsetHeight;if(e<f)e+=k;else{e+b>=g?d=0:d=e>f?e:e+k;break}}$("#table_"+c.controllerId+" div.k-grid-content").scrollTop(d)},A=function(){for(var a=c.tableGrid.table.find(">tr"),b=c.tableGrid.lockedContent.height(),d=0,f=c.tableGrid.content.scrollTop(),e=0,g=c.tableGrid.table.height(),h=0;h<a.length;h++){var k=e,e=e+a[h].offsetHeight;
if(f+b>=g){d=0;break}else if(e>f+b){d=k;break}}$("#table_"+c.controllerId+" div.k-grid-content").scrollTop(d)};c.automaticSortingTimes=[];b=epmNtw.enums.Ie;c.automaticSortingTitle=c.isAutomaticSortingDisabled?a("translate")("TOOLBAR.SORTING_DISABLED"):a("translate")("TOOLBAR.SORTING_ENABLED");for(q in b)if(b[q].value&&(c.automaticSortingTimes.push(b[q]),c.automaticSortingTime==b[q].value))var F=parseInt(q);var E=function(){g=setInterval(function(){void 0!==c.lastSortingArgs?c.sortColumnData(c.lastSortingArgs.sortField,
c.lastSortingArgs.sortDirection,!1):c.sortColumnData(c.securitiesDesignationsComboBox.value().trim(),1,!1)},c.automaticSortingTime)};c.enableAutomaticSorting=function(){c.isAutomaticSortingDisabled=!c.isAutomaticSortingDisabled;c.automaticSortingTitle=c.isAutomaticSortingDisabled?a("translate")("TOOLBAR.SORTING_DISABLED"):a("translate")("TOOLBAR.SORTING_ENABLED");c.isAutomaticSortingDisabled?void 0!==g&&clearInterval(g):(E(),console.log("sorting time:"+c.automaticSortingTime))};c.onAutomaticSortingTimeChange=
function(){clearInterval(g);E()};c.securitiesDesignations=[];b=epmNtw.enums.Ma;for(q in b)b[q].column&&c.securitiesDesignations.push(b[q]);c.onSecuritiesDesignationChange=function(){e(function(){var a=c.securitiesDesignationsComboBox.value().trim(),b=c.securitiesDesignationsComboBox.text().trim(),d=c.tableGrid.lockedColumns[G(c.tableGrid,epmNtw.enums.ba.rc,!0).index];d.valueNames[0]=a;d.names[0]=b;c.tableGrid.element.find(".designation").each(function(b){$(this).html(c.tableGrid.dataSource[b][a])});
c.tableGrid.element.find(".designation-locked").html(b);if(!c.isAutomaticSortingDisabled)for(q in epmNtw.enums.Ma)c.lastSortingArgs.sortField==epmNtw.enums.Ma[q].column&&(c.lastSortingArgs.sortField=a)},0,!0)};c.lineNumbersPerSecurity=[];for(b=1;5>=b;b++)d={},d.value=b,c.lineNumbersPerSecurity.push(d);c.onLineNumberPerSecurityChange=function(a){console.time("Toolbar: setLineNumbersPerSecurity");a=void 0!==a?a:c.lineNumberPerSecurityComboBox.value().trim();da(c.tableGrid,a);console.timeEnd("Toolbar: setLineNumbersPerSecurity")};
c.onLineNumberPerSecurityChangeHeaderClick=function(){switch(parseInt(c.lineNumbersPerSecurityToDisplay)){case 1:case 2:c.lineNumbersPerSecurityToDisplay=3;break;case 3:case 4:c.lineNumbersPerSecurityToDisplay=5;break;case 5:c.lineNumbersPerSecurityToDisplay=1}c.onLineNumberPerSecurityChange(c.lineNumbersPerSecurityToDisplay);c.lineNumberPerSecurityComboBox.select(parseInt(c.lineNumbersPerSecurityToDisplay)-1)};c.$on("kendoWidgetCreated",function(b,d){d===c.scrollingTimesComboBox?(c.scrollingTimesComboBox.span.attr("title",
a("translate")("TOOLBAR.SCROLLING_COMBOBOX")),c.scrollingTimesComboBox.select(y)):d===c.highlightingTimesComboBox?(c.highlightingTimesComboBox.span.attr("title",a("translate")("TOOLBAR.HIGHLIGHTING_COMBOBOX")),c.highlightingTimesComboBox.select(v)):d===c.automaticSortingTimesComboBox?(c.automaticSortingTimesComboBox.span.attr("title",a("translate")("TOOLBAR.SORTING_COMBOBOX")),c.automaticSortingTimesComboBox.select(F)):d===c.securitiesDesignationsComboBox?(c.securitiesDesignationsComboBox.span.attr("title",
a("translate")("TOOLBAR.SECURITIES_DESIGNATION")),c.securitiesDesignationsComboBox.select(epmNtw.config.quotesTable.securitiesDesignation-1)):d===c.lineNumberPerSecurityComboBox&&(c.lineNumberPerSecurityComboBox.span.attr("title",a("translate")("TOOLBAR.LINES_PER_SECURITIE")),c.lineNumberPerSecurityComboBox.select(epmNtw.config.quotesTable.lineNumbersPerSecurityToDisplay-1))})}else c.$on("kendoRendered",function(){c.lc()});c.showHideTableToolbar=function(){c.lc()};c.lc=function(){0==u.length&&(u=
$(u.selector));0==t.length&&(t=$(t.selector));c.quotesTableToolbarType==epmNtw.enums.ab.QUOTES_TABLE?h||c.addNewRowAlwaysVisible&&addNewRowToolbarIsVisible?h&&!c.addNewRowAlwaysVisible?(u.hide(),c.unpinnedWindow||c.Be||t.hide(),u.find(".hiddenPartOfToolbar").hide(),h=!1):!h&&c.addNewRowAlwaysVisible?(u.show(),c.unpinnedWindow||t.show(),u.find(".hiddenPartOfToolbar").show(),h=!0):(h&&c.addNewRowAlwaysVisible&&(u.find(".hiddenPartOfToolbar").hide(),h=!1),u.find(".addNewRowToolbar .toolbarComboBox input").focus()):
(u.show(),c.unpinnedWindow||t.show(),u.find(".hiddenPartOfToolbar").show(),h=!0,addNewRowToolbarIsVisible=m=!1):h?(h=!1,c.unpinnedWindow||t.hide(),u.hide(),u.outerHeight(0)):(h=!0,c.unpinnedWindow||t.show(),u.show(),u.height(25.5837));c.tableGrid.qa()};c.Sh=function(){c.lc()};c.showOnlyAddRowToolbar=function(){0==u.length&&(u=$(u.selector));if(h||m||c.addNewRowAlwaysVisible)if(h||!m||c.addNewRowAlwaysVisible)u.find(".addNewRowToolbar .toolbarComboBox input").focus();else{u.toggle();u.find(".hiddenPartOfToolbar").show();
c.unpinnedWindow||t.toggle();addNewRowToolbarIsVisible=m=!1;try{c.tableGrid.parentElement.focus()}catch(a){console.log("Quotes select Focus after render Assertion Type - toolbar hide")}}else u.show(),c.unpinnedWindow||t.show(),u.find(".hiddenPartOfToolbar").hide(),c.addNewRowAlwaysVisible||(m=!0),addNewRowToolbarIsVisible=!0,u.find(".addNewRowToolbar .toolbarComboBox input").focus();c.tableGrid.qa()};c.getTranslateParam=function(a){return"{param: "+a+"}"};c.openFontChangeWindow=function(){var b=$("#table_"+
c.controllerId),d=f.open({modal:!0,resizable:!1,width:845,height:385,title:a("translate")("TOOLBAR.CHANGE_FONT_WINDOW_TITLE")+c.title,templateUrl:epmNtw.ra+"shared/modules/font-change/font-change.view.html",controller:"epmNtw.fontChangeController",resolve:{"epmNtw.inputObject":function(){var a=b.find("td");return{controllerId:c.controllerId,Tc:epmNtw.utils.aa.eg(c.tableGrid.element),Xh:c.getRows(),fontSize:a.css("font-size"),fontWeight:a.css("font-weight"),fontFamily:a.css("font-family"),securitiesDesignation:void 0===
c.securitiesDesignationsComboBox?epmNtw.enums.Qc(epmNtw.config.quotesTable.securitiesDesignation-1):c.securitiesDesignationsComboBox.value().trim(),Gg:c.securitiesDesignationsComboBox?c.securitiesDesignationsComboBox.value().trim():epmNtw.enums.Qc(epmNtw.config.quotesTable.securitiesDesignation-1).column}}}});void 0!==B.externalSystemFunctions.Gc&&B.externalSystemFunctions.Gc();if(c.unpinnedWindow)var e=epmNtw.utils.aa.Yf(epmNtw.enums.Ac.Ff);d.result.then(function(a){console.debug("fontChangeWindow result:");
console.debug(a);c.unpinnedWindow&&e.Yh&&window.resizeTo(e.width,e.height);a?(epmNtw.config.presentFont=a.fontFamily,c.presentFont=a,c.Wb(),c.tableGrid.qa(),D(c.tableGrid)):console.debug("titleChangeWindow canceled");void 0!==B.externalSystemFunctions.jd&&B.externalSystemFunctions.jd()})};c.Wb=function(){if(!jQuery.isEmptyObject(c.presentFont)){var a=$("#table_"+c.controllerId),b=a.find("th").first().css("display")?"display: "+a.find("th").first().css("display")+";":"",d="font-weight: "+c.presentFont.fontWeight+
" !important; font-size: "+c.presentFont.fontSize+" !important; font-family: "+c.presentFont.fontFamily+" !important";"bold"==c.presentFont.fontWeight||700==c.presentFont.fontWeight?a.find("td").addClass("bold-text"):a.find("td").removeClass("bold-text");a.find("td").attr("style",b+d);a.find("th").attr("style",b+d)}};c.enableAdjustColumnsWidthToWindow=function(){c.isAdjustColumnsWidthToWindowEnabled=!c.isAdjustColumnsWidthToWindowEnabled;c.isAdjustColumnsWidthToWindowEnabled?(c.tableGrid.qa(),c.tableGrid.Ha(0),
c.tableGrid.content.css("overflow-x","hidden")):c.tableGrid.content.css("overflow-x","auto")};c.adjustColumnsToContent=function(){c.isAdjustColumnsWidthToWindowEnabled||(c.tableGrid.Oc(),c.tableGrid.adjustSize())};c.adjustColumnsWidthToWindow=function(a,b,d){c.tableType===epmNtw.enums.o.QUOTES_TABLE&&e(function(){c.tableGrid.Ha(a,b,d)},0,!0)};c.saveToolbarState=function(){var a={};a.isScrollingDisabled=c.isScrollingDisabled;a.scrollingState=c.scrollingState;a.scrollingTime=c.scrollingTime;a.isAdjustColumnsWidthToWindowEnabled=
c.isAdjustColumnsWidthToWindowEnabled;a.isHighlightingDisabled=c.isHighlightingDisabled;a.highlightingTime=c.highlightingTime;a.lineNumbersPerSecurityToDisplay=c.lineNumbersPerSecurityToDisplay;a.addNewRowAlwaysVisible=c.addNewRowAlwaysVisible;a.ud=addNewRowToolbarIsVisible;a.isAutomaticSortingDisabled=c.isAutomaticSortingDisabled;a.automaticSortingTime=c.automaticSortingTime;a.toolbarType=c.toolbarType;a.Vb=!h;a.presentFont=c.presentFont;a.isSortAlphabetic=c.isSortAlphabetic;a.Kg=m;c.toolbarType==
epmNtw.enums.ab.QUOTES_TABLE&&(a.securitiesDesignations=c.securitiesDesignationsComboBox.value().trim());return a}};epmNtw.Ee=function(b,d,c,f,a,e,h,l,g){c.bi=!0;h.invoke(["$attrs","$rootScope","$scope","$kWindow","$filter","$timeout",epmNtw.ag],this,{$attrs:b,$scope:c,$kWindow:f});c.saveSettings=function(){var a=c.saveTable();l.when(B.externalSystemFunctions.saveTable(c.unpinnedWindow?c.title:c.elementId,a).promise).then(function(){g.ha("INFO","SETTINGS_SAVED","300","90")},function(){g.ha("ERROR","SETTINGS_SAVING_ERROR","300","90")})}};epmNtw.Ee.$inject="$attrs $rootScope $scope $kWindow $filter $timeout $injector $q epmNtw.messageDialogService".split(" ");
angular.module("epmNtw.table-toolbar").controller("epmNtw.toolbarController",epmNtw.Ee);epmNtw.fa=function(b){this.$scope=b;this.gg=new Intl.Collator};function K(b,d){var c=b.$scope.tableGrid.jb[d].type;switch(c){case "number":c="sortNumber";break;case "date":c="sortDate";break;case "time":c="sortTime";break;case "string":c="sortString";break;case "pkcPcr":c="sortPkcPcr";break;case "percent":c="sortPercent";break;default:console.warn("Wrong sort type: "+c);return}return c}
epmNtw.fa.prototype.sortColumnData=function(b,d,c){this.$scope.lastSortingArgs={};this.$scope.lastSortingArgs.sortField=b;this.$scope.lastSortingArgs.sortDirection=d;for(var f=[],a=[],e=0;e<this.$scope.tableGrid.dataSource.length;e++)if(this.$scope.tableGrid.dataSource[e].separator)a.push(e);else{var h={};h.dataSource=this.$scope.tableGrid.dataSource[e];c||(h.locked=this.$scope.tableGrid.table[0].rows[e],h.unlocked=this.$scope.tableGrid.table[1].rows[e]);f.push(h)}for(e=0;e<a.length;e++)this.$scope.tableGrid.removeSeparator(a[e]);
console.time("sorting "+f.length+" items  - execution time:");console.time("bubbleSort: ");f=ea(this,f,b,d);console.timeEnd("bubbleSort: ");if(c)return f.map(function(a){return a.dataSource});console.time("sorting "+f.length+" items  - execution time:");fa(this,f);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()};
function fa(b,d){console.time("addNewRowsOrderAppend - execution time:");for(var c=[],f=0;f<d.length;f++)!b.$scope.tableGrid.table[0].appendChild(d[f].locked),!b.$scope.tableGrid.table[1].appendChild(d[f].unlocked),c.push(d[f].dataSource);b.$scope.tableGrid.dataSource=c;console.timeEnd("addNewRowsOrderAppend - execution time:")}epmNtw.fa.prototype.Qg=function(b,d,c){return void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*this.gg.compare(b,d)};
goog.exportProperty(epmNtw.fa.prototype,"sortString",epmNtw.fa.prototype.Qg);epmNtw.fa.prototype.Ng=function(b,d,c){d===epmNtw.enums.Bc&&(d=0);return void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*(parseFloat(b)-parseFloat(d))};goog.exportProperty(epmNtw.fa.prototype,"sortNumber",epmNtw.fa.prototype.Ng);epmNtw.fa.prototype.Og=function(b,d,c){0===b&&(b="");d===epmNtw.enums.Bc?d=0:0===d&&(d="");return void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*(parseFloat(b)-parseFloat(d))};
goog.exportProperty(epmNtw.fa.prototype,"sortPercent",epmNtw.fa.prototype.Og);epmNtw.fa.prototype.Pg=function(b,d,c){return-2===b?-1:-2===d?1:void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*(parseFloat(b)-parseFloat(d))};goog.exportProperty(epmNtw.fa.prototype,"sortPkcPcr",epmNtw.fa.prototype.Pg);epmNtw.fa.prototype.Mg=function(b,d,c){return void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*((new Date(b)).getTime()-(new Date(d)).getTime())};
goog.exportProperty(epmNtw.fa.prototype,"sortDate",epmNtw.fa.prototype.Mg);epmNtw.fa.prototype.Rg=function(b,d,c){return void 0===b||""===b||void 0===d||""===d?this.Ya(b,d,c):c*((new Date("1970/01/01 "+b)).getTime()-(new Date("1970/01/01 "+d)).getTime())};goog.exportProperty(epmNtw.fa.prototype,"sortTime",epmNtw.fa.prototype.Rg);epmNtw.fa.prototype.Ya=function(b,d,c){return void 0!==b&&""!==b||void 0===d||""===d?void 0===b||""===b||void 0!==d&&""!==d?0:1*c:-1*c};
goog.exportProperty(epmNtw.fa.prototype,"sortEmptyValue",epmNtw.fa.prototype.Ya);function ea(b,d,c,f){for(var a=b[K(b,c)],e,h=0,l=d.length;h<l;h++)for(var g=h;0<g;g--)0>a.call(b,d[g].dataSource[c],d[g-1].dataSource[c],f)&&(e=d[g],d[g]=d[g-1],d[g-1]=e);return d};epmNtw.da=function(b,d,c,f,a,e){this.columnName=b;this.translations=d;this.yb=c;this.columnType=f;this.buySellType=a;this.hideable=void 0!=e?e:!0;this.Yc=!1};epmNtw.pd=function(){};epmNtw.j=function(b,d){this.translate=b;this.tableGrid=d};epmNtw.j.prototype.nazwa={type:"string",formatter:"",format:""};epmNtw.j.prototype.nazwaSkrocona={type:"string",formatter:"",format:""};epmNtw.j.prototype.gielda={type:"string",formatter:"",format:""};epmNtw.j.prototype.waluta={type:"string",formatter:"",format:""};epmNtw.j.prototype.kursOdniesienia={type:"number",formatter:"openFieldFormatFilter",format:"custom"};
epmNtw.j.prototype.otwartePoz={type:"number",formatter:"openFieldFormatFilter",format:"n0"};epmNtw.j.prototype.kursOtwarcia={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype.kursMin={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype.kursMax={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype.kursTKO={type:"number",formatter:"standardFormatFilter",format:"custom"};
epmNtw.j.prototype.kursZmianaTKO={type:"percent",formatter:"TKOPercentageFormatFilter",format:"n2",showPercentageValueArrows:!0};epmNtw.j.prototype.two={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.zmianaProc={type:"number",formatter:"percentageFormatFilter",format:"n2",showPercentageValueArrows:!0};epmNtw.j.prototype.dolneWidelki={type:"number",formatter:"standardFormatFilter",format:"custom"};
epmNtw.j.prototype.gorneWidelki={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-1-k-lk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-2-k-lk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-3-k-lk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-4-k-lk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype["oferta-5-k-lk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-1-k-wk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-2-k-wk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-3-k-wk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-4-k-wk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype["oferta-5-k-wk"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-1-k-kk"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-2-k-kk"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-3-k-kk"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-4-k-kk"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};
epmNtw.j.prototype["oferta-5-k-kk"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-1-s-ks"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-2-s-ks"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-3-s-ks"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};
epmNtw.j.prototype["oferta-4-s-ks"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-5-s-ks"]={type:"pkcPcr",formatter:"pkcPcrFieldFormatFilter",format:"custom"};epmNtw.j.prototype["oferta-1-s-ws"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-2-s-ws"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-3-s-ws"]={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype["oferta-4-s-ws"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-5-s-ws"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-1-s-ls"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-2-s-ls"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-3-s-ls"]={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype["oferta-4-s-ls"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["oferta-5-s-ls"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["trans-1-kurs"]={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-2-kurs"]={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-3-kurs"]={type:"number",formatter:"standardFormatFilter",format:"custom"};
epmNtw.j.prototype["trans-4-kurs"]={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-5-kurs"]={type:"number",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-1-wolumen"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["trans-2-wolumen"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["trans-3-wolumen"]={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype["trans-4-wolumen"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["trans-5-wolumen"]={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype["trans-1-czas"]={type:"time",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-2-czas"]={type:"time",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-3-czas"]={type:"time",formatter:"standardFormatFilter",format:"custom"};
epmNtw.j.prototype["trans-4-czas"]={type:"time",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype["trans-5-czas"]={type:"time",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype.wolumen={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.WolFix1={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.WolFix2={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype.statusGrupy={type:"string",formatter:"translateFormatFilter",format:""};epmNtw.j.prototype.status={type:"string",formatter:"translateFormatFilter",format:""};epmNtw.j.prototype.obrot={type:"number",formatter:"obrotFormatFilter",format:"n2"};epmNtw.j.prototype.wolumen_o={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.wolumen_c={type:"number",formatter:"standardFormatFilter",format:"n0"};
epmNtw.j.prototype.wolumen_z={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.wolumen_d={type:"number",formatter:"standardFormatFilter",format:"n0"};epmNtw.j.prototype.obrot_o={type:"number",formatter:"standardFormatFilter",format:"n2"};epmNtw.j.prototype.obrot_c={type:"number",formatter:"standardFormatFilter",format:"n2"};epmNtw.j.prototype.obrot_z={type:"number",formatter:"standardFormatFilter",format:"n2"};
epmNtw.j.prototype.obrot_d={type:"number",formatter:"standardFormatFilter",format:"n2"};epmNtw.j.prototype.kursWazonyObrot={type:"number",formatter:"standardFormatFilter",format:"n2"};epmNtw.j.prototype.czasPub={type:"time",formatter:"standardFormatFilter",format:"custom"};epmNtw.j.prototype.translateFormatFilter=function(b){return this.translate(b)};
epmNtw.j.prototype.standardFormatFilter=function(b,d){var c=d.format;if(0===b)return"";"custom"===c&&void 0!==b&&(c=epmNtw.utils.aa.nb(b));return kendo.toString(b,c)};epmNtw.j.prototype.openFieldFormatFilter=function(b,d){var c=d.format;if(0===b)return"0";if("EMPTY_VALUE"===b)return"";"custom"===c&&void 0!==b&&(c=epmNtw.utils.aa.nb(b));return kendo.toString(b,c)};
epmNtw.j.prototype.pkcPcrFieldFormatFilter=function(b,d){var c=d.format;if(-2===b)return"PKC/PCR";if(0===b)return"";"custom"===c&&void 0!==b&&(c=epmNtw.utils.aa.nb(b));return kendo.toString(b,c)};epmNtw.j.prototype.TKOPercentageFormatFilter=function(b,d){return 0===b?"":kendo.toString(b,d.format)+"%"};epmNtw.j.prototype.percentageFormatFilter=function(b,d){return"EMPTY_VALUE"===b?"":kendo.toString(b,d.format)+"%"};
epmNtw.j.prototype.obrotFormatFilter=function(b,d){var c=d.format;if(0===b)return"";epmNtw.config.quotesTable.showFullDealing||(b/=1E3);return kendo.toString(b,c)};function ga(b,d,c){if(void 0===b[d])return c;if(void 0===c||null===c)return"";var f=b[d].formatter;return""===f?c:b[f](c,b[d])}
function ha(b,d){console.time("Grid: getFormattedSnapshot");for(var c={},f=0;f<d.length;f++){c[f]={};for(var a in d[f]){var e=d[f][a];if(epmNtw.config.quotesTable.showPercentageValueArrows&&void 0!=b[a]&&!0===b[a].showPercentageValueArrows){var h=c[f],l=a+"_arrowClassName",g;g=b;var k="";if(void 0===e||0==e)g=k;else{var m;m=g.tableGrid.Kc;var p=e,t=epmNtw.enums.Bc;m=m[K(m,a)](p,t,1);0<m?k=g.tableGrid.gb.Ic:0>m&&(k=g.tableGrid.gb.Hc);g=k}h[l]=g}c[f][a]=ga(b,a,e)}}console.timeEnd("Grid: getFormattedSnapshot");
return c};epmNtw.Hf=function(b,d,c){this.Za={};this.colors={};this.fc={};this.$scope=d;this.tableGrid=b;this.ka=c;this.Gb=epmNtw.config.quotesTable.isValueHighlighting;this.showPercentageValueArrows=epmNtw.config.quotesTable.showPercentageValueArrows;this.Ed=this.Gb?"red-value":"red";this.Dd=this.Gb?"green-value":"green";this.eb=this.Gb?"yellow-value":"yellow";this.Ic="epmNtwUpArrow";this.Hc="epmNtwDownArrow"};
function P(b,d,c,f){var a=(new Date).getTime();void 0!==b.colors[d]&&b.colors[d].className!==c&&f.removeClass(b.colors[d].className);b.colors[d]={time:a,className:c}}function ia(b,d){void 0===b.fc[d]&&(b.fc[d]=$(document.getElementById(d)));return b.fc[d]};epmNtw.Grid=function(b,d,c,f,a,e,h,l,g,k){this.element=this.content=this.tbody=this.lockedContent=void 0;this.dataSource=[];this.table=this.ma=this.lockedColumns=this.columns=void 0;this.options={};this.header=this.sa=this.lockedHeader=void 0;this.controllerId=b;this.parentElement=d;this.Sa=c;this.tableType=f;this.Mb=a;this.$scope=e;this.$timeout=h;this.$compile=g;this.Ab=this.Bb=this.ib=void 0;this.jb=new epmNtw.j(l,this);this.gb=new epmNtw.Hf(this,e,k);this.Kc=new epmNtw.fa(e);this.Ca=new epmNtw.vc(e.Wc)};
function aa(b,d,c){b.toolbar=c;b.element=d;b.lockedContent=d.find(".k-grid-content-locked");b.content=d.find(".k-grid-content");b.tbody=b.content.find("tbody");b.table=d.find("tbody");b.lockedHeader=d.find(".k-grid-header-locked");b.sa=d.find(".k-grid-header-wrap");b.header=d.find(".k-grid-header")}
function ja(b){ba(b);ka(b);la(b);ma(b);0<b.dataSource.length&&R(b);na(b);oa(b);console.time("Dopasowanie");ca(b);b.$scope.contextMenuInit();console.timeEnd("Dopasowanie");b.Mb&&b.Cd();qa(b);b.Sa&&(b.qa(),$(window).bind("resize",function(){b.adjustSize();$("#menu_"+b.controllerId).hide()}))}
function ra(b){for(var d={intCounterVisibleLocked:0,intCounterVisibleUnlocked:0},c=0;c<b.lockedColumns.length;c++)!1===b.lockedColumns[c].hidden&&++d.intCounterVisibleLocked;for(c=0;c<b.ma.length;c++)!1===b.ma[c].hidden&&++d.intCounterVisibleUnlocked;return d}n=epmNtw.Grid.prototype;
n.addSeparator=function(b,d){this.dataSource.splice(b,0,{row_class:"tr-1-display",separator:!0,isin_adress:d.separatorId});$(d.htmlSeparatorLockedContent).insertBefore(this.lockedContent.find("tr").eq(b));var c=$(d.htmlSeparatorUnlockedContent);sa(this,c);c.insertBefore(this.content.find("tr").eq(b));S(this,void 0,!0);R(this)};n.removeSeparator=function(b,d){this.dataSource.splice(b,1);!0!==d&&(this.lockedContent.find("tr").eq(b).remove(),this.content.find("tr").eq(b).remove());S(this,void 0,!0)};
function ta(b){for(var d=ra(b),c=0;c<b.dataSource.length;c++)!0===b.dataSource[c].separator&&(b.lockedContent.find("tr").eq(c).find("td").each(function(){$(this).attr("colspan",d.intCounterVisibleLocked)}),b.content.find("tr").eq(c).find("td").each(function(){$(this).attr("colspan",d.intCounterVisibleUnlocked)}))}
function D(b){console.time("Grid: adjustLockedHeaderHeight");var d=b.lockedHeader.find("tr"),c=b.sa.outerHeight(),f=d.height();null!==f&&void 0!==f&&(console.warn("contentHeaderHeight: "+c+" lockedHeaderHeight: "+f),c!==f&&(d.removeAttr("style"),console.log("Wysokosc "+c),d.height(c+"px"),epmNtw.utils.aa.Fb()&&(th=b.lockedHeader.find("th"),th.height(c+"px"))));console.timeEnd("Grid: adjustLockedHeaderHeight")}
function ca(b){console.time("Grid: adjustContentHeaderWidth");b.content.dc()||b.sa.width(b.sa.width()+17);console.timeEnd("Grid: adjustContentHeaderWidth")}
n.Ha=function(b,d,c,f){console.time("Grid: adjustColumnsToWindow");var a="#table_"+this.controllerId,e=$(a).find(".k-grid-header-wrap colgroup col"),h=$(a).find(".k-grid-content colgroup col");$(a+" .headerContentPadding > span").css("text-overflow","ellipsis");for(var l=0,g=0;g<b;g++)l+=e.eq(g).width();var k;k="ISIN_TRANSACTION_TABLE"!=this.tableType&&"COMPLETED_ALERTS_LIST"!=this.tableType&&$(a).find(".k-grid-content").dc()?17:0;g=$(a).find(".k-grid-content").width()-k;"ISIN_TRANSACTION_TABLE"==
this.tableType||"COMPLETED_ALERTS_LIST"==this.tableType||"DEFINED_ALERTS_LIST"==this.tableType?(lockedColumnsCount=0,this.columns.hidden=[]):lockedColumnsCount=this.lockedContent?this.lockedContent[0].children[0].children[0].childElementCount:0;var m=$(a).find(".k-grid-content").width(),p=$(a+" .k-grid-content table").width()-l;void 0!==c&&0!==c&&(m-=c);m=m-k-l;p=m/p;if(1===p)console.timeEnd("Grid: adjustColumnsToWindow");else if(l+k>=g)e.eq(b-1).width(d),h.eq(b-1).width(d);else{for(var l=[],t=0,
u=0,g=b;g<h.length;g++){var q=e.eq(g).width(),v=q*p,y=Math.floor(v);y<epmNtw.enums.QUOTES_TABLE.Oa&&!f?(l[g]=epmNtw.enums.QUOTES_TABLE.Oa,u+=epmNtw.enums.QUOTES_TABLE.Oa-y,console.log("mniejszy "+v+" "+epmNtw.enums.QUOTES_TABLE.Oa)):(l[g]=y,t+=v-y);1<=t&&(l[g]+=1,--t);0>l[g]-1&&1>l[g]-1&&console.warn("Size of column "+g+" is below 0: "+l[g]);1===h.length-g&&(l[g]+=t)}if(0<u){f=!1;for(g=b;g<h.length;g++)if(q=e.eq(g).width(),v=q*p,y=Math.floor(v),y-u>epmNtw.enums.QUOTES_TABLE.Oa){console.log("PS: "+
q);l[g]=y-Math.floor(u);0>l[g]-1&&1>l[g]-1&&console.warn("Size of column "+g+" is below 0: "+l[g]);f=!0;break}if(!f){console.log("Too small columns. Ignore min width");console.timeEnd("Grid: adjustColumnsToWindow");this.Ha(b,d,c,!0);return}}for(g=b;g<h.length;g++)e.eq(g).width(l[g]),h.eq(g).width(l[g]),this.columns[g+lockedColumnsCount].width=l[g];$(a+" .k-grid-content table").css("width",m+"px");$(a+" .k-grid-header-wrap table").css("width",m+"px");this.Sa&&"ISIN_TRANSACTION_TABLE"!=this.tableType&&
($(a+" .k-grid-content").css("width",m+k+"px"),$(a+" .k-grid-header-wrap").css("width",m+"px"));0===$(a+" .k-grid-content-locked table tr:first-child td").length&&$(a+" .k-grid-content-expander").css("width",m+k+"px");epmNtw.utils.aa.Fb()&&"ISIN_TRANSACTION_TABLE"!=this.tableType&&"COMPLETED_ALERTS_LIST"!=this.tableType&&"DEFINED_ALERTS_LIST"!=this.tableType&&D(this);console.timeEnd("Grid: adjustColumnsToWindow")}};
n.Oc=function(){console.time("Grid: fitColumnsToContent");var b="#table_"+this.controllerId,d="initial";epmNtw.utils.aa.Fb()&&(d="auto");$(b+" .headerContentPadding > span").css("text-overflow","clip");$(b+" .red, .green, .yellow, .white, .red-value, .green-value, .yellow-value, .white-value").css("text-overflow","clip");var c,f=$(b+" .k-grid-header-locked table colgroup col").filter(function(){return"none"!=$(this).css("display")}),a=$(b+" .k-grid-content-locked table colgroup col").filter(function(){return"none"!=
$(this).css("display")});"ISIN_TRANSACTION_TABLE"==this.tableType?(c=0,this.columns.hidden=[]):c=this.lockedContent?a.length:0;var e=$(b+" .k-grid-content").width()+$(b+" .k-grid-content-locked").width();$(b+" .k-grid-header-locked").css("width",d);$(b+" .k-grid-header-locked table").css("width",d);$(b+" .k-grid-content-locked").css("width",d);$(b+" .k-grid-content-locked table").css("width",d);for(var h=[],l=0,g=0;g<c;g++)f.eq(g).width(0),a.eq(g).width(0);for(var k=$(b+" .k-grid-header-locked table th"),
m=$(b+" .k-grid-content tr:first-child td"),p=$(b+" .k-grid-content-locked table tr:first-child td"),g=1;m.eq(0).hasClass("no-data");)m=$(b+" .k-grid-content tr").eq(g).find("td"),p=$(b+" .k-grid-content-locked table tr").eq(g).find("td"),g++;for(var t=p.length,u=m.length,q=$(b+" .k-grid-header-wrap table th"),v=p.length,g=this.columns.length-1;0<=g;g--)this.columns[g].hidden&&this.columns[g].locked?(k.splice(g,1),p.splice(g,1)):this.columns[g].hidden&&!this.columns[g].locked&&(m.splice(g-v,1),q.splice(g-
v,1));for(g=0;g<c;g++)0===t&&(p[g]={offsetWidth:0}),h[g]=k[g].offsetWidth>=p[g].offsetWidth?k[g].offsetWidth+1:p[g].offsetWidth+1,l+=h[g];for(g=k=0;g<c;g++){f.eq(g).width(h[g]);a.eq(g).width(h[g]);if(this.columns[g].hidden)for(k++,p=g+1;;p++)if(this.columns[p].hidden)k++,g=p;else break;this.columns[g+k].width=h[g]}$(b+" .k-grid-header-locked").css("width",l+"px");$(b+" .k-grid-header-locked table").css("width","");$(b+" .k-grid-content-locked .no-data").css("width","0px");$(b+" .k-grid-content-locked").css("width",
l+"px");$(b+" .k-grid-content-locked table").css("width","");e-=l;g="ISIN_TRANSACTION_TABLE"==this.tableType?0:0>$(b+" .k-grid-content").height()-$(b+" .k-grid-content table").height()?17:0;$(b+" .k-grid-content").css("width",e+"px");$(b+" .k-grid-header-wrap").css("width",e-g+"px");e=this.element.find(".k-grid-header-wrap colgroup col").filter(function(){return"none"!=$(this).css("display")});f=this.element.find(".k-grid-content colgroup col").filter(function(){return"none"!=$(this).css("display")});
h=f.length;$(b+" .k-grid-content table").css("width",d);$(b+" .k-grid-header-wrap table").css("width",d);for(g=0;g<h;g++)e.eq(g).width(0),f.eq(g).width(0);d=[];h=[];for(g=h=0;g<q.length;g++)0===t+u&&(m[g]={offsetWidth:0}),d[g]=q[g].offsetWidth>=m[g].offsetWidth?q[g].offsetWidth+1:m[g].offsetWidth+1,h+=d[g];if("ISIN_TRANSACTION_TABLE"!==this.tableType)for(g=0;g<f.length;g++){e.eq(g).width(d[g]);f.eq(g).width(d[g]);if(this.columns[g+c+k].hidden)for(k++,p=g+c+k+1;;p++)if(this.columns[p].hidden)k++;else break;
this.columns[g+c+k].width=d[g]}else for(g=0;g<f.length;g++)e.eq(g).width(d[g]),f.eq(g).width(d[g]),this.columns[g+c+k].width=d[g];$(b+" .k-grid-content table .no-data").width("0px");$(b+" .k-grid-content table").width(h+"px");$(b+" .k-grid-header-wrap table").width(h+"px");0===t&&$(b+" .k-grid-content-expander").css("width",h+"px");epmNtw.utils.aa.Fb()&&"ISIN_TRANSACTION_TABLE"!=this.tableType&&D(this);console.timeEnd("Grid: fitColumnsToContent")};
n.Tb=function(){console.time("Grid: adjustWidth");console.log("kendoGrid: adjustWidth for "+this.controllerId);if(void 0==this.content||null==this.content)console.warn("kendoGrid: adjustWidth tableGrid.content of undefined");else{var b=this.element.width(),d=0;void 0!==this.lockedContent&&(d=this.lockedContent.width());b-=d;this.content.width(b);this.sa.width(b);this.Sb();console.timeEnd("Grid: adjustWidth")}};
n.qa=function(){console.time("Grid: adjustHeight");if(void 0==this.content||null==this.content)console.warn("kendoGrid: adjustHeight tableGrid.content of undefined");else{var b=this.element,d=this.toolbar,c;this.Sa?c=window.innerHeight:this.Sa||(c=this.parentElement.height());void 0===c&&(c="ISIN_TRANSACTION_TABLE"==this.tableType?epmNtw.config.Nb.initialGadgetHeight:"DEFINED_ALERTS_LIST"==this.tableType||"COMPLETED_ALERTS_LIST"==this.tableType?epmNtw.config.alertsList.initialGadgetHeight:epmNtw.config.quotesTable.initialGadgetHeight);
b.parent().height(c);"none"===d.css("display")?b=0:0<d.outerHeight(!0)?b=d.outerHeight(!0):(b=18,d.find(".hiddenPartOfToolbar").is(":visible")&&(b+=27),d.find(".addNewRowToolbar").is(":visible")&&(b+=31));var d=this.header.outerHeight(!0),f=0,a=this.element.find(".k-pager-wrap");void 0!==a&&("COMPLETED_ALERTS_LIST"==this.tableType?f=31:f=a.outerHeight(!0));var a=0,e=this.element.siblings(".alerts-button-list");void 0!==e&&(a=e.outerHeight(!0));"DEFINED_ALERTS_LIST"==this.tableType&&(a=48);c=c-b-d-
f-a;void 0!=this.lockedContent&&this.lockedContent.height(c);this.content.height(c);if("ISIN_TRANSACTION_TABLE"==this.tableType||"COMPLETED_ALERTS_LIST"==this.tableType)this.Cc(),this.content.height(c);this.element.closest(".epm-contentPanel").siblings().height(0);this.Sb();console.timeEnd("Grid: adjustHeight")}};
n.Sb=function(){console.time("Grid: adjustScrollbars");if("ISIN_TRANSACTION_TABLE"!=this.tableType&&"COMPLETED_ALERTS_LIST"!=this.tableType){console.log("kendoGrid: adjustScrollbars for "+this.controllerId);void 0!=this.lockedContent&&(this.content.Eb()&&this.lockedContent.height()==this.content.height()&&!this.$scope.isAdjustColumnsWidthToWindowEnabled?this.lockedContent.height(this.content.height()-17):(!this.content.Eb()&&this.lockedContent.height()!=this.content.height()||this.content.Eb()&&this.$scope.isAdjustColumnsWidthToWindowEnabled)&&
this.lockedContent.height(this.content.height()));var b=this.sa;"DEFINED_ALERTS_LIST"===this.tableType&&(b=this.element.find(".k-grid-header"));if(this.content.dc()&&b.width()==this.content.width()){var d=this.content.scrollTop();0<d-1&&this.content.scrollTop(d-1);b.width(this.content.width()-17);this.content.scrollTop(d)}else this.content.dc()||b.width()==this.content.width()||b.width(this.content.width());console.timeEnd("Grid: adjustScrollbars")}};
n.adjustSize=function(){console.time("Grid: adjustSize");if(this.isUnpinned&&$scope.isAdjustColumnsWidthToWindowEnabled)window.$c,$(window).resize(function(){clearTimeout(window.$c);window.$c=setTimeout(function(){this.$scope.isAdjustColumnsWidthToWindowEnabled&&(this.qa(),"ISIN_TRANSACTION_TABLE"==this.$scope.tableType&&this.Tb(),this.Ha(0))},250)});else if(this.isUnpinned||this.Tb(),this.$scope.isAdjustColumnsWidthToWindowEnabled)this.Ha(0);else if("DEFINED_ALERTS_LIST"==this.tableType){var b=$("#table_"+
this.controllerId+" .k-grid-header-wrap.k-auto-scrollable thead tr").width();$("#table_"+this.controllerId+" .k-grid-content-expander").css("width",b+"px")}this.qa();console.timeEnd("Grid: adjustSize")};function ba(b){b.content.on("scroll",function(){b.lockedContent.scrollTop($(this).scrollTop())});b.content.on("scroll",function(){b.sa.scrollLeft($(this).scrollLeft())})}
function ma(b){$("#table_"+b.controllerId+" .k-header-column-menu").click(function(d){console.time("Grid: bindColumnMenu");var c=d.target.parentElement.parentElement.attributes.columnName.value,f=$("grid-column-menu");f.length&&f.remove();$("body").append(b.$compile('<grid-column-menu positionx="'+(d.clientX-5)+'px" positiony="'+(d.clientY+10)+'px" columnName="'+c+'"></grid-column-menu>')(b.$scope));console.timeEnd("Grid: bindColumnMenu")})}
function da(b,d){console.time("Grid: setLineNumbersPerSecurity");var c="tr-display tr-"+d+"-display";b.element.find(".tr-display").each(function(){$(this).hasClass("k-state-selected")?$(this).removeClass().addClass(c+" k-state-selected"):$(this).removeClass().addClass(c)});if(void 0!==b.dataSource)for(var f=0;f<b.dataSource.length;f++)b.dataSource[f].shownOffersOverride=void 0;console.timeEnd("Grid: setLineNumbersPerSecurity")}
function T(b,d){console.time("Grid: getDataSourceItemByIsinAddress");for(var c=0;c<b.dataSource.length;c++)if(b.dataSource[c].isin_adress===d)return b.dataSource[c];console.timeEnd("Grid: getDataSourceItemByIsinAddress")}function ua(b){console.time("Grid: getSelectedRows");for(var d=[],c=0;c<b.dataSource.length;c++)!0===b.dataSource[c].selected&&d.push(b.dataSource[c]);console.timeEnd("Grid: getSelectedRows");return d}
function S(b,d,c){console.time("Grid: unselectAllRows");if(void 0!==d)for(var f=0;f<b.dataSource.length;f++)b.dataSource[f].isin_adress!==d&&(b.dataSource[f].selected=!1);else{for(f=0;f<b.dataSource.length;f++)b.dataSource[f].selected=!1;c&&b.element.find("tr[rowname]").removeClass("k-state-selected")}console.timeEnd("Grid: unselectAllRows")}function U(b){b.columns=b.lockedColumns.concat(b.ma)}
function G(b,d,c){ret=void 0;!1!==c&&(ret=va(d,b.lockedColumns));void 0===ret&&!0!==c&&(ret=va(d,b.ma));return ret}function va(b,d){for(var c=0;c<d.length;c++)if(d[c].columnName==b)return{index:c,locked:d[c].locked}}
function wa(b,d,c,f,a,e,h){f[0].style.width=parseInt(f[0].style.width,10)+e+"px";a[0].style.width=parseInt(a[0].style.width,10)+e+"px";d[0].style.width=parseInt(d[0].style.width,10)-e+"px";c[0].style.width=parseInt(c[0].style.width,10)-e+"px";var l=e;h?(d.children(),c.children(),l=-e):(f.children(),a.children());d="#table_"+b.controllerId+" .k-grid-";b=$(d+"header-wrap table");d=$(d+"content table");b[0].style.width=parseInt(b[0].style.width,10)+l+"px";d[0].style.width=parseInt(d[0].style.width,10)+
l+"px"}function la(b){b.content.find("tr").each(function(){sa(b,this)})}
function sa(b,d){$(d)[0].ondragstart=function(c){c.dataTransfer.setData("text","draggedrow");b.ib=$(c.currentTarget);b.Bb=b.ib[0].attributes.rowname.value;b.Ab=b.lockedContent.find("tr[rowname="+b.Bb+"]");$("#table_"+b.controllerId+" tr[rowname]").removeClass("k-state-selected");b.ib.addClass("k-state-selected");b.Ab.addClass("k-state-selected")};$(d)[0].ondragover=function(b){"text/plain"!==b.dataTransfer.types[0]&&"Text"!==b.dataTransfer.types[0]||b.preventDefault()};$(d)[0].ondragend=function(){setTimeout(function(){b.ib=
void 0;b.Bb=void 0;b.Ab=void 0},0)};$(d)[0].ondrop=function(c){c.preventDefault&&c.preventDefault();c.stopPropagation&&c.stopPropagation();var d=$(c.currentTarget),a=d[0].attributes.rowname.value;if(b.Bb!==a){var e=!1;c.offsetY>c.currentTarget.offsetHeight/2&&(e=!0);c=b.lockedContent.find("tr[rowname="+a+"]");e?(d.after(b.ib),c.after(b.Ab)):(d.before(b.ib),c.before(b.Ab));for(var h,l,d=0;d<b.dataSource.length&&(void 0!==h||b.dataSource[d].isin_adress!==b.Bb||(h=d,void 0===l))&&(void 0!==l||b.dataSource[d].isin_adress!==
a||(l=e?d+1:d,void 0===h));d++);h<l&&l--;b.dataSource.splice(l,0,b.dataSource.splice(h,1)[0]);b.$scope.isSortAlphabetic=!1;B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()}}}
function ka(b){function d(c){if(a.locked){var d=b.parentElement.width()-l-epmNtw.enums.QUOTES_TABLE.Mf;c>d&&(c=d)}h+c<epmNtw.enums.QUOTES_TABLE.Oa&&(c=epmNtw.enums.QUOTES_TABLE.Oa-h);return Math.ceil(c)}function c(c){f&&(f=!1,c.pageX!==e&&(widthChange=d(c.pageX-e),a.locked?b.lockedColumns[a.index].width=h+widthChange:b.ma[a.index].width=h+widthChange,U(b),B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()))}var f=!1,a=void 0,e,h,l,g,k,m,p,t,u=null,q=b.header.find("th");q.find(".headerContentPadding").each(function(){$(this)[0].ondragstart=
function(d){c(d);t=$(d.currentTarget.parentElement);a=G(b,t[0].attributes.columnname.value);try{d.dataTransfer.setData("text/html","draggedColumn")}catch(f){}}});q.each(function(){$(this)[0].ondragover=function(c){if(null===c.dataTransfer.types[0]||"text/html"===c.dataTransfer.types[0]){if(!0===a.locked&&"k-grid-header-locked"!==c.currentTarget.offsetParent.className){if(!1===b.lockedColumns[a.index].lockable)return}else if(!1===a.locked&&!(1<b.ma.length))return;c.preventDefault()}};$(this)[0].ondrop=
function(c){var d=$(c.currentTarget),f=!1;if(t[0].attributes.columnname.value!==d[0].attributes.columnname.value){c.offsetX>c.currentTarget.offsetWidth/2&&(f=!0);c=a;var e=G(b,d[0].attributes.columnname.value),g,h,k,l,m,x,p,q,r,O,u,L;c.locked?(g=b.lockedHeader,k=b.lockedContent,m=b.lockedColumns):(g=b.sa,k=b.content,m=b.ma);e.locked?(h=b.lockedHeader,l=b.lockedContent,x=b.lockedColumns):(h=b.sa,l=b.content,x=b.ma);p=g.find("col:nth-child("+(c.index+1)+")");q=h.find("col:nth-child("+(e.index+1)+")");
r=k.find("col:nth-child("+(c.index+1)+")");O=l.find("col:nth-child("+(e.index+1)+")");u=k.find("td:nth-child("+(c.index+1)+")").not("[separator='true']");L=l.find("td:nth-child("+(e.index+1)+")").not("[separator='true']");var H=e.index;f?(d.after(t),q.after(p),O.after(r),H++):(d.before(t),q.before(p),O.before(r));L.each(function(a){f?$(L[a]).after(u[a]):$(L[a]).before(u[a])});c.locked!==e.locked?(m[c.index].locked=e.locked,wa(b,g,k,h,l,t[0].offsetWidth,e.locked)):c.index<e.index&&H--;x.splice(H,0,
m.splice(c.index,1)[0]);U(b);c.locked!==e.locked&&ta(b);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()}}});q.find(".resizeDiv").on("mousedown",function(c){f=!0;th=c.delegateTarget.parentElement;a=G(b,th.attributes.columnname.value);h=th.offsetWidth;e=c.pageX;c=b.element.find(".k-grid-header"+(a.locked?"-locked":"-wrap table"));l=parseInt(c[0].style.width,10);a.locked&&(g=b.element.find(".k-grid-header-wrap"),k=parseInt(g[0].style.width,10),m=b.element.find(".k-grid-content"),p=parseInt(m[0].style.width,
10))});b.header.on("mousemove",function(c){f&&(widthChange=d(c.pageX-e),c=b.element.find(".k-grid-header"+(a.locked?"-locked":"-wrap table")),c.find("col:nth-child("+(a.index+1)+")").width(h+widthChange),c[0].style.width=l+widthChange+"px",clearTimeout(u),u=setTimeout(function(c){content=b.element.find(".k-grid-content"+(a.locked?"-locked":" table"));b.element.find(".k-grid-content"+(a.locked?"-locked":"")+" col:nth-child("+(a.index+1)+")").width(h+c);content[0].style.width=l+c+"px";a.locked&&(g[0].style.width=
k-c+"px",m[0].style.width=p-c+"px");b.$scope.isAdjustColumnsWidthToWindowEnabled&&b.Ha(0)},250,widthChange))});b.header.on("mouseup mouseleave",function(a){c(a)})}
function na(b){$("#table_"+b.controllerId+" .buy-sell").on("dblclick",function(d){console.time("Grid: doubleclick");var c=$(d.currentTarget),f=T(b,d.currentTarget.parentElement.parentElement.attributes.rowname.value),a;c.hasClass(epmNtw.enums.BUY_SELL.BUY_CLASS)?a=epmNtw.enums.BUY_SELL.BUY:c.hasClass(epmNtw.enums.BUY_SELL.SELL_CLASS)?a=epmNtw.enums.BUY_SELL.SELL:console.error("Wrong BUY-SELL type");b.$scope.buySellFunction(d,f,a);console.timeEnd("Grid: doubleclick")})}
function oa(b){$("#table_"+b.controllerId+" [class^='row-line']:not(.buy-sell)").on("dblclick",function(d){console.time("Grid: doubleclick");d=$("#table_"+b.controllerId+" [rowname='"+d.currentTarget.parentElement.parentElement.attributes.rowname.value+"'");trClass=d.attr("class");numberToDisplay=trClass.match(/\d/);indexOfNumber=trClass.indexOf(numberToDisplay);var c;c="1"==numberToDisplay||"3"==numberToDisplay?parseInt(numberToDisplay)+2:"2"==numberToDisplay||"4"==numberToDisplay?parseInt(numberToDisplay)+
1:1;newTrClass=trClass.substr(0,indexOfNumber)+c+trClass.substr(indexOfNumber+1);d.removeClass();d.addClass(newTrClass);T(b,d.attr("rowname")).shownOffersOverride=c;console.timeEnd("Grid: doubleclick")})}
function R(b){console.time("Grid: bindSelectingRows");var d=null,c=!1,f;$("#table_"+b.controllerId+" .k-grid-content tr, #table_"+b.controllerId+" .k-grid-content-locked tr").on("click",function(e){console.time("Grid: click");var h=e.currentTarget,l=h.attributes.rowname.value,g=$("#table_"+b.controllerId+" tr[rowname]"),k=$("#table_"+b.controllerId+" tr[rowname='"+l+"']");k&&0<k.length&&(b.$scope.isGridRowSelected=!0,b.$timeout(function(){b.$scope.$apply()},0,!1));var m=T(b,l);if(e.ctrlKey||e.metaKey)-1!==
h.className.indexOf("k-state-selected")?(k.removeClass("k-state-selected"),m.selected=!1,b.$scope.isGridRowSelected=!1,b.$timeout(function(){b.$scope.$apply()},0,!1)):(k.addClass("k-state-selected"),m.selected=!0),f=d=k;else if(e.shiftKey)console.time("Shift"),l=g.length/2,e=k.index(),h=d.index(),k=k.index(),g.removeClass("k-state-selected"),S(b),T(b,f.attr("rowname")).selected=!0,f.addClass("k-state-selected"),e<d.index()&&(h=k,k=d.index()),k++,g.slice(h,k).each(function(){T(b,$(this).attr("rowname")).selected=
!0;$(this).addClass("k-state-selected")}),g.slice(h+l,k+l).addClass("k-state-selected"),console.timeEnd("Shift");else{g=ua(b);$("#table_"+b.controllerId+" tr[rowname]").removeClass("k-state-selected");for(e=0;e<g.length;e++)g[e].selected=!1;k.addClass("k-state-selected");T(b,l).selected=!0;f=d=k;a=void 0}c=!1;console.timeEnd("Grid: click")});var a;b.parentElement.keydown(function(e){if(!$(e.target).hasClass("toolbarComboBox")&&(38===e.which||40===e.which)){e.preventDefault();console.time("Grid: keydown");
var h=$("#table_"+b.controllerId+" tr[rowname]"),l=$("#table_"+b.controllerId+" div.k-grid-content"),g=d;if(null===g||void 0===g)console.timeEnd("Grid: keydown"),console.log("No row selected");else{var k=g.attr("rowname"),m=l.Eb()?17:0,m=l.height()-m;if((38===e.keyCode&&!a&&e.shiftKey||40===e.keyCode&&a&&e.shiftKey)&&void 0!==a)a=void 0;else switch(e.keyCode){case 40:if(void 0===d.next()||0===d.next().length)return;d=d.next();var p=d[0].getBoundingClientRect().top-l.offset().top,m=p+d[0].getBoundingClientRect().height-
m;0<m&&l.scrollTop(l.scrollTop()+m);a=!1;break;case 38:if(void 0===d.prev()||0===d.prev().length)return;d=d.prev();p=d[0].getBoundingClientRect().top-l.offset().top;0>p&&l.scrollTop(l.scrollTop()+p);a=!0}d.length?(e.shiftKey?c?(d.index()===f&&a?d=d.prev():d.index()!==f||a||(d=d.next()),e=T(b,d.attr("rowname")),e.selected?(e.selected=!1,d.removeClass("k-state-selected")):e.selected||(d.addClass("k-state-selected"),e.selected=!0)):(h.removeClass("k-state-selected"),S(b,k),c=T(b,d.attr("rowname")).selected=
!0,d.addClass("k-state-selected"),g.addClass("k-state-selected"),f=g.index()):(h.removeClass("k-state-selected"),S(b),T(b,d.attr("rowname")).selected=!0,c=!1,d.addClass("k-state-selected")),console.timeEnd("Grid: keydown")):d=g}}});console.timeEnd("Grid: bindSelectingRows")}
function xa(b){if("ISIN_TRANSACTION_TABLE"==b.tableType)return b.$h;for(var d=[],c=0;c<b.columns.length;c++){var f=b.columns[c],a={};a.hidden=f.hidden;a.hideable=f.hideable;a.lockable=f.lockable;a.locked=f.locked;a.columnType=f.columnType;a.width=f.width;a.columnName=f.columnName;d.push(a)}return{columns:d}}n.Cc=function(){var b=this.content[0].offsetHeight,d=this.content.find("tr")[0];this.dataSource.pageSize(Math.floor(b/(d&&0<d.offsetHeight?d.offsetHeight+1:15)))};
n.Cd=function(){function b(b){var f=b.keyCode;1!=b.shiftKey||f!=epmNtw.enums.oa.nd&&f!=epmNtw.enums.oa.od||(f=epmNtw.enums.oa.xc);switch(f){case epmNtw.enums.oa.xc:case epmNtw.enums.oa.INSERT:case epmNtw.enums.oa.NUMPAD_PLUS:d.$timeout(function(){d.$scope.selectedSecurity=""},0,!0);d.$scope.securitiesComboBox.close();d.$scope.showOnlyAddRowToolbar();b.preventDefault();b.stopPropagation();break;case epmNtw.enums.oa.DELETE:case epmNtw.enums.oa.NUMPAD_MINUS:case epmNtw.enums.oa.Kf:case epmNtw.enums.oa.Lf:d.$scope.hg()}}
console.time("Grid: bindControlls");var d=this;this.parentElement.get(0).addEventListener("click",function(b){var f=$(b.target);f.hasClass("toolbarComboBox")||f.hasClass("k-header-column-menu-span")||f.hasClass("k-input")||(d.parentElement.focus(),b.preventDefault())},!0);this.parentElement.get(0).addEventListener("keydown",b,!0);this.parentElement.find(".addNewRowToolbar .toolbarComboBox input").get(0).addEventListener("keydown",b,!0);console.timeEnd("Grid: bindControlls")};
function qa(b){console.time("Grid: bindDblClickOnNameColumn");var d=G(b,epmNtw.enums.ba.rc,!0);b.lockedHeader.find("th").eq(d.index).on("click",function(c){c=$(c.target);if(!c.hasClass("k-header-column-menu-span")&&!c.hasClass("resizeDiv"))b.$scope.onLineNumberPerSecurityChangeHeaderClick()});console.timeEnd("Grid: bindDblClickOnNameColumn")}n=kendo.ui.Grid.prototype;n.adjustSize=epmNtw.Grid.prototype.adjustSize;n.Cc=epmNtw.Grid.prototype.Cc;n.qa=epmNtw.Grid.prototype.qa;n.Tb=epmNtw.Grid.prototype.Tb;
n.Sb=epmNtw.Grid.prototype.Sb;n.Oc=epmNtw.Grid.prototype.Oc;n.Ha=epmNtw.Grid.prototype.Ha;epmNtw.vc=function(b){this.Wc=b;this.translations={};this.Hb={};this.ja={};this.oc={}};epmNtw.vc.prototype.ee=["COLUMN_0_NAME_SHORTCUT"];epmNtw.vc.prototype.Gd="COLUMN_1_STOCK_CURR COLUMN_2_PREVCLOSE_OPENED COLUMN_3_OPEN_LOW_HIGH COLUMN_4_IMP_IMV COLUMN_5_CHANGE_MIN_MAX_COLLAR COLUMN_6_B COLUMN_7_BID_VOL COLUMN_8_BID COLUMN_9_ASK COLUMN_10_ASK_VOL COLUMN_11_A COLUMN_12_TRADE_PRICE COLUMN_13_TRADE_VOL COLUMN_14_TRADE_TIME COLUMN_17_SESSION_PHASE COLUMN_15_VOL_AUC COLUMN_16_TOTAL COLUMN_18_VOL_WPRICE COLUMN_19_PREVCLOSE COLUMN_20_OPEN COLUMN_21_CHANGE COLUMN_22_TRADE_TIME COLUMN_23_MIN COLUMN_24_MIN COLUMN_24_TOTAL_VALUE".split(" ");
epmNtw.gf=function(b,d){this.Ld=b;this.Fe=d};function V(b,d){for(var c=[],f=0;f<d.length;f++){var a=d[f],e;e=void 0==b.oc[a]?b.oc[a]=0:++b.oc[a];c.push(new epmNtw.gf(a,e))}return c};var X;
epmNtw.qd=function(b,d){return{restrict:"E",link:function(c,f,a){function e(a){$(a.target).is("#menu")||$(a.target).is(".k-link, .showHideColumn")||$(a.target).parents().is("#menu")||$(a.target).hasClass("k-i-arrowhead-s")||(p.remove(),document.removeEventListener("mousedown",e,!0))}X=f=c.tableGrid;for(var h=G(f,a.columnname),l='<ul class=" k-menu-vertical k-widget k-reset k-header" id="menucontent"><li class="k-item k-columns-item k-state-default k-first" role="menuitem"><span class="k-link"><span class="k-sprite k-i-columns"></span>'+b("translate")("QUOTES_TABLE.COLUMN_MENU.COLUMNS")+
'<span class="k-icon k-i-arrow-e"></span></span>',l=l+'<ul class="k-group k-menu-group" role="menu" aria-hidden="false">',g=0;g<f.columns.length;g++)if(f.columns[g].hideable){var k="checked";f.columns[g].hidden&&(k="");l+='<li><input class="showHideColumn" type="checkbox" '+k+" onclick=\"showHideColumn('"+f.controllerId+"', this.checked, '"+f.columns[g].columnName+"');\" />";for(k=0;k<f.columns[g].names.length;k++)0<k&&(l+=" | "),l+=f.columns[g].names[k];l+="</li>"}l+="</li></ul>";if(void 0!==h)g=
h.locked?c.tableGrid.lockedColumns[h.index]:c.tableGrid.ma[h.index];else throw"Cannot find column";if(g.lockable){var m=k="k-state-disabled";g.locked?m="":1<c.tableGrid.ma.length&&(k="");l+='<li class="k-separator k-item k-state-default" role="menuitem">&nbsp;</li><li class="k-item k-lock k-state-default '+k+'" role="menuitem" '+(""!==k?"":" onclick=\"lockColumn('"+f.controllerId+"', '"+h.index+"');\"")+'><span class="k-link"><span class="k-sprite k-i-lock"></span>'+b("translate")("QUOTES_TABLE.COLUMN_MENU.LOCK")+
'</span></li><li class="k-item k-unlock k-state-default k-last '+m+'" role="menuitem" '+(""!==m?"":" onclick=\"unlockColumn('"+f.controllerId+"', '"+h.index+"');\"")+'><span class="k-link"><span class="k-sprite k-i-unlock"></span>'+b("translate")("QUOTES_TABLE.COLUMN_MENU.UNLOCK")+"</span></li>"}var l=l+"</ul>",p=$("#menu");p.length&&p.remove();$("body").append('<div id="menu" class="k-column-menu k-popup k-group k-reset k-state-border-up"/>');p=$("#menu");p.css("position","absolute").css("top",a.positiony).css("left",
a.positionx).html(l);p.kendoMenu({closeOnClick:!1,popupCollision:"fit flip"});a=p.data("kendoMenu");ya(a,g,b,c,d);document.addEventListener("mousedown",e,!0)}}};goog.exportSymbol("unlockColumn",function(b,d){Aa(b,d,!1)});goog.exportSymbol("lockColumn",function(b,d){Aa(b,d,!0)});
function Aa(b,d,c){var f=parseInt(d)+1;b="#table_"+b+" .k-grid-";var a=$(b+(c?"header-locked":"header-wrap")),e=$(b+(c?"header-wrap":"header-locked")),h=e.find("col:nth-child("+f+")"),l=e.find("th:nth-child("+f+")");width=parseInt(h[0].style.width,10);l[0].style.width=width+"px";var g=$(b+(c?"content-locked":"content")),k=$(b+(c?"content":"content-locked")),m=k.find("col:nth-child("+f+")");c?(a.find("colgroup").append(h),g.find("colgroup").append(m),$(b+"header-locked th:last-child").after(l)):(a.find("colgroup").prepend(h),
g.find("colgroup").prepend(m),$(b+"header-wrap th:first-child").before(l));var p=$(b+(c?"content":"content-locked")+" td:nth-child("+f+")").not("[separator='true']");$(b+(c?"content-locked td:last":"content td:first")+"-child").not("[separator='true']").each(function(a){td=p[a];c?$(this).after(td):$(this).before(td)});wa(X,e,k,a,g,width,c);c?(f=X.ma[d],X.lockedColumns.push(f),X.ma.splice(d,1)):(f=X.lockedColumns[d],X.ma.unshift(f),X.lockedColumns.splice(d,1));f.locked=c;U(X);ta(X);B.externalSystemFunctions.ga&&
B.externalSystemFunctions.ga()}
goog.exportSymbol("showHideColumn",function(b,d,c){var f=G(X,c);c="#table_"+b+" .k-grid-";var a=$(c+(f.locked?"content-locked":"content")+" td:nth-child("+(f.index+1)+")").not("[separator='true']"),e=$(c+(f.locked?"header-locked":"header-wrap")+" th:nth-child("+(f.index+1)+")"),h=$(c+(f.locked?"header-locked":"header-wrap")+" col:nth-child("+(f.index+1)+")"),l=$(c+(f.locked?"content-locked":"content")+" col:nth-child("+(f.index+1)+")");b=parseInt(h[0].style.width,10);d?(a.show(),e.show(),l.show(),
h.show()):(a.hide(),e.hide(),l.hide(),h.hide(),b=-b);f.locked?(X.lockedColumns[f.index].hidden=!d,d=$(c+"header-locked"),f=$(c+"content-locked"),a=parseInt(d[0].style.width,10),e=$(c+"header-wrap"),c=$(c+"content"),h=parseInt(e[0].style.width,10),l=parseInt(c[0].style.width,10),d[0].style.width=a+b+"px",f[0].style.width=a+b+"px",e[0].style.width=h-b+"px",c[0].style.width=l-b+"px"):(X.ma[f.index].hidden=!d,d=$(c+"header-wrap table"),c=$(c+"content table"),d[0].style.width=parseInt(d[0].style.width,
10)+b+"px",c[0].style.width=parseInt(c[0].style.width,10)+b+"px");U(X);ta(X);D(X);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()});
function ya(b,d,c,f,a){function e(a){f.sortColumnData(f.securitiesDesignationsComboBox.value().trim(),a,!1)}var h=[];b.insertAfter([{text:'<li class="k-separator k-state-disabled k-item k-state-default" role="menuitem">&nbsp;</li>',encoded:!1}],"#menucontent > li:last-child");for(var h=d.valueNames,l=d.names,g,k,m=[],p=c("translate")("QUOTES_TABLE.COLUMN_MENU.SORT_ASC"),t=0;t<h.length;t++)0===t&&d.columnType===epmNtw.enums.xa.tb?(g=p+""+c("translate")(f.getSecuritiesDesignationVarString()),k=p+c("translate")(f.getSecuritiesDesignationVarString()),
m.push({text:k,fnc:epmNtw.utils.aa.Ka(e,[1])})):(k=g=d.columnType===epmNtw.enums.xa.ub||d.columnType===epmNtw.enums.xa.Fa?p+(t+1)+": "+c("translate")(l[0]):p+""+c("translate")(l[t]),m.push({text:k,fnc:epmNtw.utils.aa.Ka(f.sortColumnData,[h[t],1,!1])})),b.insertAfter({text:g,spriteCssClass:"k-sprite k-i-sort-asc",encoded:!1},"#menucontent > li:last-child");b.insertAfter([{text:'<li class="k-separator k-item k-state-disabled k-state-default" role="menuitem">&nbsp;</li>',encoded:!1}],"#menucontent > li:last-child");
p=c("translate")("QUOTES_TABLE.COLUMN_MENU.SORT_DESC");for(t=0;t<h.length;t++)0===t&&d.columnType===epmNtw.enums.xa.tb?(g=p+""+c("translate")(f.getSecuritiesDesignationVarString()),k=p+c("translate")(f.getSecuritiesDesignationVarString()),m.push({text:k,fnc:epmNtw.utils.aa.Ka(f.sortColumnData,[h[t],-1,!1])})):(k=g=d.columnType===epmNtw.enums.xa.ub||d.columnType===epmNtw.enums.xa.Fa?p+(t+1)+": "+c("translate")(l[0]):p+""+c("translate")(l[t]),m.push({text:k,fnc:epmNtw.utils.aa.Ka(f.sortColumnData,[h[t],
-1,!1])})),b.insertAfter({text:g,spriteCssClass:"k-sprite k-i-sort-desc"},"#menucontent > li:last-child");a(b)(f);Ba(b,f,m)}function Ba(b,d,c){b.bind("select",function(b){for(var a=0;a<c.length;a++)if($(b.item).text()==c[a].text){b=$("#menu");b.remove();c[a].fnc();d.isSortAlphabetic=!1;return}if("Zablokuj"==$(b.item).text()||"Odblokuj"==$(b.item).text())b=$("#menu"),b.remove()})}epmNtw.qd.$inject=["$filter","$compile"];angular.module("epmNtw").directive("gridColumnMenu",epmNtw.qd);epmNtw.Rf=function(b){this.controllerId=b};function Ca(b,d){return void 0===d.na[b].isin_adress?"row-"+b:d.na[b].isin_adress}
function Da(b,d,c,f){var a="";void 0!==f&&1<=f&&5>=f&&(a=" tr-"+f+"-display");f=""+('<tr tabindex="'+d+'" rowName="'+Ca(d,c)+'" class="tr-display'+a+'">');if(void 0!==c.settings)for(a=0;a<c.settings.lockedColumns.length;a++)f=c.settings.lockedColumns[a].columnType===epmNtw.enums.xa.tb?f+Ea(b,d,c,c.settings.lockedColumns[a].valueNames):f+Fa(b,c.settings.lockedColumns[a].valueNames,c,d,c.settings.lockedColumns[a].hidden);else f+=Ea(b,d,c),log.warn("settings undefined");return f+"</tr>"}
function Ga(b,d,c,f){var a="";void 0!==f&&1<=f&&5>=f&&(a=" tr-"+f+"-display");f=""+('<tr tabindex="'+d+'" rowName="'+Ca(d,c)+'" class="tr-display'+a+'" draggable="true">');if(void 0!==c.settings)for(a=0;a<c.settings.columns.length;a++)f+=Fa(b,c.settings.columns[a].valueNames,c,d,c.settings.columns[a]);else for(a=0;a<c.settings.columns.length;a++)f+=Fa(b,c.settings.columns[a].valueNames,c,d,void 0);return f+"</tr>"}
function Y(b,d){var c=b.settings.font,f="";if(!0===d||void 0!==c)f+=' style="',!0===d&&(f+="display: none;"),void 0!==c&&""!==c&&(f+="font-weight: "+c.fontWeight+" !important; font-size: "+c.fontSize+" !important; font-family: "+c.fontFamily+" !important;"),f+='"';return f}
function Ea(b,d,c,f){for(var a="<td"+Y(c)+">",e=c.na[d].isin_adress,h=0;h<f.length;h++)var l=f[h].Ld,a=a+('<div id="'+e+"-"+l+"-"+f[h].Fe+b.controllerId+'"  + class="row-line-'+(h+1)+' designation">'+c.na[d][l]+"</div>");for(;5>h;h++)a+='<div class="row-line-'+(h+1)+'">&nbsp;</div>';return a+"</td>"}
function Fa(b,d,c,f,a){for(var e="<td"+Y(c,a.hidden)+">",h=c.na[f].isin_adress,l=0;l<d.length;l++){var g=d[l].Ld,k=d[l].Fe;if(!0!==c.settings.showPercentageValueArrows||"zmianaProc"!==g&&"dolneWidelki"!==g&&"gorneWidelki"!==g&&"kursZmianaTKO"!==g&&"kursTKO"!==g&&"two"!==g)"gielda"!==g&&"waluta"!==g||"MDM - Gray"===c.settings.configName?(m=c.na[f][g],void 0===m&&(m=""),e+='<div class="row-line-'+(l+1),"gielda"!=g&&"waluta"!=g&&"statusGrupy"!=g&&"status"!=g&&(e+=" epm-ntw-number-field"),a.columnType===
epmNtw.enums.xa.Fa?(e+=" buy-sell ",e=a.buySellType===epmNtw.enums.BUY_SELL.BUY?e+epmNtw.enums.BUY_SELL.BUY_CLASS:e+epmNtw.enums.BUY_SELL.SELL_CLASS,e+='" idx="'+(l+1)+'"'):e+='"',e+=' id="'+h+"-"+g+"-"+k+"-"+b.controllerId+'">'+m+"</div>"):(m=c.na[f][g],void 0===m&&(m=""),"gielda"===g?e+='<div class="row-line-'+(l+1)+'" id="'+h+"-"+g+"-"+k+"-"+b.controllerId+'">'+m:"waluta"===g&&(e+="("+m+")</div>"));else{var m=c.na[f][g];void 0===m&&(m="");var p="";if("kursZmianaTKO"===g||"zmianaProc"===g)p=" "+
c.na[f][g+"_arrowClassName"];e+='<div class="epmNtwArrow row-line-'+(l+1);e+=" epm-ntw-number-field"+p;e+='" id="'+h+"-"+g+"-"+k+"-"+b.controllerId+'">'+m+"</div>"}}for(;5>l;l++)e+="<div class='row-line-"+(l+1)+"'>&nbsp;</div>";return e+"</td></div>"}function Z(b){return'<col style="width:'+b.width+"px;"+(!0===b.hidden?" display: none;":"")+'">'}
function Ha(b,d){for(var c=0,f=0,a=0;a<d.settings.lockedColumns.length;a++)d.settings.lockedColumns[a].hidden||(c+=d.settings.lockedColumns[a].width);for(a=0;a<d.settings.columns.length;a++)d.settings.columns[a].hidden||(f+=d.settings.columns[a].width);var e,h=d.Vg-c;e=d.settings.font;var l=1;void 0!==e&&""!==e&&(l=parseInt(e.fontSize,10)/11,1>l&&(l=1));var g=l=d.Ug-d.Tg-("undefined"!==typeof InstallTrigger?Math.ceil(60*l):Math.ceil(49*l));e="<div class='k-grid-header'>"+('<div class="k-grid-header-locked" style="width: '+
c+'px;">');if(d.settings.isNewTable){e+="<table><colgroup>";for(a=0;a<d.settings.lockedColumns.length;a++)e+=Z(d.settings.lockedColumns[a]);e+='</colgroup><thead><tr style="height: 50px !important;">';for(a=0;a<d.settings.lockedColumns.length;a++){e+='<th columnName="'+d.settings.lockedColumns[a].columnName+'" role="columnheader" rowspan="1"'+Y(d,d.settings.lockedColumns[a].hidden);e+=' class="headerPadding k-header ng-scope k-with-icon">';e+='<div class="resizeDiv">&nbsp;</div>';e+='<a class="k-header-column-menu" href="#" tabindex="-1"><span class="k-icon k-i-arrowhead-s k-header-column-menu-span"></span></a>';
e+='<div class="headerContentPadding" draggable="true">';for(var k=0;k<d.settings.lockedColumns[a].names.length;k++)e=d.settings.lockedColumns[a].columnType===epmNtw.enums.xa.tb&&0===k?e+'<span style="display: block" class="designation-locked">':e+'<span style="display: block">',e+=d.settings.lockedColumns[a].names[k]+"</span>";e+="</div></th>"}e=e+"</tr></thead></table></div>"+('<div class="k-grid-header-wrap" style="width:'+(h-17)+'px"><table style="width: '+f+'px">')+"<colgroup>";for(a=0;a<d.settings.columns.length;a++)e+=
Z(d.settings.columns[a]);e+='</colgroup><thead><tr style="height: 50px;">';for(a=0;a<d.settings.columns.length;a++){e+='<th columnName="'+d.settings.columns[a].columnName+'" role="columnheader" rowspan="1" class="headerPadding k-header ng-scope k-with-icon"'+Y(d,d.settings.columns[a].hidden);e+=" >";e+='<div class="resizeDiv">&nbsp;</div>';e+='<a class="k-header-column-menu" href="#" tabindex="-1"><span class="k-icon k-i-arrowhead-s k-header-column-menu-span"></span></a>';e+='<div class="headerContentPadding" draggable="true">';
for(k=0;k<d.settings.columns[a].names.length;k++)if("waluta"===d.settings.columns[a].valueNames[k]){var m=d.settings.columns[a].names[k];e+="MDM - Gray"===d.settings.configName?'<span style="display: block" >'+m+"</span>":'<span style="display: block" >('+m+")</span>"}else e+='<span style="display: block" >'+d.settings.columns[a].names[k]+"</span>";e+="</div></th>"}f>h&&(g-=17);e=e+"</tr></thead></table></div></div>"+('<div class="k-grid-content-locked" style="width: '+c+"px; height:"+g+'px;"><table class="k-selectable"><colgroup>');
for(a=0;a<d.settings.lockedColumns.length;a++)e+=Z(d.settings.lockedColumns[a]);e+="</colgroup><tbody>";c="";for(a=0;a<Object.keys(d.na).length;a++)g=void 0!==d.na[a].shownOffersOverride?d.na[a].shownOffersOverride:d.settings.lineNumbersPerSecurityToDisplay,d.na[a].separator?(e+=Ia(d.je,d.na[a].isin_adress),c+=Ja(d.je,d.na[a].isin_adress)):(e+=Da(b,a,d,g),c+=Ga(b,a,d,g));e=e+"</tbody></table></div>"+('<div class="k-grid-content" style="height:'+l+"px; width:"+h+'px;"><table style="width:'+f+'px;"><colgroup>');
for(a=0;a<d.settings.columns.length;a++)e+=Z(d.settings.columns[a]);e=e+"</colgroup><tbody>"+c+"</tbody></table></div>"}return e}function Ja(b,d){return'<tr draggable="true" class="k-alt" role="row" style="height: 58px;" aria-selected="false" rowname="'+d+'"><td colspan="'+b.intCounterVisibleUnlocked+'" separator="true" class="no-data"> </td></tr>'}
function Ia(b,d){return'<tr draggable="false" class="k-alt " role="row" style="height: 58px;" aria-selected="false" rowname="'+d+'"><td colspan="'+b.intCounterVisibleLocked+'" separator="true" class="no-data"> </td></tr>'}function Ka(b){var d=[],c="separator-"+(new Date).getTime();d.htmlSeparatorLockedContent=Ia(b,c);d.htmlSeparatorUnlockedContent=Ja(b,c);d.separatorId=c;return d};epmNtw.$f=function(b,d,c,f,a,e,h,l,g,k,m,p,t,u,q,v){function y(a){a=parseInt(a);return 5==a?1:2==a||4==a?a+1:a+2}function z(c,d){console.time("Get snapshot");b.bc(c,[],function(b){console.timeEnd("Get snapshot");console.log("START TWORZENIA TABELI");console.time("Settingsy");A(a.options).then(function(d){console.timeEnd("Settingsy");x.settings=d;var f=!1;void 0!=a.options&&void 0!=a.options.isinsList&&a.options.isinsList.length>c.length&&(f=!0);a.tableGrid.dataSource.de={};if(f)for(var e=0;e<a.options.isinsList.length;e++)if(a.options.isinsList[e].separator)a.options.isinsList[e].isin_adress=
a.options.isinsList[e].isin,a.tableGrid.dataSource[e]=a.options.isinsList[e];else{var g=a.options.isinsList[e].isin;if("address"!=g){var h=b[g];void 0===h.isin_adress&&(console.error("isin_adress missing in PushXDP msg for: "+h.isin),h.isin_adress=h.isin);h.isin=g;h.rowPosition=e;h.selected=!1;a.tableGrid.dataSource[e]=h}}else for(g in b)"address"!=g&&(h=b[g],void 0===h.isin_adress&&(console.error("isin_adress missing in PushXDP msg for: "+h.isin),h.isin_adress=h.isin),h.isin=g,h.rowPosition=c.indexOf(g),
h.selected=!1,a.tableGrid.dataSource[c.indexOf(g)]=h);a.isSortAlphabetic&&!f&&(console.time("Sorting start"),a.tableGrid.dataSource=a.sortColumnData(L.column,1,!0),console.timeEnd("Sorting start"));if(void 0!==a.options&&void 0!==a.options.isinsList)for(f=0;f<a.options.isinsList.length;f++)void 0!==a.options.isinsList[f].shownOffersOverride&&(a.tableGrid.dataSource[c.indexOf(a.options.isinsList[f].isin)].shownOffersOverride=a.options.isinsList[f].shownOffersOverride);window.requestAnimationFrame(function(){kendo.ui.progress(O,
!1)});d=x.Kd(d,a.tableGrid.dataSource,c);console.time("Worker start");x.Qd(Ha(x.mc,d))})},d,a.controllerId)}function A(b){var d=p.defer();void 0===x.nc&&(x.nc=a.tableGrid.parentElement.find(".k-grid-toolbar"));var f,e=void 0!==a.options&&void 0!==a.options.toolbarState?a.options.toolbarState.Vb:a.Vb,g=void 0!==a.options&&void 0!==a.options.toolbarState?a.options.toolbarState.ud:void 0,h=void 0!==a.options&&void 0!==a.options.toolbarState?a.options.toolbarState.Kg:void 0;(!e||a.Be||a.addNewRowAlwaysVisible||
g||h)&&void 0!==e||a.unpinnedWindow?0<x.nc.outerHeight(!0)&&(f=e||g||h?epmNtw.enums.sd.If:epmNtw.enums.sd.Gf):f=0;t("QUOTES_TABLE.GRID.NAME QUOTES_TABLE.GRID.SHORT_NAME QUOTES_TABLE.GRID.STOCK QUOTES_TABLE.GRID.CURRENCY QUOTES_TABLE.GRID.KURS_ODN QUOTES_TABLE.GRID.OTWARTE QUOTES_TABLE.GRID.KURS_OTW QUOTES_TABLE.GRID.KURS_MIN QUOTES_TABLE.GRID.KURS_MAX QUOTES_TABLE.GRID.TKO QUOTES_TABLE.GRID.TKO% QUOTES_TABLE.GRID.TWO QUOTES_TABLE.GRID.ZMIANA% QUOTES_TABLE.GRID.WID_MIN QUOTES_TABLE.GRID.WID_MAX QUOTES_TABLE.GRID.K_LICZBA_OFERT QUOTES_TABLE.GRID.K_WOLUMEN QUOTES_TABLE.GRID.K_LIMIT QUOTES_TABLE.GRID.S_LIMIT QUOTES_TABLE.GRID.S_WOLUMEN QUOTES_TABLE.GRID.S_LICZBA_OFERT QUOTES_TABLE.GRID.T_KURS_OST QUOTES_TABLE.GRID.T_WOLUMEN_OST QUOTES_TABLE.GRID.T_CZAS_OST QUOTES_TABLE.GRID.WOLUMEN QUOTES_TABLE.GRID.FIX_1 QUOTES_TABLE.GRID.FIX_2 QUOTES_TABLE.GRID.OBROT QUOTES_TABLE.GRID.FAZA_SESJI QUOTES_TABLE.GRID.STATUS QUOTES_TABLE.GRID.VOL_OCZD QUOTES_TABLE.GRID.SR_KURS_WAZONY QUOTES_TABLE.GRID.OBR_OCZD QUOTES_TABLE.GRID.PREVCLOSE QUOTES_TABLE.GRID.TRADE_TIME QUOTES_TABLE.GRID.OPEN QUOTES_TABLE.GRID.MIN QUOTES_TABLE.GRID.MAX QUOTES_TABLE.GRID.TOTAL_VALUE".split(" ")).then(function(e){a.tableGrid.Ca.translations=
e;console.time("Creating columns names");e=a.tableGrid.Ca;var g=c.hiddenColumnsNames,h=epmNtw.enums.xa;e.Hb={COLUMN_0_NAME_SHORTCUT:new epmNtw.da(epmNtw.enums.ba.rc,[e.translations["QUOTES_TABLE.GRID.NAME"],e.translations["QUOTES_TABLE.GRID.SHORT_NAME"]],V(e,["nazwa","nazwaSkrocona"]),h.tb,void 0,!1)};e.ja={COLUMN_1_STOCK_CURR:new epmNtw.da(epmNtw.enums.ba.Se,[e.translations["QUOTES_TABLE.GRID.STOCK"],e.translations["QUOTES_TABLE.GRID.CURRENCY"]],V(e,["gielda","waluta"]),h.la),COLUMN_2_PREVCLOSE_OPENED:new epmNtw.da(epmNtw.enums.ba.Ze,
[e.translations["QUOTES_TABLE.GRID.KURS_ODN"],e.translations["QUOTES_TABLE.GRID.OTWARTE"]],V(e,["kursOdniesienia","otwartePoz"]),h.la),COLUMN_3_OPEN_LOW_HIGH:new epmNtw.da(epmNtw.enums.ba.$e,[e.translations["QUOTES_TABLE.GRID.KURS_OTW"],e.translations["QUOTES_TABLE.GRID.KURS_MIN"],e.translations["QUOTES_TABLE.GRID.KURS_MAX"]],V(e,["kursOtwarcia","kursMin","kursMax"]),h.la),COLUMN_4_IMP_IMV:new epmNtw.da(epmNtw.enums.ba.af,[e.translations["QUOTES_TABLE.GRID.TKO"],e.translations["QUOTES_TABLE.GRID.TKO%"],
e.translations["QUOTES_TABLE.GRID.TWO"]],V(e,["kursTKO","kursZmianaTKO","two"]),h.la),COLUMN_5_CHANGE_MIN_MAX_COLLAR:new epmNtw.da(epmNtw.enums.ba.bf,[e.translations["QUOTES_TABLE.GRID.ZMIANA%"],e.translations["QUOTES_TABLE.GRID.WID_MIN"],e.translations["QUOTES_TABLE.GRID.WID_MAX"]],V(e,["zmianaProc","dolneWidelki","gorneWidelki"]),h.la),COLUMN_6_B:new epmNtw.da(epmNtw.enums.ba.cf,[e.translations["QUOTES_TABLE.GRID.K_LICZBA_OFERT"]],V(e,["oferta-1-k-lk","oferta-2-k-lk","oferta-3-k-lk","oferta-4-k-lk",
"oferta-5-k-lk"]),h.Fa,epmNtw.enums.BUY_SELL.BUY),COLUMN_7_BID_VOL:new epmNtw.da(epmNtw.enums.ba.df,[e.translations["QUOTES_TABLE.GRID.K_WOLUMEN"]],V(e,["oferta-1-k-wk","oferta-2-k-wk","oferta-3-k-wk","oferta-4-k-wk","oferta-5-k-wk"]),h.Fa,epmNtw.enums.BUY_SELL.BUY),COLUMN_8_BID:new epmNtw.da(epmNtw.enums.ba.ef,[e.translations["QUOTES_TABLE.GRID.K_LIMIT"]],V(e,["oferta-1-k-kk","oferta-2-k-kk","oferta-3-k-kk","oferta-4-k-kk","oferta-5-k-kk"]),h.Fa,epmNtw.enums.BUY_SELL.BUY),COLUMN_9_ASK:new epmNtw.da(epmNtw.enums.ba.ff,
[e.translations["QUOTES_TABLE.GRID.S_LIMIT"]],V(e,["oferta-1-s-ks","oferta-2-s-ks","oferta-3-s-ks","oferta-4-s-ks","oferta-5-s-ks"]),h.Fa,epmNtw.enums.BUY_SELL.SELL),COLUMN_10_ASK_VOL:new epmNtw.da(epmNtw.enums.ba.Je,[e.translations["QUOTES_TABLE.GRID.S_WOLUMEN"]],V(e,["oferta-1-s-ws","oferta-2-s-ws","oferta-3-s-ws","oferta-4-s-ws","oferta-5-s-ws"]),h.Fa,epmNtw.enums.BUY_SELL.SELL),COLUMN_11_A:new epmNtw.da(epmNtw.enums.ba.Ke,[e.translations["QUOTES_TABLE.GRID.S_LICZBA_OFERT"]],V(e,["oferta-1-s-ls",
"oferta-2-s-ls","oferta-3-s-ls","oferta-4-s-ls","oferta-5-s-ls"]),h.Fa,epmNtw.enums.BUY_SELL.SELL),COLUMN_12_TRADE_PRICE:new epmNtw.da(epmNtw.enums.ba.Le,[e.translations["QUOTES_TABLE.GRID.T_KURS_OST"]],V(e,["trans-1-kurs","trans-2-kurs","trans-3-kurs","trans-4-kurs","trans-5-kurs"]),h.ub),COLUMN_13_TRADE_VOL:new epmNtw.da(epmNtw.enums.ba.Me,[e.translations["QUOTES_TABLE.GRID.T_WOLUMEN_OST"]],V(e,["trans-1-wolumen","trans-2-wolumen","trans-3-wolumen","trans-4-wolumen","trans-5-wolumen"]),h.ub),COLUMN_14_TRADE_TIME:new epmNtw.da(epmNtw.enums.ba.Ne,
[e.translations["QUOTES_TABLE.GRID.T_CZAS_OST"]],V(e,["trans-1-czas","trans-2-czas","trans-3-czas","trans-4-czas","trans-5-czas"]),h.ub),COLUMN_17_SESSION_PHASE:new epmNtw.da(epmNtw.enums.ba.Pe,[e.translations["QUOTES_TABLE.GRID.FAZA_SESJI"],e.translations["QUOTES_TABLE.GRID.STATUS"]],V(e,["statusGrupy","status"]),h.la)};epmNtw.config.quotesTable.isSessionPhaseVolume?(e.ja.COLUMN_15_VOL_AUC=new epmNtw.da(epmNtw.enums.ba.ld,[e.translations["QUOTES_TABLE.GRID.WOLUMEN"],e.translations["QUOTES_TABLE.GRID.VOL_OCZD"]],
V(e,["wolumen","wolumen_o","wolumen_c","wolumen_z","wolumen_d"]),h.la),e.ja.COLUMN_16_TOTAL=new epmNtw.da(epmNtw.enums.ba.Oe,[e.translations["QUOTES_TABLE.GRID.OBROT"],e.translations["QUOTES_TABLE.GRID.OBR_OCZD"]],V(e,["obrot","obrot_o","obrot_c","obrot_z","obrot_d"]),h.la)):epmNtw.config.quotesTable.isSessionPhaseVolume||(e.ja.COLUMN_15_VOL_AUC=new epmNtw.da(epmNtw.enums.ba.ld,[e.translations["QUOTES_TABLE.GRID.WOLUMEN"],e.translations["QUOTES_TABLE.GRID.FIX_1"],e.translations["QUOTES_TABLE.GRID.FIX_2"]],
V(e,["wolumen","WolFix1","WolFix2"]),h.la));epmNtw.config.quotesTable.ce&&(e.ja.COLUMN_18_VOL_WPRICE=new epmNtw.da(epmNtw.enums.ba.Qe,[e.translations["QUOTES_TABLE.GRID.SR_KURS_WAZONY"]],V(e,["kursWazonyObrot"]),h.la));e.Wc&&(h=epmNtw.enums.xa,e.ja.COLUMN_19_PREVCLOSE=new epmNtw.da(epmNtw.enums.ba.Re,[e.translations["QUOTES_TABLE.GRID.PREVCLOSE"]],V(e,["kursOdniesienia"]),h.la),e.ja.COLUMN_20_OPEN=new epmNtw.da(epmNtw.enums.ba.Te,[e.translations["QUOTES_TABLE.GRID.OPEN"]],V(e,["kursOtwarcia"]),h.la),
e.ja.COLUMN_21_CHANGE=new epmNtw.da(epmNtw.enums.ba.Ue,[e.translations["QUOTES_TABLE.GRID.ZMIANA%"]],V(e,["zmianaProc"]),h.la),e.ja.COLUMN_22_TRADE_TIME=new epmNtw.da(epmNtw.enums.ba.Ve,[e.translations["QUOTES_TABLE.GRID.TRADE_TIME"]],V(e,["czasPub"]),h.la),e.ja.COLUMN_23_MIN=new epmNtw.da(epmNtw.enums.ba.We,[e.translations["QUOTES_TABLE.GRID.MIN"]],V(e,["kursMin"]),h.la),e.ja.COLUMN_24_MAX=new epmNtw.da(epmNtw.enums.ba.Xe,[e.translations["QUOTES_TABLE.GRID.MAX"]],V(e,["kursMax"]),h.la),e.ja.COLUMN_25_TOTAL_VALUE=
new epmNtw.da(epmNtw.enums.ba.Ye,[e.translations["QUOTES_TABLE.GRID.TOTAL_VALUE"]],V(e,["obrot"]),h.la));for(h=0;h<g.length;h++)e.ja[g[h]].Yc=!0;for(var k=[],g=[],h=0;h<e.ee.length;h++){var l=e.Hb[e.ee[h]];void 0!==l&&k.push(l)}for(h=0;h<e.Gd.length;h++)l=e.ja[e.Gd[h]],void 0!==l&&g.push(l);console.timeEnd("Creating columns names");if(void 0!==b&&void 0!==b.columns&&void 0!==b.columns[0]&&void 0!==b.columns[0].hideable){a.tableGrid.columns=b.columns;e=[];h=[];k=1;g=0;if(l=void 0!==b.toolbarState?
b.toolbarState.isAdjustColumnsWidthToWindowEnabled:a.isAdjustColumnsWidthToWindowEnabled){var k=!1,r;a.unpinnedWindow?r=window.innerHeight:r=O.height();a.options.contentHeight+f>r&&(k=!0);r=a.tableGrid;var C=k;console.time("Grid: getPercentToAdjustColumnWidth");var k=r.parentElement.width(),m=0,x=0;C&&r.Sa?x=17:C&&!r.Sa&&(x=20);for(C=0;C<r.columns.length;C++)r.columns.hidden||(m+=r.columns[C].width);m+=x;console.timeEnd("Grid: getPercentToAdjustColumnWidth");k/=m}for(r=0;r<a.tableGrid.columns.length;r++)m=
a.tableGrid.columns[r],l&&(x=Math.floor(m.width*k),g+=m.width*k-x,1===a.tableGrid.columns.length-r&&(x+=g),m.width=x),!0===m.locked?(void 0!==a.tableGrid.Ca.Hb[m.columnName]?(m.names=a.tableGrid.Ca.Hb[m.columnName].translations,m.valueNames=a.tableGrid.Ca.Hb[m.columnName].yb):(m.names=a.tableGrid.Ca.ja[m.columnName].translations,m.valueNames=a.tableGrid.Ca.ja[m.columnName].yb),e.push(m)):(m.names=a.tableGrid.Ca.ja[m.columnName].translations,m.valueNames=a.tableGrid.Ca.ja[m.columnName].yb,h.push(m));
a.tableGrid.lockedColumns=e;a.tableGrid.ma=h}else{h=[];e=[];for(r=0;r<k.length;r++)m=l=new epmNtw.pd,m.names=k[r].translations,m.valueNames=k[r].yb,m.hidden=k[r].Yc,m.hideable=k[r].hideable,m.lockable=!1,m.locked=!0,m.buySellType=k[r].buySellType,m.columnType=k[r].columnType,m.width=85,m.columnName=k[r].columnName,e.push(l);for(r=0;r<g.length;r++)k=l=new epmNtw.pd,k.names=g[r].translations,k.valueNames=g[r].yb,k.hidden=g[r].Yc,k.hideable=g[r].hideable,k.lockable=!0,k.locked=!1,k.buySellType=g[r].buySellType,
k.columnType=g[r].columnType,k.width=85,k.columnName=g[r].columnName,h.push(l);a.tableGrid.lockedColumns=e;a.tableGrid.ma=h;U(a.tableGrid)}e=F(e,h);e.Tg=f;d.resolve(e)});return d.promise}function F(b,c){return{snapshot:{},settings:{isins:[],columns:c,lockedColumns:b,isNewTable:!0,tableName:"table_"+a.controllerId,configName:epmNtw.config.configName,showPercentageValueArrows:pa,lineNumbersPerSecurityToDisplay:void 0!==a.options&&void 0!==a.options.toolbarState?a.options.toolbarState.lineNumbersPerSecurityToDisplay:
a.lineNumbersPerSecurityToDisplay,font:void 0!==a.options&&void 0!==a.options.toolbarState?a.options.toolbarState.presentFont:void 0}}}function E(b,c){var d=a.tableGrid.gb,e;for(e in c)if("isin"!==e&&"isin_adress"!==e)for(var f=ga(d.tableGrid.jb,e,c[e]),g=0;g<=d.tableGrid.Ca.oc[e];g++)d.Za[c.isin+"-"+e+"-"+g+"-"+d.tableGrid.controllerId]={newValue:f,fieldName:e,isin_address:b}}function I(b){window.document.title=a.title+": "+b}function C(a){return"tr-"+a+"-display"}function M(){var b=a.securitiesComboBox.value().trim(),
c=b.length,d=r.length;if(0<d){if(r.substr(0,3)===b.substr(0,3))return!1;r=b;return!0}if(0===d)return r=b,!0;if(3<c)return!1;r=b;return!0}var x=this;a.controllerId=void 0!==c.controllerId?c.controllerId:a.controllerId;a.elementId=c.elementId;this.nc;this.mc=new epmNtw.Rf(a.controllerId);var J=epmNtw.utils,N=!1,r="",O=$("#"+c.elementId),pa=epmNtw.config.quotesTable.showPercentageValueArrows,L=epmNtw.enums.Qc(epmNtw.config.quotesTable.securitiesDesignation-1),H=c.securitesGroups?c.securitesGroups:[],
Q=c.pseudoIsins,za=!1,W=void 0;a.unpinnedWindow=c.isUnpinned;a.shouldReleaseSecurities=!0;a.highlightingTime=1E3*epmNtw.config.quotesTable.highlightingTime;a.scrollingTime=1E3*epmNtw.config.quotesTable.scrollingTime;a.automaticSortingTime=1E3*epmNtw.config.quotesTable.automaticSortingTime;a.isHighlightingDisabled=epmNtw.config.quotesTable.isHighlightingDisabled;a.quotesTableToolbarType=epmNtw.enums.ab.QUOTES_TABLE;a.toolbarType=a.quotesTableToolbarType;a.lineNumbersPerSecurityToDisplay=epmNtw.config.quotesTable.lineNumbersPerSecurityToDisplay;
a.isAlertPositionInContextMenuEnabled=epmNtw.config.quotesTable.isAlertPositionInContextMenuEnabled;a.isChartsPositionInContextMenuEnabled=epmNtw.config.quotesTable.isChartsPositionInContextMenuEnabled;a.alertSoundLabel="CONTEXT_MENU.DISABLE_ALERTS_SOUND";a.title=c.tableTitle;a.basketName=c.basketName;a.lastSortingArgs=void 0;a.contentHeaderHeight=0;a.isSortAlphabetic=c.isSort;a.groups=H;a.isGridRowSelected=!1;a.validSecurity=!0;void 0===a.Mb&&(a.Mb=!0);a.tableGrid=new epmNtw.Grid(a.controllerId,
O,a.unpinnedWindow,epmNtw.enums.o.QUOTES_TABLE,a.Mb,a,g,l("translate"),k,b.ka);a.isInitGridHeightAdjusted=!0===c.rg?!0:!1;a.options;(function(a){for(var b=[],c=0;c<a.length;c++)b.push(epmNtw.enums.ba[a[c]]);return b})(c.hiddenColumnsNames);(function(){null!==window.windowModel&&void 0!==window.windowModel&&(null!==window.windowModel.pseudoIsins&&void 0!==window.pseudoIsins&&(Q=window.pseudoIsins),null!==window.windowModel.securitesGroups&&void 0!==window.windowModel.securitesGroups&&(H=window.windowModel.securitesGroups));
void 0!==c.settings&&null!==c.settings?W=c.settings:void 0!==window.settings&&null!==window.settings&&(W=window.settings);if(void 0!==W){a.options=JSON.parse(W);a.unpinnedWindow||(a.options.width=void 0,a.options.height=void 0);jQuery.isArray(a.options.columns)||(a.options.columns=$.map(a.options.columns,epmNtw.utils.aa.Jd));jQuery.isArray(a.options.isinsList)||(a.options.isinsList=$.map(a.options.isinsList,epmNtw.utils.aa.Jd));a.title=a.options.tableTitle;a.basketName=a.options.basketName;a.isSortAlphabetic=
a.options.isSort;Q=[];if(epmNtw.config.quotesTable.overrideIsinList){for(var b=a.options,d=c.pseudoIsins,e=a.options.isinsList,f=[],g=0;g<d.length;g++){for(var h=!1,k=0;k<e.length;k++)if(d[g]===e[k].isin){f.push(e[k]);h=!0;break}h||f.push({isin:d[g]})}b.isinsList=f}for(var l in a.options.isinsList)void 0==a.options.isinsList[l].isin||a.options.isinsList[l].separator||Q.push(a.options.isinsList[l].isin);H=[];for(l in a.options.groupsList)H.push(a.options.groupsList[l].replace("243_","")),a.groups=
H}})();a.$watch(function(){return a.title},function(b,c){b!==c&&void 0!=h&&$("#"+h.id).data("kendoWindow").title(a.title)});a.addSeparator=function(b){var c=Ka(ra(a.tableGrid));a.tableGrid.addSeparator(b,c);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga();g(function(){a.tableGrid.qa();a.tableGrid.content.scrollTop(a.tableGrid.content.scrollTop()-11)},0,!1)};a.removeSeparator=function(b){a.tableGrid.removeSeparator(b)};a.removeRow=function(b){if(void 0!=b){for(var c=[],d=0;d<b.length;d++){var e;
e=a.tableGrid.dataSource.indexOf(b[d]);if(-1<e)if(b[d].separator)a.tableGrid.removeSeparator(e,!0);else{e=a.tableGrid.dataSource[e];var f=a.groups,g=createStockGroupId(e.gielda_skrot,e.grupa);0<f.length&&(g=f.indexOf(g),-1<g&&f.splice(g,1));c.push(e)}}0<c.length&&a.editSecurities(c,[],void 0,void 0,!0)}a.tableGrid.qa()};a.hg=function(){var b=ua(a.tableGrid);if(b&&0<b.length){var c=a.tableGrid;console.time("Grid: removeRows");if(b&&0<b.length){for(var d=0;d<b.length;d++)c.lockedContent.find("tr[rowname="+
b[d].isin_adress+"]").remove(),c.content.find("tr[rowname="+b[d].isin_adress+"]").remove();c.$scope.isGridRowSelected=!1}console.timeEnd("Grid: removeRows");a.removeRow(b)}};a.sortColumnData=function(b,c,d){return a.tableGrid.Kc.sortColumnData(b,c,d)};this.Cg=function(){console.warn("Callback");for(var b=[],c=0;c<a.tableGrid.dataSource.length;c++)record=a.tableGrid.dataSource[c],record.separator||b.push(record.pseudoIsin);a.tableGrid.gb.fc={};console.log("getQutesFromService function");a.options=
xa(a.tableGrid);z(b,E);g(function(){},0)};b.jc(this.Cg,a.controllerId);this.Kd=function(b,c,d){b.na=ha(a.tableGrid.jb,c);b.de=d;console.time("Before worker heigth");b.Vg=a.tableGrid.parentElement.width();b.Ug=a.tableGrid.parentElement.height();b.je=ra(a.tableGrid);console.timeEnd("Before worker heigth");return b};this.Qd=function(b){setTimeout(function(){window.requestAnimationFrame(function(){console.timeEnd("Worker start");console.time("Element");console.time("Tabela start");x.element=document.getElementById("table_"+
a.controllerId);console.timeEnd("Tabela start");x.element.innerHTML=b;console.timeEnd("Element");var c=$(x.element);window.dataSource=a.tableGrid.dataSource;window.requestAnimationFrame(function(){aa(a.tableGrid,c,x.nc);ja(a.tableGrid);a.unpinnedWindow&&v.ed(a.controllerId,I);x.Ag=setInterval(function(){var b=a.tableGrid.gb,c;for(c in b.colors){var d=ia(b,c),e=b.colors[c].className;(new Date).getTime()-b.colors[c].time>=b.$scope.highlightingTime&&(d.removeClass(e),delete b.colors[c])}var b=a.tableGrid.gb,
f;for(f in b.Za){var g=!1,e=!1,h=b.Za[f].newValue,d=b.Za[f].fieldName,k=b.Za[f].isin_address;field=ia(b,f);if(void 0!==field&&1===field.length){c=b.ka[k][d];var l;l=b.tableGrid.Kc;var r=c,k=b.ka[k][d+"-oldValue"];l=l[K(l,d)](r,k,1);if(0===l){delete b.Za[f];continue}else""===h?e=!0:0<l&&(g=!0);field.text(h);b.$scope.isHighlightingDisabled||(h=b,l=f,r=c,c=field,"time"===h.tableGrid.jb[d].type?(c.addClass(h.eb),d=h.eb,P(h,l,d,c)):h.showPercentageValueArrows&&h.tableGrid.jb[d].showPercentageValueArrows?
(c.removeClass(h.Ic+" "+h.Hc),e?(c.addClass(h.eb),P(h,l,h.eb,c)):0<r?c.addClass(h.Ic):0>r?c.addClass(h.Hc):0!==r&&console.warn("Unsupported")):(e?(c.addClass(h.eb),d=h.eb):g?(c.addClass(h.Dd),d=h.Dd):(c.addClass(h.Ed),d=h.Ed),P(h,l,d,c)))}delete b.Za[f]}},500)});console.timeEnd("Tabela start")})},0)};null!=H&&void 0!=H&&""!=H&&0<H.length?b.Sc(function(a){for(var b=0;b<Object.keys(a).length;b++){var c=a[b];J.arrays.Jc(Q,c)||Q.push(c)}console.log("getQutesFromService function");z(Q,E)},H):(console.log("getQutesFromService function"),
z(Q,E));a.getSecuritiesDesignationDataItem=function(b){if(void 0===a.securitiesDesignationsComboBox)return b[L];var c=a.securitiesDesignationsComboBox.value().trim();return b[c]};a.getSecuritiesDesignationVarString=function(){var b=a.securitiesDesignationsComboBox?a.securitiesDesignationsComboBox.value().trim():L.column;return epmNtw.enums.Sd(b).langId.trim()};a.buySellFunction=function(a,b,c){a=a.target.attributes.idx.value;if(void 0!==a){var d,e,f="";if(c===epmNtw.enums.BUY_SELL.BUY){d="wk";e="k";
var g="oferta-"+a+"-k-kk";b[g]&&-2!=b[g]&&(f=b[g])}else c===epmNtw.enums.BUY_SELL.SELL&&(d="ws",e="s",g="oferta-"+a+"-s-ks",b[g]&&-2!=b[g]&&(f=b[g]));if(""==f||void 0==f)f="PKC";for(var g=["","","","",""],h=1;6>h;h++){var k="oferta-"+h+"-"+e+"-"+d;g[h-1]=void 0!==b[k]?b[k]:"0"}B.externalSystemFunctions.fillBuySellForm(b.isin,b.gielda_skrot,f.toString(),g[0].toString(),g[1].toString(),g[2].toString(),g[3].toString(),g[4].toString(),(a-1).toString(),c)}else console.warn("Brak wartosci dla wype\u0142niania formatki kupna-sprzeda\u017cy")};
a.getRowLineColumnClassName=function(b){return b&&b.rowLineDisplay?"lw-column count-"+y(b.rowLineDisplay):"lw-column count-"+y(a.lineNumbersPerSecurityToDisplay)};a.setRowLineSize=function(b,c){b.separator||(null!=c?b.rowLineDisplay=c:(b.rowLineDisplay||(b.rowLineDisplay=a.lineNumbersPerSecurityToDisplay),b.rowLineDisplay=5==b.rowLineDisplay?1:2==b.rowLineDisplay||4==b.rowLineDisplay?parseInt(b.rowLineDisplay)+1:parseInt(b.rowLineDisplay)+2),b.row_class=C(b.rowLineDisplay))};a.saveTable=function(b){var c=
xa(a.tableGrid);c.tableType=epmNtw.enums.o.QUOTES_TABLE;for(var d=a.tableGrid.dataSource.length,e=[],f=0;f<d;){next=!1;for(var g in a.groups)a.tableGrid.dataSource[f].gielda+"_"+a.tableGrid.dataSource[f].grupa===a.groups[g].trim()&&(next=!0);if(!next){var h={};h.isin=a.tableGrid.dataSource[f].isin_adress;void 0!==a.tableGrid.dataSource[f].shownOffersOverride&&0<a.tableGrid.dataSource[f].shownOffersOverride?(h.row_class=C(a.tableGrid.dataSource[f].shownOffersOverride),h.shownOffersOverride=a.tableGrid.dataSource[f].shownOffersOverride):
h.row_class=C(a.lineNumbersPerSecurityToDisplay);var k=a.tableGrid.dataSource[f].separator;null!=k&&(h.separator=k);e.push(h)}f++}for(f=d=0;f<a.tableGrid.columns.length;f++)a.tableGrid.columns[f].hidden||(d+=a.tableGrid.columns[f].width);c.dataSource=null;c.isinsList=e;c.groupsList=a.groups;c.controllerId=a.controllerId;c.toolbarState=a.saveToolbarState();c.tableTitle=a.title;c.basketName=a.basketName;c.columnSizeSum=d;c.isSort=a.isSortAlphabetic;!0===a.unpinnedWindow&&(c.position={x:window.screenX,
y:window.screenY},c.width=window.outerWidth,c.height=window.innerHeight);c.contentHeight=a.tableGrid.table.height()+a.tableGrid.header.height();!1===b||epmNtw.config.quotesTable.overrideIsinList||B.externalSystemFunctions.saveTable(c);return c};a.printGrid=function(){for(var b=a.tableGrid,d=b.lockedContent[0].children[0].children[1].children.length,e='<!DOCTYPE html><html><head><meta charset="utf-8" /><title>'+c.tableTitle+"</title><style> html { font:8px sans-serif; white-space: normal !important}.k-grid, .k-grid-content { height: auto !important; }.k-grid-content { overflow: visible !important; }tr:last-child {border-bottom-width: 2px !important}div.k-grid table {width: 98% !important; margin: 0 !important; padding: 0 !important; border-spacing: 0; border-collapse: collapse;}tbody, th, tr, table, thead, tbody td { border: 1px solid black !important; }thead {background-color: #d3d3d3; -webkit-print-color-adjust:exact;}tbody td {margin: 0 !important; padding: 1 !important; vertical-align: top;}.k-grid-toolbar, .k-grid-pager > .k-link { display: none; }th.k-header, td>div, td>div>div {overflow: hidden; white-space: nowrap}.epm-ntw-number-field{text-align: right;}</style></head><body>",
e=e+"<div class='k-grid'><table style='table-layout: fixed; overflow: hidden;'><thead><tr style=\"width: 150px; height: 50px;\">"+b.header[0].children[0].children[0].children[1].children[0].innerHTML,e=e+b.header[0].children[1].children[0].children[1].children[0].innerHTML,e=e+"</tr></thead><tbody>",f=0;f<d;f++)e+="<tr>",e+=b.lockedContent[0].children[0].children[1].children[f].innerHTML,e+=b.content[0].children[0].children[1].children[0].innerHTML+"</tr>";e+="</tbody></table></div></body></html>";
w=window.open();w.document.write(e);w.document.close();w.focus();w.print();w.close()};a.loadTable=function(){var b=localStorage.QuotesOptions;null!=b&&a.tableGrid.setOptions(JSON.parse(b))};a.editSecurities=function(c,d,e,f,h){if(c instanceof Array){arrayToRemoveWithoutSeparators=[];for(var k=0;k<c.length;k++){var l=c[k];l.separator||l.invalidIsin||arrayToRemoveWithoutSeparators.push(l)}b.bc(d,arrayToRemoveWithoutSeparators,function(b){if(!1!==e){console.debug("quotesTableService.getQuotesIsins response: "+
b);var f=a.tableGrid.dataSource.length,k=[],l;for(l in b)if("address"!=l){var r=b[l];void 0===r.isin_adress&&(console.error("isin_adress missing in PushXDP msg for: "+r.isin),r.isin_adress=r.isin);r.isin=l;r.row_class=C(a.lineNumbersPerSecurityToDisplay);r.rowPosition=f++;k.push(r)}Array.prototype.push.apply(a.tableGrid.dataSource,k);a.isSortAlphabetic&&1!=h&&(a.tableGrid.dataSource=a.sortColumnData(L.column,1,!0));b=[];for(f=0;f<a.tableGrid.dataSource.length;f++)b[f]=a.tableGrid.dataSource[f].isin_adress;
if(50<d.length+c.length){console.time("Worker start");var m=x.Kd(x.settings,a.tableGrid.dataSource,b);x.Qd(Ha(x.mc,m))}else{if(0<d.length){k=[];for(f=0;f<d.length;f++)k.push({index:b.indexOf(d[f]),isin:d[f]});k.sort(function(a,b){return a.index-b.index});for(f=0;f<d.length;f++)m={},m.de=b,m.na=ha(a.tableGrid.jb,a.tableGrid.dataSource),m.settings={},m.settings.lockedColumns=a.tableGrid.lockedColumns,m.settings.columns=a.tableGrid.ma,m.settings.showPercentageValueArrows=pa,m.settings.configName=epmNtw.config.configName,
m.grid=a.tableGrid,r=k[f].index,l=$(Da(x.mc,r,m,a.lineNumbersPerSecurityToDisplay)),m=$(Ga(x.mc,r,m,a.lineNumbersPerSecurityToDisplay)),sa(a.tableGrid,m),0===r?(r=a.tableGrid.lockedContent.find("tr:first"),0<r.length?(l.insertBefore(r),m.insertBefore(a.tableGrid.content.find("tr:first"))):(l.appendTo(a.tableGrid.lockedContent.find("tbody")),m.appendTo(a.tableGrid.content.find("tbody")))):(l.insertAfter(a.tableGrid.lockedContent.find("tr").eq(r-1)),m.insertAfter(a.tableGrid.content.find("tr").eq(r-
1)));R(a.tableGrid);oa(a.tableGrid)}for(f=0;f<c.length;f++)a.tableGrid.lockedContent.find("tr[rowname='"+c[f].isin_adress+"']").remove(),a.tableGrid.content.find("tr[rowname='"+c[f].isin_adress+"']").remove();console.time("Edit Securities: bindBuySellFunction");na(a.tableGrid);console.timeEnd("Edit Securities: bindBuySellFunction")}a.Wb();g(function(){a.tableGrid.qa()},0,!1);za||(za=!0);console.debug("quotesTableService.$scope.tableGrid.dataSourceIsins finished")}},E,a.controllerId,f);if(!1!==e){f=
J.arrays.Fd(a.tableGrid.dataSource);for(k=0;k<c.length;k++)J.arrays.Jb(f,c[k]);k=a.tableGrid.dataSource;k.splice(0,k.length);k.push.apply(k,f);g(function(){a.tableGrid.qa()},0,!1)}B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()}else console.error("tempReqSecuritiesList is not Array")};a.addFastSec=function(c){var d=c.item;if(void 0===d){if(c=a.securities.get(c.toUpperCase()),void 0===c)return}else c=c.sender.dataItem(d);c=c.isin_adress;b.be([c],!0,a.controllerId)&&(c&&(a.editSecurities([],
[c]),a.isGridRowSelected=!1),g(function(){a.selectedSecurity="";a.tableGrid.parentElement.focus()},0,!0))};a.filterData=function(){var c=a.securitiesComboBox.value().trim(),d=c.length;3<=d?M()?b.Db(c.substr(0,3)).then(function(b){a.Ub=b;for(var d=0;d<a.tableGrid.dataSource.length;d++)J.arrays.Fg(b,a.tableGrid.dataSource[d].pseudoIsin);a.securities=new kendo.data.DataSource({datatype:"json",data:b,schema:{model:{id:"nazwa"}}});g(function(){a.$apply();a.securitiesComboBox.search(c);a.securitiesComboBox.refresh()},
0,!1)}):(a.securitiesComboBox.search(c),a.securitiesComboBox.refresh()):3>d&&(a.securities&&(a.securities=null),r="")};createStockGroupId=function(a,b){return a+"_"+b};a.contextMenuInit=function(){var b=$("#menu_"+a.controllerId);b.kendoContextMenu({orientation:"vertical",target:"#table_"+a.controllerId,filter:"div.k-grid-content tr, div.k-grid-content, div.k-grid-content-locked tr, div.k-grid-content-locked",open:function(c){a.rowContextMenu=!1;a.separatorContextMenu=!1;if("tr"==c.target.localName){a.noRowContextMenu=
!1;a.lastRowIndexOnContextMenuOpen=c.target.rowIndex;void 0==a.lastRowIndexOnContextMenuOpen&&(a.lastRowIndexOnContextMenuOpen=c.target.parentElement.rowIndex);if(void 0==a.tableGrid.dataSource[a.lastRowIndexOnContextMenuOpen].separator){c=a.securitiesDesignationsComboBox.value().trim();a.currentSecuritie=a.tableGrid.dataSource[a.lastRowIndexOnContextMenuOpen][c];a.currentSecuritieToDisplay=a.currentSecuritie;a.currentSecuritieIsin=a.tableGrid.dataSource[a.lastRowIndexOnContextMenuOpen].isin_adress;
c=!0;for(var d=0;d<a.tableGrid.dataSource.length;d++)if(a.tableGrid.dataSource[d].isin===a.currentSecuritieIsin&&a.tableGrid.dataSource[d].invalidIsin){c=!1;break}a.validSecurity=c?!0:!1;a.currentSecuritieIsinName=a.tableGrid.dataSource[a.lastRowIndexOnContextMenuOpen].nazwa;a.rowContextMenu=!0;a.separatorContextMenu=!1}else a.separatorContextMenu=!0,a.rowContextMenu=!1;a.noRowContextMenu=!1}else a.noRowContextMenu=!0;c=b.data("kendoContextMenu");a.separatorContextMenu?(c.element.find("[separatorContextMenu=true]").show(),
c.element.find("[separatorContextMenu=false]").hide()):(c.element.find("[separatorContextMenu=true]").hide(),c.element.find("[separatorContextMenu=false]").show());a.rowContextMenu?c.element.find("[rowContextMenu=true]").show():c.element.find("[rowContextMenu=true]").hide();a.noRowContextMenu?c.element.find("[noRowContextMenu=false]").hide():c.element.find("[noRowContextMenu=false]").show();a.isAlertPositionInContextMenuEnabled&&u.Xc()||c.remove("[isAlertPositionInContextMenuEnabled=true]");a.isChartsPositionInContextMenuEnabled||
c.remove("[isChartsPositionInContextMenuEnabled=true]");g(function(){isContextMenuInitialized=!0},0,!0)}})};a.createTransactionsTable=function(){var b="TransactionTable_"+(new Date).getTime();if(epmNtw.config.Yb)B.externalSystemFunctions.oe(null,null,a.currentSecuritieIsin,window.Ta,a.currentSecuritieToDisplay+l("translate")("TRANSACTION_TABLE.TITLE"),null,!0);else if(!0===epmNtw.config.Mc){var c={};c.Wa=a.currentSecuritieIsin;c.elementId=b;e.open({modal:!1,width:"70%",height:"600px",actions:["Custom",
"Close"],title:a.currentSecuritieToDisplay+l("translate")("TRANSACTION_TABLE.TITLE"),templateUrl:"epmNtw/modules/transactionsTable/transactionsTableView.html",controller:"epmNtw.transactionsTableController",resolve:{initData:function(){return c}}})}else B.externalSystemFunctions.oe(null,null,a.currentSecuritieIsin,window.Ta,a.currentSecuritieToDisplay+l("translate")("TRANSACTION_TABLE.TITLE"),null,!1)};a.createAlertsList=function(a){var b="AlertsList_"+(new Date).getTime(),c;c="DEFINED_ALERTS_LIST"===
a?l("translate")("ALERTS.LIST.DEFINED_TITLE"):l("translate")("ALERTS.LIST.COMPLETED_TITLE");if(epmNtw.config.Yb)B.externalSystemFunctions.openAlertsList(null,null,window.Ta,c,a,epmNtw.config.Nb.initialGadgetHeight,!0);else if(!0===epmNtw.config.Mc){var d={};d.elementId=b;d.alertListType=a;e.open({modal:!1,width:"70%",height:"600px",actions:["Custom","Close"],title:c,templateUrl:"epmNtw/modules/alerts/modules/alertsList/alertsListView.html",controller:"epmNtw.alertsListController",resolve:{initData:function(){return d}}})}else B.externalSystemFunctions.openAlertsList(null,
null,window.Ta,c,a,epmNtw.config.alertsList.initialGadgetHeight,!1)};a.openNewAlertWindow=function(){try{u.openNewAlertWindow(a.currentSecuritieIsin)}catch(b){if("TOO_MANY_ALERTS"===b)q.ha("ERROR","TOO_MANY_ALERTS","300","77");else throw b;}};a.openCompletedAlertsWindow=function(){B.externalSystemFunctions.openCompletedAlertsWindow()};a.switchAlertsSound=function(){b.switchAlertsSound()};a.getAlertSoundLabel=function(){return b.getAlertSoundLabel()};a.openChartWindow=function(){B.externalSystemFunctions.openChartWindow(a.currentSecuritieIsinName,
a.currentSecuritieIsin)};a.closeTable=function(){clearInterval(x.Ag);a.unpinnedWindow?d.fd(a.controllerId):d.ve(a.controllerId);try{$("#contextMenu_"+a.controllerId).data("kendoContextMenu").destroy(),$("#contextMenu_"+a.controllerId).remove()}catch(c){}for(var e=[],f=0;f<a.tableGrid.dataSource.length;f++)e[f]=a.tableGrid.dataSource[f];a.shouldReleaseSecurities?a.editSecurities(e,[],!1,!0):b.Nc(a.controllerId,e,E);void 0!==a&&(a.destroyed=!0,a.$destroy());delete a};a.getRows=function(){return J.arrays.Fd(a.tableGrid.dataSource)};
f.$on("$translateChangeSuccess",function(){});a.unpinnedWindow&&angular.element(document).ready(function(){var a=location.search.split("epmNtwWindowId=")[1];window.opener.angular.element("body").injector().get("epmNtw.windowsService").Zc(parseInt(a));B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()});a.$on("$destroy",function(){void 0===a.destroyed&&!1===N&&a.closeTable()});void 0!==window.opener&&null!==window.opener&&$(window).bind("beforeunload",function(){N||(N=!0,a.closeTable(),v.kd(a.controllerId))})};epmNtw.pe=function(b,d,c,f,a,e,h,l,g,k,m,p,t,u,q,v){a.Wc=!0;a.Mb=!1;a.Be=!0;v.invoke(["epmNtw.quotesTableService","epmNtw.windowsService","windowModel","$rootScope","$scope","$kWindow","$windowInstance","$filter","$timeout","$compile","$interval","$q","$translate","epmNtw.alertsService","epmNtw.messageDialogService","epmNtw.quotesTimeService",epmNtw.$f],this,{windowModel:c,$scope:a,$kWindow:e,$windowInstance:h});a.Cd=function(){a.tableGrid.element.keydown(function(b){var c=b.keyCode;1!=b.shiftKey||
c!=epmNtw.enums.oa.nd&&c!=epmNtw.enums.oa.od||(c=epmNtw.enums.oa.xc);switch(c){case epmNtw.enums.oa.Ge:b=a.tableGrid.select();var c=b.length/2-1,d=b.length/2-c;b.splice(0,c);b.splice(d,c);b=b.next();a.tableGrid.clearSelection();if(0!=b.length){var d=b.position().top,e=b.height(),c=$("#table_"+a.controllerId+" div.k-grid-content"),f=c.height();d+e>f&&c.scrollTop(c.scrollTop()+e);a.tableGrid.select(b)}break;case epmNtw.enums.oa.He:b=a.tableGrid.select(),c=b.length/2-1,b.splice(1,c),b.splice(2,c),b=
b.prev(),a.tableGrid.clearSelection(),0!=b.length&&(d=b.position().top,e=b.height(),c=$("#table_"+a.controllerId+" div.k-grid-content"),c.height(),0>d&&c.scrollTop(c.scrollTop()-e),a.tableGrid.select(b))}})};a.openNewAlertWindow=function(){try{u.openNewAlertWindow(a.currentSecuritieIsin,null,a.tableGrid.dataSource[a.lastRowIndexOnContextMenuOpen])}catch(b){if("TOO_MANY_ALERTS"===b)q.ha("ERROR","TOO_MANY_ALERTS","300","77");else throw b;}}};epmNtw.pe.$inject="epmNtw.quotesTableService epmNtw.windowsService windowModel $rootScope $scope $kWindow $windowInstance $filter $timeout $compile $interval $q $translate epmNtw.alertsService epmNtw.messageDialogService $injector epmNtw.quotesTimeService".split(" ");
angular.module("epmNtw.quotes-table").controller("epmNtw.quotesTableController",epmNtw.pe);epmNtw.tg=function(){return function(b,d){if(0===b)return"";"custom"===d&&void 0!==b&&(d=epmNtw.utils.aa.nb(b));return kendo.toString(b,d)}};angular.module("epmNtw.quotes-table").filter("epmNtwQuotesTableFormatFilter",epmNtw.tg);epmNtw.ug=function(){return function(b,d){if(0===b)return"0";if("EMPTY_VALUE"===b)return"";"custom"===d&&void 0!==b&&(d=epmNtw.utils.aa.nb(b));return kendo.toString(b,d)}};angular.module("epmNtw.quotes-table").filter("epmNtwQuotesTableOpenFieldFilter",epmNtw.ug);epmNtw.vg=function(){return function(b,d){if(-2===b)return"PKC/PCR";if(0===b)return"";"custom"===d&&void 0!==b&&(d=epmNtw.utils.aa.nb(b));return kendo.toString(b,d)}};angular.module("epmNtw.quotes-table").filter("epmNtwQuotesTablePkcPcrFilter",epmNtw.vg);epmNtw.xg=function(){return function(b,d){return 0===b?"":kendo.toString(b,d)+"%"}};angular.module("epmNtw.quotes-table").filter("epmNtwQuotesTableTKOPercentageFormatFilter",epmNtw.xg);epmNtw.zg=function(){return function(b,d){return"EMPTY_VALUE"===b?"":kendo.toString(b,d)+"%"}};angular.module("epmNtw.quotes-table").filter("epmNtwQuotestTablePercentageFormatFilter",epmNtw.zg);epmNtw.Ce=function(b,d){d.De=new kendo.data.DataSource({data:epmNtw.enums.Bh});d.Lh=function(b){b=b.sender.value();console.log(b);$("#epmNtwKendoTheme").attr("href",b)};d.Hg=function(){for(var b=0;b<d.De.options.data.length;b++){var f=d.De.options.data[b];if(f.text===epmNtw.config.Mh){d.Nh=b;$("#epmNtwKendoTheme").attr("href",f.value);break}}};d.Hg()};epmNtw.Ce.$inject=["$rootScope","$scope"];angular.module("epmNtw.theme-chooser").controller("epmNtw.themeChooserController",epmNtw.Ce);epmNtw.qe=function(b){return{restrict:"E",templateUrl:epmNtw.Ia+"quotes-table/quotes-table.view.html",link:function(d,c){kendo.ui.progress(c,!0);console.debug("View is dowloaded! Creating controller ...");var f={};f.$scope=d;f.$windowInstance=void 0;f.windowModel=null!==window.windowModel&&void 0!==window.windowModel&&window.windowModel.isUnpinned?window.windowModel:d.windowModel;console.debug("windowModel data: "+f.windowModel);b("epmNtw.quotesTableController",f)}}};
epmNtw.qe.$inject=["$controller","$compile"];angular.module("epmNtw.quotes-table").directive("epmNtwQuotesTableDirective",epmNtw.qe);epmNtw.Wg=function(){return{restrict:"E",templateUrl:"epmNtw/modules/theme-chooser/theme-chooser.view.html",replace:"true",controller:"epmNtw.themeChooserController"}};angular.module("epmNtw.theme-chooser").directive("epmNtwThemeChooserDirective",epmNtw.Wg);epmNtw.$d=function(b){return{link:function(d,c,f){d=b(d[f.epmNtwHtmlBindTemplate])(d);c.append(d);c.on("contextmenu",function(){return!1})}}};epmNtw.$d.$inject=["$compile"];angular.module("epmNtw").directive("epmNtwHtmlBindTemplate",epmNtw.$d);epmNtw.Zf=function(){return{link:function(b,d){var c;$(d).keypress(function(b){if(8==b.which||13==b.which||16==b.which||45==b.which)return!0;c=String.fromCharCode(b.which);return/[0-9a-zA-Z]/g.test(c)})}}};
angular.module("epmNtw").directive("epmNtwAlphaNumeric",epmNtw.Zf);epmNtw.Ae=function(){return{restrict:"E",link:function(){}}};epmNtw.Ae.$inject=["$compile"];angular.module("epmNtw").directive("epmNtwSetTheme",epmNtw.Ae);epmNtw.Sg=function(){return{restrict:"E",templateUrl:epmNtw.ra+"shared/modules/table-toolbar/table-toolbar.view.html",replace:!0,require:"ngModel",controller:"epmNtw.toolbarController"}};angular.module("epmNtw.table-toolbar").directive("epmNtwTableToolbarDirective",epmNtw.Sg);angular.module("epmNtw.alerts",["kendo.directives","epmNtw.alerts-editor","epmNtw.alerts-list"]);epmNtw.vd=function(b,d,c,f,a,e,h,l,g){var k=this;if(null!==window.opener&&void 0!==window.opener){var m=window.opener.angular.element("body").injector().get("epmNtw.alertsService");this.va=m.va;this.ic=m.ic;this.xb=m.xb;this.Kb=m.Kb;this.openNewAlertWindow=m.openNewAlertWindow;this.alerts=m.alerts;this.ac=m.ac;this.lb=m.lb;this.kb=m.kb;this.mb=m.mb;this.alertStateChange=m.alertStateChange;this.deleteAlert=m.deleteAlert;this.alertDeleted=m.alertDeleted;this.Pc=m.Pc;this.Ob=m.Ob;this.fb=m.fb;this.hb=
m.hb;this.Ba=m.Ba;this.Rc=m.Rc;this.Xc=m.Xc;this.isNewAlertFromMenuAvailable=m.isNewAlertFromMenuAvailable;this.isEditAlertAvailable=m.isEditAlertAvailable}else{this.va=b;this.alerts=[];this.Ba={};this.va=b;this.ac=[];this.Ob=[];this.fb={};this.hb={};this.Uf=a("translate")("ALERTS.LIST.ACTIVE");this.lg=a("translate")("ALERTS.LIST.INACTIVE");this.Lg=a("translate")("ALERTS.LIST.SINGLE");this.ng=a("translate")("ALERTS.LIST.MULTI");var p=!1;this.isNewAlertFromMenuAvailable=function(){return!0};this.isEditAlertAvailable=
function(){return!0};this.kb=function(a){return a?this.Uf:this.lg};this.mb=function(a){return a?this.Lg:this.ng};this.Rc=function(){return b.Ra().maxClientAlerts};this.Xc=function(){return!0===b.Ra().alertsEnable?!0:!1};this.openNewAlertWindow=function(a,b,c){B.ea().uc(a,b,c)};this.Pc=function(){B.ea().xf()};var t=function(a,b){var c=[],d=0,e=a.length;a:for(;d<e;d++){for(var f=0,g=b.length;f<g;f++)if(a[d].id_alert==b[f].id_alert)continue a;c.push(a[d])}return c};this.Ig=function(a){console.log("Stored Alerts: "+
JSON.stringify(a));if(void 0!=k.alerts&&0<k.alerts.length){void 0==a&&(a=[]);for(var b=!1,c=t(k.alerts,a),d=0,e=c.length;d<e;d++)b=!0,!0===c[d].active&&A(c[d].id_alert,c[d].isin_address);if(a.length>k.alerts.length-c.length)for(b=!0,c=t(a,k.alerts),d=0,e=c.length;d<e;d++)!0===c[d].active&&z(c[d]);for(var c=[],f=[],d=0,e=k.alerts.length;d<e;d++)c[k.alerts[d].isin]=k.alerts[d].walor;d=0;for(e=a.length;d<e;d++)void 0==c[a[d].isin]&&(c[a[d].isin]=a[d].isin,f.push(a[d].isin));0<f.length?u(c,f,a):q(c,a);
b&&k.Pa()}else if(void 0!=a&&0<a.length){c=[];d=0;for(e=a.length;d<e;d++)c[a[d].isin]=a[d].isin;u(c,Object.keys(c),a)}};var u=function(a,c,d){e.when(b.ob.promise).then(function(){l.kg(c.join()).then(function(b){for(var c=0,e=b.data.length;c<e;c++)a[b.data[c].isin_adress]=b.data[c].nazwa;q(a,d);k.Pa()},function(){console.warn("Nie mo\u017cna pobra\u0107 informacji o instrumentach: "+Object.keys(a).join());q(a,d);k.Pa()})})},q=function(a,b){k.alerts.length=0;k.alerts.push.apply(k.alerts,b);for(var c=
0,d=k.alerts.length;c<d;c++)k.alerts[c].singleName=k.mb(k.alerts[c].single),k.alerts[c].activeName=k.kb(k.alerts[c].active),k.alerts[c].walor=a[k.alerts[c].isin]};this.ic=function(a,b){console.log(" setAlertId for: "+a+" // "+b+"; TotalAlerts:"+this.alerts.length);var c=k.Ba[a].data,d=k.Ba[a].promise;c.id_alert=b;k.alerts.push(c);delete k.Ba[a];d.resolve();k.Pa();c.active&&z(c);return!0};this.xb=function(){for(var a=0,b=0,c=k.alerts.length;b<c;b++)k.alerts[b].active&&a++;return a};this.Kb=function(a){a=
JSON.parse(a);var b=e.defer(),c={};c.promise=b;c.data=a;void 0==a.id_alert?(k.Ba[a.id_alert_temp]=c,a.singleName=k.mb(a.single),a.activeName=k.kb(a.active)):k.Ba[a.id_alert]=c;k.we(a);return b.promise};this.lb=function(a){for(var b=0,c=k.alerts.length;b<c;b++)if(k.alerts[b].id_alert==a)return k.alerts[b]};var v=function(a,b){a.active=b;a.activeName=k.kb(b);k.Pa();B.externalSystemFunctions.alertStateChange(a.id_alert,b)};this.alertStateChange=function(a,c){if(!0===c&&k.xb()>=b.Ra().maxClientAlerts)throw"TOO_MANY_ALERTS";
var d=k.lb(a);void 0!=d&&(v(d,c),c?z(d):A(d.id_alert,d.isin_address))};this.deleteAlert=function(a){B.externalSystemFunctions.deleteAlert(a)};this.alertDeleted=function(a){for(var b=0,c=k.alerts.length;b<c;b++)if(k.alerts[b].id_alert==a){k.alerts[b].active&&A(k.alerts[b].id_alert,k.alerts[b].isin_address);k.alerts.splice(b,1);break}k.Pa()};this.we=function(a){B.externalSystemFunctions.Kb(JSON.stringify(a))};this.editAlert=function(a){var c=k.lb(a),d=k.Ba[a].data,e=k.Ba[a].promise,f=c.active,g=c.isin_address,
l;!0===d.active&&!1===f&&k.xb()>=b.Ra().maxClientAlerts&&(l=!1);if(void 0!=c){for(var m in d)c[m]=d[m];!0===c.active?!1!==l?f?(console.log("Edit alert in pushXDP: oldIsin:"+g+" alert:"+JSON.stringify(d)),d=$.param({token:b.ua(),alert:JSON.stringify(y(d)),edited_isin_address:g}),F("editAlert",d)):z(d):c.active=!1:f&&A(c.id_alert,g);c.singleName=k.mb(c.single);c.activeName=k.kb(c.active)}delete k.Ba[a];e.resolve();k.Pa();!1===l&&h.ha("ERROR","TOO_MANY_ALERTS","300","77")};var y=function(a){return{id_alert:""+
a.id_alert,isin_address:a.isin_address,walor:a.walor,message:a.message,multiple:!a.single,conditions:a.conditions}},z=function(a){console.log("Add alert to pushXDP: "+JSON.stringify(a));a=$.param({token:b.ua(),alert:JSON.stringify(y(a))});F("newAlert",a)},A=function(a,c){console.log("Remove alert from PushXDP: "+a+" // "+c);var d=$.param({token:b.ua(),id_alert:a,isin_address:c});F("removeAlert",d)},F=function(a,c){"newAlert"!==a&&"removeAlert"!==a&&"initAlert"!==a&&"editAlert"!==a?console.error("Incompatible request type: "+
a):d.post(b.ya()+"/"+a+"?"+b.wa(),c,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(){}).error(function(c,d){console.error("Connection to "+b.ya()+"/"+a+" failed."+d)})},E=new Audio(epmNtw.ra+"assets/sounds/alert.mp3"),I=function(b){a:if(epmNtw.config.alerts.onAlertExecutionShowList){for(var c=0,d=g.unpinnedWindows.length;c<d;c++)if(g.unpinnedWindows[c].type==epmNtw.enums.o.COMPLETED_ALERTS_LIST&&0==g.unpinnedWindows[c].windowReference.closed){g.unpinnedWindows[c].windowReference.focus();
break a}if(!epmNtw.config.alerts.onAlertExecutionShowUnpinnedList)for(c=0,d=g.pinnedWindows.length;c<d;c++)if(g.pinnedWindows[c].type==epmNtw.enums.o.COMPLETED_ALERTS_LIST)break a;B.externalSystemFunctions.openAlertsList(null,null,window.Ta,a("translate")("ALERTS.LIST.COMPLETED_TITLE"),epmNtw.enums.o.COMPLETED_ALERTS_LIST,epmNtw.config.alertsList.initialGadgetHeight,!0)}c={id_alert:b.id_alert,id_alert_exec:b.id_alert+((new Date).getTime()+Math.floor(1E6*Math.random()+1)),walor:b.walor,time:b.time,
single:!b.multiple,singleName:k.mb(!b.multiple),message:b.message};k.ac.unshift(c);b.multiple||(b=k.lb(b.id_alert),void 0!=b&&v(b,!1));p=!0};setInterval(function(){!0===p&&(k.ig(),b.bb&&E.play(),p=!1)},1E3);this.ec=function(){return c.Rh};(function(){e.when(b.ob.promise).then(function(){if(!0===b.Ra().alertsEnable&&void 0!=k.ec()){console.log("Register alert listener @ "+k.ec());b.registerHandler(""+k.ec(),I);for(var a=[],c=0,d=k.alerts.length;c<d;c++)k.alerts[c].active&&a.push(y(k.alerts[c]));0<
a.length&&(a=$.param({token:b.ua(),alert:JSON.stringify({token:b.ua(),alertsList:a})}),F("initAlert",a))}})})()}this.Vf=function(a,b){k.fb[a]=b};this.Wf=function(a,b){k.hb[a]=b};this.ig=function(){for(var a in k.fb)k.fb[a]()};this.Pa=function(){for(var a in k.hb)k.hb[a]();f(function(){},0)};this.Eg=function(a){delete k.hb[a]};this.Dg=function(a){delete k.fb[a]};this.sg=function(a){if("DEFINED_ALERTS_LIST"===a)return k.Pc(),new kendo.data.DataSource({data:k.alerts,schema:{model:{id:"id_alert"}}});
if("COMPLETED_ALERTS_LIST"===a)return new kendo.data.DataSource({data:k.ac,pageSize:35,schema:{model:{id:"id_alert_exec"}}})}};epmNtw.Aa=function(b,d,c,f,a,e,h,l,g){epmNtw.vd.call(this,b,d,c,f,a,e,h,l,g);this.isNewAlertFromMenuAvailable=function(){return!1};this.isEditAlertAvailable=function(){return!1};this.we=function(a){void 0==a.id_alert&&void 0!=a.id_alert_temp&&this.ic(a.id_alert_temp,a.id_alert_temp)};this.ec=function(){return b.ua().substring(0,128)};this.deleteAlert=function(a){this.alertDeleted(a)}};epmNtw.Aa.prototype=Object.create(epmNtw.vd.prototype);epmNtw.Aa.$inject="epmNtw.eventBusService $http $rootScope $timeout $filter $q epmNtw.messageDialogService epmNtw.quotesTableService epmNtw.windowsService".split(" ");
angular.module("epmNtw").service("epmNtw.alertsService",epmNtw.Aa);angular.module("epmNtw.alerts-editor",["kendo.directives"]);epmNtw.xd=function(b,d,c,f,a,e,h,l,g,k,m){function p(a){for(var b=0,c=d.fields3.length;b<c;b++)if(d.fields3[b].name===a)return d.fields3[b].id;return!1}function t(){for(var a=[],b=0,c=d.conditions.length;b<c;b++)if(!$.isEmptyObject(d.conditions[b])&&q(d.conditions[b])){var e={};e.field1=void 0==d.conditions[b].field1?"":d.conditions[b].field1;e.operator=void 0==d.conditions[b].operator?"":d.conditions[b].operator;e.field2=void 0==d.conditions[b].field2?"":d.conditions[b].field2;e.comparator=void 0==
d.conditions[b].comparator?"":d.conditions[b].comparator;e.field3=void 0==d.conditions[b].Cb?"":N.test(d.conditions[b].Cb)?kendo.parseFloat(d.conditions[b].Cb).toString():d.conditions[b].Cb;a.push(e)}return a}function u(){for(var a=0,b=0,c=d.conditions.length;b<c;b++)q(d.conditions[b])&&a++;return a>I.maxAlertConditions?!0:!1}function q(a){return A.string.pa(a.comparator)}function v(){var a=y(),b=a.length,c=F.length;if(0<c){if(F.substr(0,3)===a.substr(0,3))return!1;F=a;return!0}if(0===c)return F=
a,!0;if(3<b)return!1;F=a;return!0}function y(){return null!==d.autoCompleteSelectedSecurity&&void 0!==d.autoCompleteSelectedSecurity&&0<d.autoCompleteSelectedSecurity.length?d.autoCompleteSelectedSecurity.trim():""}var z=this,A=epmNtw.utils,F="",E=!1;console.log("init alertsEditorController: "+d.windowModel.pseudoIsins);d.Th=!1;var I=g.va.Ra();d.conditions=[];d.oldWindowHeight=$(window).height();d.allow2changeSecurity=!0;window.document.title=a("translate")("ALERTS.EDITOR.TITLE");d.Fc=function(a){a&&
(d.Wa=a);d.autoCompleteSelectedSecurity=a.nazwa+" "+a.gielda+"("+a.waluta+")"};(function(){if(void 0!==d.windowModel.pseudoIsins&&""!==d.windowModel.pseudoIsins){var a=JSON.parse(windowModel.settings);if(void 0!=a.security)a.security.walor=a.security.nazwa,d.Fc(a.security),d.allow2changeSecurity=!1,d.currentPrice=kendo.toString(a.security.zamkniecie,"n2"),f(function(){},0);else{if(void 0!=a.id_alert){var b=g.lb(a.id_alert);console.log("EDIT ALERT alertDef for: "+a.id_alert+" :: "+JSON.stringify(b));
void 0!=b&&(z.ae=a.id_alert,d.message=b.message,E=d.alertActive=b.active,d.singleAlert={value:""+b.single},d.conditions=angular.copy(b.conditions))}k.Db(d.windowModel.pseudoIsins.substr(0,3),"pseudoIsin").then(function(a){for(var b=0,c=a.length;b<c;b++)if(a[b].isin_adress===d.windowModel.pseudoIsins){d.autoCompleteSelectedSecurity=a[b].Vh;d.Fc(a[b]);f(function(){},0);break}})}}})();c=I.maxAlertConditions;if(I.maxAlertConditions>d.conditions.length){var C=0;for(e=I.maxAlertConditions-d.conditions.length;C<
e;C++)d.conditions.push({})}else c=d.conditions.length;void 0==d.alertActive&&(d.alertActive=!0,d.singleAlert={value:"true"});var C=a("translate")("ALERTS.EDITOR.DESCRIPTION"),M="ALERTS.EDITOR.CHANGE;ALERTS.FIELDS.|ZMIANA % DO ODN.|;ALERTS.FIELDS.KURS AKTUALNY;ALERTS.FIELDS.KURS ODNIESIENIA;ALERTS.FIELDS.ZMIANA % DO ODN.;ALERTS.FIELDS.KURS AKTUALNY;ALERTS.FIELDS.KURS ODNIESIENIA;ALERTS.FIELDS.ZMIANA % DO ODN.;ALERTS.FIELDS.WARTO\u015a\u0106 TRANSAKCJI;ALERTS.FIELDS.KURS AKTUALNY;ALERTS.FIELDS.KURS POPRZ. TRANS.;ALERTS.FIELDS.ZMIANA % DO POPRZ.;ALERTS.FIELDS.KURS AKTUALNY;ALERTS.FIELDS.KURS POPRZ. TRANS.;ALERTS.FIELDS.ZMIANA % DO POPRZ.;ALERTS.FIELDS.|ZMIANA % DO POPRZ.|;ALERTS.FIELDS.LIMIT SPRZEDA\u017bY;ALERTS.FIELDS.LIMIT KUPNA;ALERTS.FIELDS.WOLUMEN KUPNA;ALERTS.FIELDS.WARTO\u015a\u0106 TRANSAKCJI;ALERTS.FIELDS.OBR\u00d3T NA SESJI".split(";"),
x=0;for(e=M.length;x<e;x++)C=C.replace("{"+x+"}",a("translate")(M[x]));d.description=l.trustAsHtml(C);d.descriptionHeight=252;5>c&&(d.descriptionHeight+=37*(5-c));$("#contentDefinition").height(d.descriptionHeight);d.fields=[];d.fields3=[];h("ALERTS.FIELDS.KURS ODNIESIENIA;ALERTS.FIELDS.KURS OTWARCIA;ALERTS.FIELDS.KURS MINIMALNY;ALERTS.FIELDS.KURS MAKSYMALNY;ALERTS.FIELDS.KURS AKTUALNY;ALERTS.FIELDS.KURS POPRZ. TRANS.;ALERTS.FIELDS.ZMIANA DO ODN.;ALERTS.FIELDS.ZMIANA % DO ODN.;ALERTS.FIELDS.|ZMIANA DO ODN.|;ALERTS.FIELDS.|ZMIANA % DO ODN.|;ALERTS.FIELDS.ZMIANA DO OTW.;ALERTS.FIELDS.ZMIANA % DO OTW.;ALERTS.FIELDS.|ZMIANA DO OTW.|;ALERTS.FIELDS.|ZMIANA % DO OTW.|;ALERTS.FIELDS.ZMIANA DO POPRZ.;ALERTS.FIELDS.ZMIANA % DO POPRZ.;ALERTS.FIELDS.|ZMIANA DO POPRZ.|;ALERTS.FIELDS.|ZMIANA % DO POPRZ.|;ALERTS.FIELDS.WOLUMEN TRANSAKCJI;ALERTS.FIELDS.WARTO\u015a\u0106 TRANSAKCJI;ALERTS.FIELDS.WOLUMEN NA SESJI;ALERTS.FIELDS.OBR\u00d3T NA SESJI;ALERTS.FIELDS.LIMIT KUPNA;ALERTS.FIELDS.LIMIT SPRZEDA\u017bY;ALERTS.FIELDS.WOLUMEN KUPNA;ALERTS.FIELDS.WOLUMEN SPRZEDA\u017bY".split(";")).then(function(a){d.fields.push({id:"",
name:""});angular.forEach(a,function(a,b){d.fields.push({id:b.replace("ALERTS.FIELDS.",""),name:a})});d.fields3=d.fields;d.fields1DS=new kendo.data.DataSource({Lc:"json",data:d.fields});d.fields2DS=new kendo.data.DataSource({Lc:"json",data:d.fields});d.fields3DS=new kendo.data.DataSource({Lc:"json",data:d.fields3})},function(a){console.log("A: "+a)});d.clearCondition=function(a){d.conditions[a]={};$("#field3ComboBox-"+a).removeClass("ng-invalid");f(function(){},0)};d.isConditionExists=function(a){return A.string.pa(a.field1)||
A.string.pa(a.field2)||A.string.pa(a.field3)||A.string.pa(a.operator)||A.string.pa(a.comparator)};d.isSecurityValid=function(){return void 0!==d.Wa&&d.Wa!=={}};var J=RegExp("^[0-9a-zA-Z\u0119\u015b\u0107\u0142\u0144\u0105\u00f3\u017a\u017c\u0104\u0118\u0106\u015a\u0141\u00d3\u0143\u0179\u017b!?@#$%^&*_ \\.,;:+-\\/\\(\\)]{1,}$");d.isMessageValueValid=function(a){return J.test(a)?!0:!1};d.isField1Required=function(a){return A.string.pa(a.operator)||!A.string.pa(a.field2)&&A.string.pa(a.comparator)};
d.isOperatorRequired=function(a){return A.string.pa(a.field1)&&A.string.pa(a.field2)};d.isField2Required=function(a){return A.string.pa(a.operator)};d.isComparatorRequired=function(a){return A.string.pa(a.field1)||A.string.pa(a.field2)||A.string.pa(a.field3)};d.isField3Required=function(a){return q(a)};d.hasAtLeastOneCondition=function(){for(var a=0,b=d.conditions.length;a<b;a++)if(q(d.conditions[a]))return!0;return!1};d.confirm=function(){if(d.alertActive){var a=g.Rc(),c=g.xb(),e=E&&a<c?!0:!1;if(!E&&
a<c+1||e){b.ha("ERROR","TOO_MANY_ALERTS","300","77");return}}if(u())return b.ha("ERROR","TOO_MANY_ALERT_CONDITIONS","300","77",{maxAlertConditions:I.maxAlertConditions}),!1;a=0;for(c=d.conditions.length;a<c;a++)void 0!==d.conditions[a]&&q(d.conditions[a])&&(N.test(d.conditions[a].field3)?d.conditions[a].Cb=d.conditions[a].field3:d.conditions[a].Cb=p(d.conditions[a].field3));a={};void 0!=z.ae&&(a.id_alert=z.ae);a.id_alert_temp="Alert"+(Math.floor(1E9*Math.random()+1)+Math.floor(1E9*Math.random()+1));
a.isin=d.Wa.isin;a.stock=d.Wa.gielda;a.isin_address=d.Wa.isin_adress;a.walor=d.Wa.nazwa;a.active=d.alertActive;a.message=d.message;a.single="true"==String(d.singleAlert.value)?!0:!1;a.conditions=t();console.log("SAVE Alert: "+JSON.stringify(a));g.Kb(JSON.stringify(a)).then(function(){b.ha("INFO","ALERT_SAVED","210","85",void 0,d.cancel)})};d.cancel=function(){d.windowModel.isUnpinned&&m.fd(z.Xb,!0)};var N=/^-?\d+([\s,]\d{3})*[,.]?\d*%?$/;d.isField3ValueValid=function(a){return!1!==p(a)||N.test(a)?
!0:!1};d.openField3ComboBox=function(a){var b=d.conditions[a].field3;$("#field3ComboBox-"+a).change(function(){var b=kendo.parseFloat($(this).val());$.isNumeric(b)&&$("#field3ComboBox-"+a).val(kendo.toString(b,"n2"))});void 0!==b&&0<b.length?(d.conditions[a].field3="",f(function(){$("#field3ComboBox-"+a).data("kendoAutoComplete").search()},25,!0)):$("#field3ComboBox-"+a).data("kendoAutoComplete").search()};d.filterData=function(){var a=y(),b=a.length;""!==a&&(3<=b?v()?k.Db(a.substr(0,3)).then(function(b){displayedSecurities=
d.autoAllSecurities=b;d.securities=new kendo.data.DataSource({Lc:"json",data:b});f(function(){d.$apply();d.securitiesComboBox.search(a);d.securitiesComboBox.refresh()},0,!1)}):d.securitiesComboBox.search(a):3>b&&(d.securities&&(d.securities=null),F=""))};d.bindData=function(a){d.Fc(a.sender.dataItem(a.item));a.preventDefault()};d.$on("kendoRendered",function(){console.log("kendoRendered")});$(window).bind("resize",function(){d.onResize();d.$apply()});d.onResize=function(){var a=window.innerHeight;
d.descriptionHeight-=d.oldWindowHeight-a;$("#contentDefinition").height(d.descriptionHeight);d.oldWindowHeight=a};d.windowModel.isUnpinned&&angular.element(document).ready(function(){z.Xb=parseInt(location.search.split("epmNtwWindowId=")[1],10);m.Zc(z.Xb);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()})};epmNtw.xd.$inject="epmNtw.messageDialogService $scope $windowInstance $timeout $filter $q $translate $sce epmNtw.alertsService epmNtw.quotesTableService epmNtw.windowsService".split(" ");
angular.module("epmNtw.alerts-editor").controller("epmNtw.alertsEditorController",epmNtw.xd);epmNtw.yd=function(b){return{restrict:"E",templateUrl:epmNtw.Ia+"alerts/modules/alerts-editor/alerts-editor.view.html",link:function(d){console.debug("View is dowloaded! Creating controller ...");var c={};c.$scope=d;c.$windowInstance=void 0;c.windowModel=null!==window.windowModel&&void 0!==window.windowModel&&window.windowModel.isUnpinned?window.windowModel:d.windowModel;console.debug("windowModel data: "+c.windowModel);b("epmNtw.alertsEditorController",c)}}};epmNtw.yd.$inject=["$controller","$compile"];
angular.module("epmNtw.alerts-editor").directive("epmNtwAlertsEditorDirective",epmNtw.yd);epmNtw.wd=function(b){return{restrict:"A",require:"ngModel",scope:{isField3ValueValid:"=",index:"="},link:function(d,c,f,a){c.bind("change select input",function(){var e=c.val();void 0!==e&&0<e.length&&(e=d.isField3ValueValid(e),a.$setValidity("invalid",e),e?c.parent().removeClass("ng-invalid"):c.parent().addClass("ng-invalid"),b(function(){},0))})}}};epmNtw.wd.$inject=["$timeout"];angular.module("epmNtw.alerts-editor").directive("epmNtwAlertsComboValidator",epmNtw.wd);angular.module("epmNtw.alerts-list",["kendo.directives"]);epmNtw.jg=function(b){return'<ul id="contextMenu_'+b+'" class="epmNtwContextMenu"><li ng-click="adjustColumnsToContent()" translate="CONTEXT_MENU.ADJUST_COLUMNS_TO_CONTENT"></li></ul>'};epmNtw.zd=function(b,d,c,f,a,e,h,l,g,k,m,p){function t(){if(void 0!=a.alertsDataSource)for(var b=0;b<a.alertsDataSource._data.length;b++){var c=a.alertsDataSource._data[b].id_alert_exec,d=(new Date).getTime();if(void 0!=a.rowClassNames[c]){if(""===a.rowClassNames[c].className)break;2E3<d-a.rowClassNames[c].inserttime&&(M=!0,a.rowClassNames[c].className="")}}}function u(){a.tableGrid&&void 0!=a.Wb&&a.Wb()}function q(a){return rowTemplate="<tr role='row'"+(1==a?" class='k-alt' ":" ")+"ng-class=rowClassNames[dataItem.id_alert_exec].className><td role='gridcell' ng-bind='dataItem.walor'></td><td class='epm-ntw-number-field' role='gridcell' ng-bind='dataItem.time | date:\"yyyy-MM-dd HH:mm:ss\"'></td><td role='gridcell' ng-bind='dataItem.singleName'></td><td role='gridcell' ng-bind='dataItem.message'></td> </tr>"}
function v(a){return rowTemplate="<tr role='row'"+(1==a?" class='k-alt' ":" ")+"ng-class=rowClassNames[dataItem.id_alert_exec].className><td role='gridcell' ng-bind='dataItem.walor'></td><td role='gridcell' ng-bind='dataItem.singleName'></td><td role='gridcell' ng-bind='dataItem.activeName'></td><td role='gridcell' ng-bind='dataItem.message'></td> </tr>"}function y(b){if(a.isAdjustColumnsWidthToWindowEnabled){for(var c=0,d=0;d<a.tableGrid.columns.length;d++)if(b.column.id===a.tableGrid.columns[d].id){c=
b.oldWidth;break}a.adjustColumnsWidthToWindow(d-0,c)}B.externalSystemFunctions.ga()}function z(){a.tableGrid.dataSource.read()}function A(){C=a.alertsDataSource._data.length;z();newAlertsCount=a.alertsDataSource._data.length;g(function(){for(var b=0;b<newAlertsCount-C;b++)a.rowClassNames[a.alertsDataSource._data[b].id_alert_exec]={className:"yellow",inserttime:(new Date).getTime()}},0)}function F(){var c=$("#"+b.elementId);a.tableGrid.parentElement=c;a.tableGrid.toolbar=a.tableGrid.parentElement.find(".k-grid-toolbar");
a.tableGrid.header=a.tableGrid.thead;a.tableGrid.sa=a.tableGrid.header;a.tableGrid.Sa=a.unpinnedWindow;a.tableGrid.$scope=a;a.tableGrid.tableType=a.alertListType;a.tableGrid.$timeout=g;if("DEFINED_ALERTS_LIST"===a.alertListType)k.Wf(a.controllerId,z);else if(k.Vf(a.controllerId,A),void 0!=a.alertsDataSource)for(C=a.alertsDataSource._data.length,c=0;c<C;c++)a.rowClassNames[a.alertsDataSource._data[c].id_alert_exec]={className:"yellow",inserttime:(new Date).getTime()};a.isAlertsListReady=!0;a.unpinnedWindow?
kendo.ui.progress($("body > div.epm-ntw"),!1):kendo.ui.progress($("#"+a.controllerId),!1);a.tableGrid.qa();g(function(){},0);z()}a.unpinnedWindow=b.isUnpinned;a.controllerId=b.controllerId;a.isInitGridHeightAdjusted=!1;a.quotesTableToolbarType=epmNtw.enums.ab.BASIC;a.alertListType=b.type;a.selectedData=[];a.selectedData.active=!0;a.selectedState=!0;var E=!1;a.alertsDataSource=k.sg(a.alertListType);a.title=b.tableTitle;a.options=void 0;a.listType=!0;void 0!==b.settings&&null!==b.settings?(a.options=
JSON.parse(b.settings),a.alertListType=a.options.alertListType,x=a.options.dataSource,a.options.toolbarState=a.options.toolbarState,a.title=a.options.tableTitle):void 0!==window.settings&&null!==window.settings&&""!==window.settings&&(a.options=JSON.parse(window.settings),a.alertListType=a.options.alertListType,x=a.options.dataSource,a.options.toolbarState=a.options.toolbarState,a.title=a.options.tableTitle);"DEFINED_ALERTS_LIST"===a.alertListType?a.listType=!0:"COMPLETED_ALERTS_LIST"===a.alertListType&&
(a.listType=!1);kendo.ui.progress($("#"+b.elementId),!1);a.unpinnedWindow?(window.document.title=a.title,kendo.ui.progress($("body > div.epm-ntw"),!0)):kendo.ui.progress($("#"+a.controllerId),!0);a.isAdjustColumnsWidthToWindowEnabled=!1;var I="",C=0,M=a.isAlertsListReady=!1,x,J=!1;a.rowClassNames=[];void 0!==a.options?(a.options.columnResize=y,"DEFINED_ALERTS_LIST"===a.alertListType?(a.options.rowTemplate=v,a.options.altRowTemplate=v(!0)):"COMPLETED_ALERTS_LIST"===a.alertListType&&(a.options.rowTemplate=
q,a.options.altRowTemplate=q(!0)),a.options.dataBound=u,a.tableGridOptions=a.options):"DEFINED_ALERTS_LIST"===a.alertListType?a.tableGridOptions={resizable:!0,reorderable:!0,scrollable:!0,selectable:"row",rowTemplate:v(),altRowTemplate:v(!0),columnResize:y,dataBound:u,columns:[{field:"walor",title:"{{ 'ALERTS.LIST.SECURITY' | translate }}",width:85},{field:"single",title:"{{ 'ALERTS.LIST.TYPE' | translate }}",width:85},{field:"active",title:"{{ 'ALERTS.LIST.STATE' | translate }}",width:85},{field:"message",
title:"{{ 'ALERTS.LIST.STATEMENT' | translate }}",width:85}]}:"COMPLETED_ALERTS_LIST"===a.alertListType&&(a.tableGridOptions={resizable:!0,reorderable:!0,pageable:{numeric:!1,input:!0,messages:{page:""}},rowTemplate:q(),altRowTemplate:q(!0),columnResize:y,dataBound:u,columns:[{field:"walor",title:"{{ 'ALERTS.LIST.SECURITY' | translate }}",width:100},{field:"time",title:"{{ 'ALERTS.LIST.TIME' | translate }}",width:75},{field:"single",title:"{{ 'ALERTS.LIST.TYPE' | translate }}",width:60},{field:"message",
title:"{{ 'ALERTS.LIST.STATEMENT' | translate }}",width:300}]});a.onSelection=function(b){g(function(){var c=b.sender;a.selectedState=!1;a.selectedData=c.dataItem(c.select())},0)};a.$on("kendoRendered",function(){a.tableGrid.Ha(0);a.unpinnedWindow&&"DEFINED_ALERTS_LIST"===a.alertListType&&a.tableGrid.adjustSize()});a.saveTable=function(b){for(var c=0,d=0;d<a.tableGrid.columns.length;d++)a.tableGrid.columns[d].hidden||(c+=a.tableGrid.columns[d].width);d=a.tableGrid.getOptions();d.tableType=a.alertListType;
d.dataSource=x;d.controllerId=a.controllerId;d.toolbarState=a.saveToolbarState();d.columnSizeSum=c;d.tableTitle=a.title;d.alertListType=a.alertListType;a.unpinnedWindow&&(d.position={x:window.screenX,y:window.screenY},d.width=window.outerWidth,d.height=window.outerHeight);!1!==b&&B.externalSystemFunctions.saveTable(d);return d};a.$on("kendoWidgetCreated",function(b,c){if(c===a.tableGrid){a.unpinnedWindow&&$(window).bind("resize",function(){a.tableGrid.adjustSize()});I=setInterval(function(){a.isAlertsListReady&&
t();!0===M&&g(function(){},0);M=!1},500);a.$on("$destroy",function(){void 0==a.destroyed&&a.closeTable()});void 0===b.currentScope.adjustColumnsWidthToWindow||E||((a.isAdjustColumnsWidthToWindowEnabled||a.unpinnedWindow)&&g(function(){a.adjustColumnsWidthToWindow(0)},0,!1),E=!0);J||(a.tableGrid.controllerId=a.controllerId,void 0!==e&&($("#"+e.id).data("kendoWindow").wrapper.find(".k-i-custom").click(function(a){a.preventDefault()}),a.title=$("#"+e.id).data("kendoWindow").options.title),J=!0,F());
var d=a.tableGrid.element[0].children[1];a.$watch(function(){return d.offsetHeight},function(){})}});void 0!==window.opener&&null!==window.opener&&$(window).bind("beforeunload",function(){a.closeTable()});a.closeTable=function(){"DEFINED_ALERTS_LIST"===a.alertListType?k.Eg(a.controllerId):k.Dg(a.controllerId);B.externalSystemFunctions.ga();a.unpinnedWindow?c.fd(a.controllerId,!0):c.ve(a.controllerId);for(var b=0,d=k.Ob.length;b<d;b++)k.Ob[b].controllerId===a.controllerId&&k.Ob.splice(b,1);try{$("#contextMenu_"+
a.controllerId).data("kendoContextMenu").destroy(),$("#contextMenu_"+a.controllerId).remove(),void 0!==a&&(a.destroyed=!0,a.$destroy())}catch(e){}clearInterval(I)};a.getRows=function(){return a.alertsDataSource.data()};a.alertsListContextMenu=epmNtw.jg(a.controllerId);a.newAlert=function(){k.openNewAlertWindow()};a.editAlert=function(a,b){B.ea().uc(a,b)};a.deleteAlert=function(b){k.deleteAlert(b);a.selectedState=!0};a.alertStateChange=function(b,c){try{k.alertStateChange(b,c),a.selectedState=!0}catch(d){if("TOO_MANY_ALERTS"===
d)p.ha("ERROR","TOO_MANY_ALERTS","300","77");else throw d;}};a.unpinnedWindow&&angular.element(document).ready(function(){self.Xb=parseInt(location.search.split("epmNtwWindowId=")[1],10);c.Zc(self.Xb);B.externalSystemFunctions.ga&&B.externalSystemFunctions.ga()});a.isNewAlertFromMenuAvailable=function(){return k.isNewAlertFromMenuAvailable()};a.isEditAlertAvailable=function(){return k.isEditAlertAvailable()}};epmNtw.zd.$inject="windowModel epmNtw.quotesTableService epmNtw.windowsService $rootScope $scope $windowInstance $kWindow $translate $timeout epmNtw.alertsService $filter epmNtw.messageDialogService".split(" ");
angular.module("epmNtw.alerts-list").controller("epmNtw.alertsListController",epmNtw.zd);epmNtw.Ad=function(b){return{restrict:"E",templateUrl:epmNtw.Ia+"alerts/modules/alerts-list/alerts-list.view.html",link:function(d,c){kendo.ui.progress(c,!0);var f={};f.$scope=d;f.$windowInstance=void 0;f.windowModel=null!==window.windowModel&&void 0!==window.windowModel&&window.windowModel.isUnpinned?window.windowModel:d.windowModel;b("epmNtw.alertsListController",f);c.on("contextmenu",function(){return!1})}}};epmNtw.Ad.$inject=["$controller","$compile"];
angular.module("epmNtw.alerts-list").directive("epmNtwAlertsListDirective",epmNtw.Ad);
