/**
 * @license RequireJS text 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! $Id: modal-region.js 247450 2013-04-22 13:05:40Z kkwiatkowski $ */

/*! $Id: layout.js 289082 2013-12-11 08:15:45Z EBRE\ZEW_2_6434 $ */

/*! $Id: submenu-item.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: submenu.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-transfer-prepare-service.js 256618 2013-06-14 08:11:56Z EBRE\zew_2_7123 $ */

/*! $Id: nmb-transfer-submit-service.js 257267 2013-06-19 10:56:29Z EBRE\zew_2_7123 $ */

/*! $Id: nmb-transfer-finalize-service.js 257267 2013-06-19 10:56:29Z EBRE\zew_2_7123 $ */

/*! $Id: nmb-transfer-cancel-p2p.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-date-check-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: transfer-wizard.js 289897 2013-12-16 15:16:30Z EBRE\ZEW_2_3247 $ */

/*! $Id: service.js 296625 2014-02-13 12:37:55Z EBRE\ZEW_2_6434 $ */

/*! $Id: dashboard-empty.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: app.js 294180 2014-01-27 16:12:49Z EBRE/ZEW_2_6718 $ */

/*! $Id: controller.js 254749 2013-06-04 12:18:48Z EBRE\zew_2_5643 $ */

/*! $Id: router.js 260512 2013-07-12 08:04:02Z EBRE\zew_2_3247 $ */

/*! $Id: dashboard.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: dashboard-group-item.js 289082 2013-12-11 08:15:45Z EBRE\ZEW_2_6434 $ */

/*! $Id: dashboard-group.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: dashboard-menu.js 254749 2013-06-04 12:18:48Z EBRE\zew_2_5643 $ */

/*! $Id: dashboard-layout.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: formTypeChange.js 274665 2013-10-07 11:12:31Z EBRE\zew_2_6718 $ */

/*! $Id: formTypeChange.js 254749 2013-06-04 12:18:48Z EBRE\zew_2_5643 $ */

/*! $Id: transfer-step2.js 294180 2014-01-27 16:12:49Z EBRE\ZEW_2_6718 $ */

/*! $Id: transfer-recipient-search.js 255826 2013-06-10 11:45:22Z EBRE\zew_2_4687 $ */

/*! $Id: livesearch-phone-charging.js 260512 2013-07-12 08:04:02Z EBRE\zew_2_3247 $ */

/*! $Id: transfer-sidebar-menu.js 260512 2013-07-12 08:04:02Z EBRE\zew_2_3247 $ */

/*! $Id$ */

/*! $Id: transfer-layout.js 273927 2013-10-03 11:33:15Z EBRE\zew_2_6718 $ */

/*! $Id: transfer-summary.js 283152 2013-11-15 08:22:33Z EBRE\zew_2_6718 $ */

/*! $Id: nmb-account-validate-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-account-coowners-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-account-check-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: _generic.js 296129 2014-02-10 12:24:09Z EBRE\ZEW_2_6718 $ */

/*! $Id: bank_info.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: country.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: countries.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: bank.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: banks.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: branch.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: branches.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-transfer-abroad-check-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: abroad.js 292851 2014-01-16 14:49:31Z EBRE\ZEW_2_3247 $ */

/*! $Id: facebook-schema.js 254749 2013-06-04 12:18:48Z EBRE\zew_2_5643 $ */

/*! $Id: mobile.js 255490 2013-06-06 16:00:23Z EBRE\zew_2_7123 $ */

/*! $Id: nmb-transfer-domestic-check-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: nmb-refresh-accounts-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: domestic.js 293724 2014-01-23 11:18:05Z EBRE\ZEW_2_6434 $ */

/*! $Id: domestic.js 257225 2013-06-19 08:02:00Z EBRE\zew_2_3247 $ */

/*! $Id: facebook-schema.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: facebook.js 266453 2013-08-22 13:44:05Z pmichalczyk $ */

/*! $Id: nmb-transfer-p2p-check-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: facebook_cz.js 255490 2013-06-06 16:00:23Z EBRE\zew_2_7123 $ */

/*! $Id: mobile-schema.js 254749 2013-06-04 12:18:48Z EBRE\zew_2_5643 $ */

/*! $Id: mobile.js 266453 2013-08-22 13:44:05Z pmichalczyk $ */

/*! $Id: nmb-transfer-cost-service.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: own.js 293724 2014-01-23 11:18:05Z EBRE\ZEW_2_6434 $ */

/*! $Id: us_symbols.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: us_city.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: us_cities.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: us_name.js 241181 2013-03-27 09:54:39Z kkwiatkowski $ */

/*! $Id: us_names.js 243335 2013-04-04 11:26:33Z EBRE\zew_2_2757 $ */

/*! $Id: us.js 288154 2013-12-06 15:45:27Z EBRE\ZEW_2_6718 $ */

/*! $Id: zus.js 284746 2013-11-22 11:19:48Z EBRE\zew_2_6718 $ */

/*! $Id: nmb-phone-charge-check.js 241181 2013-06-11 09:54:39Z pwujczyk $ */

/*! $Id: phone.js 295812 2014-02-07 10:46:50Z EBRE\ZEW_2_6434 $ */

define("text",["module"],function(e){"use strict";var t,a,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o="undefined"!=typeof location&&location.href,s=o&&location.protocol&&location.protocol.replace(/\:/,""),l=o&&location.hostname,d=o&&(location.port||void 0),c=[],u=e.config();return t={version:"2.0.0",strip:function(e){if(e){e=e.replace(n,"");var t=e.match(i);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var e,t,a;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t++){a=r[t];try{e=new ActiveXObject(a)}catch(e){}if(e){r=[a];break}}return e},parseName:function(e){var t=!1,a=e.indexOf("."),r=e.substring(0,a),n=e.substring(a+1,e.length);return a=n.indexOf("!"),a!==-1&&(t=n.substring(a+1,n.length),t="strip"===t,n=n.substring(0,a)),{moduleName:r,ext:n,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,a,r,n){var i,o,s,l=t.xdRegExp.exec(e);return!l||(i=l[2],o=l[3],o=o.split(":"),s=o[1],o=o[0],!(i&&i!==a||o&&o!==r||(s||o)&&s!==n))},finishLoad:function(e,a,r,n){r=a?t.strip(r):r,u.isBuild&&(c[e]=r),n(r)},load:function(e,a,r,n){if(n.isBuild&&!n.inlineText)return void r();u.isBuild=n.isBuild;var i=t.parseName(e),c=i.moduleName+"."+i.ext,m=a.toUrl(c),p=u.useXhr||t.useXhr;!o||p(m,s,l,d)?t.get(m,function(a){t.finishLoad(e,i.strip,a,r)},function(e){r.error&&r.error(e)}):a([c],function(e){t.finishLoad(i.moduleName+"."+i.ext,i.strip,e,r)})},write:function(e,a,r,n){if(c.hasOwnProperty(a)){var i=t.jsEscape(c[a]);r.asModule(e+"!"+a,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,a,r,n,i){var o=t.parseName(a),s=o.moduleName+"."+o.ext,l=r.toUrl(o.moduleName+"."+o.ext)+".js";t.load(s,r,function(a){var r=function(e){return n(l,e)};r.asModule=function(e,t){return n.asModule(e,l,t)},t.write(e,s,r,i)},i)}},"undefined"!=typeof process&&process.versions&&process.versions.node?(a=require.nodeRequire("fs"),t.get=function(e,t){var r=a.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}):t.createXhr()?t.get=function(e,a,r){var n=t.createXhr();n.open("GET",e,!0),u.onXhr&&u.onXhr(n,e),n.onreadystatechange=function(t){var i,o;4===n.readyState&&(i=n.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=n,r(o)):a(n.responseText))},n.send(null)}:"undefined"!=typeof Packages&&(t.get=function(e,t){var a,r,n="utf-8",i=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(i),n)),l="";try{for(a=new java.lang.StringBuffer,r=s.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),a.append(r);null!==(r=s.readLine());)a.append(o),a.append(r);l=String(a.toString())}finally{s.close()}t(l)}),t}),define("text!transfer/templates/app/layout.html",[],function(){return'{% // $Id: layout.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n<div class="notify-region" aria-relevant="additions" aria-live="assertive"></div>\r\n<div style="position:relative;">\r\n    <div class="submenu-region"></div>\r\n    <h1 class="accessible-not-visible">{{ i18n(\'transfer.submenu.singleAccessibilityLabel\') }}</h1>\r\n    <div class="sliding-region"></div>\r\n</div>\r\n<div class="dialog-region"></div>'}),define("transfer/js/views/app/modal-region",[],function(){var e=Backbone.Marionette.Region.extend({open:function(e){var t=this.$el.html(e.el);this.dialog=t.dialog({autoOpen:!0,width:428,modal:!0,resizable:!1,closeOnEscape:!1})},close:function(){var e=this.currentView;e&&(this.dialog.dialog("close"),e.close&&e.close(),this.trigger("view:closed",e),delete this.currentView)}});return e}),define("transfer/js/views/app/layout",["text!../../../templates/app/layout.html","./modal-region"],function(e,t){var a=Backbone.Marionette.Layout.extend({template:e,className:"container",attributes:{id:"transfer-app-view"},regions:{notify:".notify-region",menu:".submenu-region",main:{selector:".sliding-region",regionType:Backbone.nmb.SlidingRegion},modal:{selector:".dialog-region",regionType:t}},events:{"mouseenter .hoverable":"highlightOn","mouseleave .hoverable":"highlightOff"},highlightOn:function(e){$(e.currentTarget).addClass("hover")},highlightOff:function(e){$(e.currentTarget).removeClass("hover")}});return a}),define("text!transfer/templates/submenu.html",[],function(){return'{% // $Id: submenu.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n\r\n<div class="section-nav">\r\n    <ul class="nav-horizontal third-level"></ul>\r\n</div>\r\n\r\n<div class="section-nav section-static" style="display:none;">\r\n    <ul class="nav-horizontal third-level">\r\n        <li class="active">\r\n            <a href="#/transfer">\r\n                <span class="text"></span>\r\n                <span class="extender"></span>\r\n            </a>\r\n        </li>\r\n    </ul>\r\n</div>\r\n\r\n<span class="underline-decoration">\r\n    <span class="hover"></span>\r\n</span>'}),define("text!transfer/templates/submenu-item.html",[],function(){return'{% // $Id: submenu-item.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n\r\n<a href="{{ link }}" data-gemius-event-type="action" data-gemius-event-action-id="{{ gemiusId }}" data-gemius-event-action-name="{{ gemiusName }}">\r\n    <span class="text">{{ i18n(text) }}</span>\r\n    <span class="extender">{{ i18n(text) }}</span>\r\n    <i class="dropdown-trigger icon-big-red-chevron-small-down"></i>\r\n</a>\r\n\r\n'}),define("transfer/js/views/submenu-item",["text!../../templates/submenu-item.html"],function(e){var t=Backbone.Marionette.ItemView.extend({template:e,tagName:"li",className:"sub-item",events:{"click a":"fire"},initialize:function(){this.bindTo(this.model,"selected",this.itemSelected,this)},itemSelected:function(){this.$el.addClass("active").siblings().removeClass("active")},fire:function(e){e.preventDefault(),this.model.trigger("fire",this.model.get("triggers"))},onRender:function(){this.model.get("selected")&&this.itemSelected()}});return t}),define("transfer/js/views/submenu",["text!../../templates/submenu.html","./submenu-item","../app"],function(e,t,a){var r=Backbone.Marionette.CompositeView.extend({template:e,itemView:t,collection:new Backbone.Collection([{name:"single",link:"#/transfer",gemiusId:"190001",gemiusName:"transfer.single",triggers:"show:dashboard",text:"transfer.submenu.single",selected:!0},{name:"cyclic",gemiusId:"195001",gemiusName:"transfer.periodic",link:"#/periodicpayments",triggers:"show:payments-periodic",text:"transfer.submenu.cyclic"},{name:"cyclicList",gemiusId:"199001",gemiusName:"transfer.periodic.transfer-list",link:"#/periodicpayments/list",triggers:"show:payments-periodic-list",text:"transfer.submenu.cyclicList"}]),tagName:"div",className:"section-header normal-view",attributes:{id:"transfer-app-menu"},events:{},ui:{dynamicMenu:".section-nav:first",staticMenu:".section-nav.section-static"},initialize:function(e){this.app=e.app;var t=this,a=$.grep(t.collection.models,function(e,t){return"escrow"===e.attributes.name});a&&0!==a.length||nmbServices.isEscrowEnabled({success:function(e){e===!0&&t.collection.add({name:"escrow",link:"#/escrow",gemiusId:"260001",gemiusName:"transfer.escrow",triggers:"show:escrow",text:"transfer.submenu.escrow"})}}),this.bindTo(this.app,"all",this.changeTitle,this),this.bindTo(this.collection,"fire",this.fireOnApp,this)},showTitle:function(e){this.ui.dynamicMenu.hide(),this.ui.staticMenu.find("span").text(e.title),this.ui.staticMenu.show(),this.underlineActiveItem(this.ui.staticMenu.find("li"))},changeTitle:function(e){"transfer:authStep"==e?(this.ui.dynamicMenu.hide(),this.ui.staticMenu.find("span").text(I18n.t("transfer.confirmation")),this.ui.staticMenu.show(),this.ui.staticMenu.off("click").click(function(e){thisView.app.trigger("show:dashboard"),e.preventDefault()}),this.underlineActiveItem(this.ui.staticMenu.find("li"))):(this.ui.dynamicMenu.show(),this.ui.staticMenu.hide(),this.underlineActiveItem())},fireOnApp:function(e){_.isEmpty(e)||this.app.trigger(e),Ebre.Wizard.trigger("wizard:hide")},onRender:function(){var e=this;setTimeout(function(){e.underlineActiveItem()},300)},underlineActiveItem:function(e){var t=e||this.$("li.active");t.length&&this.$(".underline-decoration > .hover").stop().animate({width:t.width(),left:t.position().left+parseInt(t.css("margin-left"),10)},800)},appendHtml:function(e,t){e.$(".section-nav:first .nav-horizontal").append(t.el)}});return r}),define("transfer/js/models/nmb-transfer-prepare-service",[],function(){function e(e){var a=e.own||!1,r=a&&"domestic"===e.transferType?"own":e.transferType;return"PrepareTransfer"+t[r]}var t={base:"Base",domestic:"Domestic",abroad:"Abroad",zus:"ZUS",onezus:"ONEZUS",us:"US",mobile:"Phone",phone:"PhoneCharge",facebook:"Facebook",own:"Self",performed:"Performed",voip:"PhoneCharge",splitdomestic:"Split",splitown:"SplitSelf",splitted:"Split"},a=Backbone.Model.extend({sync:function(t,a,r){var n;if("read"===t){n=e(r);try{nmbServices[n].call(null,r)}catch(e){if("Aborted operation."!==e)throw e;r.error()}}}});return a}),define("transfer/js/models/nmb-transfer-submit-service",[],function(){function e(e){return"IntermediateSubmitTransfer"+t[e]}var t={domestic:"Domestic",abroad:"Abroad",zus:"Zus",onezus:"OneZus",us:"Us",mobile:"Phone",phone:"PhoneCharge",own:"Self",facebook:"Facebook",voip:"PhoneCharge",splitdomestic:"Split",splitown:"SplitSelf",splitted:"Split"},a=Backbone.Model.extend({sync:function(t,a,r){var n;"read"===t&&(n=e(r.formData.formType),nmbServices[n].call(null,r))}});return a}),define("transfer/js/models/nmb-transfer-finalize-service",[],function(){function e(e){return"FinalSubmitTransfer"+t[e]}var t={domestic:"Domestic",abroad:"Abroad",zus:"Zus",onezus:"OneZus",us:"Us",mobile:"Phone",phone:"PhoneCharge",own:"Self",facebook:"Facebook",voip:"PhoneCharge",splitdomestic:"Split",splitown:"SplitSelf",splitted:"Split"},a=Backbone.Model.extend({sync:function(t,a,r){var n;"read"===t&&(n=e(r.formType),nmbServices[n].call(null,r))}});return a}),define("transfer/js/models/nmb-transfer-cancel-p2p",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.CancelTransferFacebook.call(null,a)}});return e}),define("transfer/js/models/nmb-transfer-check-falter",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.CheckFalter(a)}});return e}),define("transfer/js/models/nmb-date-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.isTodaysDate(a)}});return e}),define("transfer/js/models/nmb-transfer-split-switched-sidebar-data-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.GetSplitSwitchedSidebarData(a)}});return e}),define("transfer/js/models/transfer-wizard",["./nmb-transfer-prepare-service","./nmb-transfer-submit-service","./nmb-transfer-finalize-service","./nmb-transfer-cancel-p2p","./nmb-transfer-check-falter","./nmb-date-check-service","./nmb-transfer-split-switched-sidebar-data-service"],function(e,t,a,r,n,o,s){var l="",d={},c=Backbone.Model.extend({getDefaultForm:function(e,t){var a=new $.Deferred,r=this.getStaticDefaultForm(e,t);if(!t.isFacebookEnabled){var n=r.sidebarData.templateTypes.map(function(e){return e.type}).indexOf("facebook");n!=-1&&r.sidebarData.templateTypes.splice(n,1)}return(Ebre.Entity.isPL()||Ebre.Entity.isOF())&&Ebre.Venezia.ProfileContext.IsFirm?this.getDefaultSidebarData().then(function(e){if(e=e.toJSON(),e&&e.switchedSidebarTemplates)for(i=0;i<e.switchedSidebarTemplates.length;i++){var t=e.switchedSidebarTemplates[i];t.template&&t.template.disabled===!1&&r.sidebarData.templateTypes.splice(t.index,0,t.template)}a.resolve(r)}):a.resolve(r),a.promise()},getStaticDefaultForm:function(t,a){var r=this;r.clear(),r.set(r.defaults);var n=(new $.Deferred,new e,{formData:{title:I18n.t("transfer.domestic.defaultTitle"),transferModes:{elixir:{name:"elixir",doneTime:I18n.t("transfer.domestic.elixir.doneTime"),label:I18n.t("transfer.domestic.elixir.label"),commissionsAndFees:null},express:{name:"express",doneTime:I18n.t("transfer.domestic.express.doneTime"),label:I18n.t("transfer.domestic.express.label"),commissionsAndFees:null},sorbnet:{name:"sorbnet",doneTime:I18n.t("transfer.domestic.sorbnet.doneTime"),label:I18n.t("transfer.domestic.sorbnet.label"),commissionsAndFees:null}},defaultData:{additionalOptions:{changeAccountFee:null},availableCurrency:["PLN"],currentDateMockingEnabled:!1,availableFromAccounts:[{balance:0,coowners:[{}],currency:"",displayName:I18n.t("transfer.domestic.accountSourceNumber"),number:"not_defined"}],dateNow:"2013-05-17T00:00:00.000",calendar:{maxDate:new Date,minDate:new Date},deliveryTime:["elixir"]},canAddToBasket:!0,incomeSourceDict:[],paymentPurposeDict:[],sepaReceiverCountries:[]},sidebarData:{activeTemplateId:null,templateTypes:[{blankLabel:"new.domestic",disabled:!1,templatesSidebar:[],type:"domestic",action:null,controller:null,contactId:null,amountLimit:null}],sourceCategory:"domestic",receiverName:null},formType:"domestic",defaultData:!0});return Ebre.Entity.isSK()||n.sidebarData.templateTypes.push({blankLabel:"new.abroad",disabled:!1,templatesSidebar:[],type:"abroad",action:null,controller:null,contactId:null,amountLimit:null}),Ebre.Entity.isCZ()&&(delete n.formData.transferModes.express,delete n.formData.transferModes.sorbnet),"undefined"!=typeof a.contactMode&&"TM"==a.contactMode||n.sidebarData.templateTypes.push({blankLabel:"new.facebook",disabled:!1,templatesSidebar:[],type:"facebook",action:null,controller:null,contactId:null,amountLimit:null}),n.sidebarData.templateTypes.push({blankLabel:"new.mobile",disabled:!1,templatesSidebar:[],type:"mobile",action:null,controller:null,contactId:null,amountLimit:null}),n.formData=_.extend(n.formData,n.formData.defaultData),r.set("formLoaded",new Backbone.Model(n)),n},getForm:function(t,a){var r=this,n=r&&r.get("formLoaded")&&r.get("formLoaded").get("sidebarData");n&&(delete n.activeTemplateId,delete n.sourceCategory,d.safePrevSideBarData=n),r.clear(),r.set(r.defaults),r.deferred=new $.Deferred;var i=new e;return i.fetch(_.extend({},t,{success:function(){if("resolved"!==r.deferred.state()){var e=i.toJSON(t);if(e.sidebarData&&e.sidebarData.templateTypes.length||(!n&&d.safePrevSideBarData&&(n=d.safePrevSideBarData),e.sidebarData=n,e.sidebarData.sourceCategory=e.formData.formType,e.sidebarData.activeTemplateId=e.formData.templateId),e.formData=_.extend(e.formData,e.formData.defaultData),t.recipientName&&!e.formData.recipientName&&(l=t.recipientName,e.formData.recipientId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId,e.formData.recipientName=t.recipientName,_.each(e.sidebarData.templateTypes,function(e,t){e.contactId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId}),e.formData.recipientId==Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId&&(e.formData.recipientName=l)),"performed"!==t.transferType||e.formData.recipientId||(e.formData.recipientId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId),("performed"===t.transferType||e.formData.wasPerformed)&&(e.formData.performed=!0),e.formData.recipientId||e.formData.isFromBasket!==!0||(e.formData.recipientId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId),t.defaultFormData&&("domestic"===e.formType||"phone"===e.formType)){var a;e.formData.availableFromAccounts.length&&(a=_.find(e.formData.availableFromAccounts,function(e){return e.number===t.defaultFormData.fromAccount})),"undefined"!=typeof a&&(e.formData=_.extend(e.formData,t.defaultFormData))}"mobile"===e.formType&&e.formData.templateId&&e.formData.templateId.length>6&&(e.formData.isDefined=!0),"domestic"===e.formType&&Ebre.Entity.isCZSK()&&(e.formData.symbols={VS:e.formData.VS,SS:e.formData.SS,KS:e.formData.KS}),"facebook"==e.formType&&e.formData.defaultData.isDefined&&(e.formData.addToAddressBook=!1),r.set("formLoaded",new Backbone.Model(e)),r.deferred.resolve(e)}},error:function(e,t){switch(t.code){case"paym_NotEnoughIndividualAccounts":Ebre.Common.createMessage("",I18n.t("transfer.selfTransferDisabled_onlyOneCurrentAccount")),a.trigger("transfer:new",{transferType:"base",selfTransferMode:!0});break;case"paym_OneAccountInCurrentContext":Ebre.Common.createMessage("",I18n.t("transfer.selfTransferDisabled_onlyOneAccountInCurrentContext")),a.trigger("transfer:new",{transferType:"base",selfTransferMode:!0});break;default:r.deferred.reject($.parseJSON(t.responseText))}}})),r.deferred.promise()},getPopulatedModel:function(){var e=this.get("formLoaded").toJSON();"undefined"!=typeof this.get("formData")&&JSON.stringify(e.formData.deliveryTimeUpdate)!==JSON.stringify(this.get("formData").deliveryTimeUpdate)&&(e.formData.deliveryTimeUpdate=null);var t=$.extend(e.formData,this.get("formData"));return e.formData.transferModes=t.deliveryTimeUpdate||e.formData.transferModes,"domestic"===e.formData.formType&&Ebre.Entity.isCZSK()&&(e.formData.symbols={VS:e.formData.VS,SS:e.formData.SS,KS:e.formData.KS}),new Backbone.Model(e)},updatePopulatedModel:function(e,t){if("undefined"!=typeof this.get("formLoaded")){var a=this.get("formLoaded").toJSON();a.formData[e]=t,this.set("formLoaded",new Backbone.Model(a))}},getDefaultSidebarData:function(){var e=new $.Deferred,t=new s;return t.fetch({success:function(t){e.resolve(t)},fail:function(t){e.resolve()}}),e.promise()},shouldICheckFalter:function(e){var t=new $.Deferred,a=Ebre.Entity.isPL()||Ebre.Entity.isOF(),r="elixir"===e.deliveryTime||"express"===e.deliveryTime||"sorbnet"===e.deliveryTime;if(a&&r){var n=new o;n.fetch({date:e.date,success:function(a){a.toJSON().isTodaysDate?t.resolve(e):t.reject()}})}else t.reject();return t.promise()},checkFalter:function(e){var t=this,a=this.get("formLoaded").toJSON(),r=new $.Deferred;return this.shouldICheckFalter(e).done(function(){var i=new n;i.fetch({loaderParent:$(".form-view"),formData:e,recipientId:a.recipientId,templateId:a.templateId,success:function(){var a=i.toJSON();t.set("falterData",new Backbone.Model({formData:e,falter:a})),r.resolve(a)},error:r.reject})}).fail(r.reject),r.promise()},intermediateSubmit:function(e){var a=this,r=this.get("formLoaded").toJSON(),n=new $.Deferred,o=new t,s=r.formData.availableFromAccounts.length;if("abroad"==r.formType){var l=$("#transfer-app-root").find('input[name="toAccount"]').prev().text();l&&(e.toAccount=l+" "+e.toAccount),$("#recipients-livesearch-query").val()&&(e.recipientName=$("#recipients-livesearch-query").val())}for("domestic"==r.formType&&Ebre.Entity.isCZSK()&&(e.KS=e.symbols.KS,e.SS=e.symbols.SS,e.VS=e.symbols.VS,delete e.symbols),a.set("formData",e),i=0;i<s;i++)if(r.formData.availableFromAccounts[i].number==e.fromAccount){e.accountParams=r.formData.availableFromAccounts[i].accountParams;break}e.formType=r.formType,e.perfToken=r.formData.perfToken,e=this.convertAmounts(e),"own"!=e.formType&&"domestic"!=e.formType||!e.currencies||(e.currency=e.currency==e.currencies?e.currency:e.currencies);var d="domestic"==e.formType||"splitdomestic"==e.formType;return"undefined"!=typeof e.deliveryTime&&e.deliveryTimeUpdate&&d&&(e.dtmsg=e.deliveryTimeUpdate[e.deliveryTime]&&null!==e.deliveryTimeUpdate[e.deliveryTime].doneTime?e.deliveryTimeUpdate[e.deliveryTime].doneTime:r.formData.transferModes[e.deliveryTime].doneTime,e.priceStr=e.deliveryTimeUpdate[e.deliveryTime]?e.deliveryTimeUpdate[e.deliveryTime].priceStr:""),e.showRepeatFromBasketWarning=r.formData.showRepeatFromBasketWarning,o.fetch({loaderParent:$(".form-view"),formData:e,recipientId:r.formData.recipientId,templateId:r.formData.templateId,success:function(){var e=o.toJSON();a.set("formIntermediate",new Backbone.Model(e)),n.resolve(e)},error:n.reject}),n.promise()},finalSubmit:function(e,t){var r=this,n=new $.Deferred,i=new a({authMode:e}),o=r.get("formIntermediate"),s=o.get("templateId");return i.fetch(_.extend({},r.get("formData"),t||{},{loaderParent:$(".form-view"),templateId:s,success:function(){var e=i.toJSON();r.refreshAds(),r.set("summaryData",new Backbone.Model(e)),n.resolve(e)},error:n.reject})),n.promise()},transferFacebookCancel:function(e){var t=new $.Deferred,a=new r;return a.fetch(_.extend({},e,{success:function(){var e=a.toJSON();t.resolve(e)},error:t.reject})),t.promise()},finalSubmitWithoutAuth:function(e){return this.finalSubmit("none",e)},finalSubmitWithSMSAuth:function(e){return this.finalSubmit("sms",e)},finalSubmitWithTANAuth:function(e){return this.finalSubmit("tan",e)},refreshAds:function(){void 0!==Ebre.Venezia.Adv&&require([Ebre.Venezia.Adv.Urls.ScriptUrls.Registry,Ebre.Venezia.Adv.Urls.ScriptUrls.Poller],function(e,t){t.whirlwindPoll(e.RefreshAction.Refresh)})},convertAmounts:function(e){return"onezus"===e.formType?e.amount=e.totalWrapper.total.replace(/\s/g,""):"splitdomestic"==e.formType?(e.amount.grossAmount.value=e.amount.grossAmount.replace(/\s/g,""),e.amount.vatAmount.value=e.amount.vatAmount.replace(/\s/g,"")):"splitown"==e.formType?e.amount.vatAmount.value=e.amount.vatAmount.replace(/\s/g,""):"zus"!=e.formType&&"abroad"!=e.formType?e.amount=e.amount.replace(/\s/g,""):"abroad"==e.formType?e.amount.value=e.amount.value.replace(/\s/g,""):_.each(e.selectZus,function(e){e.checkbox&&(e.content=e.content.replace(/\s/g,""))}),e},fetchFbIdFromSidebarData:function(){var e=null,t=this.get("formLoaded").get("sidebarData").templateTypes;if(t){var a=_.find(t,function(e){return"new.facebook"==e.blankLabel})||{};a.hasOwnProperty("templatesSidebar")&&null!=a.templatesSidebar&&a.templatesSidebar.length>0&&(a=a.templatesSidebar,e=a[0].p2pTemplateId)}return e},getPaymentPurposeName:function(e){var t=this.get("formLoaded").get("formData").paymentPurposeDict,a=null;return"undefined"!=typeof t&&t.length&&(a=_.find(t,function(t){return t.id==e})),a?a.name:null},getIncomeSourceName:function(e){var t=this.get("formLoaded").get("formData").incomeSourceDict,a=null;return"undefined"!=typeof t&&t.length&&(a=_.find(t,function(t){return t.id==e})),a?a.name:null}});return new c}),nmbServices=nmbServices||{},function(){var e={bankInfo:{blackList:[]}};_.extend(nmbServices,{updateTaxAuthority:function(e,t){var a=e.formData&&e.formData.taxAuthority&&e.formData.tasksCenterData;if(a&&!e.formData.taxAuthority.authoritySymbol.toAnother&&t.summaryData){var r=/^.*(?=,)/i,n=r.exec(t.summaryData.recipientName);1==n.length&&(e.formData.taxAuthority.authorityName.label=n[0])}},invalidateLSData:function(e){Ebre.Modules.Payments.Transfer&&(e.addToAddressBook||e.additionalOptions&&e.additionalOptions.addReceiver&&e.additionalOptions.addReceiver.addToAddressBook)&&(Ebre.Modules.Payments.Transfer.LiveSearchData&&Ebre.Modules.Payments.Transfer.LiveSearchData.invalidateSectionsCollection("addressBookItemsList"),Ebre.Modules.Payments.Transfer.LiveSearchPhoneData&&Ebre.Modules.Payments.Transfer.LiveSearchPhoneData.invalidateSectionsCollection("addressBookItemsList"))},checkLoaderParent:function(e){var t=null;if(e){var a=!0;a&&(t=e.loaderParent||null),e.loaderParent=null}return t},getCoowners:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonServices.GetCoownersUrl,data:JSON.stringify({accountNumber:e.accountNo,accountParams:e.accountParams,getAccountCoowner:e.getAccountCoowner}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},GoToAddressbook:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.GoToAddressbook,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},AddNewContact:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.AddNewContact,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},OwnCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SelfService.OwnCheckUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),data:JSON.stringify({data:e.data||null,accountParams:e.accountParams}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},SplitSelfCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitSelfService.DataCheckUrl,data:JSON.stringify({data:e.data||null,accountParams:e.accountParams}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},RefreshAvailableFromAccounts:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonServices.RefreshAvailableFromAccountsUrl,data:JSON.stringify({isDefined:e.data.isDefined,isSeries:e.data.isSeries,formType:e.data.formType,isRepeatable:e.data.isRepeatable,templateId:e.data.templateId,oldAccount:e.data.oldAccount}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},DomesticCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.DomesticCheckUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8",error:function(e,t){switch(e.code){case"paym_SameAccount":break;case"paym_NoCurrencyTransferFromCreditCard":break;case"paym_InvalidAccountNo":break;case"addr_WrongIbanLenght":break;default:Ebre.Proxy.HandleDefaultError(e,t)}}}).success(function(t){e.success(t)}).fail(function(t){e.fail(t)})},SplitDataCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitService.DataCheckUrl,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8",error:function(e,t){switch(e.code){case"paym_SameAccount":break;case"paym_NoCurrencyTransferFromCreditCard":break;case"paym_InvalidAccountNo":break;case"addr_WrongIbanLenght":break;default:Ebre.Proxy.HandleDefaultError(e,t)}}}).success(function(t){e.success(t)}).fail(function(t){e.fail(t)})},P2PCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.MobileService.P2PCheckServiceUrlCZSK,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8",error:function(e,t){}}).success(function(t){e.success(t)}).fail(function(t){e.fail(t)})},NavigateToDirectDebit:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.NavigateToDirectDebitUrl,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},UsCheckService:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.UsCheckServiceUrl,data:JSON.stringify({accNo:e.accNo||null,otherTaxAuth:e.otherTaxAuth||null}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},GetSplitSwitchedSidebarData:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitService.SplitSwitchedSidebarDataUrl,data:JSON.stringify({data:e.data||null}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},PrepareTransferDomestic:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.TransferFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId||null,templateId:"undefined"==typeof e.definedTemplateId||"undefined"==e.definedTemplateId||"null"==e.definedTemplateId?null:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar,selfTransferMode:e.selfTransferMode}),contentType:"application/json;charset=utf-8",error:function(e,t){}}).done(e.success).fail(e.error)},PrepareTransferSplit:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitService.TransferFormUrl,unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId||null,templateId:"undefined"==typeof e.definedTemplateId||"undefined"==e.definedTemplateId||"null"==e.definedTemplateId?null:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar,selfTransferMode:e.selfTransferMode}),contentType:"application/json;charset=utf-8",error:function(e,t){}}).done(e.success).fail(e.error)},PrepareTransferSplitSelf:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitSelfService.TransferFormUrl,unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId||null,templateId:"undefined"==typeof e.definedTemplateId||"undefined"==e.definedTemplateId||"null"==e.definedTemplateId?null:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar,selfTransferMode:e.selfTransferMode}),contentType:"application/json;charset=utf-8",error:function(e,t){}}).done(e.success).fail(e.error)},PrepareTransferBase:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonServices.BaseTransfer,unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId||null,templateId:"undefined"==typeof e.definedTemplateId||"undefined"==e.definedTemplateId||"null"==e.definedTemplateId?null:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar,selfTransferMode:e.selfTransferMode}),contentType:"application/json;charset=utf-8",error:function(e,t){}}).done(e.success).fail(e.error)},AccountChanged:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonService.AccountChangedUrl,data:JSON.stringify({accNo:e.accountNo||null}),contentType:"application/json;charset=utf-8"}).success(function(t){e.success(t)})},CheckFalter:function(e){e.formData.toAccount=e.formData.toAccount.replace(/\s/g,"");var t={toAccount:e.formData.toAccount,recipientName:e.formData.recipientName,amount:e.formData.amount,title:e.formData.title,isSeriesOfTransfers:e.formData.isSeriesOfTransfers,isRepeatableTransfer:e.formData.isRepeatableTransfer};Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.CheckFalterUrl,unique:"firstWins",data:JSON.stringify(_.extend({recipientId:e.recipientId,templateId:e.templateId},{data:t})),error:function(e,t){},contentType:"application/json;charset=utf-8"}).success(e.success).fail(function(){e.error()})},IntermediateSubmitTransferDomestic:function(e){e.formData.toAccount=e.formData.toAccount.replace(/\s/g,""),"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes),Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.IntermediateSubmitUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferSplit:function(e){e.formData.toAccount=e.formData.toAccount.replace(/\s/g,""),"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes),
Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitService.IntermediateSubmitUrl,unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferSplitSelf:function(e){e.formData.toAccount=e.formData.toAccount.replace(/\s/g,""),Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitSelfService.IntermediateSubmitUrl,unique:"firstWins",data:JSON.stringify({formData:e.formData}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferFacebook:function(e){"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes);var t=_.extend({recipientId:e.recipientId,templateId:e.templateId},{formData:e.formData});Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.FacebookService.IntermediateSubmitUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify(t),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferSelf:function(e){"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes),Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SelfService.IntermediateSubmitUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({formData:e.formData,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},GetOneZusStartDate:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.OneZusService.GetOneZusStartDateUrl,unique:"firstWins",contentType:"application/json;charset=utf-8"}).done(function(t){e.done(t)})},PrepareTransferZUS:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.ZusService.TransferFormUrl,unique:"firstWins",data:JSON.stringify({selectDefaultTemplate:e.selectDefaultTemplate,recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},IntermediateSubmitTransferZus:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.ZusService.IntermediateFormUrl,unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},FinalSubmitTransferZus:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.ZusService.FinalFormUrl,unique:"firstWins",data:JSON.stringify({tanCodeValue:e.tanCodeValue,smsCodeValue:e.smsCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e)})},FinalSubmitTransferDomestic:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DomesticService.FinalFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),setTimeout(function(){Ebre.Wizard.trigger("layout:nextStep")},800),nmbServices.invalidateLSData(e)})},FinalSubmitTransferSplit:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitService.FinalFormUrl,unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),setTimeout(function(){Ebre.Wizard.trigger("layout:nextStep")},800),nmbServices.invalidateLSData(e)})},FinalSubmitTransferSplitSelf:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SplitSelfService.FinalFormUrl,unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),setTimeout(function(){Ebre.Wizard.trigger("layout:nextStep")},800),nmbServices.invalidateLSData(e)})},FinalSubmitTransferFacebook:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.FacebookService.FinalFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e),void 0!==Ebre.Venezia.Adv&&require([Ebre.Venezia.Adv.Urls.ScriptUrls.Registry,Ebre.Venezia.Adv.Urls.ScriptUrls.Poller],function(e,t){t.whirlwindPoll(e.RefreshAction.FacebookTransferOrdered)})})},CancelTransferFacebook:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.FacebookService.CancelTransferFacebook,data:JSON.stringify({fullLink:e.fullLink}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},FinalSubmitTransferSelf:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SelfService.FinalFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e)})},PrepareTransferPhone:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.MobileService.TransferFromUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},PrepareTransferPhoneCharge:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PhoneChargeService.TransferFromUrl,unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId,templateId:e.definedTemplateId,recipientName:e.recipientName,fromSidebar:e.fromSidebar,transferType:e.transferType}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},AddToSMSCharkgeCountForPhoneCharge:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PhoneChargeService.AddToSMSChargeCountUrl,data:JSON.stringify({account:e.fromAccount,accountParams:e.accountParams}),error:e.error,contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},PrepareTransferFacebook:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.FacebookService.TransferFromUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId||null,templateId:e.definedTemplateId||null,facebookId:e.facebookId||e.definedTemplateId||null,facebookName:e.facebookName||null,fromSidebar:e.fromSidebar}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},IntermediateSubmitTransferPhone:function(e){e.formData.p2pId||e.formData.templateId||""==e.formData.phoneNumber?e.formData.p2pId=e.formData.templateId:e.formData.p2pId=e.formData.phoneNumber.replace(/\s/g,""),"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes),Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.MobileService.IntermediateSubmitUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:"",templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferPhoneCharge:function(e){var t=_.extend(e.formData,e.formData.addToAddressBookOptions);Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PhoneChargeService.IntermediateSubmitUrl,unique:"firstWins",data:JSON.stringify({formData:t,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},FinalSubmitTransferPhone:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.MobileService.FinalSubmitUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e),void 0!==Ebre.Venezia.Adv&&require([Ebre.Venezia.Adv.Urls.ScriptUrls.Registry,Ebre.Venezia.Adv.Urls.ScriptUrls.Poller],function(e,t){t.whirlwindPoll(e.RefreshAction.MobileTransferOrdered)})})},FinalSubmitTransferPhoneCharge:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PhoneChargeService.FinalSubmitUrl,unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){nmbServices.invalidateLSData(e),e.success(t)})},getDashboardData:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.DashboardService.GetDataUrl,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t.properties)}).fail(function(){e.error()})},PrepareTransferSelf:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.SelfService.TransferFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},PrepareTransferUS:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.TransferFormUrl,unique:"firstWins",dataType:"json",data:JSON.stringify({selectDefaultTemplate:e.selectDefaultTemplate,recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(e.success).fail(e.error)},IntermediateSubmitTransferUs:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.IntermediateFormUrl,unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){nmbServices.updateTaxAuthority(e,t),e.success(t)})},FinalSubmitTransferUs:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.FinalFormUrl,unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e)})},getUsSymbols:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.getUsSymbols,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},getUsCities:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.getUsCities,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},getUs:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.UsService.getUs,dataType:"json",data:JSON.stringify({cityName:e.id.cityId,symbolId:e.id.symbolId}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},getCountries:function(t){e.countries?t.success(e.countries):Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(t),url:Ebre.Modules.Payments.Transfer.AbroadService.GetCountriesListUrl,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8"}).done(function(a){e.countries=a.properties,t.success(a.properties)})},getBanks:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.GetBanksListUrl,dataType:"json",data:JSON.stringify({countryId:e.id}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t.properties)})},getBranches:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.GetBranchesListUrl,dataType:"json",data:JSON.stringify({bankId:e.id}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t.properties)})},getBankBic:function(t){return e.bankInfo.hasOwnProperty(t.id)?t.success(e.bankInfo[t.id]):_.contains(e.bankInfo.blackList,t.id)?void t.fail():void Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(t),url:Ebre.Modules.Payments.Transfer.AbroadService.GetBankDetailsFromBicUrl,dataType:"json",data:JSON.stringify({bicSwiftInput:t.id}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1,error:function(){}}).done(function(a){return a.properties&&"XXXXXXXX"!=a.properties.id?(e.bankInfo[t.id]=a.properties,void t.success(a.properties)):(e.bankInfo.blackList.push(t.id),void t.fail())}).fail(function(a){e.bankInfo.blackList.push(t.id),t.fail($.parseJSON(a.responseText))})},PrepareTransferAbroad:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.TransferFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",dataType:"json",data:JSON.stringify({recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(e.success).fail(e.error)},IntermediateSubmitTransferAbroad:function(e){e.formData.toAccount=e.formData.toAccount.replace(/\s/g,""),"undefined"!=typeof e.formData.pep&&(e.formData.incomeSource=e.formData.pep.incsour,e.formData.paymentPurpose=e.formData.pep.purposes),Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.IntermediateFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},FinalSubmitTransferAbroad:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.FinalFormUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({authCode:e.smsCodeValue?e.smsCodeValue:e.tanCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e)})},getTransferDashboard:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.TransferDashboardUrl,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)}).fail(function(){e.error()})},getAddressbookList:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.GetAddressBookDataUrl,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},getFacebookList:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.GetFacebookList,cache:!1,error:e.error}).done(function(t){e.success(t)})},getLiveSearchDataList:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.RecipientService.GetLiveSearchDataUrl,dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},getAvailableAbroadTransferTypes:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.AbroadService.AvailableAbroadTransferTypes+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),dataType:"json",data:JSON.stringify(e.data),type:"POST",contentType:"application/json;charset=utf-8",cache:!1,error:function(e,t){switch(e.code){case"paym_SameAccount":break;default:Ebre.Proxy.HandleDefaultError(e,t)}}}).done(function(t){e.success(t)}).fail(function(t){e.fail(t)})},checkPhoneChargeNetworkOperator:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PhoneChargeService.CheckPhoneChargeNetworkOperatorUrl,dataType:"json",data:JSON.stringify({phoneNumber:e.data.input}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},ModifyAction:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonServices.ModifyActionUrl,dataType:"json",data:JSON.stringify({}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},AuthorizeLater:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.CommonServices.AuthorizeLaterUrl,dataType:"json",data:JSON.stringify({}),type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(t){e.success(t)})},isTodaysDate:function(e){var t,a,r=new Date;e.date&&(t=e.date.setHours(0,0,0,0)==r.setHours(0,0,0,0),a=e.date.setHours(0,0,0,0)<r.setHours(0,0,0,0)),e.success({isTodaysDate:t,isPastDate:a})},getApplicationsStatusFromFb:function(e){return Ebre.Proxy.VeneziaPostJSON({url:Ebre.Modules.Payments.Transfer.FacebookService.GetApplicationsStatusFromFb,data:"{}",error:function(t,a){e.error()}}).done(function(t){_.isArray(t)?e.success(t):_.isFunction(e.error)&&e.error()})},getFacebookApplicationsIds:function(e){return Ebre.Proxy.VeneziaGetJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.FacebookService.GetFacebookApplicationsIds,data:"{}"}).done(function(t){_.isArray(t)?e.success(t):_.isFunction(e.error)&&e.error()})},PrepareTransferPerformed:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.PerformedService.TransferFromUrl+(Ebre.Entity.isCZ()||Ebre.Entity.isSK()?"CZSK":""),unique:"firstWins",data:JSON.stringify({transferId:e.transferId}),contentType:"application/json;charset=utf-8"}).done(e.success).fail(e.error)},uwRedirect:function(e){Ebre.Proxy.VeneziaGetJSON({url:Ebre.Modules.Payments.Transfer.DomesticService.UWRedirectUrl,loaderParent:e.loaderParent,dataType:"html",data:{area:"",url:e.url+"?wierzyciel="+e.uwId,rurl:e.rurl}}).done(function(t){e.success(t)})},redirectToPeriodicPhoneCharge:function(e){Ebre.Proxy.VeneziaPostJSON({url:Ebre.Modules.Payments.Transfer.PhoneChargeService.RedirectToPeriodicPhoneCharge,loaderParent:nmbServices.checkLoaderParent(e),data:JSON.stringify({phoneNumber:e.phoneNumber,phoneType:e.phoneType,operatorId:e.operatorId,recipientId:e.RecipientId,recipientName:e.RecipientName,fromAccount:e.fromAccount,amount:e.amount,amountSelect:e.amountSelect}),dataType:"json",type:"POST",contentType:"application/json;charset=utf-8",cache:!1}).done(function(e){Ebre.Common.NavigateTo("#periodicpayments/periodicphonecharge")})},getFacebookUserData:function(e){return Ebre.Proxy.VeneziaPostData({url:Ebre.Modules.Payments.Transfer.FacebookService.GetFacebookUserData,data:{id:e.id},context:e.context})},shouldShowFKOMessage:function(e){Ebre.Proxy.VeneziaPostJSON({url:Ebre.Modules.Payments.Transfer.RecipientService.ShouldShowFKOMessage}).success(function(t){e.success(t)})},disableFKOMessage:function(e){Ebre.Proxy.VeneziaPostJSON({url:Ebre.Modules.Payments.Transfer.RecipientService.DisableFKOMessage}).success(function(t){void 0!==e&&e.success()})},isEscrowEnabled:function(e){Ebre.Proxy.VeneziaPostJSON({url:Ebre.Modules.Payments.Transfer.RecipientService.IsEscrowEnabled}).success(function(t){e.success(t)})}})}(),define("transfer/js/services/service",function(){}),define("transfer/js/logic/livesearch-common",[nmbPaths.global.js+"validators/livesearch",nmbPaths.global.js+"validators/trim"],function(e,t){var a={initializedForBackbone:!1,lastSearchValue:"",addressBookMode:!1,tooltipsEnabled:!0,doFocusFirstFormInput:!1,transferAppRootElement:"#transfer-app-root",transferAppViewElement:"#transfer-app-view",transferAppMenuElement:"#transfer-app-menu"};return _.extend(a,{resetValues:function(){this.lastSearchValue="",this.tooltipsEnabled=!0,this.addressBookMode=!1,this.doFocusFirstFormInput=!1,this.initializedForBackbone=!1,this.state="",this.stateMessage="";var e=$("#recipients-livesearch-query").liveSearch("data");e&&(e.keyNavigationMode="CycleOnly")},initializeForBackboneApp:function(e){if(!this.initializedForBackbone){this.initializedForBackbone=!0;var t=this;e.on("show:dashboard show:payments-periodic show:payments-periodic-list",function(){t.resetValues()})}},newTransferLSItemClickWrap:function(e,a,r,n){var i=this;e.on("click",function(e){if(i.hideLiveSearchList(),i.hideTooltips(),i.tooltipsEnabled=!1,r&&r.name)i.lastSearchValue=r.name;else{i.state="",i.stateMessage="",$("#livesearch-validation-message").text(""),i.validateLiveSearch();var o=$("#recipients-livesearch-query").val();t.call({setValue:function(e){o=e,$("#recipients-livesearch-query").val(e),i.lastSearchValue=e,setTimeout(function(){$("#transfer-container").addClass("keep-state"),i.setInfoState(I18n.t("transfer.livesearch.tooltips.trimValidation"))},0)}},o)}n(a)})},findTemplate:function(e,t){var a,r,n=0;return $.each(e,function(e,i){r=i.name.match(t),r&&r.length>n&&(a=i,n=r.length)}),a},validateLiveSearch:_.throttle(function(t){var a=this,r=$("#recipients-livesearch-query").val();a.lastSearchValue=r,e.call({setValue:function(e){r=e,$("#recipients-livesearch-query").val(e),a.lastSearchValue=e,setTimeout(function(){a.setInfoState(I18n.t("transfer.livesearch.tooltips.bluemediaValidation"))},60)}},r,t)},300,{leading:!1}),updateLiveSearchInfoTooltipText:function(e,t,a){e.hasClass("book-red")?(t.find(".text").text(I18n.t("transfer.livesearch.tooltips.allABContacts")),e.find("span.accessability-nohide").text(I18n.t("transfer.livesearch.tooltips.allABContacts"))):(t.find(".text").text(I18n.t("transfer.livesearch.tooltips.sectionContacts")),e.find("span.accessability-nohide").text(I18n.t("transfer.livesearch.tooltips.sectionContacts"))),a&&e.mytooltip("reposition")},hideLiveSearchList:function(){$(this.transferAppRootElement).find(".livesearch-border").removeClass("focus")},hideTooltips:function(){$("#live-search-search-tip-tooltip, #live-search-select-person-tip-tooltip").hide()},setSearchTipTooltip:function(){if(this.tooltipsEnabled){var e=this;$("#live-search-select-person-tip-tooltip").hide();var t=$("#recipients-livesearch-query");document.getElementById("live-search-search-tip-tooltip")?$("#live-search-search-tip-tooltip").show():t.mytooltip({width:"auto",opening:"open",closing:"close",tooltip:$('<span id="live-search-search-tip-tooltip"></span>').text(I18n.t("transfer.livesearch.searchContactTip")),offset:{left:-336,top:-7},parentElement:e.transferAppRootElement,conditionToShow:function(t,a,r){return e.tooltipsEnabled},conditionToHide:function(e){return!1}},function(e){$("#recipients-livesearch-query").trigger("open.tooltip")})}},setSelectPersonTipTooltip:function(){if(this.tooltipsEnabled){var e=this;$("#live-search-search-tip-tooltip").hide();var t=$("#recipients-livesearch-query");document.getElementById("live-search-select-person-tip-tooltip")?$("#live-search-select-person-tip-tooltip").show():t.mytooltip({width:"auto",opening:"openselectp",closing:"close",tooltip:$('<span id="live-search-select-person-tip-tooltip"></span>').text(I18n.t("transfer.livesearch.selectPerson")),offset:{left:-336,top:-7},parentElement:e.transferAppRootElement,conditionToShow:function(t,a,r){return e.tooltipsEnabled},conditionToHide:function(e){return!1}},function(e){$("#recipients-livesearch-query").trigger("openselectp.tooltip")})}},isFormLocked:function(){return $(this.transferAppViewElement).find(".transfer-form-view").hasClass("transfer-form-locked")},focusFirstInput:function(){this.doFocusFirstFormInput&&!this.isFormLocked()&&(this.doFocusFirstFormInput=!1,$(this.transferAppViewElement).find(".form-view").find("input:not([autocomplete]):visible:first").trigger("focus"))},bindEventHandlers:function(e,t){var a={enter:13,escape:27,left:37,up:38,right:39,down:40,tab:9},r=this,n=e.$el.find("#recipients-livesearch-query");$(document).off("keydown.navigation").on("keydown.navigation",function(e){if(!$(r.transferAppRootElement).find(".warning-dialog").length){var t=e.keyCode||e.which;switch(t){case a.escape:r.lastSearchValue&&($("#recipients-livesearch-query").val(r.lastSearchValue).trigger("blur").closest(".livesearch-border").removeClass("focus"),$("#live-search-field-wrapper .placeholder-livesearch, #livesearch-placeholder-for-ie10").hide(),r.focusFirstInput())}}}),n.off("keydown.ergonomics").on("keydown.ergonomics",function(e){e.keyCode?e.keyCode:e.charCode}),n.off("click.ergonomics").on("click.ergonomics",function(e){r.hideTooltips()}),n.off("keyup.ergonomics").on("keyup.ergonomics",function(e){var t=$("#recipients-livesearch-query"),a=e.keyCode?e.keyCode:e.charCode;r.hideTooltips(),t.val()?$("#live-search-search-tip-tooltip").hide():($("#live-search-select-person-tip-tooltip").hide(),r.addressBookMode&&_.indexOf([9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,91],a)==-1&&t.liveSearch("showSection","addressBookItemsList",{autoOpen:!0}))}),n.off("keydown.navigation").on("keydown.navigation",function(t){var n=t.keyCode||t.which;switch(n){case a.enter:e.$el.find(".ui-livesearch-item-selected").length||($(r.transferAppRootElement).find(".livesearch-border").removeClass("focus"),$(r.transferAppRootElement).find(".recipients-livesearch").find(".new-recipient").trigger("click"))}}),$(window).off("blur.livesearchutil").on("blur.livesearchutil",function(e){var t=$("#recipients-livesearch-query");t.length&&(t.val()?$(r.transferAppRootElement).find(".transfer-form-locked").length&&r.setSelectPersonTipTooltip():($(r.transferAppRootElement).find(".livesearch-border"),r.setSearchTipTooltip()))}),$(r.transferAppMenuElement).find("a").off("click.hidetooltips").on("click.hidetooltips",function(){$(document).off("click.transferslivesearch"),$(window).off("blur.livesearchutil"),r.hideTooltips()}),$(document).off("click.transferslivesearch").on("click.transferslivesearch",function(e){r.handleLiveSearchClick(e)}),Modernizr.touch&&$(document).off("touchstart.transferslivesearch").on("touchstart.transferslivesearch",function(e){r.handleLiveSearchClick(e)})},handleLiveSearchClick:function(e){var t=this;t.resetState();var a=$("#live-search-field-wrapper");if(a.length&&!a.hasClass("ui-livesearch-working")&&!Ebre.Common.wasElementClicked(e,a.parent())){var r=$("#recipients-livesearch-query");t.lastSearchValue&&t.lastSearchValue!=r.val()&&($("#recipients-livesearch-query").val(t.lastSearchValue).closest(".livesearch-border").removeClass("focus"),$("#live-search-field-wrapper .placeholder-livesearch, #livesearch-placeholder-for-ie10").hide()),$(t.transferAppRootElement).find("#ui-transfer-blocker-screen").length&&($("#recipients-livesearch-query").val()&&t.setSelectPersonTipTooltip(),t.lastSearchValue||(r.val()||t.setSearchTipTooltip(),$("#recipients-livesearch-query").liveSearch("trigger"),r.trigger("focus",[!0])))}},setFocus:function(e){var t=this;e.$el.find("#recipients-livesearch-query").off("focus").on("focus",function(a,r){t.doFocusFirstFormInput=!0,e.focus.apply(this,[a,r])})},setInfoState:function(e){this.state="info";var t=$("#transfer-container").find(".transfer-receiver"),a=this.getValidationMessage();a.closest("body").length||$("#transfer-container").find(".recipients-livesearch").append(a),t.addClass("info");var r=a.text();r?a.text([r,e].join(" ")):a.text(e),this.stateMessage=a.text(),setTimeout(function(){var e=$("#transfer-container").find(".info"),t=e.children().get(0),a=e.find(".recipients-livesearch").css("background-color"),r=/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/,n=r.exec(a);n&&$({r:n[1],g:n[2],b:n[3],a:1}).animate({r:n[1],g:n[2],b:n[3],a:0},{step:function(){t.style.backgroundColor="rgba("+~~this.r+","+~~this.g+","+~~this.b+","+~~(100*this.a)/100+")"},duration:1500}).promise().done(function(){t.style.backgroundColor="",e.removeClass("info").find(".validation-message").text(""),$("#transfer-container").removeClass("keep-state")})},3e3)},getValidationMessage:function(){var e="livesearch-validation-message",t=$("#"+e);return t.length||(t=$('<span class="validation-message"></span>').attr("id",e)),t},setTooltips:function(e){var t=this,r=e.$el.find(".input-decorations"),n="live-search-info-tooltip",i=document.getElementById(n);i||(i=$('<span><span class="text"></span></span>').attr("id",n)),r.mytooltip({tooltip:i,parentElement:t.transferAppRootElement,onShow:function(e,t){a.updateLiveSearchInfoTooltipText(r,t)}});var o=e.$el.find(".live-search-preloader"),s="live-search-loader-tooltip",l=document.getElementById(s);l||(l=$("<span></span>").text(I18n.t("transfer.livesearch.preloaderTooltipText")).attr("id",s)),o.mytooltip({tooltip:l,parentElement:t.transferAppRootElement}),e.$el.find("[rel=tooltip]").each(function(){var e=$(this);if(!e.hasClass("ui-tooltip-caller")){var t='<span class="gray-gradient"><span class="text">{% if (obj && obj.text) { %}{{ text }}{% } %}</span></span>';n="ui-payments-general-purpose-tooltip",e.mytooltip({tooltip:$(document.getElementById(n)||$(_.template(t)({text:""})).attr("id",n).appendTo("#transfer-app-root")),width:200,outDelay:60,offset:{top:-7},onShow:function(e,t){t.find(".text").html(e.data().originalTitle),e.mytooltip("reposition")},parentElement:"#transfer-app-root"})}}).off("click.tooltipcaller").on("click.tooltipcaller",function(e){
e.preventDefault()})},toggleAddressbook:function(e){var t=$(e.target);if(!t.hasClass("working")){t.addClass("working");var r=$("#recipients-livesearch-query").liveSearch("data");t.hasClass("book-red")?(this.addressBookMode=!0,r.keyNavigationMode="CycleAdding",r.sections.addressBookItemsList.afterBuild=function(){var e=this;!this.currentSelection||this.currentSelection.length<r.itemsToDisplay+1||this.$container.myscroll({height:"464px",railVisible:!0,alwaysVisible:!0,onScrollEndApproaching:function(t){var r=$("#recipients-livesearch-query").liveSearch("data");e.displayMoreItems(r,1),a.setLastItemRoundedCorners(r.listElement)}})},$("#recipients-livesearch-query").focus().liveSearch("showSection","addressBookItemsList",{autoOpen:!0}),t.removeClass("book-red").addClass("all-lists").removeClass("working"),this.updateLiveSearchInfoTooltipText(t,$("#live-search-info-tooltip"),!0)):(this.addressBookMode=!1,r.keyNavigationMode="CycleOnly",r.sections.addressBookItemsList.afterBuild=null,r.sections.addressBookItemsList.$container&&r.sections.addressBookItemsList.$container.myscroll("destroy"),$("#recipients-livesearch-query").focus().liveSearch("includeSections",!0),t.removeClass("all-lists").addClass("book-red").removeClass("working"),this.updateLiveSearchInfoTooltipText(t,$("#live-search-info-tooltip"),!0))}},viewOnRender:function(e){this.addressBookMode?e.$el.find(".input-decorations").addClass("all-lists"):e.$el.find(".input-decorations").addClass("book-red"),this.fixPlaceholderForIE10plus(e),this.initLiveSearchFocusedPlaceholder(e.$el),this.restoreState(e.$el)},resetState:function(){$("#transfer-container").hasClass("keep-state")||(this.state=this.stateMessage="",$("#transfer-container").find(".transfer-receiver").removeClass("info"),$("#livesearch-validation-message").remove())},restoreState:function(e){this.state&&(e.addClass(this.state),e.children().append(this.getValidationMessage().text(this.stateMessage)))},setLastItemRoundedCorners:function(e){e.find(".special-rounded-bottom-corners").removeClass("special-rounded-bottom-corners"),this.addressBookMode||e.find(".ui-livesearch-results-number").length||e.find(".ui-livesearch-item-last").addClass("special-rounded-bottom-corners")},initLiveSearchFocusedPlaceholder:function(e){var t="placeholder"in document.createElement("input"),a=navigator.userAgent.toLowerCase(),r=a.indexOf("android")>-1,n=($.browser.opera&&$.browser.version<10.5,e.find("#live-search-field-wrapper")),i=e.find("#live-search-field-wrapper input"),o=$('<span class="placeholder-livesearch"></span>');if(!t||$.browser.opera||r){var s=i.attr("placeholder");""!=s&&(n.append(o),o.text(s)),""!=i.val()&&o.hide(),o.click(function(){i.focus()}),i.live("focus",function(){$.trim(i.val())||""===$.trim(i.val())||o.hide()}),i.live("keyup",function(){""!==$.trim(i.val())?o.hide():o.show()}),i.live("keypress",function(){o.hide()}),i.live("blur",function(){$.trim(i.val())||o.show()}),i.attr("placeholder","")}},fixPlaceholderForIE10plus:function(e){if(10==Ebre.Common.getInternetExplorerVersion()||$.browser.msie||parseInt($.browser.version)>10){var t=e.$el.find("#recipients-livesearch-query"),a=t.attr("placeholder");t.attr("placeholder","");var r=$('<div id="livesearch-placeholder-for-ie10"></div>').text(a),n={position:"absolute",top:"-4px",left:"10px",fontWeight:"bold",zIndex:100,color:"#bababa"};for(x in n)r.css(x,n[x]);t.parent().prepend(r),_.each(["change.placeholder","keyup.placeholder","blur.placeholder"],function(e){t.on(e,function(e){$.trim(t.val())?r.hide():r.show()})}),t.on("keypress.placeholder",function(e){r.hide()}),r.on("click.placeholder",function(e){t.trigger("focus")}),$.trim(t.val())&&r.hide()}}}),a}),define("transfer/js/services/facebook-data-manager",[],function(){var e={fetchedData:{}},t=["mobile","domestic","facebook","abroad","own"];return _.extend(e,{getFacebookData:function(e,a,r){return this.fetchedData.hasOwnProperty(e)?r(this.fetchedData[e]):null!==e&&_.contains(t,a)?void nmbServices.getFacebookUserData({id:e,context:this}).done(function(t){this.fetchedData[e]=t,r(t)}).fail(function(e){e.error&&r({error:e.error})}):r({})}}),e}),define("transfer/js/models/fko-importer-info",[],function(){var e=Backbone.Model.extend({disableMessage:function(e){nmbServices.disableFKOMessage(e)}});return e}),define("transfer/js/views/view-helpers",[],function(){var e={"transfer.sidebar.domestic":190007,"transfer.sidebar.own":190008,"transfer.sidebar.abroad":190009,"transfer.sidebar.facebook":190010,"transfer.sidebar.phone":190011,"transfer.sidebar.mobile":190012,"transfer.sidebar.template.domestic":190013,"transfer.sidebar.template.own":190014,"transfer.sidebar.template.abroad":190015,"transfer.sidebar.template.facebook":190016,"transfer.sidebar.template.phone":190017,"transfer.sidebar.template.mobile":190018,"transfer.livesearch.addressbook":190019,"transfer.step2.modify":190020,"transfer.delivery.type.elixir":190021,"transfer.delivery.type.express":190022,"transfer.delivery.type.sorbnet":190023,"transfer.delivery.type.sepa":190024,"transfer.delivery.type.swift_own":190025,"transfer.trasnfer.type.swift_sha":190026,"transfer.dashboard.template":190027,"transfer.tab.series.trasnfer":190028,"transfer.tab.standing.order":190029,"transfer.calendar.select":190030,"transfer.sidebar.voip":190031,"transfer.sidebar.template.voip":190032},t={getGemiusActionId:function(t){return e.hasOwnProperty(t)?e[t]:0},getActionIdForSidebarTransferType:function(e,t){var a;if(t)switch(e){case"domestic":a=190013;break;case"own":a=190014;break;case"abroad":a=190015;break;case"facebook":a=190016;break;case"phone":a=190017;break;case"mobile":a=190018}else switch(e){case"domestic":a=190007;break;case"own":a=190008;break;case"abroad":a=190009;break;case"facebook":a=190010;break;case"phone":a=190011;break;case"mobile":a=190012}return a}};return t}),define("transfer/js/logic/form-editors",[],function(){return function(){var e=Backbone.Form,t=e.editors;t.DeliveryTimeSelect=t.Radio.extend({tagName:"div",className:"fields",_arrayToHtml:function(e){var t=[],a=this;return _.each(e,function(e,r){var n='<div class="radio-panel one-third">',i=a.id+"-"+r,o=a.id+"Label",s=i+"Label",l=e.usePoints?I18n.t("mWaluta"):I18n.t("deliveryTimeRadio.costs");if(_.isObject(e)){var d=e.val||"",c=e.help||"";e.amount||"",e.currency||"";priceStr=e.priceStr||"",commissionsAndFees=e.commissionsAndFees||null,n+='<div class="radio-area"><span class="radio-wrapper">',n+='<input type="radio" name="'+a.id+'" value="'+d+'" id="'+i+'" aria-labelledby="'+o+" "+s+'" data-gemius-event-type="action" data-gemius-event-action-id="'+Backbone.View.prototype.viewHelpers.getGemiusActionId("transfer.delivery.type."+d)+'" data-gemius-event-action-name="transfer.delivery.type.'+d+'" />',n+="</span></div>",n+='<label class="radio-label" for="'+i+'" id="'+s+'">',n+='<span class="transfer-type">'+e.label+"</span>",e.tooltip&&(n+='<a href="#" class="tooltip-icon btn-gray-gradient btn-small" rel="tooltip" title="'+I18n.t(e.tooltip)+'">',n+='<i class="icon-question-mark">Pomoc</i>',n+="</a>"),n+='<span class="time">'+c+"</span>",commissionsAndFees&&(n+='<span class="time">'+commissionsAndFees+"</span>"),""!==priceStr&&(n+="<span>"+l+": "+priceStr+"</span>"),n+="</label>"}else n+='<input type="radio" name="'+a.id+'" value="'+e+'" id="'+i+'" aria-labelledby="'+o+" "+s+'" />',n+='<label for="'+i+'" id="'+s+'">'+e+"</label>";n+="</div>",t.push(n)}),t.join("")}}),t.List=t.List.extend({addItem:function(e,a){var r=this;void 0!==this.schema.fixEditorsCode&&1!=this.schema.fixEditorsCode&&(e=this.value||[]);var n=new t.List.Item({list:this,schema:this.schema,value:e,Editor:this.Editor,key:this.key,index:this.items.length+1}).render(),i=function(){(!n.schema.itemsLimit||r.items.length<n.schema.itemsLimit)&&(n.index=r.items.length+1,r.items.push(n),r.$list.append(n.el)),n.editor.on("all",function(e){"change"!=e&&(args=_.toArray(arguments),args[0]="item:"+e,args.splice(1,0,r),t.List.prototype.trigger.apply(this,args))},r),n.editor.on("change",function(){n.addEventTriggered||(n.addEventTriggered=!0,this.trigger("add",this,n.editor)),this.trigger("item:change",this,n.editor),this.trigger("change",this)},r),n.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},r),n.editor.on("blur",function(){if(this.hasFocus){var e=this;setTimeout(function(){_.find(e.items,function(e){return e.editor.hasFocus})},0)}},r),(a||e)&&(n.addEventTriggered=!0),a&&(r.trigger("add",r,n.editor),r.trigger("change",r))};return this.Editor.isAsync?n.editor.on("readyToAdd",i,this):i(),n.schema.itemsLimit&&r.items.length>=n.schema.itemsLimit&&(this.$el.find('[data-action="add"]').hide(),n.editor.$el.focus()),n},removeItem:function(e){if(this.$el.find('[data-action="add"]').not(":visible")&&this.$el.find('[data-action="add"]').show(),this.items.length>1){var t=this.schema.confirmDelete;if(t&&!confirm(t))return;var a=_.indexOf(this.items,e);this.items[a].remove(),this.items.splice(a,1),"undefined"!=typeof this.items[a-1]&&this.items[a-1].editor.$el.focus(),e.addEventTriggered&&(this.trigger("remove",this,e.editor),this.trigger("change",this)),this.items.length||this.Editor.isAsync||this.addItem()}else this.trigger("lastItemRemoved",this)},render:function(){var t=this,a=this.value||[],r=$(e.templates[this.schema.listTemplate]({items:'<b class="bbf-tmp"></b>'}));return this.$list=r.find(".bbf-tmp").parent().empty(),a.length?_.each(a,function(e,a){t.addItem(e)}):this.Editor.isAsync||this.addItem(void 0,!0),this.setElement(r),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),t.schema.itemsLimit&&t.items.length==t.schema.itemsLimit&&this.$el.find('[data-action="add"]').hide(),this}}),t.List.Item=t.List.Item.extend({events:{'click [data-action="remove"]':function(e){e.preventDefault(),this.list.removeItem(this)}},render:function(){this.editor=new this.Editor({key:this.key,id:this.key+this.index,schema:this.schema,value:this.value,list:this.list,item:this,index:this.index}).render();var t=$(e.templates[this.schema.listItemTemplate]({editor:'<b class="bbf-tmp"></b>',index:this.index,key:this.key}));return t.find(".bbf-tmp").replaceWith(this.editor.el),this.setElement(t),this.placeholders(t),this},placeholders:function(e){e.find("[data-placeholder]:not(.pl-on)").each(function(){var e=$(this).find("input[type=text]"),t=$(this).attr("data-placeholder");e.length>0&&e.val().length<1&&(e.css({color:"#a3a3a3"}).val(t).addClass("empty"),$(this).addClass("pl-on")),e.off("focus.placeholder, blur.placeholder").on("focus.placeholder",function(){e.val()===t&&e.attr("style","").val("").removeClass("empty")}).on("blur.placeholder",function(){e.val().length||e.css({color:"#a3a3a3"}).val(t).addClass("empty")})})}})}}),nmbServices=nmbServices||{},function(){_.extend(nmbServices,{PrepareTransferONEZUS:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.OneZusService.TransferFormUrl,unique:"firstWins",data:JSON.stringify({selectDefaultTemplate:e.selectDefaultTemplate,recipientId:e.definedRecipientId,templateId:e.definedTemplateId,extraFormData:e.extraFormData||null,fromSidebar:e.fromSidebar}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)}).fail(e.error)},GetCostInformation:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.OneZusService.GetCostInformationUrl,unique:"firstWins",data:JSON.stringify({fromAccount:e.fromAccount}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},IntermediateSubmitTransferOneZus:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.OneZusService.IntermediateFormUrl,unique:"firstWins",data:JSON.stringify({formData:e.formData,recipientId:e.recipientId,templateId:e.templateId}),contentType:"application/json;charset=utf-8"}).done(function(t){e.success(t)})},FinalSubmitTransferOneZus:function(e){Ebre.Proxy.VeneziaPostJSON({loaderParent:nmbServices.checkLoaderParent(e),url:Ebre.Modules.Payments.Transfer.OneZusService.FinalFormUrl,unique:"firstWins",data:JSON.stringify({tanCodeValue:e.tanCodeValue,smsCodeValue:e.smsCodeValue,formData:e,templateId:e.templateId}),contentType:"application/json;charset=utf-8",error:e.error}).done(function(t){e.success(t),nmbServices.invalidateLSData(e)})}})}(),define("transfer/js/company/services/service",function(){}),define("transfer/js/company/companyTransfersApp",["./../models/transfer-wizard","./services/service"],function(e,t){var a={perpareTransfer:function(t,a,r){function n(e,t){var a=e.currentView;return a&&a instanceof t||(a=new t),a}function i(e,t){return e.currentView===t}function o(e,t){i(e,t)||e.show(t)}var s=e.getForm(t,a),l=$.Deferred(),d=!0;require(["transfer/js/views/transfer-layout"],l.resolve),l.done(function(e){var t=r.main,a=n(t,e);i(t,a)?(d=!1,a.showFormPreloader()):o(t,new Backbone.nmb.Preloader)});var c=$.when(s,l);l.always(function(){c.fail(function(e){var n=e.message||{};d?(a.trigger("show:dashboard"),Ebre.Proxy.HandleDefaultError(e)):("function"==typeof t.callback&&t.callback(),r.main.currentView&&"function"==typeof r.main.currentView.showNotLoaded&&(Ebre.Venezia.AuthService.UserUseNam&&$(".grayscale-blocker").hide(),r.main.currentView.showNotLoaded(t,n)))})}),c.done(function(e,s){var l=r.main,d=n(l,s);e.sidebarData&&e.sidebarData.isContactShared&&Ebre.Common.createInfoMessage("",I18n.t("transfer.sharedContactRestrictionInfo")),i(l,d)?e.formData.recipientId&&d.model.get("formData").recipientId===e.formData.recipientId?d.refresh():d.render():o(l,d),null!=d.model.get("formData").recipientName&&d.model.get("formData").recipientName.replace(/[^a-z0-9]/gi,"").length<2&&(Ebre.Common.createErrorMessage(I18n.t("errors.invalidRecipientName"),I18n.t("errors.errorTransferNotSent")),a.main.currentView.main.currentView.lockForm()),t.callback&&t.callback()})}};return a}),define("transfer/js/app",["./views/app/layout","./views/submenu","./models/transfer-wizard","./services/service","./logic/livesearch-common","./services/facebook-data-manager","./models/fko-importer-info","./views/view-helpers","./logic/form-editors","./company/companyTransfersApp"],function(e,t,a,r,n,i,o,s,l,d){l();var c=new Backbone.Marionette.Application;c.unloadLayout=function(){this.off(),$(window).off("resize.payments"),$(document).off("click.transferslivesearch keydown.navigation"),$(window).off("blur.livesearchutil"),$(window).off("keydown.blockmodalkeys"),n.resetValues();try{$("#fko-info-payments").closest(".message-box").remove(),this.removeRegion("main")}catch(e){}},c.getP2PAppData=function(e,t){var r={fn:function(r){switch(r){case"FetchDataError":var i=a.get("formLoaded").get("formData"),o=new Backbone.Model;if(o.set("message",I18n.t("transfer.facebook.error.fetchDataHeader")),o.set(i),n.trigger("dialog","facebook-connection-warning",o),"function"==typeof t)return t();break;default:return this.getP2PAppData.called=!0,this.cache.p2pAppData={application:"P2PApplication",installed:!1},e(this.cache.p2pAppData)}}};if(!Ebre.Modules.Payments.Transfer.FacebookService.GetApplicationsStatusFromFb)return r.fn.call(this);var n=c;this.getP2PAppData.called=!0,this.cache.p2pAppData?e(this.cache.p2pAppData):nmbServices.getApplicationsStatusFromFb({success:function(t){var a=_.find(t,function(e){return"P2PApplication"===e.application});a&&1==a.installed?nmbServices.getFacebookApplicationsIds({success:function(t){var i=_.find(t,function(e){return"P2PApplication"===e.application});i?(a.facebookAppId=i.facebookAppId,n.cache.p2pAppData=a,e(a)):r.fn.call(c,"NotInstalled")}}):r.fn.call(c,"NotInstalled")},error:function(e){r.fn.call(c,"FetchDataError")}})},c.openFbDialog=function(e){var t=$(window).width()/2-320,a=$(window).height()/2-200;return window.open(e,"FacebookPopupDialog","width=640,height=400,left="+t+",top="+a+",screenX=100,screenY=100")},c.showFKOImporterInfo=function(){nmbServices.shouldShowFKOMessage({success:function(e){e===!0&&require(["transfer/js/views/dialogs/fko-importer-info"],function(e){var t=new e({model:new o});$("#fko-info-payments").length>0||Ebre.Common.createMessage({isMsgHtml:!0,message:t.render().$el,afterClose:function(){nmbServices.disableFKOMessage()}})})}})};var u={onChangeSubPage:function(){$(document).off("click.transferslivesearch keydown.navigation"),$(window).off("blur.livesearchutil"),$("#transfer-app-root").find(".ui-tooltip-caller").mytooltip("destroy"),$("#transfer-app-root").find(".ui-tooltip").remove(),setTimeout(function(){n.resetValues()},10)}};return c.initLayout=function(){function r(){$("#content").css("min-height",$(window).height()-$("#header").height())}function o(e,t){var a=e.currentView;return a&&a instanceof t||(a=new t),a}function l(e,t){return e.currentView===t}function m(e,t){l(e,t)||e.show(t)}c.addRegions({main:"#transfer-app-root"}),c.cache={fbManager:i},Backbone.View.prototype.viewHelpers=_.extend(Backbone.View.prototype.viewHelpers,s),n.resetValues(),$(window).off("resize.payments").on("resize.payments",r),r(),window.PIE&&$('[class*="btn"], [class*="btn-carret"] span, .underline-decoration, .underline-decoration .hover, input[type="text"]').each(function(){PIE.attach(this)});var p=this,f=new e;c.showFKOImporterInfo(),this.main.show(f),f.menu.show(new t({app:p})),p.on("error",function(){require(["transfer/js/views/app/error"],function(e){var t=new e;f.main.show(t)})}),p.on("show:dashboard",function(){u.onChangeSubPage(),require(["transfer/js/views/dashboard-layout","transfer/js/views/transfer-layout"],function(e,t){if(void 0!==typeof f.main){var a=new e,r=f.main.currentView;if(r&&r instanceof t){var n=r.form;n&&n instanceof Backbone.nmb.FadingRegion&&n.currentView&&r.on("close",function(){f.main.animationPromise.done(function(){n.currentView.close(),r=n=null})})}f.main.show(a),a.defaultView()}})}),p.on("show:payments-periodic",function(){u.onChangeSubPage(),window.location.hash="#periodicpayments"}),p.on("show:payments-periodic-list",function(){u.onChangeSubPage(),window.location.hash="#periodicpayments/list"}),p.on("show:payments-periodic-list-summary",function(){u.onChangeSubPage(),window.location.hash="#periodicpayments/listsummary"}),p.on("show:payments-periodic-list-authorize",function(e){u.onChangeSubPage(),window.location.hash=e?"#periodicpayments/listauthorizelaterrep":"#periodicpayments/listauthorizelaterseries"}),p.on("show:escrow",function(){u.onChangeSubPage(),window.location.hash="#escrow"}),p.on("dialog",function(e,t){require(["transfer/js/views/dialogs/"+e],function(e){var a=new e({model:t});f.modal.show(a)})}),p.on("dialogClose",function(){f.modal.close()}),p.on("transfer:newCompany transfer:newRecipient",function(e){return d.perpareTransfer(e,p,f)}),p.on("transfer:new transfer:newRecipient",function(e){if("default"===e.transferType){var t=a.getDefaultForm(e,p);Ebre.Wizard.trigger("layout:gotoStep",0)}else var t=a.getForm(e,p);var r=$.Deferred(),n=!0;require(["transfer/js/views/transfer-layout"],r.resolve),r.done(function(e){var t=f.main,a=o(t,e);l(t,a)?(n=!1,a.showFormPreloader()):m(t,new Backbone.nmb.Preloader)});var s=$.when(t,r);r.always(function(){s.fail(function(t){var a=t.message||{};n?(p.trigger("show:dashboard"),Ebre.Proxy.HandleDefaultError(t)):("function"==typeof e.callback&&e.callback(),f.main.currentView&&"function"==typeof f.main.currentView.showNotLoaded&&(Ebre.Venezia.AuthService.UserUseNam&&$(".grayscale-blocker").hide(),f.main.currentView.showNotLoaded(e,a)))})}),s.done(function(t,r){var n=f.main,s=o(n,r);if(p.isFacebookEnabled){var d=e.facebookId||a.fetchFbIdFromSidebarData();t.sidebarData&&t.sidebarData.isContactShared&&Ebre.Common.createInfoMessage("",I18n.t("transfer.sharedContactRestrictionInfo"));var c=new $.Deferred;e.facebookName?(i.fetchedData[d]={name:e.facebookName},t.formData.p2pId=d,t.formData.p2pName=e.facebookName,c.resolve()):i.getFacebookData(d,e.transferType,function(a){if(t.formData.p2pId=d,a&&a.name)t.formData.p2pName=a.name;else if((a.error||a.fail)&&"facebook"===e.transferType){var r=new Backbone.Model,n=a.fail?I18n.t("transfer.facebook.error.fetchGraphConnectionError"):I18n.t("transfer.facebook.error.fetchGraphDataError");r.set("message",n),r.set(t.formData),p.trigger("dialog","facebook-connection-warning",r)}c.resolve()})}else{var c=new $.Deferred;c.resolve()}c.done(function(){l(n,s)?t.formData.recipientId&&s.model.get("formData").recipientId===t.formData.recipientId?s.refresh():s.render():m(n,s),null!=s.model.get("formData").recipientName&&s.model.get("formData").recipientName.replace(/[^a-z0-9]/gi,"").length<2&&(Ebre.Common.createErrorMessage(I18n.t("errors.invalidRecipientName"),I18n.t("errors.errorTransferNotSent")),p.main.currentView.main.currentView.lockForm()),e.callback&&e.callback()})})}),p.on("transfer:unlock transfer:addRecipient",function(){var e=f.main.currentView;"function"==typeof e.unlockForm&&e.unlockForm()}),p.on("transfer:lock",function(){var e=f.main.currentView;"function"==typeof e.lockForm&&e.lockForm()}),p.on("sidebar:lock",function(){var e=f.main.currentView;"function"==typeof e.lockSidebar&&e.lockSidebar()}),p.on("sidebar:unlock",function(){var e=f.main.currentView;"function"==typeof e.unlockSidebar&&e.unlockSidebar()}),p.on("transfer:checkFalter",function(e){var t=e.form?e.form.getValue():e,r=a.checkFalter(t);r.done(function(t){t?require(["transfer/js/views/transfer-layout"],function(e){f.main.currentView instanceof e&&f.main.currentView.showFalter()}):p.trigger("transfer:submit",e)}).fail(function(){p.trigger("transfer:submit",e)})}),p.on("transfer:submit",function(e){var t=e.form?e.form.getValue():e,r=a.intermediateSubmit(t);r.done(function(e){p.trigger("transfer:authStep")})}),p.on("transfer:authStep",function(){require(["transfer/js/views/transfer-layout"],function(e){f.main.currentView instanceof e&&f.main.currentView.showStep2()})}),p.on("transfer:done",function(e){return Ebre.Common.Gemius_event({type:"action",actionName:"transferDone",params:{transferType:e.transferCategory}}),"undefined"!=typeof e&&"undefined"!=typeof e.standingOrBulk&&null!==e.standingOrBulk&&e.standingOrBulk===!0?void p.trigger("show:payments-periodic-list-summary"):(p.trigger("show:dashboard"),void require(["transfer/js/views/transfer-summary"],function(e){var t=new e({model:a.get("summaryData").set("recipientName",a.get("formData").recipientName)});if(f.notify.show(t),void 0!==Ebre.Venezia.Adv){var r=$.Deferred(),n=$(".rtm-placeholder-ikp");r.done(function(){}),r.fail(function(){require([Ebre.Venezia.Adv.Urls.ScriptUrls.TransferSummaryInit],function(e){e(n)})});var i=a.getPopulatedModel().get("formData"),o={amount:i.amount,recipient:i.recipientName,title:i.title,toAccount:i.toAccount};require([Ebre.Venezia.Adv.Urls.ScriptUrls.TransferMiniRtmInitStep3],function(e){e(n,o,r)})}t.bindTo(p,"all",function(){"function"==typeof t.closePopup?t.closePopup():f.notify.close()})}))}),p.on("transfer:p2p:cancel",function(e){var t=a.get("summaryData").get("fbSummary").fullLink,r=a.transferFacebookCancel({fullLink:t});r.done(function(){p.trigger("show:dashboard");var t=a.get("summaryData").get("operations")[0].amount,r="invalidFacebookUser"==e?I18n.t("transfer.facebook.facebookMessageCanceledWrongUserTitle"):I18n.t("transfer.facebook.facebookMessageCanceledTitle"),n="invalidFacebookUser"==e?Ebre.Extensions.format(I18n.t("transfer.facebook.facebookMessageCanceledDescriptionWrongUser"),Ebre.Common.formatNumber(t)):Ebre.Extensions.format(I18n.t("transfer.facebook.facebookMessageCanceledDescription"),Ebre.Common.formatNumber(t));Ebre.Common.createErrorMessage(r,n)})}),p.on("fb:p2p:registered:pre",function(e){/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent)?p.trigger("dialog","facebook-redirect-info",new Backbone.Model(e)):p.trigger("fb:p2p:registered",e)},200),p.on("fb:p2p:registered",function(e){var t=new $.Deferred;window.app=p,p.cache.p2pFinalData=e,p.getP2PAppData(t.resolve),p.cache.pollTimer&&window.clearInterval(p.cache.pollTimer),t.done(function(t){if(t.installed){delete p.cache.p2pStatus,p.trigger("transfer:lock");var r=Ebre.Modules.Payments.Transfer.FacebookService.OpenLoginDialog+"?facebookAppId="+t.facebookAppId;"undefined"==typeof p.cache.fbMessageDialog||p.cache.fbMessageDialog.closed===!0?p.cache.fbMessageDialog=p.openFbDialog(r):p.cache.fbMessageDialog.location.replace(r);var n=Ebre.Common.formatNumber(e.summary.fromAccount.operationValue),i=e.fbSummary.fullLink,o=(I18n.t("transfer.facebook.facebookMessageTitle"),Ebre.Extensions.format(I18n.t("transfer.facebook.facebookMessageDescription"),n,e.fbSummary.operationTitle,e.fbSummary.fullLink),Ebre.Modules.Payments.Transfer.FacebookService.OpenFacebookMessageDialog+"?facebookAppId="+t.facebookAppId+"&to="+a.get("formData").p2pId+"&link="+encodeURIComponent(i));window.X={cache:{operationAmount:n,messageUrl:o}},p.cache.pollTimer=window.setInterval(function(){"undefined"!=typeof p.cache.fbMessageDialog&&null!==p.cache.fbMessageDialog&&p.cache.fbMessageDialog.closed!==!1&&"undefined"==typeof p.cache.p2pStatus&&(window.clearInterval(p.cache.pollTimer),p.cache.p2pStatus="error",Ebre.Modules.Payments.Transfer.handleCloseMessageWindow(p.cache.p2pStatus))},200)}else p.cache.fbMessageDialog.close()})}),p.on("transfer:edit",function(){require(["transfer/js/views/transfer-layout"],function(e){var t=f.main,a=o(t,e);e.prototype.renderLivesearch.call(a),a.transferEditMode(),m(t,a)})}),p.on("transfer:cancel",function(){}),p.on("toggle:modal:screen",function(e){var t="transfer-modal-blocker-screen",a=document.getElementById(t);if(a||e)$(a).remove(),$(window).off("keydown.blockmodalkeys");else{var r=$("#content")[0].scrollHeight;$("<div></div>").attr("id",t).height(r).appendTo("#content"),$(window).off("keydown.blockmodalkeys").on("keydown.blockmodalkeys",function(e){if(9===e.keyCode||27===e.keyCode)return e.stopPropagation(),!1})}}),p.on("hide:livesearch",function(){$(".livesearch-border").removeClass("focus")}),"#/transfer/newDomestic"==document.location.hash?c.trigger("transfer:new",{transferType:"base"}):"#/transfer/newSplitDomestic"===document.location.hash?c.trigger("transfer:new",{transferType:"splitdomestic"}):"#/transfer/newAbroad"===document.location.hash?c.trigger("transfer:new",{transferType:"abroad"}):"#/transfer/newSelf"===document.location.hash?c.trigger("transfer:new",{transferType:"own"}):"#/transfer/newSplitSelf"===document.location.hash?c.trigger("transfer:new",{transferType:"splitown"}):"#/transfer/newZus"===document.location.hash?c.trigger("transfer:new",{transferType:"zus"}):"#/transfer/newUs"===document.location.hash?c.trigger("transfer:new",{transferType:"us"}):"#/transfer/newFacebook"===document.location.hash?c.trigger("transfer:new",{transferType:"facebook"}):"#/transfer/newMobile"===document.location.hash?c.trigger("transfer:new",{transferType:"mobile"}):"#/transfer/newPhone"===document.location.hash?c.trigger("transfer:new",{transferType:"phone"}):"#/transfer/newPhoneCharge"===document.location.hash?c.trigger("transfer:new",{transferType:"phone"}):"#/transfer/oneZus"===document.location.hash?c.trigger("transfer:newCompany",{transferType:"onezus"}):c.trigger("show:dashboard")},c}),define("transfer/js/i18n/pl-PL",[],function(){var e={pl:{toAccountInfo:"Od 1 stycznia 2018 obowizuj nowe zasady patnoci do ZUS-u. Wpisz indywidualny numer rachunku skadkowego, ktry wysa Ci ZUS.",errors:{accountZus:"Niepoprawny numer rachunku ZUS",amountAddZero:"Bdny format kwoty",street:{},accountNRBIncorrect:"Numer rachunku jest niepoprawny",accountNRB:"Numer rachunku musi skada si z 26 cyfr. Popraw numer lub zmie typ szablonu na zagraniczny.",input:{regex:"Nieprawidowa warto"},minimumDateUs:"Podany okres rozliczenia jest nieprawidowy. Dla wybranego formularza okres musi zawiera si od {{min}}.",wrongManualDate:"Nieprawidowa data lub data poza dopuszczalnym zakresem",wrongPeriodM:"Nieprawidowy miesic. Dozwolone wartoci od 1 do 12",wrongPeriodD:"Nieprawidowa dekada lub miesic",wrongPeriodR:"Nieprawidowy rok",wrongPeriodP:"Dozwolone wartoci to 1 lub 2",wrongPeriodJ:"Nieprawidowy dzie lub miesic",wrongPeriodK:"Nieprawidowy kwarta. Dozwolone wartoci od 1 do 4",wrongPeriodLong:"Maksymalna dugo to 4 znaki",wrongPeriodLongTwo:"Maksymalna dugo to 2 znaki",fromAccCorrected:"Rachunek rdowy zosta zmieniony na zgodny z wybranym profilem",fromAccChangedToTemplate:"Rachunek rdowy zosta zmieniony na zgodny z wybranym szablonem",abroadTransferUnavaliable:"W tej chwili nie moemy zrealizowa patnoci zagranicznej dla podanego banku, prosimy sprbowa pniej.",emptyPeriodAvailable:". Jeli nie chcesz podawa okresu rozliczenia, pozostaw pola niewypenione.",fromAccNotAllowed:"Rachunek rdowy zosta zmieniony na zgodny z wybranym typem operacji",auth:{sms:"Wprowadzone haso SMS-owe jest niepoprawne. Porwnaj numer i dat operacji z treci wiadomoci SMS.",tan:"Wprowadzone haso jednorazowe jest niepoprawne. Porwnaj numer listy i hasa z danymi obok."},smsSenderError:'Wysanie hasa smsowego jest w tej chwili niemoliwe. Aby potwierdzi operacj wybierz przycisk "Potwierd pniej". Aktualnie wprowadzone dane znajd si w licie "Operacje do potwierdzenia" dostpnej z lewego menu. Moesz potwierdzi je pniej - przez automatyczny serwis mLinii lub korzystajc z opcji "Wylij ponownie SMS" z listy operacji do potwierdzenia.',smsSenderErrorNoPostpone:"Wysanie hasa smsowego jest w tej chwili niemoliwe.",integer:"Pole przyjmuje tylko wartoci cakowite",seriesAndRepeatableNotForIban:"Na ten numeru rachunku seria przeleww oraz zlecenie stae s niedostpne",invalidRecipientName:"Niepoprawna nazwa odbiorcy",invalidRecipientNameForModifyStandingOrder:"Przepraszamy, ale ze wzgldu na nieprawidow nazw odbiorcy musisz ponownie zdefiniowa zlecenie stae.",errorTransferNotSent:"Przelew nie zosta zlecony"},transfer:{formLabel:"Formularz przelewu",favorite:"Ulubieni odbiorcy",heading:"Wykonaj przelew",calendar:"Kalendarz",help:"Pomoc",suggestToAbroad:"Podany numer rachunku nie jest rachunkiem do kraju Unii Europejskiej, Liechtensteinu, Szwajcarii, Norwegii, Islandii, San Marino ani Monako. Czy chcesz wykona przelew poza ten obszar?",confirmation:"Podsumowanie przelewu",basketTooltip:"Koszyk patnoci to miejsce, w ktrym mona zgromadzi operacje, a nastpnie stworzy z nich paczk i za pomoc autoryzacji jednym hasem zleci jej wykonanie.",addAddress:"Dodaj adres (opcjonalnie)",addZusOrUsAddress:"Dodaj nazw i adres patnika (opcjonalnie)",showAddress:"Poka adres odbiorcy (opcjonalnie)",showAddressNoSwift:"Poka adres odbiorcy",showZusOrUsAddress:"Poka nazw i adres patnika (opcjonalnie)",hideAddress:"Zwi adres odbiorcy",hideZusOrUsAddress:"Zwi nazw i adres",addToTrustedList:"Dodaj do rachunkw zaufanych",selfTransferDisabled_onlyOneCurrentAccount:"Masz tylko jeden rachunek w mBanku, z tego wzgldu funkcjonalno przeleww miedzy Twoimi rachunkami jest niedostpna.",selfTransferDisabled_onlyOneAccountInCurrentContext:"Posiadasz tylko jeden rachunek w wybranym kontekcie, z tego wzgldu przelew wasny na ten rachunek jest niemoliwy.",transferDateChanged:"Zmieniono dat na biec.",sharedContactRestrictionInfo:"Funkcjonalno przeleww zostaa ograniczona poniewa prezentowany kontakt nie pochodzi z Twojej Ksiki Odbiorcw.<br>Skopiuj kontakt do wasnej Ksiki Odbiorcw, aby zyska moliwo edycji.",selectDate:"Wybierz dat",addNextConfirmationEmail:"Dodaj kolejny e-mail dla potwierdzenia przlewu",removeAdditionalConfirmationEmail:"Usu dodatkowy e-mail potwierdzenia",modal:{transferTypeChanged:"Zmieni si wybrany przez Ciebie typ patnoci, zweryfikuj wpisane dane i wylij przelew."},submenu:{singleAccessibilityLabel:"Przelew jednorazowy",single:"Wykonaj przelew jednorazowy",cyclic:"Wykonaj przelew cykliczny",cyclicList:"Lista przeleww cyklicznych",escrow:"Rachunek zastrzeony"},notLoaded:"Bd podczas pobierania danych przelewu",
menu:{domestic:"Do osoby lub firmy",own:"Na wasne konto",request:"Popro o przelew",phone:"Doaduj telefon",us:"Podatkowy",zus:"Do ZUS-u"},sidebar:{option:{label:"Wybr typu odbiorcy",own:"Midzy wasnymi rachunkami w mBanku",domestic:"Na rachunek w Polsce<br /> lub Unii Europejskiej",facebook:"Na profil facebookowy",facebookError:"Bd poczenia",mobile:"Na numer telefonu",phone:"Doaduj telefon",voip:"Doaduj telefon VoIP",abroad:"Na rachunek poza<br /> Uni Europejsk",us:"Do organu<br /> podatkowego",zus:"Do ZUS",onezus:"Do ZUS na nowych zasadach",splitdomestic:"Na rachunek w Polsce<br /> patno podzielona",splitown:"Midzy wasnymi<br /> rachunkami VAT w mBanku"},limit:{max:"max",currency:"PLN"},add:{domestic:"Nowy rachunek odbiorcy",mobile:"Nowy numer odbiorcy",phone:"Nowy numer odbiorcy",voip:"Nowy numer odbiorcy",abroad:"Nowy rachunek odbiorcy",facebook:"",us:"Nowy przelew podatkowy",zus:"Nowy przelew skadki",onezus:"Nowy przelew do ZUS",splitdomestic:"Nowy rachunek odbiorcy"}},falter:{acceptOffer:"Skorzystaj",declineOffer:"Kontynuuj przelew"},step2:{recipientChanged:"Odbiorca zosta zmieniony na posiadacza rachunku docelowego.",recipient:"Odbiorca",recipientNameChanged:"Na potrzeby wysania przelewu zagranicznego niedozwolone znaki w nazwie odbiorcy zostay zastpione ich midzynarodowymi odpowiednikami",includingVat:"w tym VAT",toAccount:"Na rachunek:",toBank:"Do banku:",transfers:{title:"Tytu:",phoneNumber:"Na numer telefonu:",operator:"Operator:",invoiceNumber:"Nr faktury VAT:"},fromAccount:"Z rachunku:",fromAccountVat:"W tym VAT z rachunku",additionalInfo:"Dodatkowe informacje",toFacebook:"Wysany na konto Facebook",toMobile:"Na numer telefonu",additionalInfoForFacebook:"rodki zostan zablokowane na koncie do momentu zgoszenia si po nie przez odbiorc lub przez kolejne 15 dni.",auth:{smsCode:"Haso SMS",tanCode:"Haso jednorazowe",nr:"nr",fromDay:"z dnia"},error:{sms:"Nieprawidowy kod SMS",tan:"Nieprawidowe haso jednorazowe"},zus:{toAccount:"Na rachunek:",title:{social:"Ubezpieczenie spoeczne:",health:"Ubezpieczenie zdrowotne:",fgsp:"Fundusz pracy i FGP:",pension:"Fundusz Emerytur Pomostowych:",accountNumberLabel:"Numer konta"}},addingToBasket:"Przelew zostanie dodany do Twojego koszyka przeleww i zostanie zrealizowany dopiero po autoryzacji w sekcji koszyk patnoci.",basketInit:"Twj koszyk zosta automatycznie zablokowany po poprzedniej sesji. Aby go odblokowa wpisz otrzymane haso  bdziesz mg modyfikowa zawarto koszyka.",authorizeLaterTitle:"Przelew zosta przekazany do pniejszego potwierdzenia.",authorizeLater:"Operacja zostanie zrealizowana, jeli dokonasz jej autoryzacji w sekcji Do potwierdzenia.",authorizeLaterWithoutAddToAddressBook:"Operacja zostanie zrealizowana, jeli dokonasz jej autoryzacji w sekcji Do potwierdzenia.<br /> Dyspozycja dodania do ksiki odbiorcw zostaa anulowana.",idType:{id:"Dowd osobisty",passport:"Paszport",PESEL:"PESEL",REGON:"REGON",NIP:"NIP",other:"Inny dokument"},paymentType:{A:"A  Opata dodatkowa za bdy patnika",D:"D  Opata dodatkowa",E:"E  Egzekucja",M:"M  skadka dusza ni 1 miesic",S:"S  skadka za 1 miesic",T:"T  odroczenie terminu",U:"U  Ukad ratalny"},checkboxes:{addToAddressBook:"Dodaj do ksiki odbiorcw",addToTrustedList:"Dodaj do rachunkw zaufanych",addToTrustedPhones:"Dodaj do telefonw zaufanych",blockResources:"Zablokuj rodki na koncie do czasu przelewu",transferConfirmation:"Potwierdzenie wykonania przelewu",chargeFeeAccount:"Rachunek do pobrania prowizji",referenceNumber:"Numer referencyjny",specialPurpose:"Szczeglny cel",additionalInstructions:"Dodatkowe instrukcje",addToSMSCharge:"Aktywuj doadowania SMSem z tego numeru telefonu",primarySenderDetails:"Dane pierwotnego nadawcy",senderDetails:"Dane nadawcy",finalReceiverDetails:"Dane ostatecznego odbiorcy",receiverDetails:"Dane odbiorcy",addTemplate:"Zapisz rachunek odbiorcy w ksice"},soPaymentName:"Nazwa wasna zlecenia:",seriesPaymentName:"Nazwa wasna serii:",repeatableTransfer:{repeatFrom:"od",repeatTo:"do",untilCancellation:"momentu odwoania"}},summary:{addToBasketTitle:"Zlecenie przelewu dodano do koszyka",addToBasket:"Do czasu autoryzacji przelewu w koszyku nie zostanie on zrealizowany.",basketOperations:{one:"Masz now patno w koszyku na rachunku ",other:"Masz {{count}} patnoci w koszyku na rachunku ",zero:"Nie masz patnoci w koszyku na rachunku "},authorizeBasket:"Autoryzuj teraz",successTitle:"Przelew zosta zrealizowany",successTitleP2p:"Przelew zosta zlecony",successTitleBulk:"Seria przeleww zostaa zlecona",successTitlePhoneCharge:"Zlecenie doadowania zostao przekazane do operatora",successSwiftTitle:"Przelew zosta zlecony",successStandingOrder:"Zlecenie stae zostao przyjte do realizacji",operationLabel:"Kwota",operationCategorizedLabel:"zostanie zaksigowana we wskazanym dniu.",operationSwiftLabel:"zostanie zaksigowana.",includingVat:"w tym VAT",operationLabelNow:"zostaa zaksigowana.",operationLabelP2p:"zostanie zaksigowana we wskazanym przez odbiorc dniu.",balanceTitle:"Podsumowanie",additionalinfo:"Informacje dodatkowe",amountMayDiffer:"Kwota obcienia rachunku moe rni si od kwoty blokady w przypadku zmiany kursu waluty przed zaksigowaniem przelewu.",standingOrderNoLimit:"momentu odwoania",from:"od",to:"do",and:"i",standingOrderLabel:"bdzie realizowana co ",bulkSummary:"W przypadku braku rodkw, prba realizacji przelewu bdzie ponawiana przez 3 dni.",firstLimitReached:"Dyspozycja przelewu zostaa przyjta. Do penej realizacji wymagane jest potwierdzenie jej przez innego uytkownika rachunku.",secondLimitReached:'W tej chwili nie masz uprawnie do zlecenia tej operacji. Dyspozycja zostaa zarejestrowana na licie operacji oczekujcych na autoryzacj w "Koszyku Przeleww".',repeatFromBasketWarning:"Ponawiany przelew nie zosta usunity z listy operacji do zatwierdzenia. Pamitaj o jego usuniciu w celu uniknicia wykonania podwjnego przelewu.",transferHoldTitle:"Wstrzymalimy ten przelew ze wzgldw bezpieczestwa.",transferHoldMessage:"Wanie go sprawdzamy. <br/>W cigu 15 minut zadzwonimy do Ciebie, aby potwierdzi t transakcj. <br/>Jeli wszystko bdzie w porzdku, wykonamy przelew. Nie bdziesz musia zleca go ponownie. <br/><br/>Wicej informacji o tym jak moemy wsplnie dba o bezpieczestwo Twoich pienidzy znajdziesz na naszej stronie internetowej w zakadce Uwani w sieci.",splitOwnRelatedAccountsInfo:"Ksigowanie przelewu zostanie zrealizowane take na powizanych rachunkach rozliczeniowych."},form:{title:{domestic:"Przelew do osoby lub firmy",own:"Przelew na swoje konto",facebook:"Przelew do osoby lub firmy",mobile:"Przelew do osoby lub firmy",phone:"Przelew do osoby lub firmy",abroad:"Przelew do osoby lub firmy",us:"Przelew podatku lub do ZUS",zus:"Przelew podatku lub do ZUS"},fromAccount:{balance:"",ownFunds:""}},livesearch:{addnew:"Kontynuuj przelew do wpisanego odbiorcy",label:"Nazwa odbiorcy",defaultValue:'Imi i nazwisko lub nazwa firmy, np. "Jan Kowalski"',searchContactTip:"Wprowad nazw odbiorcy",preloaderTooltipText:"Wyszukiwanie...",selectPerson:"Wybierz odbiorc",group:{addressbook:"Wybierz odbiorc z ksiki",facebook:"Wybierz odbiorc z Facebooka",recent:"Wybierz odbiorc z historii"},titlesCount:{one:"inny",few:"inne",other:"innych",and:" i "},tooltips:{allABContacts:"Poka wycznie kontakty z ksiki odbiorcw",sectionContacts:"Szukaj we wszystkich kontaktach: z ksiki odbiorcw, historii operacji, Facebooka (jeli jeste poczony).",bluemediaValidation:"Niedozwolone znaki zostay zamienione.",trimValidation:"Usunito nadmiarowe biae znaki."},fieldHelp:'Wpisz nazw odbiorcy przelewu, a nastpnie wybierz opcj "Do nowego odbiorcy" - jeli beneficjentem jest osoba, do ktrej nie by wykonywany wczeniej aden przelew, ani nie jest zapisana w ksice. W innym wypadku wybierz znanego Ci odbiorc z listy podpowiadanej przez system.',fieldHelp2:'Wpisz nazw odbiorcy doadowania, a nastpnie wybierz opcj "Do nowego odbiorcy" - jeli beneficjentem jest osoba, ktra nie jest zapisana w ksice. W innym wypadku wybierz znanego Ci odbiorc z listy podpowiadanej przez system.'},domestic:{sender:"Nadawca",fromAccount:"Z rachunku",accountSourceNumber:"Numer rachunku rdowego",toAccount:"Na rachunek",address:"Adres (opcjonalnie)",amount:"Kwota",title:"Tytu przelewu",deliveryTime:{title:"Rodzaj przelewu",rowSubDesc1:"Czas dostarczenia",rowSubDesc2:"Prowizje i opaty",commissionsAndFeesOwn:"pacisz tylko Ty",commissionsAndFeesSha:"pacisz Ty i odbiorca"},deliveryDate:"Data realizacji",additionalOptions:"Opcje dodatkowe",change:"Zamie na:",series:"Seri przeleww",planned:"Zlecenie stae",phonecharge:"Doadowanie stae",additionalOptions:{title:"Opcje dodatkowe",blockResources:"Zablokuj rodki na koncie do czasu przelewu",sendConfirmation:"Wylij e-mail z potwierdzeniem wysania przelewu",addReceiver:"Dodaj do ksiki odbiorcw",sendSmsOnFail:"Informuj SMSem o niewykonanej patnoci"},tooltips:{deliveryTime:"Czas dostarczenia oznacza moment otrzymania przelewu przez bank odbiorcy. Zazwyczaj rodki na rachunku odbiorcy s ksigowane niezwocznie, w niektrych przypadkach bank odbiorcy moe potrzebowa wicej czasu na uznanie rachunku klienta.",seriesTooltip:"Zaplanuj seri kilku lub wicej przeleww do wybranego odbiorcy na dowolnie wybrane kwoty, w dowolnych terminach oraz z dowolnie okrelon czstotliwoci.",recurrentTooltip:"Zaplanuj harmonogram regularnych przeleww do wybranego odbiorcy na sta kwot i z okrelon czstotliwoci.",seriesTooltipClose:"Zamknij seri przeleww.",recurrentTooltipClose:"Zamknij zlecenie stae.",toAccountTooltip:"Przelew zostanie wysany wycznie na podstawie polskiego numeru rachunku bankowego lub IBAN, midzynarodowego numeru rachunku odbiorcy. Bank odbiorcy przelewu nie weryfikuje wprowadzonej przez Ciebie nazwy odbiorcy. Przelew moe zosta zrealizowany do krajw Unii Europejskiej, Norwegii, Liechtensteinu, Islandii, Szwajcarii, San Marino lub Monako.",toAccountTooltipSplit:"Przelew zostanie wysany wycznie na podstawie polskiego numeru rachunku bankowego odbiorcy. Bank odbiorcy przelewu nie weryfikuje wprowadzonej przez Ciebie nazwy odbiorcy. W przypadku, gdy przelew zostanie wysany na rachunek odbiorcy, dla ktrego bank odbiorcy nie prowadzi rachunku VAT, bank dokona zwrotu rodkw."},infoPZ:"Sprawd czy dla odbiorcy {0} moesz ustanowi wygodne polecenie zapaty",buttonPZ:"Utwrz polecenie zapaty",defaultTitle:"Przelew rodkw",elixir:{doneTime:"Dzi wieczorem  ",label:"Standardowy przelew ELIXIR"},express:{doneTime:"Nawet za 15 minut  ",label:"Ekspresowy do 5000,00 PLN"},sorbnet:{doneTime:"Nawet za 15 minut  ",label:"Ekspresowy SORBNET bez limitu"},placeholders:{name:"Imi i nazwisko lub nazwa firmy",address:"Ulica i numer",city:"Kod pocztowy i miejscowo",toAccount:"Podaj numer rachunku w Polsce lub IBAN rachunku w Unii Europejskiej."}},split:{grossAmount:"Kwota brutto",vatAmount:"Kwota VAT",idType:"Typ identyfikatora",idNumber:"Numer",invoiceNumber:"Numer faktury VAT",ownerNIP:"NIP posiadacza",errors:{must_be_less_than_gross_amount:"Kwota VAT nie moe by wiksza ni kwota do zapaty",idNumber_incorrect_tag_inv:"Wpisz numer bez /INV/",idNumber_incorrect_tag_txt:"Wpisz numer bez /TXT/",invoiceNumber_incorrect_tag:"Wpisz numer faktury bez /TXT/",title_incorrect_tag:"Wpisz tytu bez /TXT/"},placeholders:{toAccount:"Podaj numer rachunku w Polsce."}},standingOrder:{repeatEach:"Powtarzaj co",tillRevokation:"do momentu odwoania",from:"od",to:"do",noOfPaymentsBegin:"Zostanie wykonanych",noOfPaymentsEnd:"patnoci.",message:"Przelew zaplanowany na dzie wolny, zostanie wykonany przed tym dniem wolnym.",select:"Wybierz"},bulkPayment:{addNewTransfer:"Dodaj kolejny przelew do tego odbiorcy",removePosition:"Usu pozycj"},zus:{selectZus:"Zakad Ubezpiecze Spoecznych",total:"Kwota",defaultPrefixTitle:"Wpata na ZUS",showContribution:"Oblicz ze skadek",fromAccount:"Z rachunku",toAccount:"Na rachunek",toAccountTooltip:"Od 1 stycznia 2018 obowizuj nowe zasady patnoci za ubezpieczenia spoeczne, ubezpieczenie zdrowotne, Fundusz Pracy i Fundusz gwarantowanych wiadcze Pracowniczych oraz Fundusz Emerytur Pomostowych. Zamiast kilku wpat na rne rachunki wystarczy jeden przelew, na indywidualny numer rachunku skadkowego (NRS). Od tej pory nie bd Ci potrzebne dodatkowe dane identyfikacyjne. Twj NIP zawarty jest w numerze rachunku skadkowego.Indywidualny numer rachunku otrzymasz od ZUS-u poczt.",nameAndAddress:"Patnik",nip:"NIP",idType:"Typ identyfikatora",series:"Numer",expandAddress:"Rozwi nazw i adres",collapseAddress:"Zwi nazw i adres",addresField:"Patnik",declaration:{title:"Deklaracja",month:"Miesic",year:"Rok",number:"Numer"},paymentType:"Typ wpaty",decisionNumber:"Nr dec./umowy/tytuu wykonawczego",additionalOptions:{title:"Opcje dodatkowe",blockResources:"Zablokuj rodki na koncie do czasu przelewu",addReceiver:"Dodaj do ksiki odbiorcw"},errors:{must_be_at_least_one:"Musi by wypeniona co najmniej jedna kwota."}},us:{taxAuthoritySymbol:{title:"Organ podatkowy",symbol:"Symbol formularza urzdu skarbowego lub izby celnej",toAnother:"Do innego organu podatkowego"},taxAuthorityCity:"Miejscowo",taxAuthorityName:"Nazwa organu podatkowego",taxAuthorityAccountNumber:"Numer konta organu podatkowego",amount:"Kwota",fromAccount:"Z rachunku",nameAndAddress:"Patnik",noTaxAuthorityBranches:"Nie ma rachunkw speniajcych podane kryterium wyszukiwania",idType:{title:"Typ identyfikatora",type:"Identyfikator",series:"Numer"},period:{title:"Okres rozliczenia",subSchema:"Numer okresu rozliczeniowego",period:"Jednostka okresu rozliczeniowego",year:"Rok",month:"Miesic",value:{J:"J - Dzie",M:"M - Miesic",K:"K - Kwarta",P:"P - Procze",R:"R - Rok",D:"D - Dekada"}},placeholder:{symbol:"Wybierz...",city:"Wpisz nazw miasta...",name:"Wybierz organ podatkowy...",custAcc:"Wpisz numer...",custName:"Wpisz nazw..."},commitmentId:"Identyfikacja <br /> zobowizania",additionalOptions:{title:"Opcje dodatkowe",blockResources:"Zablokuj rodki na koncie do czasu przelewu",addReceiver:"Dodaj do ksiki odbiorcw"},tooltips:{taxAuthoritySymbol:"Jeeli wykonujesz przelew do urzdu skarbowego wybierz symbol patnoci z rozwijalnej listy. W innym przypadku - wybierz opcj przelewu do innego organu podatkowego.",commitmentId:"Podaj rodzaj dokumentu, z ktrego wynika naleno podatku np. decyzja, tytu wykonawczy, postanowienie."},submitButtons:{submit:"Dalej",cancel:"Anuluj"}},p2p:{checkboxes:{addToAddressBook:"Dodaj do ksiki odbiorcw",addTemplate:"Zapisz rachunek odbiorcy w ksice",addTemplateTooltip:"W celu otrzymania przelewu odbiorca podaje swj numer rachunku bankowego, ktry zostanie dopisany automatycznie do kontaktu  w ksice"}},mobile:{fromAccount:"Z rachunku",phoneNumber:"Nr telefonu",amount:"Kwota",title:"Tytu",defaultTitle:"Przelew rodkw"},phone:{fromAccount:"Z rachunku",phoneNumber:"Numer telefonu",operator:"Operator sieci",operatorTooltip:"Wybierz z dostpnej listy operatora sieci, do ktrego naley doadowywany numer telefonu. Jeeli nazwa operatora jest wyszarzona oznacza to, e sytem zidentyfikowa go automatycznie.",amount:"Kwota doadowania",amountPlaceholder:"kwota od {{from}} do {{to}}",amountPlaceholderFromZero:"kwota od 0 do {{to}}",amountPlaceholderEmpty:"Wprowad kwot",numberPlaceholderEmpty:"Wprowad numer",title:"Tytu",operatorNotRecognized:"Nie udao si ustali operatora dla tego numeru telefonu. Wybierz waciwego operatora z listy.",additionalOptions:{activateRechargeSMS:"Aktywuj doadowania SMSem z tego numeru telefonu",addReceiver:"Dodaj do ksiki odbiorcw",addToTrustedList:"Dodaj do telefonw zaufanych",agreements:"Owiadczam, e:",agreement1:"chc aby usuga zostaa zrealizowana natychmiast, a doadowanie dostarczone niezwocznie po jego zamwieniu, co bdzie skutkowao utrat prawa do odstpienia od umowy,",agreement2:'zapoznaem si i akceptuj <a target="_blank" href="{{regulationsFileLink}}">Regulamin</a> natychmiastowego doadowania telefonu na kart,',agreement3:"jestem rezydentem Rzeczpospolitej Polskiej.",dataAdministratorInfo:"Administratorem danych osobowych jest Blue Media S.A. ul. Powstacw Warszawy 6, 81-718 Sopot. Podanie danych osobowych jest dobrowolne, ale niezbdne do realizacji usugi. Podstawa prawna, cel, okres przetwarzania danych osobowych oraz uprawnienia przysugujce Uytkownikowi, a take inne wane informacje dotyczce zasad przetwarzania danych osobowych s szczegowo okrelone w Regulaminie."}},addressbook:{warningDialog:{header:"Wybrany kontakt nie jest poczony z profilem facebookowym",description:"Moesz to zrobi w ksice odbiorcw",ok:"Przejd do ksiki odbiorcw",cancel:"Wr do przelewu"}},facebook:{warningDialog:{add:"Przejd do Ustawie",cancel:"Wr do przelewu",header:"Moesz wygodnie i bezpieczenie przelewa rodki do swoich znajomych na Facebook'u",description:"Aby skorzysta z tej opcji aktywuj moliwo wykonywania przeleww do znajomych z Facebooka.",point1:"nie musisz zna numeru rachunku bankowego znajomego",point2:"rodki trafi na rachunek bankowy znajomego",point3:"maksymalna kwota pojedynczej transakcji to",point3amount:"50 pln"},fromAccount:"Z rachunku",amount:"Kwota",title:"Tytu",defaultTitle:"Przelew rodkw",facebookMessageTitle:"Twj znajomy przesya Ci pienidze!",facebookMessageDescription:"Kliknij w link aby odebra {0} PLN.",label:{amount:"Kwota",sender:"Nadawca"},facebookMessageCanceledTitle:"Wiadomo na Facebooka nie zostaa wysana.",facebookMessageCanceledWrongUserTitle:"Wiadomo nie zostaa wysana.",facebookMessageCanceledDescription:"Przelew na kwot <strong>{0} PLN</strong> nie zosta zrealizowany.",facebookMessageCanceledDescriptionWrongUser:"Przelew na kwot  <strong>{0}</strong> PLN  nie zosta zrealizowany.<br/> Wiadomo nie moe by wysana przez uytkownika obecnie zalogowanego na Facebooku.<br/> Zaloguj si na profil facebookowy zsynchronizowany z mBankiem i wykonaj przelew ponownie.",error:{fetchDataHeader:"Wystpi bd podczas pobierania danych aplikacji facebookowych, czy chcesz wykona przelew na rachunek krajowy?",fetchGraphConnectionError:"Aktualnie nie mona nawiza poczenia z aplikacj Facebook, czy chcesz wykona przelew na rachunek krajowy?",fetchGraphDataError:"Nie udao si pobra danych z Facebooka, czy chcesz wykona przelew na rachunek krajowy?"},YouWillBeRedirected:"Zostaniesz przekierowany do Facebooka w celu wysania wiadomoci"},abroad:{fromAccount:"Z rachunku",toAccount:"Na rachunek",address:"Adres",addressNoSwift:"Adres",amount:"Kwota",title:"Tytu przelewu",change:"Zamie na:",series:"Seri przeleww",planned:"Zlecenie stae",additionalOptions:{title:"Opcje dodatkowe",blockResources:"Zablokuj rodki na koncie do czasu przelewu",sendConfirmation:"Wylij e-mail z potwierdzeniem wysania przelewu",addReceiver:"Dodaj do ksiki odbiorcw"},label:{country:"Kraj:",displayName:"Bank:",branch:"Oddzia:",bicSwiftInput:"Numer BIC / SWIFT",bicUnknown:"Nie znasz numeru BIC / SWIFT banku odbiorcy?",bankDetails:"Dane banku odbiorcy",bicWizard:"Odszukaj bank, do ktrego chcesz wysa przelew",bicWzardClose:"Zamknij wyszukiwanie banku, do ktrego chcesz wysa przelew",bicBank:"Bank",bicBranch:"Oddzia",bicBranchInput:"Opis banku i adres",sender:"Nadawca",amount:"Kwota",commissionsAndFees:"Prowizje i opaty",transferType:"Rodzaj przelewu",traditionalMail:"Chc otrzyma potwierdzenie listem (odpatne)",addToTrustedList:"Dodaj do rachunkw zaufanych",changeAccountFee:"Zmie rachunek do pobrania prowizji",optionalTransferDetails:"Opcjonalne szczegy przelewu",referenceNumber:"Nr referencyjny",specialPurpose:"Szczeglny cel",additionalInstructions:"Dodatkowe instrukcje",receiverDetails:"Dane odbiorcy",receiverType:"Typ odbiorcy",receiverCountry:"Kraj odbiorcy",idType:"Typ identyfikatora",idDescription:"Opis identyfikatora",idTypeInput:"Dane",date:"Data",idTypeCountry:"Kraj",idTypeCity:"Miasto",idTypeProvince:"Wojewdztwo",instructionsData:"Tre instrukcji",authority:"Wydany przez",finalReceiverDetails:"Dane ostatecznego odbiorcy",name:"Nazwa/Imi i nazwisko",senderDetails:"Dane nadawcy",primarySenderDetails:"Dane pierwotnego nadawcy",senderType:"Typ nadawcy",select:"Wybierz",principalReceiver:"Pokrywa zleceniodawca oraz odbiorca",principal:"Pokrywa tylko zleceniodawca",principalHelp:"dostpne w droszych przelewach SWIFT",otherBanksCosts:" + koszt in. bankw"},placeholder:{country:"Wybierz kraj...",bicBank:"Wybierz bank...",bicBranch:"Wybierz oddzia...",street:"Ulica i numer",city:"Kod pocztowy i miejscowo"},tooltips:{principalReceiverTooltip:"Jedyna opcja kosztw przy patnociach bez przewalutowania realizowanych w krajach czonkowskich UE patnika i odbiorcy - zgodnie z UUP",bic:"Kod skadajcy si z 8 lub 11 znakw, identyfikujcy bank odbiorcy.",transferTypeSwift:"Pokrycie kosztw przez zleceniodawc oznacza, e zlecajcy przelew zapaci koszty bankw poredniczcych i prowizj w swoim banku. Podzia kosztw przelewu na zleceniodawc i odbiorc oznacza koszty dzielone, czyli prowizj banku zleceniodawcy pokrywa zlecajcy przelew, natomiast ewentualne koszty bankw poredniczcych pokrywa odbiorca przelewu. Jeeli waluta rachunku, z ktrego zlecany jest przelew, jest inna ni waluta przelewu, to kwota kosztw zostanie przeliczona i pobrana w walucie rachunku.",transferTypeSwiftEog:"Podzia kosztw przelewu na zleceniodawc i odbiorc oznacza koszty dzielone, czyli prowizj banku zleceniodawcy pokrywa zlecajcy przelew, natomiast ewentualne koszty bankw poredniczcych pokrywa odbiorca przelewu. Jeeli waluta rachunku, z ktrego zlecany jest przelew, jest inna ni waluta przelewu, to kwota kosztw zostanie przeliczona i pobrana w walucie rachunku.",transferTypeSepa:"Koszty przelewu zgodne z Taryf prowizji i opat mBanku pokrywaj zleceniodawca i odbiorca. Jeeli waluta rachunku, z ktrego zlecany jest przelew, jest inna ni EUR, to kwota kosztw zostanie przeliczona i pobrana w walucie rachunku."},button:{submit:"Dalej",cancel:"Anuluj"}},time:{tomorrow:{morning:"Na jutro rano"}},defaults:{address:{street:"Ulica i numer",city:"Kod pocztowy i miasto"}},forms:{chosen:{noResults:"Brak wynikw",choose:"Wybierz..."},validation:{required:"Pole wymagane",wrongDateFormat:"Zy format daty, uyj: dd.mm.rrrr",phone:"Bdny format numeru telefonu, powinien skada si jedynie z 9 cyfr",phoneZero:"Numer powinien by podany bez zera na pocztku",amountNoDecimal:"Kwota musi by zaokrglona do penych zotych",amountOneDecimal:"Kwota musi by zaokrglona do 10 groszy",maxAmount:"Maksymalna dostpna kwota to {0} PLN",bicBRE:"Dla odbiorcw z grupy mBanku wystarczy podanie numeru BREXPLPW",bicXXX:"Dla nr BIC koczcego si na XXX wystarczy podanie omioznakowego numeru BIC",account:{nan:"Numer rachunku powinien skada si jedynie z 26 cyfr",tooShort:"Numer rachunku jest za krtki, powinien skada si z 26 cyfr",tooLong:"Numer rachunku jest za dugi, powinien skada si z 26 cyfr"},toAccountChanged:"Konto docelowe zostao zmienione.",fromAccountChanged:"Z karty kredytowej nie mona zleci przelewu za granic.",fromAccountChangedWrongCurrency:"Z karty kredytowej nie mona zleci przelewu walutowego.",fromAccountVatExceeded:"Na wybranym rachunku VAT nie posiadasz wystarczajcych rodkw na realizacj przelewu.<br/>Brakujca kwota zostanie pobrana z powizanego rachunku rozliczeniowego.",fromAccountVatInfo:"Jeli pacisz VAT to w pierwszej kolejnoci wykorzystasz rodki z rachunku mBiznes konto VAT.",currencyChangedConversion:"Aby unikn podwjnego przewalutowania, waluta przelewu zostaa zmieniona z {0} na {1}.",currencyChanged:"Waluta zostaa zmieniona na zgodn z rachunkiem rdowym.",dateChanged:"Data zostaa zmieniona na najbliszy dzie roboczy. rodki zostay zablokowane. Moesz anulowa przelew w zakadce Nadchodzce patnoci."}},dashboard:{accessability:{selectTemplate:"Wykonaj przelew do kontaktu {0} z szablonu o nazwie",templateTrusted:"szablon zaufany"},groups:{label:{favourite:"Wykonaj przelew do ulubionych odbiorcw",frequent:"Wykonaj przelew do najczciej wybieranych odbiorcw"}},empty:{title:"Brak ulubionych odbiorcw",buttons:{gotoAdressbook:"Przejd do Ksiki odbiorcw",newContact:"Dodaj nowy kontakt",newFromFacebook:"Dodaj znajomych z Facebooka"}},tooltips:{favoriteList:"Aby stworzy list ulubionych odbiorcw, oznacz gwiazdk wybrane kontakty w ksice odbiorcw."},transferTo:"przelej na",transferToNewAccount:"Przelej na nowe konto"},buttons:{submit:"Dalej",submitPhoneCharge:"Pac za doadowanie telefonu",cancel:"Anuluj",addToBasket:"Dodaj do koszyka",convertToPeriodic:"Zamie na doadowanie stae",yes:"Tak",no:"Nie",ok:"Ok"},currency:{conversion:{warn:"Wybrana waluta jest inna ni waluta rachunku, z ktrego robisz przelew. Operacja wie si z przewalutowaniem. Czy chcesz wykona przelew?"}},fko:{infoFKOMessage:"Uwaga. Od teraz masz osobne Ksiki Odbiorcw dla kadego z profili: indywidualnego i firmowych. Aby korzysta z zapisanych odbiorcw w profilu firmowym, naley wykona import kontaktw.",infoFKOMessageLink:"http://www.mbank.pl/serwis-informacje-o-fko/",infoFKOMessageCheck:"Dowiedz si jak to zrobi",redirectToImporterBtn:"Przejd do Importu"}},mWaluta:"mWaluta"}};return e}),define("transfer/js/i18n/pl-OR",[],function(){var e={or:{errors:{accountNRB:"Numer rachunku musi skada si z 26 cyfr. Popraw numer lub zmie typ szablonu na zagraniczny."},transfer:{confirmation:"podsumowanie przelewu",submenu:{single:"wykonaj przelew jednorazowy",cyclic:"wykonaj przelew cykliczny",cyclicList:"lista przeleww cyklicznych",escrow:"rachunek zastrzeony"},sidebar:{option:{own:"Na wasne konto<br/> w Orange Finanse",splitown:"Midzy wasnymi<br /> rachunkami VAT w Orange Finanse"}},summary:{transferHoldMessage:"W trosce o bezpieczestwo Twoich rodkw, poprosimy Ci o dodatkowe potwierdzenie operacji, ktr zlecie. Za chwil zadzwoni do Ciebie pracownik Orange Finanse, a po poprawnej weryfikacji operacja zostanie wykonana bez koniecznoci ponownego zlecania."}}}};return e}),define("transfer/js/i18n/en-GB",[],function(){var e={"en-GB":{}};return e}),define("transfer/js/i18n/cs-CZ",[],function(){var e={cs:{errors:{amountAddZero:"Chybn formt stky",street:{},accountNRBIncorrect:"Chybn slo tu",input:{regex:"Nesprvn hodnota"},wrongManualDate:"Nesprvn datum nebo datum mimo ppustn rozsah",wrongPeriodM:"Nesprvn msc. Povolen hodnoty jsou 1 a 12",wrongPeriodD:"Nesprvn dekda nebo msc",wrongPeriodR:"Nesprvn rok",wrongPeriodP:"Povolen hodnoty jsou 1 a 2",wrongPeriodJ:"Nesprvn den nebo msc",wrongPeriodK:"Nesprvn tvrtlet. Povolen hodnoty jsou 1 a 4",wrongPeriodLong:"Maximln dlka jsou 4 znaky.",wrongPeriodLongTwo:"Maximln dlka jsou 2 znaky.",fromAccCorrected:"Zdrojov et byl zmnn na et odpovdajc vybranmu profilu",fromAccChangedToTemplate:"Zdrojov et byl zmnn na et odpovdajc vybran ablon",abroadTransferUnavaliable:"V tto chvli se nm neda realizace zahranin platby do zadan banky. Zkuste to prosm pozdji.",emptyPeriodAvailable:". Pokud nechcete uvdt ztovac obdob, ponechte pole nevyplnn.",fromAccNotAllowed:"Zdrojov et byl zmnn na et odpovdajc vybranmu typu operace",auth:{sms:"Zadan SMS kd je nesprvn. Srovnejte slo operace a jej datum se zprvou v SMS.",tan:"Zadan jednorzov heslo je chybn. Srovnejte slo seznamu a hesla sdaji vedle."},smsSenderError:"Odesln SMS kdu nen v tomto okamiku mon.",smsSenderErrorNoPostpone:"Odesln SMS kdu nen v tomto okamiku mon.",integer:"Hodnotou pole me bt jen cel slo",fixedCharacters:"Nepovolen znaky boli odstrnen.",seriesAndRepeatableNotForIban:"Trvalou platbu nen mon zadat na zahranin et.",transferInForeignCurrencyNotForBban:"Pro platbu v ciz mn zadejte slo tu ve formtu IBAN",invalidRecipientName:"Uvedli jste nesprvn nebo nepln nzev pjemce.",invalidRecipientNameForModifyStandingOrder:"Je nm lto, trvalou platbu je  poteba celou zadat znovu, a to s doplnnm nzvem pjemce.",transferInForeignCurrencyNotForBban:"Pro platbu v ciz mn zadejte slo tu ve formtu IBAN",errorTransferNotSent:"Zkontrolujte nzev pjemce, jinak nebude mon platbu provst."},transfer:{formLabel:"Formul platby",favorite:"Oblben pjemce",heading:"Provst platbu",calendar:"kalend",help:"Npovda",suggestToAbroad:"Uveden slo tu neodpovd tuzemskmu nebo tu z Evropsk unie. Chcete provst platbu do zahrani mimo Evropskou unii?",confirmation:"Sumarizace platby",basketTooltip:"Kok plateb je msto, v nm mete shromdit operace a nsledn znich vytvoit balek, kter bude autorizovn k proveden jedinm heslem.",addAddress:"Pidat adresu (voliteln)",addZusOrUsAddress:"Pidat nzev a adresu pltce (voliteln)",showAddress:"Zobrazit adresu pjemce (voliteln)",showAddressNoSwift:"Zobrazit adresu pjemce",showZusOrUsAddress:"Zobrazit nzev a adresu pltce (voliteln)",hideAddress:"Skrt adresu pjemce ",hideZusOrUsAddress:"Skrt nzev a adresu",addToTrustedList:"Pidat kdvryhodnm tm",selfTransferDisabled_onlyOneCurrentAccount:"Mte jen jeden et u mBank, proto je funkce pevod mezi Vaimi ty nedostupn.",selfTransferDisabled_onlyOneAccountInCurrentContext:"Mte jen jeden et ve vybranm kontextu, proto vlastn pevod na tento et nen mon.",transferDateChanged:"Datum bylo zmnno na aktuln.",sharedContactRestrictionInfo:"Funknost plateb byla omezena, ponvad prezentovan kontakt nepochz z vaeho adrese pjemc. Zkoprujte kontakt do vlastnho adrese, aby bylo mon kontakt mnit.",modal:{transferTypeChanged:"Typ platby byl zmnn. Ped potvrzenm platby prosm ovte jej detaily."},submenu:{singleAccessibilityLabel:"Jednorzov platba",single:"Provst jednorzovou platbu",cyclic:"Provst pravidelnou platbu",cyclicList:"Seznam pravidelnch plateb"},notLoaded:"Chyba pi stahovn dat k platb",menu:{domestic:"Pro osobu nebo firmu",own:"Na vlastn et",request:"Podejte o platbu",phone:"Dobt telefon",us:"Daov",zus:"Pro SSZ"},sidebar:{option:{label:"Vbr typu pjemce",own:"Mezi vlastnmi ty u mBank",domestic:"Tuzemsk platba<br /> a do Evropsk unie",facebook:"Na facebook ",facebookError:"Chyba spojen",mobile:"Na mobil ",phone:"Dobt telefon",voip:"Dobt telefon VoIP",abroad:"Platba mimo<br/> Evropskou unii",us:"Do daov<br /> orgn",zus:"Pro SSZ"},limit:{max:"max",currency:"CZK"},add:{domestic:"Nov et pjemce",mobile:"Nov slo pjemce",phone:"Nov slo pjemce",voip:"Nov slo pjemce",abroad:"Nov et pjemce",facebook:"",us:"Nov platba na daov ad",zus:"Nov platba pspvku do SSZ"}},step2:{recipientChanged:"Pjemce byl zmnn na majitele clovho tu.",recipient:"Pjemce",recipientNameChanged:"Pro ely odesln zahraninho pevodu byly nepovolen znaky vnzvu pjemce nahrazeny jejich mezinrodnmi ekvivalenty. ",toAccount:"Na et: ",toBank:"Do banky:",transfers:{title:"Zprva pro pjemce:",phoneNumber:"Na telefonn slo: ",operator:"Opertor:"},fromAccount:"Ztu: ",additionalInfo:"Dal informace",toFacebook:"Odeslan na Facebook",toMobile:"Na mobil",additionalInfoForFacebook:"Prostedky budou zablokovny na tu, dokud se o n pjemce nepihls nebo po dobu dalch 15 dn.",auth:{smsCode:"SMS kd",tanCode:"Jednorzov heslo",nr:".",fromDay:"ze dne"},error:{sms:"Nesprvn SMS kd",tan:"Nesprvn jednorzov heslo"},zus:{toAccount:"Na et: ",title:{social:"Sociln zabezpeen:",health:"Zdravotn pojitn:",fgsp:"Fond prce a Fond garantovanch zamstnaneckch plnn:",pension:"Fond pedasnch dchod:"}},addingToBasket:"Platba bude pidna do Vaeho koku plateb a bude provedena teprve po autorizaci v sekci Kok plateb.",basketInit:"V kok byl automaticky zablokovn po pedchoz relaci. Pro jeho odblokovn zadejte obdren heslo  pot budete moci upravit obsah koku.",authorizeLaterTitle:"Pevod byl odesln kpozdjmu potvrzen.",
authorizeLater:"Operace bude provedena, pokud provedete jej autorizaci v sekci K potvrzen.",authorizeLaterWithoutAddToAddressBook:"Operace bude provedena, pokud provedete jej autorizace v sekci K potvrzen.<br /> Pokyn kpidn na seznam pjemc byl zruen.",idType:{id:"Obansk prkaz",passport:"Pas",PESEL:"Rodn slo",REGON:"I",NIP:"DI",other:"Jin dokument"},paymentType:{A:"A  Poplatek za chyby pltce",D:"D  Pplatek",E:"E  Exekuce",M:"M  odvod vintervalu delm ne 1 msc",S:"S  pspvek za 1 msc",T:"T  odloen termnu",U:"U  spltkov kalend"},checkboxes:{addToAddressBook:"Pidat do adrese",addToTrustedList:"Pidat kdvryhodnm tm",addToTrustedPhones:"Pidat k dvryhodnm",blockResources:"Zablokovat prostedky na tu do doby odesln platby",transferConfirmation:"Potvrzen proveden platby",chargeFeeAccount:"et pro natovn poplatku",referenceNumber:"Referenn slo",specialPurpose:"Zvltn el",additionalInstructions:"Dal pokyny",addToSMSCharge:"Aktivovat dobjen formou SMS ztohoto telefonnho sla ",primarySenderDetails:"daje pvodnho zadavatele",senderDetails:"daje zadavatele",finalReceiverDetails:"daje konenho pjemce",receiverDetails:"daje pjemce",addTemplate:"Uloit et pjemce do adrese"},soPaymentName:"Vlastn nzev platby: ",seriesPaymentName:"Vlastn nzev srie: ",repeatableTransfer:{repeatFrom:"od",repeatTo:"do",untilCancellation:"do okamiku odvoln"}},summary:{addToBasketTitle:"Platba byla pidna do koku",addToBasket:"Platba bude provedena a po autorizaci vkoku.",basketOperations:{one:"Mte novou platbu vkoku na tu ",other:"Mte {{count}} plateb vkoku na tu ",zero:"Nemte platby vkoku na tu "},authorizeBasket:"Autorizovat nyn",successTitle:"Platba byla provedena",successTitleP2p:"Platba byla zadna",successTitleBulk:"Srie plateb byla zadna",successTitlePhoneCharge:"Pokyn kdobit byl pedn opertorovi",successSwiftTitle:"Platba byla zadna",successStandingOrder:"Trval latba byla pijata k proveden",operationLabel:"stka",operationCategorizedLabel:"bude zatovna vuveden den. ",operationSwiftLabel:"bude zatovna.",operationLabelNow:"byla zatovna. ",operationLabelP2p:"bude zatovna vden uveden pjemcem. ",balanceTitle:"Sumarizace",additionalinfo:"Dal informace",amountMayDiffer:"stka odeten z tu se me liit od zablokovan stky v ppad zmny mnovho kurzu ped zatovnm platby.",standingOrderNoLimit:"okamiku odvoln",from:"od",to:"do",and:"a",standingOrderLabel:"bude provdna jednou za ",bulkSummary:"V ppad nedostatku prostedk bude pokus o proveden platby opakovn po dobu 3 dn.",firstLimitReached:"Pkaz kpevodu byl pijat. Pro dokonen proveden operace je poadovno jej potvrzen jinm uivatelem tu. ",secondLimitReached:"V tomto okamiku nemte oprvnn pro zadn tto operace.  Platba byla uloena na seznamu operac ekajcch na autorizaci vKoku plateb.",repeatFromBasketWarning:"Obnoven platba nebyla odstranna ze seznamu operac Na potvrzen. Nezapomete odstranit jej pedchoz verzi, aby se neprovedly ob platby."},form:{title:{domestic:"Pro osobu nebo firmu",own:"Platba na vlastn et",facebook:"Pro osobu nebo firmu",mobile:"Pro osobu nebo firmu",phone:"Pro osobu nebo firmuu",abroad:"Pro osobu nebo firmu",us:"Platba dan nebo pspvk pro SSZ",zus:"Platba dan nebo pspvk pro SSZ"},fromAccount:{balance:"",ownFunds:""}},livesearch:{addnew:"Pokraovat splatbou pro zadanho pjemce",label:"Nzev pjemce",defaultValue:"Zadejte pesn jmno a pjmen, nebo nzev spolenosti pjemce platby",searchContactTip:"Zadejte pesn nzev pjemce platby!",preloaderTooltipText:"Vyhledvn...",selectPerson:"Vyberte pjemce",group:{addressbook:"Vyberte pjemce ze seznamu",facebook:"Vyberte pjemce z Facebooku",recent:"Vyberte pjemce z historie"},titlesCount:{one:"jin",few:"jin",other:"jinch",and:" a "},tooltips:{allABContacts:"Zobrazit vhradn ty ze seznamu pjemc",sectionContacts:"Vyhledvat ve vech kontaktech: ze seznamu pjemc, historie operac, Facebooku (pokud jste pipojen(a)).",bluemediaValidation:"Nepovolen znaky byly nahrazeny. ",trimValidation:"Byly odstranny pebyten bl znaky. "},fieldHelp:"Zadejte pesn jmno a pjmen, nebo nzev spolenosti pjemce platby. Nzev pjemce je odesln do banky pjemce. V ppade neshodnosti nzvu pjemce me bt platba vrcena a stka snena o poplatky jinch bank, ppadn o poplatek za vrcen platby.",fieldHelp2:'Zadejte nzev pjemce dobjen a nsledn vyberte volbu "Pro novho pjemce" - pokud je pjemcem osoba, kter nen uloena na seznamu. Vostatnch ppadech vyberte znmho pjemce ze seznamu nabzenho systmem.'},domestic:{sender:"Odeslatel",fromAccount:"Z tu",accountSourceNumber:"et odeslatele",toAccount:"Na et",address:"Adresa (voliteln)",amount:"stka",title:"Zprva pro pjemce",deliveryTime:{title:"Druh platby",rowSubDesc1:"as doruen",rowSubDesc2:"Poplatky uhrad",commissionsAndFeesOwn:"jen odeslatel",commissionsAndFeesSha:"odeslatel a pjemce"},deliveryDate:"Datum splatnosti",referenceSymbol:"Reference",additionalOptions:{title:"Dal monosti",blockResources:"Zablokovat prostedky na tu do doby vykonn platby",sendConfirmation:"Odeslat e-mail spotvrzenm o proveden platby",addReceiver:"Pidat do adrese",sendSmsOnFail:"Informovat SMS zprvou o neproveden platb"},change:"Zmnit na:",series:"Srii plateb",planned:"Trvalou platbu",tooltips:{deliveryTime:"Doba dodn znamen okamik pipsn platby v bance pjemce. Obvykle jsou prostedky pipsny na et pjemce neprodlen, v nkterch ppadech me banka pjemce potebovat vce asu na pipsn prostedk na et klienta.",seriesTooltip:"Naplnovat srii nkolika nebo vce pevod pro vybranho pjemce vlibovolnch stkch, vlibovolnch termnech a s libovoln stanovenm opakovnm.",recurrentTooltip:"Naplnovat harmonogram pravidelnch plateb pro vybranho pjemce ve stl vi se stanovenm zpsobem opakovn.",seriesTooltipClose:"Uzavt srii plateb.",recurrentTooltipClose:"Uzavt trval pkaz.",toAccountTooltip:"Chcete-li provst tuzemskou platbu v CZK v rmci esk republiky, zadejte et pjemce v nrodnm formtu BBAN, tedy 123456-1234567890/1234. Pro platby v jin mn ne CZK, nebo platby do zahrani, pouijte slo tu pjemce v mezinrodnm formtu IBAN. Platba z tto ablony me bt odeslna pouze do zem Evropsk unie, Norska, Lichtentejnska, Islandu a vcarska."},infoPZ:"Zjistte, zda pro pjemce {0} je mono zdit pohodln inkaso",buttonPZ:"Vytvoit souhlas k inkasu",defaultTitle:"Pevod prostedk",elixir:{doneTime:"Dnes veer  ",label:"Standardn platba"},express:{doneTime:"Za 15 minut   ",label:"Expresn do ve 5000,00 CZK"},sorbnet:{doneTime:"Za 15 minut   ",label:"Expresn SORBNET bez limitu"},symbols:{addSymbolsCheckbox:"Platebn symboly",expandSymbols:"Platebn symboly (zobrazit)",collapseSymbols:"Platebn symboly (skrt)"},pepLabel:"el platby a pvod prostedk",placeholders:{symbcon:"Konstantn symbol",symbvar:"Variabiln symbol",symbspc:"Specifick symbol",choosePurpose:"Vyberte el obchodu",chooseIncsour:"Vyberte pvod prostedk",chooseBank:"Vyberte kd banky",address:"Adresa pjemce (ulice)",city:"PS, obec pjemce",country:"Stt",toAccount:"Zadejte slo tu ve tvaru 123456-1234567890/1234, nebo IBAN"}},standingOrder:{repeatEach:"Opakovat jednou za",tillRevokation:"do okamiku odvoln",from:"od",to:"do",noOfPaymentsBegin:"Bude provedeno",noOfPaymentsEnd:"plateb.",message:"Plnovan platba pipadajc na voln den, bude provedena ped volnm dnem.",select:"Vybrat"},bulkPayment:{addNewTransfer:"Pidat dal platbu pro stejnho pjemce"},zus:{selectZus:"esk sprva socilnho zabezpeen",total:"Celkem",fromAccount:"Z tu",nameAndAddress:"Pltce",nip:"DI",idType:"Typ identifiktoru",series:"slo",declaration:{title:"Prohlen",month:"Msc",year:"Rok",number:"slo"},paymentType:"Typ platby",decisionNumber:".rozhodnut/smlouvy/exekunho titulu",additionalOptions:{title:"Dal monosti",blockResources:"Zablokovat prostedky na tu do doby vykonn platby",addReceiver:"Pidat do adrese"},errors:{must_be_at_least_one:"Mus bt vyplnna nejmn jedna stka."}},us:{taxAuthoritySymbol:{title:"Daov orgn",symbol:"Symbol formule finannho adu nebo celnho adu",toAnother:"Pro jin daov orgn"},taxAuthorityCity:"Obec",taxAuthorityName:"Nzev daovho orgnu",taxAuthorityAccountNumber:"slo tu daovho orgnu",amount:"stka",fromAccount:"Z tu",nameAndAddress:"Pltce",noTaxAuthorityBranches:"ty splujc uveden kritria vyhledvn neexistuj",idType:{title:"Typ identifiktoru",type:"Identifiktor",series:"slo"},period:{title:"Ztovac obdob",subSchema:"Hodnota",period:"Obdob",year:"Rok",month:"Msc",value:{J:"J - Den",M:"M - Msc",K:"K - tvrtlet",P:"P - Pololet",R:"R - Rok",D:"D - Dekda"}},placeholder:{symbol:"Vybrat...",city:"Zadejte nzev msta...",name:"Zvolte daov orgn...",custAcc:"Zadejte slo...",custName:"Zadejte nzev..."},commitmentId:"Identifikace <br /> zvazku",additionalOptions:{title:"Dal monosti",blockResources:"Zablokovat prostedky na tu do doby vykonn platby",addReceiver:"Pidat do adrese"},tooltips:{taxAuthoritySymbol:"Pokud provdte platbu pro finann ad, zvolte symbol platby zrolovacho menu. V ostatnch ppadech zvolte monost platba pro jin daov orgn.",commitmentId:"Uvete druh dokumentu, znho vyplv ve dan, nap. rozhodnut, exekun titul, ustanoven."},submitButtons:{submit:"Odeslat platbu",cancel:"Zruit"}},p2p:{checkboxes:{addToAddressBook:"Pidat do adrese",addTemplate:"Uloit et pjemce do adrese",addTemplateTooltip:"Za elem pijet platby uvede pjemce slo svho bankovnho tu, kter bude automaticky pidno do adrese"}},mobile:{fromAccount:"Z tu",phoneNumber:"Telefonn slo",amount:"stka",title:"Zprva pro pjemce",defaultTitle:"Pevod prostedk"},phone:{fromAccount:"Z tu",phoneNumber:"Telefonn slo",operator:"Opertor st",operatorTooltip:"Zvolte z dostupnho seznamu opertora st, do n pat dobjen telefonn slo",amount:"stka dobit",amountPlaceholder:"stka od {{from}} do {{to}}",amountPlaceholderFromZero:"stka od 0 do {{to}}",amountPlaceholderEmpty:"Zadat stku",title:"Nzev",operatorNotRecognized:"Dle telefonnho sla se nezdailo identifikovat opertora. Vyberte sprvnho opertora ze zeznamu.",additionalOptions:{activateRechargeSMS:"Aktivovat dobjen formou SMS ztohoto telefonnho sla ",addReceiver:"Pidat na seznam pjemc",addToTrustedList:"Pidat k dvryhodnm"}},addressbook:{warningDialog:{header:"Vybran kontakt nen pipojen na FB",description:"Mete to provst v adresi",ok:"Pejt do adrese ",cancel:"Zpt k platb"}},facebook:{warningDialog:{add:"Jt do Nastaven",cancel:"Zpt k platb",header:"Mete pohodln a bezpen pevdt penze svm ptelm na Facebooku. ",description:"Pro vyuit tto monosti aktivujte monost provdn pevod ptelm z Facebooku.",point1:"nemuste znt slo bankovnho tu dan osoby",point2:"prostedky budou pipsny na bankovn et vybran osoby",point3:"maximln stka jednotliv transakce in",point3amount:"2000 CZK"},fromAccount:"Z tu",amount:"stka",title:"Nzev",defaultTitle:"Pevod prostedk",facebookMessageTitle:"V ptel Vm posl penze!",facebookMessageDescription:"Kliknte na odkaz pro pevzet {0} CZK.",label:{amount:"stka",sender:"Odeslatel"},facebookMessageCanceledTitle:"Zprva na Facebook nebyla odeslna.",facebookMessageCanceledWrongUserTitle:"Zprva nebyla odeslna.",facebookMessageCanceledDescription:"Platby stky <strong>{0} CZK</strong> nebyla provedena.",facebookMessageCanceledDescriptionWrongUser:"Platba stky <strong>{0}</strong> CZK  nebyla provedena.<br/> Zprva neme bt zaslna uivatelem, kter je nyn pihlen na Facebook.<br/> Pihlaste se na facebookov profil synchronizovan s mBank a opakujte platbu.",error:{fetchDataHeader:"Dolo k chyb pi stahovn dat zfacebookovch aplikac, chcete provst platbu na tuzemsk et?",fetchGraphConnectionError:"Vtomto okamiku nelze navzat spojen s aplikac Facebook, chcete provst platbu na tuzemsk et?",fetchGraphDataError:"Nepodailo se sthnout data z Facebooku, chcete provst platbu na tuzemsk et?"},YouWillBeRedirected:"Za elem odesln sprvy, budete pesmrovn/a na Facebook."},abroad:{fromAccount:"Z tu",toAccount:"Na et",address:"Adresa",addressNoSwift:"Adresa",amount:"stka",title:"Zprva pro pjemce",change:"Zmnit na:",series:"Srii plateb",planned:"Trval platba",additionalOptions:{title:"Dal monosti",blockResources:"Zablokovat prostedky na tu do doby vykonn platby",sendConfirmation:"Odeslat e-mail spotvrzenm o proveden platby",addReceiver:"Pidat do adrese"},label:{country:"Stt: ",displayName:"Banka:",branch:"Poboka:",bicSwiftInput:". BIC / SWIFT",bicUnknown:"Neznte . BIC / SWIFT banky pjemce?",bankDetails:"daje banky pjemce",bicWizard:"Vyhledat banku, do n chcete provst platbu",bicBank:"Banka",bicBranch:"Poboka",bicBranchInput:"Popis banky a adresa",sender:"Odeslatel",amount:"stka",commissionsAndFees:"Poplatky",transferType:"Druh platby",traditionalMail:"Chci obdret potvrzen potou (zpoplatnno)",addToTrustedList:"Pidat kdvryhodnm tm",changeAccountFee:"Zmnit et pro natovn poplatku",optionalTransferDetails:"Voliteln detaily platby",referenceNumber:"Referenn slo",specialPurpose:"Zvltn el",additionalInstructions:"Dal pokyny",receiverDetails:"daje pjemce",receiverType:"Typ pjemce",receiverCountry:"Stt pjemce",idType:"Typ identifiktoru",idDescription:"Popis identifiktoru",idTypeInput:"daje",date:"Datum",idTypeCountry:"Stt",idTypeCity:"Msto",idTypeProvince:"Kraj",instructionsData:"Obsah pokynu",authority:"Vydan",finalReceiverDetails:"daje konenho pjemce",name:"Nzev/jmno a pjmen ",senderDetails:"daje odeslatele",primarySenderDetails:"daje pvodnho odeslatele",senderType:"Typ odeslatele",select:"Vybrat",principalReceiver:"Hrad zadavatel a pjemce",principal:"Hrad jen zadavatel",principalHelp:"dostupn u zahraninch plateb SWIFT",otherBanksCosts:" + nklady jinch bank"},placeholder:{country:"Zvolte stt...",bicBank:"Zvolte banku...",bicBranch:"Zvolte poboku...",street:"Ulice a slo",city:"PS a obec"},tooltips:{bic:"Kd obsahujc 8 nebo 11 znak, identifikujc banku pjemce.",transferTypeSwift:"hrada nklad zadavatelem znamen, e zadavatel platby uhrad nklady bank zajiujcch zprostedkovn a provizi ve sv bance. Rozdlen nklad na vykonn platby mezi zadavatele a pjemce znamen sdlen nklad, tj. poplatky banky zadavatele hrad zadavatel a poplatky banky pjemce hrad pjemce. ",transferTypeSwiftEog:"Rozdlen nklad na vykonn platby mezi zadavatele a pjemce znamen sdlen nklad, tj. poplatky banky zadavatele hrad zadavatel a poplatky banky pjemce hrad pjemce. ",transferTypeSepa:"Nklady na platbu dle sazebnku poplatk mBank hrad zadavatel i pjemce. Pokud je mna tu, znj je platba provdna, jin ne EUR, bude stka nklad pepotena a natovna vmn, vn je veden et."},button:{submit:"Odeslat platbu",cancel:"Zruit"}},time:{tomorrow:{morning:"Na ztra rno"}},defaults:{address:{street:"Ulice a slo",city:"PS a msto"}},forms:{chosen:{noResults:"dn vsledky",choose:"Vybrat"},validation:{wrongDateFormat:"Nesprvn forma datum. Pouijte dd.mm.rrrr.",required:"Povinn pole",phone:"Chybn formt telefonnho sla, mus obsahovat pouze 9 slic",phoneZero:"slo je nutno zadat bez nuly na zatku",amountNoDecimal:"stka mus bt zaokrouhlen na 1 K",amountOneDecimal:"stka mus bt zaokrouhlen na 0,1 K",maxAmount:"Maximln dostupn stka in {0} CZK",bicBRE:"Pro pjemce ze skupiny mBank sta uvst slo BREXPLPW",bicXXX:"Pro . BIC konc XXX sta uvst slo BIC obsahujc osm znak. ",account:{nan:"slo tu mus obsahovat min 5 a max 16 slic",tooShort:"slo tu je pli krtk, mus obsahovat min 5 a max 16 slic",tooLong:"slo tu je pli dlouh, mus obsahovat min 5 a max 16 slic"},toAccountChanged:"et pjemce byl zmnn.",fromAccountChanged:"Z kreditn karty nen platba do zahrani povolena.",fromAccountChangedWrongCurrency:"Platbu v ciz mn nen mon zadat z tu kreditn karty.",currencyChangedConversion:"Abyste pedeli konverzi mn, mna platby byla zmnna na {1}. Pro proveden platby v ciz mn zadejte slo tu pjemce ve formtu IBAN.",currencyChanged:"Mna platby byla zmnna v souladu s mnou tu."}},dashboard:{groups:{label:{favourite:"Provst platbu pro oblben pjemce",frequent:"Provst platbu pro nejastji pouvan pjemce"}},empty:{title:"dn oblben pjemci",buttons:{gotoAdressbook:"Pejt do Adrese ",newContact:"Pidat nov kontakt",newFromFacebook:"Pidat ptele z Facebooku"}},tooltips:{favoriteList:"Pro vytvoen seznamu oblbench pjemc oznate hvzdikou vybran kontakty v adresi."},transferTo:"Provst platbu na",transferToNewAccount:"Provst platbu na svho novho tu"},buttons:{submit:"Odeslat platbu",cancel:"Storno",addToBasket:"Pidat do koku",yes:"Ano",no:"Ne",ok:"Ok"},currency:{conversion:{warn:"Vybran mna platby je jin ne mna tu, ze kterho dlte platbu. Chcete provst platbu v ciz mne?"}}}}};return e}),define("transfer/js/i18n/sk-SK",[],function(){var e={sk:{errors:{amountAddZero:"Chybn formt sumy",street:{},accountNRBIncorrect:"slo tu je nesprvne",input:{regex:"Nesprvna hodnota"},wrongManualDate:"Nesprvny dtum alebo dtum mimo povolenho rozsahu",wrongPeriodM:"Nesprvny mesiac. Povolen hodnoty s od 1 do 12",wrongPeriodD:"Nesprvna dekda alebo mesiac",wrongPeriodR:"Nesprvny rok",wrongPeriodP:"Povolen hodnoty s 1 alebo 2",wrongPeriodJ:"Nesprvny de alebo mesiac",wrongPeriodK:"Nesprvny kvartl. Povolen hodnoty s od 1 do 4",wrongPeriodLong:"Maximlna dka s 4 znaky",wrongPeriodLongTwo:"Maximlna dka s 2 znaky",fromAccCorrected:"et odosielatea bol zmenen na et zodpovedajci zvolenmu profilu.",fromAccChangedToTemplate:"et odosielatea bol zmenen na et zodpovedajci zvolenej ablne.",abroadTransferUnavaliable:"Prve teraz sa nm nedar zrealizova zahranin platbu do zadanej banky. Skste prosm neskr.",emptyPeriodAvailable:". Ak nechcete uvies ztovacie obdobie, polia nechajte nevyplnen.",fromAccNotAllowed:"et odosielatea bol zmenen na et zodpovedajci zvolenmu typu opercie.",auth:{sms:"Zadan SMS kd je nesprvny. Porovnajte slo a dtum opercie s obsahom SMS sprvy.",tan:"Zadan jednorazov heslo je nesprvne. Porovnajte slo zoznamu a hesla s veda uvedenmi dajmi."},smsSenderError:"Momentlne nie je mon odosla SMS kd.",smsSenderErrorNoPostpone:"Momentlne nie je mon odosla SMS kd.",integer:"Do poa mono zada len cel sla.",fixedCharacters:"Nepovolen znaky boli odstrnen.",seriesAndRepeatableNotForIban:"Trval platbu nie je mon zada na zahranin et.",invalidRecipientName:"Zadali ste nesprvny alebo nepln nzov prijmatea.",invalidRecipientNameForModifyStandingOrder:"Je nm to, trval platbu je potrebn zada cel znovu, s doplnenm nzvom prijmatea.",errorTransferNotSent:"Skontrolujte nzov prijmatea, inak nebude mon platbu vykona."},transfer:{formLabel:"Formulr platby",favorite:"Obben prijmate",heading:"Vykona platbu",calendar:"kalendr",help:"Pomocnk",suggestToAbroad:"Zadan slo tu nie je tuzemsk et, chcete vykona platbu do zahraniia?",confirmation:"Sumarizcia platby",basketTooltip:"Kok platieb sli na ukladanie platieb. Z uloench platieb mete vytvori balek, ktor autorizujete jednm SMS kdom.",addAddress:"Zobrazi adresu prijmatea (voliten)",addZusOrUsAddress:"Prida nzov a adresu odosielatea (voliten)",showAddress:"Zobrazi adresu prijmatea (voliten)",showAddressNoSwift:"Zobrazi adresu prijmatea",showZusOrUsAddress:"Zobrazi nzov a adresu odosielatea (voliten)",hideAddress:"Zbali adresu prijmatea",hideZusOrUsAddress:"Zbali nzov a adresu",addToTrustedList:"Prida k dveryhodnm tom",selfTransferDisabled_onlyOneCurrentAccount:"V mBank mte len jeden et, preto platby medzi vlastnmi tami nie s k dispozcii.",selfTransferDisabled_onlyOneAccountInCurrentContext:"V tomto kontexte mte iba jeden et, preto nie je mon vykona platbu medzi vlastnmi tami.",transferDateChanged:"Dtum bol zmenen na aktulny.",sharedContactRestrictionInfo:"Prezentovan kontakt nie je z vho adresra, a preto bola funkcionalita platieb obmedzen. Skoprujte kontakt do vlastnho adresra, aby ste mohli kontakt editova.",submenu:{singleAccessibilityLabel:"Jednorazov platba",single:"Vykona jednorazov platbu",cyclic:"Vykona pravideln platbu",cyclicList:"Zoznam pravidelnch platieb"},notLoaded:"Chyba pri preberan dajov platby",menu:{domestic:"Osobe alebo firme",own:"Na vlastn et",request:"Poiada o platbu",phone:"Dobi telefn",us:"Daov",zus:"Do zdravotnej/socilnej poisovne"},sidebar:{option:{label:"Vber typu prijmatea",own:"Medzi vlastnmi tami v mBank",domestic:"SEPA platba",facebook:"Na Facebook",facebookError:"Chyba spojenia",mobile:"Na mobil",phone:"Dobi mobil",voip:"Dobi mobil VoIP",abroad:"Do zahraniia",us:"Daovmu<br /> radu",zus:"Do socilnej/zdravotnej poisovne"},limit:{max:"max.",currency:"EUR"},add:{domestic:"Nov et prijmatea",mobile:"Nov slo prijmatea",phone:"Nov slo prijmatea",voip:"Nov slo prijmatea",abroad:"Nov et prijmatea",facebook:"",us:"Nov platba na daov rad",zus:"Nov platba do Socilnej poisovne"}},step2:{recipientChanged:"Prijmate bol zmenen na majitea cieovho tu.",recipient:"Prijmate",recipientNameChanged:"Nepovolen znaky v nzve prijmatea boli nahraden ich medzinrodnmi ekvivalentmi.",toAccount:"Na et:",toBank:"Do banky:",transfers:{title:"Sprva pre prijmatea:",phoneNumber:"Na mobil:",operator:"Opertor:"},fromAccount:"Z tu:",additionalInfo:"Doplujce informcie",toFacebook:"Odoslan na Facebook",toMobile:"Na mobil",additionalInfoForFacebook:"Prostriedky na platbu bud zablokovan na vaom te, km sa o ne prijmate neprihlsi, maximlne vak 15 dn.",auth:{smsCode:"SMS kd",tanCode:"Jednorazov heslo",nr:".",fromDay:"zo da"},error:{sms:"Nesprvny SMS kd",tan:"Nesprvne jednorazov heslo"},zus:{toAccount:"Na et:",title:{social:"Socilne zabezpeenie:",health:"Zdravotn poistenie:",fgsp:"Pracovn fond a garann fond:",pension:"Dchodkov zabezpeenie"}},addingToBasket:"Platba bude pridan do vho koka platieb, ale vykonan bude a po autorizcii v asti Kok platieb.",basketInit:"V kok bol automaticky zablokovan po uplynut bezpenostnho asovho limitu. Ak ho chcete odblokova, zadajte doruen heslo a budete mc upravi obsah koka.",authorizeLaterTitle:"Platba bola odoslan na neskorie potvrdenie.",authorizeLater:"Opercia bude vykonan, ak ju autorizujete v asti Na potvrdenie.",authorizeLaterWithoutAddToAddressBook:"Opercia bude vykonan, ak ju autorizujete v asti Na potvrdenie.<br />Pokyn na uloenie do adresra bol zruen.",idType:{id:"Obiansky preukaz",passport:"Pas",PESEL:"Rodn slo",REGON:"IO",NIP:"DI",other:"In dokument"},paymentType:{A:"A  dodaton poplatok za chyby poplatnka",D:"D  dodaton poplatok",E:"E  exekcia",M:"M  odvod za viac ne 1 mesiac",S:"S  odvod za 1 miesiac",T:"T  odroenie termnu",U:"U  spltkov kalendr"},checkboxes:{addToAddressBook:"Prida do adresra",addToTrustedList:"Prida k dveryhodnm tom",addToTrustedPhones:"Prida k dveryhodnm tel. slam",blockResources:"Zablokova prostriedky na te, km bude platba aka na vykonanie",transferConfirmation:"Potvrdenie o vykonan platby",chargeFeeAccount:"Poplatok sa ztuje z tu",referenceNumber:"Referenn slo",specialPurpose:"pecilny el platby",additionalInstructions:"Doplujce intrukcie",addToSMSCharge:"Aktivujte si dobitie mobilu odoslanm SMS sprvy z tohto telefnneho sla",primarySenderDetails:"daje o pvodnom odosielateovi",senderDetails:"daje o odosielateovi",finalReceiverDetails:"daje o poslednom prijmateovi",receiverDetails:"daje o prijmateovi",addTemplate:"Uloi et prijmatea do adresra"},soPaymentName:"Vlastn nzov platby:",seriesPaymentName:"Vlastn nzov srie:",repeatableTransfer:{repeatFrom:"od",repeatTo:"do",untilCancellation:"do momentu odvolania"}},summary:{addToBasketTitle:"Platba bola pridan do koka",addToBasket:"Platba v koku nebude vykonan, km ju neautorizujete.",basketOperations:{one:"V koku na te mte nov platbu ",other:"V koku na te mte {{count}} platieb ",zero:"Na te nemte iadne platby V koku. "},authorizeBasket:"Autorizova teraz",successTitle:"Platba bola spene vykonan",successTitleP2p:"Platba bola spene zadan",successTitleBulk:"Sria platieb bola spene zadan",successTitlePhoneCharge:"Prkaz na dobitie bol odoslan opertorovi",successSwiftTitle:"Platba bola spene zadan",successStandingOrder:"Trval platba bola spene zadan.",operationLabel:"Suma",operationCategorizedLabel:"bude zatovan v urenom dni",operationSwiftLabel:"bude zatovan.",operationLabelNow:"bola zatovan.",operationLabelP2p:"bude zatovan v dni urenom prijmateom.",balanceTitle:"Sumarizcia",additionalinfo:"Doplujce informcie",amountMayDiffer:"Odpsan suma z tu sa me li od zablokovanej sumy, ak pred zatovanm platby djde ku zmene vmennho kurzu.",standingOrderNoLimit:"momentu odvolania",from:"od",to:"do",and:"a",standingOrderLabel:"bude vykonvan kad ",bulkSummary:"V prpade nedostatku prostriedkov na te v uren de , sa bude pokus o vykonanie trvalej platby opakova ete 3 dni.",firstLimitReached:"Aby mohla by platba vykonan, mus ju autorizova in pouvate tu.",secondLimitReached:"Momentlne nemte oprvnenie vykona tto operciu. Opercia ak na autorizciu v Koku platieb.",repeatFromBasketWarning:"Obnoven platba nebola odstrnen zo zoznamu operci Na potvrdenie. Nezabudnite odstrni jej predchdzajcu verziu, aby sa nevykonali obe platby."},form:{title:{domestic:"Osobe alebo firme",own:"Na vlastn et",facebook:"Osobe alebo firme",mobile:"Osobe alebo firme",phone:"Osobe alebo firme",abroad:"Osobe alebo firme",us:"Prevod dane alebo odvodu",zus:"Prevod dane alebo odvodu"},fromAccount:{balance:"dispo: ",ownFunds:"vlastn: "}},livesearch:{addnew:"Pokraova v platbe zadanmu prijmateovi",label:"Nzov prijmatea",defaultValue:"Zadajte presn meno a priezvisko alebo nzov firmy prijmatea platby",searchContactTip:"Zadajte nzov prijmatea",preloaderTooltipText:"Vyhadvanie...",selectPerson:"Vyberte prijmatea",group:{addressbook:"Vybra prijmatea z adresra",facebook:"Vybra prijmatea z Facebooku",recent:"Vybra prijmatea z histrie"},titlesCount:{one:"in",few:"in",other:"inch",and:" a "},tooltips:{allABContacts:"Zobrazi iba kontakty z adresra",sectionContacts:"Hada vo vetkch kontaktoch: v adresri, histrii, Facebooku (ak ste pripojen).",bluemediaValidation:"Nepovolen znaky boli nahraden.",trimValidation:"Nadbyton biele znaky boli odstrnen."},fieldHelp:"Ak chcete odosla platbu prijmateovi, ktormu ste ete neodosielali platbu, alebo nie je uloen v adresri, tak zadajte nzov prijmatea platby a potom vyberte monos Novmu prijmateovi. Inak vyberte prijmatea zo zoznamu, ktor vm systm ponkne.",fieldHelp2:"Ak je prijmateom dobitia osoba, ktor nie je uloen v adresri, tak zadajte nzov prijmatea dobitia a potom vyberte monos Novmu prijmateovi. Inak vyberte prijmatea zo zoznamu, ktor vm systm ponkne."},domestic:{sender:"Odosielate",fromAccount:"Z tu",accountSourceNumber:"et odosielatea",toAccount:"Na et",toAccountIBAN:"Na et IBAN",toAccountBBAN:"Na et BBAN",address:"Adresa (voliten)",amount:"Suma",title:"Sprva pre prijmatea",referenceSymbol:"Referencia",deliveryTime:{title:"Typ platby",rowSubDesc1:"as doruenia",rowSubDesc2:"Poplatky zaplat",commissionsAndFeesOwn:"len odosielate",commissionsAndFeesSha:"odosielate a prjmate"},deliveryDate:"Dtum splatnosti",additionalOptions:{title:"Doplujce monosti",blockResources:"Zablokova prostriedky na te, km platba ak na vykonanie",sendConfirmation:"Posla e-mail s potvrdenm o vykonan platby",addReceiver:"Prida do adresra",sendSmsOnFail:"Informova SMS sprvou o nevykonanej platbe"},change:"Zmeni na:",series:"sriu platieb",planned:"Trval platba",tooltips:{deliveryTime:"asom doruenia sa rozumie as doruenia platby do banky prijmatea. Prijat platba sa zvyajne na te prijmatea zatuje v de, v ktorom banka prijmatea prijala platbu na svoj et.",seriesTooltip:"Naplnujte si sriu platieb alebo viacero platieb v vybranmu prijmateovi v ubovonej sume, v ubovonch doch a s ubovonou frekvenciou.",recurrentTooltip:"Naplnujte si harmonogram pravidelnch platieb vybranmu prijmateovi v pevne stanovenej vke a frekvencii.",seriesTooltipClose:"Zavrie sriu platieb ",recurrentTooltipClose:"Zavrie trval platbu",toAccountTooltipSK:"Zadajte slo tu prijmatea v medzinrodnom tvare IBAN."},infoPZ:"Overte, i pre prijmatea {0} je mon nastavi pohodln inkaso",buttonPZ:"Vytvori inkasn prkaz",defaultTitle:"Prevod prostriedkov",elixir:{doneTime:"Dnes veer  ",label:"tandardn prevod ELIXIR"},express:{doneTime:"O 15 mint  ",label:"Expresn do 5000,00 EUR"},sorbnet:{doneTime:"O 15 mint  ",label:"Expresn bez limitu SORBNET"},symbols:{addSymbolsCheckbox:"Platobn symboly",expandSymbols:"Platobn symboly (rozbali)",collapseSymbols:"Platobn symboly (zbali)"},pepLabel:"el platby a pvod prostriedkov",placeholders:{symbcon:"Kontantn symbol",symbvar:"Variabiln symbol",symbspc:"pecifick symbol",choosePurpose:"Vyberte el obchodu",chooseIncsour:"Vyberte pvod prostriedkov",chooseBank:"Vyberte kd banky",address:"Adresa prjemcu (ulica)",city:"PS, obec/mesto prjemcu",country:"tt",toAccount:"Zadajte tuzemsk alebo zahranin IBAN prijmatea platby"}},standingOrder:{repeatEach:"Opakova kad",tillRevokation:"do momentu odvolania",from:"od",to:"do",noOfPaymentsBegin:"Bude vykonanch",noOfPaymentsEnd:"platieb.",message:"Plnovan platba pripadajca na von de, bude vykonan pred vonm dom.",select:"Vybra"},bulkPayment:{addNewTransfer:"Prida aliu platbu tomuto prijmateovi"},zus:{selectZus:"Socilna/zdravotn poisova",total:"Spolu",fromAccount:"Z tu",nameAndAddress:"Platca",nip:"DI",idType:"Typ identifiktora",series:"slo",declaration:{title:"Vyhlsenie",month:"Mesiac",year:"Rok",number:"slo"},paymentType:"Typ vkladu",decisionNumber:". rozhod./zmluvy/vykonvacieho titulu",additionalOptions:{title:"Doplujce monosti",blockResources:"Zablokova prostriedky na te, km platba ak na vykonanie",addReceiver:"Prida do adresra prijmateov"},errors:{must_be_at_least_one:"Aspo jedna suma mus by vyplnen."}},us:{taxAuthoritySymbol:{title:"Daov orgn",symbol:"Symbol formulra daovho alebo colnho radu",toAnother:"Inmu daovmu orgnu"},taxAuthorityCity:"Miesto",taxAuthorityName:"Nzov daovho orgnu",taxAuthorityAccountNumber:"slo tu daovho radu",amount:"Suma",fromAccount:"Z tu",nameAndAddress:"Platca",noTaxAuthorityBranches:"Nenali sa ty vyhovujce zadanmu kritriu vyhadvania.",idType:{title:"Typ identifiktora",type:"Identifiktor",series:"slo"},period:{title:"Ztovacie obdobie",subSchema:"Hodnota",period:"Obdobie",year:"Rok",month:"Mesiac",value:{J:"J  de",M:"M  mesiac",K:"K  kvartl",P:"P  polrok",R:"R  rok",D:"D  dekda"}},placeholder:{symbol:"Vybra...",city:"Zadajte nzov mesta...",name:"Vyberte daov orgn...",custAcc:"Zadajte slo...",custName:"Zadajte nzov..."},commitmentId:"Identifikcia <br /> zvzku",additionalOptions:{title:"Doplujce monosti",blockResources:"Zablokova prostriedky na te, km platba ak na vykonanie",
addReceiver:"Prida do adresra prijmateov"},tooltips:{taxAuthoritySymbol:"Ak vykonvate platbu na daov rad, z rozbaovacieho zoznamu vyberte symbol platby. V opanom prpade vyberte monos prevodu na in daov orgn.",commitmentId:"Zadajte typ dokumentu, z ktorho vyplva daov povinnos, napr. rozhodnutie, vykonvac titul, uznesenie."},submitButtons:{submit:"Odosla platbu",cancel:"Zrui"}},p2p:{checkboxes:{addToAddressBook:"Prida do adresra",addTemplate:"Uloi et prijmatea do adresra",addTemplateTooltip:"Aby mohol prijmate platbu prija,  zad slo svojho bankovho tu, ktor sa automaticky ulo ku kontaktu v adresri."}},mobile:{fromAccount:"Z tu",phoneNumber:"Telefnne slo",amount:"Suma",title:"Popis",defaultTitle:"Prevod prostriedkov"},phone:{fromAccount:"Z tu",phoneNumber:"Telefnne slo",operator:"Opertor",operatorTooltip:"Z dostupnho zoznamu vyberte opertora siete, do ktorej patr dobjan telefnne slo",amount:"Suma dobitia",amountPlaceholder:"suma od {{from}} do {{to}}",amountPlaceholderFromZero:"suma od 0 do {{to}}",amountPlaceholderEmpty:"Zadajte sumu",title:"Popis",operatorNotRecognized:"Poda telefnneho sla sa nepodarilo identifikova opertora. Vyberte sprvneho opertora zo zoznamu.",additionalOptions:{activateRechargeSMS:"Aktivujte dobitie odoslanm SMS sprvy z tohto telefnneho sla",addReceiver:"Prida do adresra",addToTrustedList:"Prida k dveryhodnm"}},addressbook:{warningDialog:{header:"Vybran kontakt nie je prepojen s FB",description:"Mete to urobi v adresri",ok:"Prejs do adresru",cancel:"Sp k platbe"}},facebook:{warningDialog:{add:"Prejs k Nastaveniam",cancel:"Sp k platbe",header:"Priateom na Facebooku mete pohodlne a bezpene prevdza peniaze",description:"Ak chcete vyui tto funkciu, aktivujte monos odosielania platieb priateom na Facebooku.",point1:"Nemuste pozna slo bankovho tu priatea",point2:"peniaze bud poukzan na bankov et priatea",point3:"maximlna suma jednej transakcie je",point3amount:"50 EUR"},fromAccount:"Z tu",amount:"Suma",title:"Popis",defaultTitle:"Prevod prostriedkov",facebookMessageTitle:"V priate vm posiela peniaze!",facebookMessageDescription:"Kliknutm na odkaz si preberte {0} EUR.",label:{amount:"Suma",sender:"Odosielate"},facebookMessageCanceledTitle:"Sprva na Facebook nebola odoslan.",facebookMessageCanceledWrongUserTitle:"Sprva nebola odoslan.",facebookMessageCanceledDescription:"Prevod sumy <strong>{0} EUR</strong> nebol zrealizovan.",facebookMessageCanceledDescriptionWrongUser:"Prevod sumy <strong>{0}</strong> EUR nebol zrealizovan.<br/> Pouvate, ktor je prve prihlsen na Facebooku, neme odosla sprvu.<br/> Prihlste sa na facebookov profil sychronizovan s mBank a vykonajte platbu znovu.",error:{fetchDataHeader:"Pri preberan dajov facebookovch aplikci dolo k chybe. Chcete vykona platbu na tuzemsk et?",fetchGraphConnectionError:"Momentlne nie je mon spoji sa s aplikciou Facebook. Chcete vykona platbu na tuzemsk et?",fetchGraphDataError:"Nepodarilo sa prevzia daje z Facebooku. Chcete vykona pplatbu na tuzemsk et?"},YouWillBeRedirected:"Za elom odoslania sprvy, budete presmerovan na Facebook."},abroad:{fromAccount:"Z tu",toAccount:"Na et",address:"Adresa",addressNoSwift:"Adresa",amount:"Suma",title:"Popis",change:"Zmeni na:",series:"sriu platieb",planned:"Trval platba",additionalOptions:{title:"Doplujce monosti",blockResources:"Zablokova prostriedky na te, km platba ak na vykonanie",sendConfirmation:"Posla e-mail s potvrdenm o vykonan platby",addReceiver:"Prida do adresra"},label:{country:"tt:",displayName:"Banka:",branch:"Poboka:",bicSwiftInput:"BIC/SWIFT",bicUnknown:"Nepoznte BIC/SWIFT banky prijmatea?",bankDetails:"daje o banke prijmatea",bicWizard:"Vyhada banku, do ktorej chcete odosla platbu",bicBank:"Banka",bicBranch:"Poboka",bicBranchInput:"Popis banky a adresa",sender:"Odosielate",amount:"Suma",commissionsAndFees:"Poplatky",transferType:"Typ platby",traditionalMail:"Chcem dosta potvrdenie potou (za poplatok)",addToTrustedList:"Prida k dveryhodnm tom",changeAccountFee:"Zmeni et na ztovanie poplatku",optionalTransferDetails:"Voliten detaily platby",referenceNumber:"Referencia",specialPurpose:"pecilny el",additionalInstructions:"Doplujce intrukcie",receiverDetails:"daje o prijmateovi",receiverType:"Typ prijmatea",receiverCountry:"tt prijmatea",idType:"Typ identifiktora",idDescription:"Opis identifiktora",idTypeInput:"daje",date:"Dtum",idTypeCountry:"tt",idTypeCity:"Mesto",idTypeProvince:"Kraj",instructionsData:"Obsah intrukcie",authority:"Vydal",finalReceiverDetails:"daje o poslednom prijmateovi",name:"Nzov/meno a priezvisko",senderDetails:"daje o odosielateovi",primarySenderDetails:"daje o pvodnom odosielateovi",senderType:"Typ odosielatea",select:"Vybra",principalReceiver:"Hrad odosielate alebo prijmate",principal:"Hrad prkazca",principalHelp:"k dispozcii v platbch SWIFT",otherBanksCosts:" + nklady inch bnk"},placeholder:{country:"Vybra tt...",bicBank:"Vybra banku...",bicBranch:"Vybra poboku...",street:"Ulica a slo",city:"PS a obec"},tooltips:{bic:"Kd skladajci sa z 8 alebo 11 znakov, ktor identifikuje banku prijmatea.",transferTypeSwift:"hrada nkladov odosielateom znamen, e odosielate zahraninej platby zaplat nklady sprostredkovateskch bnk a poplatky vo svojej banke. Rozdelenie nkladov medzi prkazcu a prijmatea znamen, e poplatky banky odosielatea zaplat odosielate platby a prpadn nklady sprostredkovateskch bnk zaplat prijmate platby. Ak je et, z ktorho je platba odosielan, veden v inej mene ako je mena platby, tak sa suma nkladov prepota a ztuje v mene tu.",transferTypeSwiftEog:"Rozdelenie nkladov medzi prkazcu a prijmatea znamen, e poplatky banky odosielatea zaplat odosielate platby a prpadn nklady sprostredkovateskch bnk zaplat prijmate platby. Ak je et, z ktorho je platba odosielan, veden v inej mene ako je mena platby, tak sa suma nkladov prepota a ztuje v mene tu.",transferTypeSepa:"Nklady na vykonanie platby v slade so Sadzobnkom poplatkov mBank hrad prkazca a prijmate. Ak je et, z ktorho je platba odosielan, veden v inej mene ako je mena platby, tak sa suma nkladov prepota a ztuje v mene tu."},button:{submit:"Odosla platbu",cancel:"Zrui"}},time:{tomorrow:{morning:"Zajtra rno"}},defaults:{address:{street:"Ulica a slo",city:"PS a mesto"}},forms:{chosen:{noResults:"Nie s vsledky",choose:"Vybra"},validation:{required:"Povinn pole",wrongDateFormat:"Nesprvny formt dtumu. Pouite dd.mm.rrrr.",phone:"Chybn formt telefnneho sla, mus sa sklada presne z 9 slic",phoneZero:"slo sa mus uvies bez nuly na zaiatku",amountNoDecimal:"Suma mus by zaokrhlen na 1 ",amountOneDecimal:"Suma mus by zaokrhlen na 0,10 ",maxAmount:"Maximlna suma k dispozcii je {0} EUR",bicBRE:"Pre prijmateov zo skupiny mBank v Posku sta zada slo BREXPLPW",bicXXX:"V prpade BIC koniaceho sa na XXX sta zada osemcifern slo BIC",account:{nan:"slo tu sa mus obsahova min 5 a max 16 slic.",tooShort:"slo tu je prli krtke, mus obsahova min 5 a max 16 slic.",tooLong:"slo tu je prli dlh, mus obsahova min 5 a max 16 slic."},toAccountChanged:"et prijmatea bol zmenen.",fromAccountChanged:"Z kreditnej karty nie je mon zada platbu do zahraniia.",notIbanSkDomestic:"Zadali ste zahranin IBAN tu. Opravte IBAN tu, alebo pouite formulr pre platby do zahraniia.",sepaBlocked:"Je nm to, do tejto banky nie je mon zasla platbu SEPA"}},dashboard:{groups:{label:{favourite:"Vykona platbu obbenm prijmateom",frequent:"Vykona platbu najastejie vyberanm prijmateom"}},empty:{title:"Nemte obbench prijmateov.",buttons:{gotoAdressbook:"Prejs do adresra",newContact:"Prida nov kontakt",newFromFacebook:"Prida priateov z Facebooku"}},tooltips:{favoriteList:"Ak chcete vytvori zoznam obbench prijmateov, oznate vybran kontakty v adresri hviezdikou."},transferTo:"Vykona platbu na",transferToNewAccount:"Vykona platbu na nov et"},buttons:{submit:"Odosla platbu",cancel:"Zrui",addToBasket:"Prida do koka",yes:"no",no:"Nie",ok:"Ok"},currency:{conversion:{warn:"Zvolen mna je jin ne mna tu, ze kterho dlte platbu. Chcete-li provst platbu?"}}}}};return e}),define("transfer/js/locale",["./i18n/pl-PL","./i18n/pl-OR","./i18n/en-GB","./i18n/cs-CZ","./i18n/sk-SK"],function(e,t,a,r,n){return _.extend({},e,t,a,r,n)}),define("transfer/js/controller",["./app"],function(e){return{showDefault:function(){e.trigger("show:dashboard")},addrBookNewDomestic:function(){e.trigger("transfer:new",{transferType:"base"})},addrBookNewSplitDomestic:function(){e.trigger("transfer:new",{transferType:"splitdomestic"})},addrBookNewSelf:function(){e.trigger("transfer:new",{transferType:"own"})},addrBookNewSplitSelf:function(){e.trigger("transfer:new",{transferType:"splitown"})},addrBookNewAbroad:function(t){e.trigger("transfer:new",{transferType:"abroad",recipientName:t})},addrBookNewOneZus:function(){e.trigger("transfer:newCompany",{transferType:"onezus"})},addrBookNewUs:function(){e.trigger("transfer:new",{transferType:"us"})},addrBookNewFacebook:function(){e.trigger("transfer:new",{transferType:"facebook"})},addrBookNewMobile:function(){e.trigger("transfer:new",{transferType:"mobile"})},addrBookNewPhoneCharge:function(){e.trigger("transfer:new",{transferType:"phone"})}}}),define("transfer/js/router",["./controller"],function(e){var t=Backbone.Marionette.AppRouter.extend({appRoutes:{"transfer/newDomestic":"addrBookNewDomestic","transfer/newSplitDomestic":"addrBookNewSplitDomestic","transfer/newSelf":"addrBookNewSelf","transfer/a/:recipientName":"addrBookNewAbroad","transfer/newAbroad":"addrBookNewAbroad","transfer/newZus":"addrBookNewOneZus","transfer/oneZus":"addrBookNewOneZus","transfer/newUs":"addrBookNewUs","transfer/newFacebook":"addrBookNewFacebook","transfer/newMobile":"addrBookNewMobile","transfer/newPhoneCharge":"addrBookNewPhoneCharge",transfer:"showDefault"}});return new t({controller:e})}),define("transfer/js/main",["./app","./locale","./router","./controller"],function(e,t,a,r){function n(){I18n.translations=$.extend(!0,{},I18n.translations,t)}return e.controller=r,e.router=a,{initialize:function(){n(),e.initLayout()},destroy:function(){e.unloadLayout()}}}),define("text!transfer/templates/dashboard-layout.html",[],function(){return'{% // $Id: dashboard-layout.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n<div class="transfer-menu-view"></div>\r\n<h2 class="accessible-not-visible">{{ i18n(\'transfer.favorite\') }}</h2>\r\n<div class="list-favourite-view"></div>\r\n<div class="list-frequent-view"></div>'}),define("transfer/js/models/dashboard",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.getTransferDashboard(a)}});return e}),define("text!transfer/templates/dashboard-group.html",[],function(){return'{% // $Id: dashboard-group.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n\r\n<header>\r\n    <h3>\r\n    {{ i18n(\'transfer.dashboard.groups.label\', label) }} \r\n    {% if (label=="favourite") { %}\r\n    <a href="#"  class="fav-tooltip btn-gray-gradient-darker btn-small">              \r\n        <i class="icon-question-mark">{{ I18n.t(\'transfer.help\') }}</i>\r\n        <span class="accessability-nohide">{{ I18n.t(\'transfer.dashboard.tooltips.favoriteList\') }}</span>\r\n     </a>\r\n    {% } %}\r\n    </h3>\r\n</header>\r\n\r\n<ul class="receivers-list" data-gemius-event-type="action" data-gemius-event-action-id="{# getGemiusActionId(\'transfer.dashboard.template\') #}" data-gemius-event-action-name="transfer.dashboard.template"></ul>'}),define("text!transfer/templates/dashboard-group-item.html",[],function(){return'{% // $Id: dashboard-group-item.html 273389 2013-10-01 14:40:44Z EBRE\\zew_2_6718 $ %}\r\n\r\n{% if (accounts && accounts.length) { %}\r\n<ul class="receiver-details" data-transfer-id="{{ accounts[0].id }}" data-transfer-type="{{ accounts[0].type }}" >\r\n{% } else { %}\r\n<ul class="receiver-details">\r\n{% } %}\r\n    <li class="receiver-photo">\r\n    {% if (type && _.contains([\'Zus\', \'Us\'], type)) { %}\r\n      <img src="{{ Ebre.Venezia.Urls.ContentUrls.gfx }}ico_{{type.toLowerCase()}}.png" alt="{{ name }}" height="53" width="53" />\r\n    {% } else { %}\r\n      <img src="{{ fbPhotoUrl(fbid, true) }}" height="53" width="53" alt="{{ name }}" />\r\n    {% } %}\r\n    </li>\r\n    <li class="receiver-name">{{ name }}</li>\r\n    <li class="receiver-action-buttons">\r\n        {% if (accounts && accounts.length) { %}\r\n        <span class="label">{{I18n.t(\'transfer.dashboard.transferTo\')}}:</span>        \r\n            {% _.each(accounts, function(account, index) { %}\r\n                {% if (account && index < 5) { %}                                                        \r\n                    <a href="#" data-transfer-id="{{ account.id }}" data-transfer-type="{{ account.type }}" class="defined-transfer btn-white-just-border {% if(account.trusted) { print(\'checked\') } %}" rel="tooltip" title="{{ account.description }}"\r\n                       data-gemius-event-type="action" data-gemius-event-action-id="{# getGemiusActionId(\'transfer.dashboard.template\') #}" data-gemius-event-action-name="transfer.dashboard.template">\r\n                           <span class="accessability-nohide">\r\n                               {{ Ebre.Extensions.format(I18n.t(\'transfer.dashboard.accessability.selectTemplate\'), name) }}\r\n                           </span> \r\n                            {{ account.name }}\r\n                            <span class="accessability-nohide">\r\n                                {% if(account.trusted) { print(\'(\'+I18n.t(\'transfer.dashboard.accessability.templateTrusted\')+\')\') } %}\r\n                            </span>\r\n\r\n                    </a>                                               \r\n                {% } %}\r\n            {% }); %}\r\n        {% } %}        \r\n        <a href="#" class="new-blank-transfer btn-white-just-border more-action"\r\n           data-gemius-event-type="action" data-gemius-event-action-id="{# getGemiusActionId(\'transfer.dashboard.template\') #}" data-gemius-event-action-name="transfer.dashboard.template">\r\n            +<span class="accessible-not-visible">{{ name }} {{I18n.t(\'transfer.dashboard.transferToNewAccount\')}}</span>\r\n        </a>\r\n    </li>\r\n</ul>'}),define("transfer/js/logic/touch-wrapper",[],function(){return function(e,t){var a=_.extend({parentClass:"receiver-row",hoverClass:"hover"},t||{});return _.wrap(e,function(e,t){var r=$(t.currentTarget),n=r.hasClass(a.parentClass)?r:r.closest("."+a.parentClass);return n.hasClass(a.hoverClass)?e.call(this,t):($("."+a.parentClass).removeClass(a.hoverClass),n.addClass(a.hoverClass)),t.preventDefault(),t.stopPropagation(),!1})}}),define("transfer/js/views/dashboard-group-item",["text!../../templates/dashboard-group-item.html","../logic/touch-wrapper","../app"],function(e,t,a){var r=Modernizr.touch&&$("html").hasClass("ipad")?{"touchend .receiver-details":"newTransferFromTemplate","touchend .receiver-action-buttons .defined-transfer":"newTransferFromTemplate","touchend .receiver-action-buttons .new-blank-transfer":"newTransferToRecipient"}:{"click .receiver-details":"newTransferFromTemplate","click .receiver-action-buttons .defined-transfer":"newTransferFromTemplate","click .receiver-action-buttons .new-blank-transfer":"newTransferToRecipient"},n=function(e){return Modernizr.touch?t(e):e};return Backbone.Marionette.ItemView.extend({template:e,tagName:"li",className:"receiver-row hoverable",events:r,newTransferFromTemplate:n(function(e){var t=$(e.currentTarget).attr("data-transfer-id"),r=$(e.currentTarget).attr("data-transfer-type"),n=this.model.get("id");return"undefined"!=typeof t&&"undefined"!=typeof r?a.trigger("transfer:new",{transferType:r,definedRecipientId:n,definedTemplateId:t,facebookId:this.model.get("fbid")||null}):a.trigger("transfer:new",{transferType:"base",definedRecipientId:n}),e.stopPropagation(),e.preventDefault(),!1}),newTransferToRecipient:n(function(e){var t=this.model.get("id"),r=$(e.currentTarget).closest(".receiver-details").attr("data-transfer-type");return a.trigger("transfer:new",{transferType:"undefined"===r||"zus"!=r&&"us"!=r?"domestic":r,definedRecipientId:t}),!1}),onRender:function(){var e=this.$el.find(".receiver-action-buttons a").length,t=780-107*e-55;this.$el.find(".receiver-name").css({"max-width":t+"px"})}})}),define("transfer/js/views/dashboard-group",["text!../../templates/dashboard-group.html","./dashboard-group-item"],function(e,t){var a=Backbone.Marionette.CompositeView.extend({itemView:t,template:e,tagName:"section",appendHtml:function(e,t){e.$(".receivers-list").append(t.el)},onRender:function(){this.$el.addClass("receivers-"+this.model.get("label")),this.collection.length||this.$("#no-favourites").show(),this.tooltip()},onClose:function(){this.$("a[rel=tooltip]").tooltip("disable"),$("body > .tooltip").remove()},tooltip:function(){this.$el.find(".fav-tooltip").click(function(){return!1}).mytooltip({tooltip:$("<span></span>").text(I18n.t("transfer.dashboard.tooltips.favoriteList")),inDelay:10,outDelay:0,side:"top",position:"center bottom",offset:"0 -6",parentElement:"#transfer-app-root"})}});return a}),define("text!transfer/templates/dashboard-empty.html",[],function(){return'<div class="box box-info box-big" id="no-favourites">\r\n    <span class="message">{{ i18n(\'transfer.dashboard.empty.title\') }}</span>\r\n    \r\n    <a href="#" class="btn-gray-gradient goto-addressbook">\r\n        <i class="icon-big-book"></i>\r\n        {{ i18n(\'transfer.dashboard.empty.buttons.gotoAdressbook\') }}\r\n    </a>\r\n    \r\n    <a href="#" class="btn-gray-gradient new-contact">\r\n        <i class="icon-big-plus"></i>\r\n        {{ i18n(\'transfer.dashboard.empty.buttons.newContact\') }}\r\n    </a>\r\n</div>'}),define("transfer/js/views/dashboard-empty",["text!../../templates/dashboard-empty.html","../app"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{"click .goto-addressbook":"gotoAddressbook","click .new-contact":"addNewContact"},gotoAddressbook:function(e){return e.preventDefault(),nmbServices.GoToAddressbook({success:function(e){Ebre.Common.NavigateTo(e)}}),!1},addNewContact:function(e){return e.preventDefault(),nmbServices.AddNewContact({success:function(e){Ebre.Common.NavigateTo(e)}}),!1}});return a}),define("text!transfer/templates/dashboard-menu.html",[],function(){return'{% // $Id: dashboard-menu.html 266702 2013-08-23 14:33:23Z EBRE\\zew_2_6718 $ %}\r\n\r\n<div class="at-top-view">\r\n    <section class="transfer-context-menu">\r\n        <ul class="transfers-types-list">\r\n            \r\n            <li class="transfer-type-row first-row domestic">\r\n                <a href="#/transfer" class="transfer-domestic" id="trans1"\r\n                   data-gemius-event-type="action"\r\n                   data-gemius-event-action-id="190002"\r\n                   data-gemius-event-action-name="transfer.single.transfer-domestic">\r\n                    <span class="accessability-nohide">{{I18n.t(\'transfer.submenu.single\')}}</span>\r\n                    {{ i18n(\'transfer.menu.domestic\') }}\r\n                    <span class="gfx"></span>\r\n                    <span class="dropdown-trigger btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n                </a>\r\n            </li>\r\n            \r\n            <li class="transfer-type-row own-account">\r\n                <a href="#/transfer" class="transfer-personal" id="trans2"\r\n                   data-gemius-event-type="action"\r\n                   data-gemius-event-action-id="190003"\r\n                   data-gemius-event-action-name="transfer.single.transfer-personal">\r\n                    <span class="accessability-nohide">{{I18n.t(\'transfer.submenu.single\')}}</span>\r\n                    {{ i18n(\'transfer.menu.own\') }}\r\n                    <span class="gfx"></span>\r\n                    <span class="dropdown-trigger btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n                </a>\r\n            </li>\r\n\r\n            {% if (!Ebre.Entity.isCZ() && !Ebre.Entity.isSK()) { %}\r\n                <li class="transfer-type-row mobile-transfer" >\r\n                    <a href="#/transfer" class="transfer-phone" id="trans4"\r\n                       data-gemius-event-type="action"\r\n                       data-gemius-event-action-id="190004"\r\n                       data-gemius-event-action-name="transfer.single.transfer-phone">\r\n                        {# i18n(\'transfer.menu.phone\') #}\r\n                        <span class="gfx"></span>\r\n                        <span class="dropdown-trigger btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n                    </a>\r\n                </li>\r\n            \r\n                <li class="transfer-type-row us-transfer" >\r\n                    <a href="#/transfer" class="transfer-us" id="trans5"\r\n                       data-gemius-event-type="action"\r\n                       data-gemius-event-action-id="190005"\r\n                       data-gemius-event-action-name="transfer.single.transfer-us">\r\n                        <span class="accessability-nohide">{{I18n.t(\'transfer.submenu.single\')}}</span>\r\n                        {{ i18n(\'transfer.menu.us\') }}\r\n                        <span class="gfx"></span>\r\n                        <span class="dropdown-trigger btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n                    </a>\r\n                </li>\r\n            \r\n                <li class="transfer-type-row zus-transfer">\r\n                    <a href="#/transfer" class="transfer-zus" id="trans6"\r\n                       data-gemius-event-type="action"\r\n                       data-gemius-event-action-id="190006"\r\n                       data-gemius-event-action-name="transfer.single.transfer-zus">\r\n                        <span class="accessability-nohide">{{I18n.t(\'transfer.submenu.single\')}}</span>\r\n                        {{ i18n(\'transfer.menu.zus\') }}\r\n                        <span class="gfx"></span>\r\n                        <span class="dropdown-trigger btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n                    </a>\r\n                </li>\r\n            {% } %}\r\n        </ul>\r\n    </section>    \r\n</div>'}),define("transfer/js/views/dashboard-menu",["../app","text!../../templates/dashboard-menu.html"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:t,tagName:"section",className:"transfer-menu-view",events:{"click a.transfer-domestic":"newDomesticTransfer","click a.transfer-personal":"newPersonalTransfer","click a.transfer-us":"newUsTransfer","click a.transfer-zus":"newZusTransfer","click a.transfer-phone":"newPhoneChargeTransfer"},newDomesticTransfer:function(t){return t.preventDefault(),e.trigger("transfer:new",{transferType:"default"}),!1},newPersonalTransfer:function(t){return t.preventDefault(),e.trigger("transfer:new",{transferType:"own"}),!1},newMobileTransfer:function(t){return t.preventDefault(),e.trigger("transfer:new",{transferType:"mobile"}),!1},newUsTransfer:function(t){return t.preventDefault(),e.trigger("transfer:new",{transferType:"us",selectDefaultTemplate:!1}),!1},newZusTransfer:function(t){return t.preventDefault(),e.trigger("transfer:new",{transferType:"onezus",selectDefaultTemplate:!1}),!1},newPhoneChargeTransfer:function(t){if(t.preventDefault(),Ebre.IB30.FeatureFlags.IsPaymentsPhoneChargeLiftingEnabled){var a=window.location.origin+"/payments/phonecharge";window.location.href=a}else e.trigger("transfer:new",{transferType:"phone",selectDefaultTemplate:!0});return!1}});return a}),define("transfer/js/views/dashboard-layout",["text!../../templates/dashboard-layout.html","../app","../models/dashboard","./dashboard-group","./dashboard-empty","./dashboard-menu"],function(e,t,a,r,n,i){var o=Backbone.Marionette.Layout.extend({template:e,tagName:"article",attributes:{id:"transfer-dashboard"},regions:{menu:".transfer-menu-view",favList:".list-favourite-view"},initialize:function(){},defaultView:function(){var e=new a,r=this;e.fetch({success:function(){var a=e.toJSON();r.model=new Backbone.Model(a),t.isFacebookEnabled=a.isFacebookEnabled,r.menu.show(new i),t.contactMode=a.contactMode,r.model.get("hasRecipients")?r.showReciepients():r.showEmptyView()}})},showReciepients:function(){var e=this,t=this.model.get("contactsGroups");this.showReciepientGroup({group:t.favourite,compositeViewClass:r,region:e.favList})},showReciepientGroup:function(e){var t=new Backbone.Model(e.group),a=new Backbone.Collection(e.group.contacts);e.region.show(new e.compositeViewClass({model:t,collection:a}))},showEmptyView:function(){this.favList.show(new n)},onRender:function(){t.trigger("toggle:modal:screen",!0)}});return o}),define("text!transfer/templates/dialogs/formTypeChange.html",[],function(){return'<p>{{ message }}</p>\r\n<div class="buttons">\r\n    <button id="accept">{{ i18n(\'transfer.buttons.yes\') }}</button>\r\n    <button id="cancel">{{ i18n(\'transfer.buttons.no\')  }}</button>\r\n</div>\r\n'}),define("transfer/js/views/dialogs/formTypeChange",["text!../../../templates/dialogs/formTypeChange.html","transfer/js/app"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{"click  #cancel":"cancel","click  #accept":"accept",keypress:"checkKeyPressed"},initialize:function(){},cancel:function(e){var a=this.model.get("deferred"),r=this.model.get("validationMessage");return e.preventDefault(),t.trigger("dialogClose"),a&&(r?a.reject():a.resolve()),!1},accept:function(e){var a=this.model.get("type"),r=this.model.get("formValues"),n=this.model.get("recipientId"),i=this.model.get("deferred"),o={};return e.preventDefault(),"object"==typeof r.amount?(o.amount=r.amount.value,o.currency=r.amount.currency):(o.amount=r.amount,o.currency=r.currency||r.currencies),countryCode="undefined"!=typeof r.ibanCountryCode?r.ibanCountryCode:"",o.toAccount=countryCode+r.toAccount||"",o.recipientName=r.recipientName||"",o.recipientId=n,o.fromAccount=r.fromAccount||"",o.title=r.title||"",o.nameAndAddress=r.address||"",o.date=r.date||"",o.activeIncomeSource="undefined"!=typeof r.pep?r.pep.incsour:"",o.activePaymentPurpose="undefined"!=typeof r.pep?r.pep.purposes:"",o.sender=r.sender||"",t.trigger("transfer:new",{transferType:a,recipientId:this.model.get("recipientId"),extraFormData:o}),t.trigger("dialogClose"),i.reject(),!1},onRender:function(){this.$el.find("#accept").focus()},checkKeyPressed:function(e){32==e.keyCode&&this.proceed(e)}});return a}),define("transfer/js/views/dialogs/facebook-connection-warning",["text!../../../templates/dialogs/formTypeChange.html","transfer/js/app"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{"click #cancel":"cancel","click #accept":"accept",keypress:"checkKeyPressed"},cancel:function(e){t.trigger("dialogClose"),t.trigger("show:dashboard")},accept:function(e){$("#sidebar-blocker-screen").remove(),t.trigger("dialogClose"),t.trigger("transfer:new",{transferType:"domestic",recipientName:this.model.get("recipientName"),definedRecipientId:this.model.get("recipientId"),definedTemplateId:null})},onRender:function(){this.$el.find("#accept").focus()},checkKeyPressed:function(e){32==e.keyCode&&this.proceed(e)}});return a}),define("text!transfer/templates/dialogs/facebook-redirect-info.html",[],function(){return'<div class=\'layer-content facebook-info-dialog\'>\r\n<p>{{I18n.t(\'transfer.facebook.YouWillBeRedirected\')}}</p>\r\n  <div class="actions">\r\n    <a class="ok-button btn-red-gradient" href="javascript:void(0);"><span> OK </span></a>\r\n  </div>\r\n</div>\r\n'}),define("transfer/js/views/dialogs/facebook-redirect-info",["../../app","text!../../../templates/dialogs/facebook-redirect-info.html"],function(e,t){return Backbone.Marionette.CompositeView.extend({template:t,className:"info-dialog",itemViewContainer:".layer-content",events:{"click .ok-button":"buttonClickOk"},beforeRender:function(){e.trigger("toggle:modal:screen"),$("html, body").animate({scrollTop:0})},hideLayer:function(){e.trigger("toggle:modal:screen",!0);var t=this.$el;t.fadeOut(600,function(){$(this).remove()})},buttonClickOk:function(){this.hideLayer(),e.trigger("dialogClose"),e.trigger("fb:p2p:registered",this.model.attributes)}})}),define("text!transfer/templates/dialogs/fko-importer-info.html",[],function(){return" <a class=\"btn-gray-gradient\">{{ I18n.t('transfer.fko.redirectToImporterBtn') }}</a>\r\n <span>\r\n    {{ I18n.t('transfer.fko.infoFKOMessage') }} <a href=\"{{ I18n.t('transfer.fko.infoFKOMessageLink') }}\" target=\"_blank\"><u>{{ I18n.t('transfer.fko.infoFKOMessageCheck') }}</u></a>\r\n</span>\r\n"}),define("transfer/js/views/dialogs/fko-importer-info",["../../app","text!../../../templates/dialogs/fko-importer-info.html"],function(e,t){return Backbone.Marionette.ItemView.extend({template:t,id:"fko-info-payments",className:"fko-importer-info",initialize:function(){},events:{"click .btn-gray-gradient":"goToImporter"},goToImporter:function(){this.model.disableMessage({success:function(){Ebre.Common.NavigateTo(Ebre.Modules.Payments.Transfer.RecipientService.FKOImporterUrl)}})}})}),define("text!transfer/templates/dialogs/confirm.html",[],function(){return'<p>{{ message }}</p>\r\n<div class="buttons">\r\n    <button id="accept">{{ i18n(\'transfer.buttons.yes\') }}</button>\r\n    <button id="cancel">{{ i18n(\'transfer.buttons.no\')  }}</button>\r\n</div>\r\n'}),define("transfer/js/views/dialogs/confirm",["text!../../../templates/dialogs/confirm.html","transfer/js/app"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{"click  #cancel":"cancel","click  #accept":"accept",keypress:"checkKeyPressed"},initialize:function(){},cancel:function(e){var a=this.model.get("deferred");return e.preventDefault(),t.trigger("dialogClose"),a.reject(),!1},accept:function(e){var a=this.model.get("deferred");return e.preventDefault(),t.trigger("dialogClose"),a.resolve(),!1},checkKeyPressed:function(e){32==e.keyCode&&this.cancel(e)}});return a}),define("text!transfer/templates/dialogs/info.html",[],function(){return'<p>{{ message }}</p>\r\n<div class="buttons">\r\n    <button id="accept">{{ i18n(\'transfer.buttons.ok\')  }}</button>\r\n</div>\r\n'}),define("transfer/js/views/dialogs/info",["text!../../../templates/dialogs/info.html","transfer/js/app"],function(e,t){var a=Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{"click  #accept":"closeDialog",keypress:"checkKeyPressed"},initialize:function(){},closeDialog:function(e){var a=this.model.get("deferred");return e.preventDefault(),t.trigger("dialogClose"),a.reject(),!1},checkKeyPressed:function(e){32==e.keyCode&&this.closeDialog(e)}});return a}),define("text!transfer/templates/transfer-layout.html",[],function(){return'{% // $Id: transfer-layout.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n<div class="transfer-receiver-view"></div>\r\n<div style="position:relative;">\r\n    <h2 class="accessible-not-visible">{{ i18n(\'transfer.sidebar.option.label\') }}</h2>\r\n    <div class="transfer-sidebar-view"></div>\r\n    <h2 class="accessible-not-visible">{{ i18n(\'transfer.formLabel\') }}</h2>\r\n    <div class="transfer-form-view"></div>\r\n</div>\r\n'}),define("text!transfer/templates/transfer-falter/transfer-falter.html",[],function(){return'<div class="form-view">\r\n    <section class="form-falter">\r\n        <form onsubmit="javascript:return false;">\r\n            <div class="falter-content">\r\n                <div class="falter-gfx">\r\n                    <div class="content"></div>\r\n                </div>\r\n                <div class="falter-offer">\r\n                    <div class="content">\r\n                        <div class="falter-offer-header">\r\n                            [header]\r\n                        </div>\r\n\r\n                        <div class="falter-offer-description">\r\n                            [description]\r\n                        </div>\r\n\r\n                        <div class="falter-buttons">\r\n                            <div class="fields action-buttons">\r\n                                <a href="#" title="{{ i18n(\'transfer.falter.declineOffer\') }}" class="decline-offer btn-gray-gradient">\r\n                                    {{ i18n(\'transfer.falter.declineOffer\') }}\r\n                                </a>\r\n                                <a href="#" title="{{ i18n(\'transfer.falter.acceptOffer\') }}" class="accept-offer btn-red-gradient">\r\n                                    {{ i18n(\'transfer.falter.acceptOffer\') }}\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <a target="_blank" class="falter-red falter-disclaimer" href="{{ falter.disclaimer }}">Nota prawna</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </section>\r\n</div>';
}),define("transfer/js/views/transfer-falter",["text!../../templates/transfer-falter/transfer-falter.html","../models/transfer-wizard","../app"],function(e,t,a){var r=Backbone.Marionette.ItemView.extend({events:{"click a.accept-offer":"acceptOffer","click a.decline-offer":"declineOffer"},templateHelpers:function(){return $.extend({},Backbone.Marionette.CompositeView.prototype.templateHelpers,{formatGenericAccountNumber:function(e){if(!e||e.length<4)return e;var t=e.replace(/\s/g,""),a=t.match(/(\w{1,4})/g);if(a){var r=[];return _.each(a,function(e){r.length?r.push(e):r.push(e.substr(0,2)+" "+e.substr(2,2))}),r.join(" ")}return e},replaceTokens:function(e,t){return t&&_.keys(t).length?(_.each(t,function(t,a){e=e.replace("["+a+"]",t)}),e):e}})}(),getTemplate:function(){var t=this.model.get("falter"),a=this.model.get("formData");t.interest=window.I18n.toCurrency(t.interest,{precision:2}),t.interest=t.interest.replace(/0$/,"");var r={amount:a.amount,currency:a.currency,product:t.product,interest:t.interest},n=this.templateHelpers.replaceTokens(t.header,r),i=this.templateHelpers.replaceTokens(t.text,r),o=e.replace("[header]",n).replace("[description]",i);return o},tagName:"article",disableDefaultFocus:!0,attributes:{id:"transfer-falter"},onRender:function(){},acceptOffer:function(e){e.preventDefault();var t=this.model.get("falter"),a=t.uwLink;""!==a&&Ebre.Proxy.GetView({url:a,loaderParent:"#transfer-falter"},function(e){$("#transfer-falter").html(e)})},declineOffer:function(e){e.preventDefault();var t=this.model.get("formData");a.trigger("transfer:submit",t)}});return r}),define("text!transfer/templates/transfer-recipient-search.html",[],function(){return'<div class="recipients-livesearch">\r\n  <span class="validation-icon"></span>\r\n    <label for="recipients-livesearch-query">{{ i18n(\'transfer.livesearch.label\') }}</label>\r\n    <a aria-label="{{ i18n(\'transfer.help\') }}: {{ formType == \'phone\' ? i18n(\'transfer.livesearch.fieldHelp2\') : i18n(\'transfer.livesearch.fieldHelp\') }}" id="live-search-field-tooltip" href="javascript:void(0)" class="btn-gray-gradient btn-small" rel="tooltip" data-original-title="{{ formType == \'phone\' ? i18n(\'transfer.livesearch.fieldHelp2\') : i18n(\'transfer.livesearch.fieldHelp\') }}" aria-describedby="recipientHelpText">\r\n        <i class="icon-question-mark"></i>\r\n    </a>\r\n    <div class="livesearch-border">\r\n        <h2 class="accessible-not-visible">{{ i18n(\'transfer.livesearch.label\') }}</h2> \r\n        <div id="live-search-field-wrapper" class="search-field-wrapper input-decorated">\r\n            <input type="text" id="recipients-livesearch-query" placeholder="{{ i18n(\'transfer.livesearch.defaultValue\') }}"\r\n                   maxlength="70" class="" role="combobox" aria-describedby="live-search-field-tooltip" aria-owns="live-search-results-region" />\r\n            <a href="javascript:void(0)"  data-gemius-event-type="action" data-gemius-event-action-id="{# getGemiusActionId(\'transfer.livesearch.addressbook\') #}" data-gemius-event-action-name="transfer.livesearch.addressbook" class="input-decorations"><span class="accessability-nohide">{{ I18n.t(\'transfer.livesearch.tooltips.allABContacts\') }}</span></a>\r\n        </div>\r\n        <ul id="live-search-results-region" class="search-results-region" style="background-color: White;" role="listbox"></ul>\r\n    </div>\r\n</div>\r\n'}),define("text!transfer/templates/livesearch/addressbook-contact-item.html",[],function(){return'<li role="option">\r\n      <span class="photo-holder">\r\n        {% if (fbid) { %}\r\n          <img src="https://graph.facebook.com/{{fbid}}/picture" alt="" width="50" height="50" class="picture" />\r\n        {% } else { %}\r\n          <img src="/venezia/gfx/u/user-dummy-photo.jpg" alt="" width="50" height="50" class="picture" />\r\n        {% } %}\r\n      </span>\r\n      <span class="text-holder">\r\n\t      <span class="recipient-name">{{name}}</span><br />\r\n        {%print(firstMatch(templates, \'name\'))%}\r\n      </span>\r\n  </a>\r\n</li>'}),define("text!transfer/templates/livesearch/facebook-friend-item.html",[],function(){return'<li>\r\n  <span class="photo-holder">\r\n\t  <img src="https://graph.facebook.com/{{id}}/picture" alt="" width="50" height="50" class="picture" />\r\n  </span>\r\n  <span class="text-holder">\r\n\t  <span class="recipient-name">{{name}}</span>\r\n  </span>\r\n</li>'}),define("text!transfer/templates/livesearch/performed-transfer-item.html",[],function(){return'<li>\r\n  <span class="photo-holder">\r\n\t  <img src="/venezia/gfx/u/user-dummy-photo.jpg" alt="" width="50" height="50" class="picture" />\r\n  </span>\r\n  <span class="text-holder">\r\n\t  <span class="recipient-name">{{name}}</span><br />\r\n      <span class="account-number">\r\n        {{ accountNumber }}\r\n      </span>\r\n  </span>\r\n</li>'}),define("text!transfer/templates/livesearch/addnew-row-item.html",[],function(){return'<li class="ui-livesearch-item new-recipient special-rounded-top-corners">\r\n  <a href="javascript:void(0);">\r\n    <span class="btn-gray-gradient btn-small"><i class="icon-big-plus"></i></span>\r\n    <span class="text">{{I18n.t(\'transfer.livesearch.addnew\')}}</span>\r\n  </a>\r\n</li>'}),define("transfer/js/views/transfer-recipient-search",["text!../../templates/transfer-recipient-search.html","text!../../templates/livesearch/addressbook-contact-item.html","text!../../templates/livesearch/facebook-friend-item.html","text!../../templates/livesearch/performed-transfer-item.html","text!../../templates/livesearch/addnew-row-item.html","../app","../logic/livesearch-common"],function(e,t,a,r,n,i,o){function s(e){if(e.searchType){if("abContact"==e.searchType&&e.recipientId)return void i.trigger("transfer:new",{transferType:"base",definedRecipientId:e.recipientId});if("abTransfer"==e.searchType&&e.recipientId&&e.transferId&&e.transferType)return void i.trigger("transfer:new",{transferType:e.transferType,definedRecipientId:e.recipientId,definedTemplateId:e.transferId});if("abSelf"==e.searchType)return void(e.transferId||i.trigger("transfer:new",{transferType:"own"}));if("pt"==e.searchType&&e.transferId)return void i.trigger("transfer:new",{transferType:"performed",transferId:e.transferId});if("fb"==e.searchType&&e.facebookId)return void i.trigger("transfer:new",{transferType:"facebook",definedRecipientId:e.recipientId,facebookId:e.facebookId,facebookName:e.facebookName,recipientName:e.recipientName})}var t=i.main.currentView.main.currentView.model,a=t.get("formType");if("domestic"!=a||1==t.get("defaultData"))return void i.trigger("transfer:new",{transferType:"base",recipientName:l.lastSearchValue,definedRecipientId:Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId});var a=t.get("formType"),r=t.get("formData"),n=r.recipientId;if(n===Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId)return void i.main.currentView.main.currentView.updateRecipientName(l.lastSearchValue);if(n)i.trigger("transfer:new",{transferType:a,recipientName:l.lastSearchValue,defaultFormData:i.main.currentView.main.currentView.getCurrentFormData()});else{var o=t.get("sidebarData");r.recipientName=l.lastSearchValue,r.recipientId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId,_.each(o.templateTypes,function(e,t){e.contactId=Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId}),o.receiverName=l.lastSearchValue,r.amount=r.amount||null,r.title=r.title||I18n.t("transfer.domestic.defaultTitle"),r.toAccount=r.toAccount||"",r.performed=r.wasPerformed,t.set("formData",r),t.set("sidebarData",o),i.trigger("transfer:addRecipient",{transferType:a,recipientName:l.lastSearchValue}),i.trigger("transfer:edit"),i.trigger("hide:livesearch")}}o.initializeForBackboneApp(i);var l=o,d=Backbone.Marionette.Layout.extend({template:e,tagName:"section",className:"transfer-receiver",events:{"blur #recipients-livesearch-query":"blur","click .input-decorations":"toggleAddressbook"},regions:{results:".search-results-region"},blur:function(e){var t=$("#recipients-livesearch-query").val();if(t||l.lastSearchValue||i.main.currentView.main.currentView.lockForm(),t)if(t.replace(/[^a-z0-9]/gi,"").length<2)Ebre.Common.createErrorMessage(I18n.t("errors.invalidRecipientName"),I18n.t("errors.errorTransferNotSent")),i.main.currentView.main.currentView.lockForm(),l.lastSearchValue=t;else{i.main.currentView.main.currentView.unlockForm();var a=$("#recipients-livesearch-query").liveSearch("data")?$("#recipients-livesearch-query").liveSearch("data").getSelectedItem():null;a&&!a.element.hasClass("new-recipient")||(t===l.lastSearchValue?($(l.transferAppRootElement).find(".livesearch-border").removeClass("focus"),$("#live-search-field-wrapper .placeholder-livesearch, #livesearch-placeholder-for-ie10").hide(),l.focusFirstInput()):($(l.transferAppRootElement).find(".livesearch-border").removeClass("focus"),$(l.transferAppRootElement).find(".recipients-livesearch").find(".new-recipient").trigger("click")))}this.fireMiniRtm()},fireMiniRtm:function(){if("domestic"===this.model.get("formData").formType){var e={amount:$("#amount").val(),recipient:$("#recipients-livesearch-query").val(),title:$("#title").val(),toAccount:$("#toAccount").val()||""};Ebre.Dispatcher.triggerHandler({type:"TransferDataChanged.TransferMiniRtm"},e)}},focus:function(e,t){$(this).closest(".livesearch-border").addClass("focus");var a=$("#recipients-livesearch-query");a.val()&&a.liveSearch("trigger"),l.addressBookMode&&a.liveSearch("showSection","addressBookItemsList",{autoOpen:!0})},initialize:function(){},toggleAddressbook:function(e){e.preventDefault(),l.toggleAddressbook(e)},onRender:function(){var e=this.model.get("formData");e.recipientName&&(this.$el.find("#recipients-livesearch-query").val(e.recipientName).addClass("recipient-set"),l.lastSearchValue=e.recipientName),l.setFocus(this),l.setTooltips(this),this.setLiveSearch(),l.bindEventHandlers(this,s),l.viewOnRender(this)},setLiveSearch:function(){var e=this,d=this.$el.find(".search-results-region"),c=this.$el.find("#recipients-livesearch-query");if(Ebre.Modules.Payments.Transfer.LiveSearchData)e.$el.find(".livesearch-border").removeClass("working"),Ebre.Modules.Payments.Transfer.LiveSearchData.unsetSearch(),Ebre.Modules.Payments.Transfer.LiveSearchData.listElement=d,e.$el.find("#recipients-livesearch-query").removeClass("ui-livesearch-disabled").liveSearch(Ebre.Modules.Payments.Transfer.LiveSearchData);else{var u=function(e,t){if(m.addressBookItemsList.collection&&m.addressBookItemsList.collection.length){if(m.addressBookItemsList.collection[0]===e)return-1;if(m.addressBookItemsList.collection[0]===t)return 1}return 0},m={addressBookItemsList:{url:Ebre.Modules.Payments.Transfer.LiveSearchService.GetAddressBookDataUrl,fixed:!0,title:I18n.t("transfer.livesearch.group.addressbook"),searchProperties:["name","templates.name"],itemTemplate:t,sortMethod:u},performedTransferedItemsList:{minimumChars:3,url:Ebre.Modules.Payments.Transfer.LiveSearchService.GetPerformedTransferDataUrl,title:I18n.t("transfer.livesearch.group.recent"),searchProperties:["name"],itemTemplate:r}};Ebre.Modules.Payments.Transfer.FacebookService.GetApplicationsStatusFromFb&&(m.Facebook={ajaxParams:{url:Ebre.Modules.Payments.Transfer.FacebookService.GetFriendList,timeout:1e4},fixed:!0,title:I18n.t("transfer.livesearch.group.facebook"),searchProperties:["name"],itemTemplate:a,getAjaxPromise:function(e){return $.ajax(e)}}),c.liveSearch({minimumChars:2,fetchOnInitialization:["Facebook","addressBookItemsList"],listElement:d,getAjaxPromise:function(e){return e.data=JSON.stringify(e.data),Ebre.Proxy.VeneziaJSON(e)},limit:3,itemsToDisplay:8,onItemCreation:function(e,t,a,r){var n;switch(a.name){case"addressBookItemsList":if(r&&r.length&&"name"!=r[0].matchedProperty)"templates.name"==r[0].matchedProperty&&(n=l.findTemplate(t.templates,a.liveSearchData.pattern),n&&l.newTransferLSItemClickWrap(e,{searchType:"abTransfer",recipientId:t.id,transferId:n.id,transferType:n.type},t,s));else if(a.liveSearchData.sections.addressBookItemsList.collection[0]===t)l.newTransferLSItemClickWrap(e,{searchType:"abSelf"},t,s);else if(t.templates&&t.templates.length){if(n=l.findTemplate(t.templates,a.liveSearchData.pattern),!n){var i=["domestic","splitdomestic","abroad"];n=_.find(t.templates,function(e){return _.contains(i,e.type.toLowerCase())})}n&&l.newTransferLSItemClickWrap(e,{searchType:"abTransfer",recipientId:t.id,transferId:n.id,transferType:n.type},t,s)}else t.fbid?l.newTransferLSItemClickWrap(e,{searchType:"fb",recipientId:t.id,transferId:t.fbid,facebookId:t.fbid,recipientName:t.name},t,s):l.newTransferLSItemClickWrap(e,{searchType:"abContact",recipientId:t.id},t,s);break;case"performedTransferedItemsList":l.newTransferLSItemClickWrap(e,{searchType:"pt",transferId:t.id},t,s);break;case"Facebook":l.newTransferLSItemClickWrap(e,{searchType:"fb",facebookId:t.id,transferId:t.id,recipientName:t.name,facebookName:t.name},t,s)}},sections:m,showPreloaderInField:!1,selectionsFilter:function(e){if(e.performedTransferedItemsList){for(var t,a=[],r=[];t=e.performedTransferedItemsList.shift();)_.contains(r,t.obj.name.toLowerCase())||(a.push(t),r.push(t.obj.name.toLowerCase()));e.performedTransferedItemsList=a}if(!e.addressBookItemsList&&e.Facebook&&e.performedTransferedItemsList){var n=_.pluck(_.pluck(e.performedTransferedItemsList,"obj"),"name");n=_.map(n,function(e){return e.toLowerCase()}),e.Facebook=_.filter(e.Facebook,function(e){return!_.contains(n,e.obj.name.toLowerCase())})}if(e.addressBookItemsList&&(e.Facebook||e.performedTransferedItemsList)){var i=_.pluck(_.pluck(e.addressBookItemsList,"obj"),"name");if(i=_.map(i,function(e){return e.toLowerCase()}),e.Facebook&&(e.Facebook=_.filter(e.Facebook,function(e){return!_.contains(i,e.obj.name.toLowerCase())})),e.performedTransferedItemsList&&(e.performedTransferedItemsList=_.filter(e.performedTransferedItemsList,function(e){return!_.contains(i,e.obj.name.toLowerCase())}),e.Facebook)){var n=_.pluck(_.pluck(e.performedTransferedItemsList,"obj"),"name");n=_.map(n,function(e){return e.toLowerCase()}),e.Facebook=_.filter(e.Facebook,function(e){return!_.contains(n,e.obj.name.toLowerCase())})}}},onAjaxCallsStart:function(){var e=$("#recipients-livesearch-query"),t=e.closest(".livesearch-border");t.find(".live-search-preloader").length&&t.addClass("working"),$("#live-search-loader-tooltip").show()},onAjaxCallsEnd:function(){var e=$("#recipients-livesearch-query");if(e.closest(".livesearch-border").removeClass("working"),!e.parent().children(".live-search-preloader").length){var t=Ebre.Entity.isOF()?"../venezia/gfxOrange/preloader-3.gif":"../venezia/gfx/preloader-3.gif";e.parent().prepend('<img class="live-search-preloader" src="'+t+'" alt="" />')}$("#live-search-loader-tooltip").hide()},onSearchStart:function(e,t){Ebre.Modules.Payments.Transfer.LiveSearchData=t},onSearchEnd:function(e,t){Ebre.Modules.Payments.Transfer.LiveSearchData=t},onRender:function(e,t){if($("#recipients-livesearch-query").val().replace(/[^a-z0-9]/gi,"").length>=2&&(i.main.currentView.main.currentView.unlockForm(),!o.addressBookMode)){var a=$(_.template(n,{}));a.on("mouseenter.livesearch",function(e){$(this).addClass("ui-livesearch-item-over")}).on("mouseleave.livesearch",function(e){$(this).removeClass("ui-livesearch-item-over")}),o.newTransferLSItemClickWrap(a,{searchPattern:t.search},{},s),t.displayedItems.length||a.addClass("special-rounded-all-corners"),e.prepend(a),t.displayedItems.unshift({element:a,item:{}})}l.setLastItemRoundedCorners(e)}})}},onClose:function(){},isLocked:function(){return"disabled"===$(".transfer-sidebar-view").parent().css({opacity:.6,cursor:"default",zIndex:-1}).find("input, radio, select, textarea").attr("disabled")}});return d}),define("text!transfer/templates/livesearch/addressbook-contact-phone-item.html",[],function(){return'<li>\r\n  <span class="photo-holder">\r\n    {% if (fbid) { %}\r\n      <img src="https://graph.facebook.com/{{fbid}}/picture" alt="" width="50" height="50" class="picture" />\r\n    {% } else { %}\r\n      <img src="/venezia/gfx/u/user-dummy-photo.jpg" alt="" width="50" height="50" class="picture" />\r\n    {% } %}\r\n  </span>\r\n  <span class="text-holder">\r\n      <span class="recipient-name">{{name}}</span><br />\r\n      {% if (templates.length) { %}\r\n        {%print(phoneTemplatesDescription(templates))%}\r\n      {% } %}\r\n  </span>\r\n</li>'}),define("transfer/js/views/livesearch-phone-charging",["text!../../templates/transfer-recipient-search.html","text!../../templates/livesearch/addressbook-contact-phone-item.html","text!../../templates/livesearch/addnew-row-item.html","../app","../logic/livesearch-common"],function(e,t,a,r,n){function i(e){if(e.searchType&&"phone"==e.searchType&&e.recipientId)return void r.trigger("transfer:new",{transferType:"phone",definedRecipientId:e.recipientId,definedTemplateId:e.transferId});var t=r.main.currentView.main.currentView.model,a=t.get("formData");return a.recipientId===Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId?void r.main.currentView.main.currentView.updateRecipientName(o.lastSearchValue):void r.trigger("transfer:new",{transferType:"phone",recipientName:o.lastSearchValue,definedRecipientId:Ebre.Modules.Payments.Transfer.LiveSearchService.EmptyRecepientId,defaultFormData:r.main.currentView.main.currentView.getCurrentFormData()})}n.initializeForBackboneApp(r);var o=n,s=Backbone.Marionette.Layout.extend({template:e,tagName:"section",className:"transfer-receiver",events:{"blur #recipients-livesearch-query":"blur","click .input-decorations":"toggleAddressbook"},regions:{results:".search-results-region"},blur:function(e){var t=$("#recipients-livesearch-query").val();if(t||o.lastSearchValue||r.main.currentView.main.currentView.lockForm(),t)if(t.replace(/[^a-z0-9]/gi,"").length<2)Ebre.Common.createErrorMessage(I18n.t("errors.invalidRecipientName"),I18n.t("errors.errorTransferNotSent")),r.main.currentView.main.currentView.lockForm(),o.lastSearchValue=t;else{r.main.currentView.main.currentView.unlockForm();var a=$("#recipients-livesearch-query").liveSearch("data")?$("#recipients-livesearch-query").liveSearch("data").getSelectedItem():null;a&&!a.element.hasClass("new-recipient")||(t===o.lastSearchValue?($(o.transferAppRootElement).find(".livesearch-border").removeClass("focus"),$("#live-search-field-wrapper .placeholder-livesearch, #livesearch-placeholder-for-ie10").hide(),o.focusFirstInput()):($(o.transferAppRootElement).find(".livesearch-border").removeClass("focus"),$(o.transferAppRootElement).find(".recipients-livesearch").find(".new-recipient").trigger("click")))}},focus:function(e,t){$(this).closest(".livesearch-border").addClass("focus");var a=$("#recipients-livesearch-query");a.val()&&a.liveSearch("trigger"),o.addressBookMode&&a.liveSearch("showSection","addressBookItemsList",{autoOpen:!0})},initialize:function(){},toggleAddressbook:function(e){o.toggleAddressbook(e)},onRender:function(){var e=this.model.get("formData");e.recipientName&&this.$("input[type=text]").val(e.recipientName).addClass("recipient-set"),o.setFocus(this),o.setTooltips(this),this.setLiveSearch(),o.lastSearchValue=this.$el.find("#recipients-livesearch-query").val(),o.bindEventHandlers(this,i),o.viewOnRender(this)},setLiveSearch:function(){var e=this,s=this.$el.find(".search-results-region");this.$el.find("#recipients-livesearch-query");if(Ebre.Modules.Payments.Transfer.LiveSearchPhoneData)e.$el.find(".livesearch-border").removeClass("working"),Ebre.Modules.Payments.Transfer.LiveSearchPhoneData.unsetSearch(),Ebre.Modules.Payments.Transfer.LiveSearchPhoneData.listElement=s,e.$el.find("#recipients-livesearch-query").removeClass("ui-livesearch-disabled").liveSearch(Ebre.Modules.Payments.Transfer.LiveSearchPhoneData);else{var l=function(e,t){if(d.addressBookItemsList.collection&&d.addressBookItemsList.collection.length){if(d.addressBookItemsList.collection[0]===e)return-1;if(d.addressBookItemsList.collection[0]===t)return 1}return 0},d={addressBookItemsList:{url:Ebre.Modules.Payments.Transfer.LiveSearchService.GetAddressBookPhoneDataUrl,fixed:!0,title:I18n.t("transfer.livesearch.group.addressbook"),searchProperties:["name"],itemTemplate:t,sortMethod:l}};e.$el.find("#recipients-livesearch-query").liveSearch({minimumChars:2,fetchOnInitialization:["addressBookItemsList"],listElement:s,getAjaxPromise:function(e){return e.data=JSON.stringify(e.data),Ebre.Proxy.VeneziaJSON(e)},limit:8,itemsToDisplay:8,onItemCreation:function(e,t,a,r){if("addressBookItemsList"==a.name){var n=a.liveSearchData.search;t.templates&&t.templates.length?o.newTransferLSItemClickWrap(e,{searchType:"phone",searchPattern:n,recipientId:t.id,transferId:t.templates[0].id,recipientName:t.name},t,i):o.newTransferLSItemClickWrap(e,{searchType:"phone",searchPattern:n,recipientId:t.id,recipientName:t.name},t,i)}},sections:d,showPreloaderInField:!1,onAjaxCallsStart:function(){var e=$("#recipients-livesearch-query"),t=e.closest(".livesearch-border");t.find(".live-search-preloader").length&&t.addClass("working"),$("#live-search-loader-tooltip").show()},onAjaxCallsEnd:function(){var e=$("#recipients-livesearch-query");if(e.closest(".livesearch-border").removeClass("working"),!e.parent().children(".live-search-preloader").length){var t=Ebre.Entity.isOF()?"../venezia/gfxOrange/preloader-3.gif":"../venezia/gfx/preloader-3.gif";e.parent().prepend('<img class="live-search-preloader" src="'+t+'" alt="" />')}$("#live-search-loader-tooltip").hide()},onSearchStart:function(e,t){var a=e.closest(".livesearch-border");a.find(".live-search-preloader").length&&a.addClass("working"),$("#live-search-loader-tooltip").show(),Ebre.Modules.Payments.Transfer.LiveSearchPhoneData=t},onSearchEnd:function(e,t){if(e.closest(".livesearch-border").removeClass("working"),!e.parent().children(".live-search-preloader").length){var a=Ebre.Entity.isOF()?"../venezia/gfxOrange/preloader-3.gif":"../venezia/gfx/preloader-3.gif";e.parent().prepend('<img class="live-search-preloader" src="'+a+'" alt="" />')}$("#live-search-loader-tooltip").hide(),Ebre.Modules.Payments.Transfer.LiveSearchPhoneData=t},templateHelpers:{phoneTemplatesDescription:function(e){if(e&&e.length){var t=e[0],a=t.name+" "+this.phoneNumberFormat(t.number);return 1==e.length?a:2==e.length?a+I18n.t("transfer.livesearch.titlesCount.and")+(e.length-1)+" "+I18n.t("transfer.livesearch.titlesCount.one"):e.length>2&&e.length<5?a+I18n.t("transfer.livesearch.titlesCount.and")+(e.length-1)+" "+I18n.t("transfer.livesearch.titlesCount.few"):a+I18n.t("transfer.livesearch.titlesCount.and")+(e.length-1)+" "+I18n.t("transfer.livesearch.titlesCount.other")}return""},phoneNumberFormat:function(e){return e&&("string"==typeof e||e instanceof String)&&9==e.length?e.substring(0,3)+" "+e.substring(3,6)+" "+e.substring(6,9):e}},onRender:function(e,t){if($("#recipients-livesearch-query").val().replace(/[^a-z0-9]/gi,"").length>=2&&(r.main.currentView.main.currentView.unlockForm(),!n.addressBookMode)){var s=$(_.template(a,{}));s.on("mouseenter.livesearch",function(e){$(this).addClass("ui-livesearch-item-over")}).on("mouseleave.livesearch",function(e){$(this).removeClass("ui-livesearch-item-over")}),n.newTransferLSItemClickWrap(s,{searchPattern:t.search},{},i),t.displayedItems.length||s.addClass("special-rounded-all-corners"),e.prepend(s),t.displayedItems.unshift({element:s,item:{}})}o.setLastItemRoundedCorners(e)}})}},onClose:function(){},isLocked:function(){return"disabled"===$(".transfer-sidebar-view").parent().css({opacity:.6,cursor:"default",zIndex:-1}).find("input, radio, select, textarea").attr("disabled")}});return s}),define("text!transfer/templates/transfer-sidebar-menu.html",[],function(){return'{% // $Id: transfer-sidebar-menu.html 241181 2013-03-27 09:54:39Z kkwiatkowski $ %}\r\n\r\n<div class="transfer-context-menu">\r\n    <ul class="transfers-types-list {% if (typeof sidebarData.sourceCategory === \'string\') { %}active-type-{{ sidebarData.sourceCategory }}{% } %}">\r\n    </ul>\r\n</div>'}),define("text!transfer/templates/transfer-sidebar-menu-item.html",[],function(){return'{% // $Id: transfer-sidebar-menu-item.html 267942 2013-09-02 14:29:06Z EBRE\\zew_2_6718 $ %}\r\n\r\n<li class="transfer-type-row {{ type }}-transfer {% if (disabled){ print(\'not-active\') } %}">\r\n    <a href="#/transfer" class="add-new" data-gemius-event-type="action" data-gemius-event-action-id="{{ getGemiusActionId(\'transfer.sidebar.\' + type) }}" data-gemius-event-action-name="transfer.sidebar.{{ type }}">\r\n        {# i18n(\'transfer.sidebar.option\', type) #}\r\n\r\n        {% if (_.contains([\'facebook\', \'mobile\'], type) && typeof amountLimit !== \'undefined\' && amountLimit) { %}\r\n            <br />\r\n            {% if (amountLimit!==null) { %}\r\n            {{ i18n(\'transfer.sidebar.limit.max\') }}\r\n            {{ l10n(\'currencyInteger\', amountLimit) }}\r\n            {{ i18n(\'transfer.sidebar.limit.currency\') }}\r\n            {% } %}\r\n        {% } %}\r\n\r\n        <span class="gfx"></span>\r\n\r\n        {% if (!_.contains([\'own\', \'facebook\', \'splitown\'], type)) { %}\r\n            <span class="dropdown-trigger btn-gray-gradient btn-small">\r\n                <i class="icon-big-plus"></i>\r\n            </span>\r\n        {% } %}\r\n    </a>\r\n    \r\n    {% if (!_.contains([\'own\', \'splitown\'], type)) { %}\r\n        <ul class="options-list">\r\n            {% _.each(templatesSidebar, function(transferTemplate, index) {%}\r\n                <li data-transferId="{{ type==\'facebook\' ? transferTemplate.p2pTemplateId : transferTemplate.templateId }}">\r\n                    <a href="javascript:void(0)" title="{{ transferTemplate.name }}" class="defined-transfer-link" data-transferid="{{ type==\'facebook\' ? transferTemplate.p2pTemplateId : transferTemplate.templateId }}" data-isown="{{ transferTemplate.own || false }}" data-gemius-event-type="action" data-gemius-event-action-id="{{ getGemiusActionId(\'transfer.sidebar.template.\' + type) }}" data-gemius-event-action-name="transfer.sidebar.template.{{ type }}">\r\n                        {% if (transferTemplate.phoneNum) { %}\r\n                        <span>\r\n                            {{ transferTemplate.phoneType }}\r\n                            {%print(phoneNumberFormat(transferTemplate.phoneNum))%}\r\n                        </span>\r\n                        {% } else{ %}\r\n                        <span>{{ transferTemplate.name }}</span>\r\n                        {% } %}\r\n                        {% if (transferTemplate.own) { %}\r\n                        <span class="bold">{{transferTemplate.ownBalance}}</span>\r\n                        {% } %}\r\n\r\n                        <span class="gfx"></span>\r\n                        {% if (transferTemplate.isTrusted) { %}\r\n                        <span class="trusted"></span>\r\n                        {% } %}\r\n                    </a>\r\n                </li>\r\n            {% }); %}\r\n        \r\n            <li class="add-new-account new-transfer-{{ type }} active" style="display:none">\r\n                <a href="javascript:void(0)" data-gemius-event-type="action" data-gemius-event-action-id="{{ getGemiusActionId(\'transfer.sidebar.\' + type) }}" data-gemius-event-action-name="transfer.sidebar.{{ type }}">\r\n                    <span>{{ i18n(\'transfer.sidebar.add\', type) }}</span>\r\n                    <span class="gfx"></span>\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    {% } %}\r\n</li>'}),define("text!transfer/templates/dialogs/facebook-settings-warning.html",[],function(){return"<div class='layer-content settings-warning'>\r\n  <a class=\"cancel \" href=\"javascript:void(0);\">{{I18n.t('transfer.facebook.warningDialog.cancel')}}</a>\r\n  <h2>{{I18n.t('transfer.facebook.warningDialog.header')}}</h2>\r\n  <ul>\r\n    <li>{{I18n.t('transfer.facebook.warningDialog.point1')}}</li>\r\n    <li>{{I18n.t('transfer.facebook.warningDialog.point2')}}</li>\r\n    <li>{{I18n.t('transfer.facebook.warningDialog.point3')}} <strong>{{amountLimit}} {{ I18n.t('transfer.sidebar.limit.currency') }}</strong></li>\r\n  </ul>\r\n  <span>{{I18n.t('transfer.facebook.warningDialog.description')}}</span>\r\n  <div class=\"actions\">\r\n    <a class=\"connect-to-fb btn-gray-gradient\" href=\"javascript:void(0);\"><span>{{I18n.t('transfer.facebook.warningDialog.add')}}</span></a>\r\n    <a class=\"cancel btn-gray-gradient\" href=\"javascript:void(0);\">{{I18n.t('transfer.facebook.warningDialog.cancel')}}</a>\r\n  </div>\r\n</div>"}),define("transfer/js/views/dialogs/facebook-settings-warning",["../../app","text!../../../templates/dialogs/facebook-settings-warning.html"],function(e,t){return Backbone.Marionette.CompositeView.extend({template:t,className:"warning-dialog",itemViewContainer:".layer-content",events:{"click .cancel":"cancel","click .connect-to-fb":"goToSettings"},beforeRender:function(){e.trigger("toggle:modal:screen")},hideLayer:function(){e.trigger("toggle:modal:screen",!0);var t=this.$el;t.fadeOut(600,function(){$(this).remove()})},cancel:function(){var t=this.model.get("cancelEvent");t&&e.trigger(t,_.extend({},this.model.get("cancelEventData"))),this.hideLayer()},goToSettings:function(){return Ebre.Common.NavigateTo("#Settings/Facebook"),this.hideLayer(),!1},onRender:function(){this.$el.attr("id","facebook-settings-warning-dialog")}})}),define("text!transfer/templates/dialogs/addressbook-warning.html",[],function(){return'<div class=\'layer-content addressbook-warning\'>\r\n  <a class="cancel " href="javascript:void(0);">{{I18n.t(\'transfer.addressbook.warningDialog.cancel\')}}</a>\r\n  <h2>{{I18n.t(\'transfer.addressbook.warningDialog.header\')}}</h2>\r\n  <span>{{I18n.t(\'transfer.addressbook.warningDialog.description\')}}</span>\r\n  <div class="actions">\r\n    <a class="go-to-addressbook btn-gray-gradient" href="javascript:void(0);"><span>{{I18n.t(\'transfer.addressbook.warningDialog.ok\')}}</span></a>\r\n    <a class="cancel btn-gray-gradient" href="javascript:void(0);">{{I18n.t(\'transfer.addressbook.warningDialog.cancel\')}}</a>\r\n  </div>\r\n</div>'}),define("transfer/js/views/dialogs/addressbook-warning",["../../app","text!../../../templates/dialogs/addressbook-warning.html"],function(e,t){return Backbone.Marionette.CompositeView.extend({template:t,className:"warning-dialog",itemViewContainer:".layer-content",events:{"click .cancel":"hideLayer","click .go-to-addressbook":"goToAb"},beforeRender:function(){e.trigger("toggle:modal:screen")},hideLayer:function(){e.trigger("toggle:modal:screen",!0);var t=this.$el;t.fadeOut(600,function(){$(this).remove()})},goToAb:function(){return Ebre.Common.NavigateTo("#/AddressBook"),this.hideLayer(),!1},onRender:function(){this.$el.attr("id","addressbook-warning-dialog")}})}),define("transfer/js/views/transfer-sidebar-menu",["../app","text!../../templates/transfer-sidebar-menu.html","text!../../templates/transfer-sidebar-menu-item.html","./dialogs/facebook-settings-warning","./dialogs/addressbook-warning"],function(e,t,a,r,n){var i=Backbone.Marionette.ItemView.extend({template:a,events:{"click .defined-transfer-link":"loadPredefinedTransferForm","click .add-new":"loadNewTransferForm","focus .add-new":"highlight","blur .add-new":"lowpoint","focus .defined-transfer-link":"highlight","blur .defined-transfer-link":"lowpoint"},loading:!1,loadPredefinedTransferForm:function(t){if(this.loading)return!1;this.loading=!0,e.trigger("sidebar:lock");var a=this,r=$(t.currentTarget),n=r.attr("data-transferId"),i="true"===r.attr("data-isOwn"),o={transferType:this.model.get("type"),definedRecipientId:this.model.get("contactId"),definedTemplateId:n,own:i,fromSidebar:!0,callback:function(){a.loading=!1,e.trigger("sidebar:unlock")}};if("facebook"==o.transferType){var s=$(t.currentTarget).find("span").eq(0).text(),l=s!==I18n.t("transfer.sidebar.option.facebookError")?s:null;
o=_.extend(o,{facebookName:l,definedTemplateId:null,facebookId:n})}e.trigger("transfer:new",o),t.preventDefault()},loadNewTransferForm:function(t){if(this.loading)return!1;this.loading=!0,e.trigger("sidebar:lock");var a=this;if(!this.model.get("disabled"))switch(this.model.get("type")){case"facebook":var i=this.model.get("amountLimit"),o=this.model,s=$.Deferred();e.getP2PAppData(s.resolve,function(){e.trigger("sidebar:unlock"),a.loading=!1}),s.done(function(t){if(t.installed)if(a.model.attributes.templatesSidebar&&"undefined"!=typeof a.model.attributes.templatesSidebar[0]&&"undefined"!=typeof a.model.attributes.templatesSidebar[0].templateId)e.trigger("transfer:new",{transferType:o.get("type"),definedRecipientId:o.get("contactId"),facebookId:o.attributes.templatesSidebar[0].p2pTemplateId,recipientName:e.main.currentView.main.currentView.model.toJSON().formData.recipientName,fromSidebar:!0,callback:function(){a.loading=!1,e.trigger("sidebar:unlock")}});else{if(0==$(".addressbook-warning").length){var s=new n;s.render(),s.$el.hide(),$("#transfer-container").append(s.$el),s.$el.fadeIn(200)}a.loading=!1,e.trigger("sidebar:unlock")}else{if(0==$(".settings-warning").length){var s=new r({model:new Backbone.Model({amountLimit:i})});s.render(),s.$el.hide(),$("#transfer-container").append(s.$el),s.$el.fadeIn(200)}a.loading=!1,e.trigger("sidebar:unlock")}});break;default:e.trigger("transfer:new",{transferType:this.model.get("type"),definedRecipientId:this.model.get("contactId"),recipientName:e.main.currentView.main.currentView.model.toJSON().formData.recipientName,fromSidebar:!0,callback:function(){a.loading=!1,e.trigger("sidebar:unlock")}})}t.preventDefault()},highlight:function(e){$(e.target).addClass("ui-anchor-highlight")},lowpoint:function(e){$(e.target).removeClass("ui-anchor-highlight")},onRender:function(){this.$el.find("a").attr("tabindex","2")},templateHelpers:function(){return $.extend({},Backbone.Marionette.CompositeView.prototype.templateHelpers,{phoneNumberFormat:function(e){return e&&("string"==typeof e||e instanceof String)&&9==e.length?e.substring(0,3)+" "+e.substring(3,6)+" "+e.substring(6,9):e}})}()}),o=Backbone.Marionette.CompositeView.extend({template:t,itemView:i,tagName:"section",className:"sidebar-view",markActive:function(e){var t=this.$(".transfers-types-list");this.clearActive(),t.addClass("active-type-"+e.activeFormType);var a=t.find('li[data-transferId="'+e.activeTemplateId+'"]').addClass("active");a.length||("facebook"!==e.activeFormType?t.find(".transfer-type-row."+e.activeFormType+"-transfer li.add-new-account").show().addClass("active"):t.find(".transfer-type-row.facebook-transfer li").addClass("active"))},clearActive:function(e){var t=this.$(".transfers-types-list");t.attr("class",$.trim(t.attr("class").replace(/active-type-.+\b/g,""))),this.$("li.active").removeClass("active"),this.$("li.add-new-account").hide()},collapseItems:function(e){this.$el.find("ul.options-list").hide()},appendHtml:function(e,t){var a,r=this.model.get("formType"),n=t.model.get("type"),i=n===r;i&&(a=t.$('li[data-transferId="'+this.model.get("sidebarData").activeTemplateId+'"]').addClass("active"),a.length||"facebook"==n?this.model.get("formData").p2pTemplateId&&t.$('li[data-transferId="'+this.model.get("formData").p2pTemplateId+'"]').addClass("active"):t.$("li.add-new-account").show()),e.$(".transfers-types-list").append(t.el)},onRender:function(){var t=e.cache.fbManager,a=this.$el.find(".transfer-type-row.facebook-transfer .options-list");a.length&&a.children().each(function(){var e=$(this),a=$(this).data("transferid");if("undefined"!=typeof a&&""!=a){var r=e.children(":first"),n="undefined"!=typeof t.fetchedData[a]?t.fetchedData[a].name:I18n.t("transfer.sidebar.option.facebookError");r.attr("title",n).children(":first").text(n)}}),this.model.get("sidebarData").isContactShared&&this.$el.find(".abroad-transfer > a,.domestic-transfer > a,.us-transfer > a,.zus-transfer > a,.splitdomestic-transfer > a,.splitown-transfer > a").each(function(){$(this).off("click").on("click",function(){return $(this).removeClass("ui-anchor-highlight"),!1}).find(".dropdown-trigger").hide()})}});return o}),define("text!transfer/templates/transfer-step2.html",[],function(){return'<div class="form-view">\r\n        <section class="form-transfer-domestic-summary">\r\n            <form onsubmit="javascript:return false;">\r\n                <fieldset>\r\n                    <hr />\r\n                    <div class="row{{ (isRecipientChanged) ? \' validation info\': \'\' }}">\r\n                        <div class="header">\r\n                            <span class="label">{{ i18n(\'transfer.step2.recipient\') }}</span>\r\n                        </div>\r\n                        <div class="fields">\r\n                            {% if (isRecipientChanged) { %}\r\n                            <span class="validation-icon"></span> \r\n                            {% } %}\r\n                            <dl>\r\n                                <dt></dt>\r\n                                <dd class="word-break"><strong>{{ summaryData.recipientName }}</strong></dd>\r\n                            </dl>\r\n                                {% if (isRecipientChanged) { %}\r\n                                <span class="info margin-bottom">{{ i18n(\'transfer.step2.recipientChanged\') }}</span>\r\n                                {% } %}\r\n                        </div>\r\n                    </div>\r\n                    <div class="row">\r\n                        <div class="header">\r\n          \r\n                        </div>\r\n                            <div class="fields">\r\n                                <dl>\r\n                                {% if (\'zusOperations\' in summaryData && summaryData.zusOperations != null && summaryData.zusOperations.length > 0){ %}\r\n                                \r\n                                    {% _.each(summaryData.zusOperations, function(operation){ %}\r\n                                        <dt>{{ i18n(\'transfer.step2.zus.title\', operation.zusType) }}</dt>\r\n                                        <dd class="amount-value">{{ l10nCurrency(operation.amount, operation.currency) }} {{ operation.currency }}</dd>\r\n                                        \r\n                                        <dt>{{ i18n(\'transfer.step2.zus.toAccount\') }}</dt>\r\n                                        <dd class="margin-bottom">{{ operation.account }}</dd>\r\n                                        \r\n                                    {% }) %}\r\n                                \r\n                                  <dt></dt>\r\n                                  <dd>{{ l10n("date.formats.default", summaryData.zusOperationsDate) }}</dd>\r\n                                \r\n                                {% } else { %}\r\n                                    \r\n                                    {% _.each(summaryData.operations, function(operation){ %}\r\n                                        \r\n                                        {% _.each(operation.transfers, function(transfer){ %}\r\n    \r\n                                            <dt></dt>\r\n                                    <dd class="amount-value">\r\n                                        {% if (summaryData.formType !== \'splitown\'){ %} \r\n                                            {{ l10nCurrency(transfer.amount, transfer.currency) }} {{ transfer.currency }} \r\n                                        {% } %}\r\n                                        {% if (summaryData.isSplitTransfer){ %} \r\n                                            {% if (summaryData.formType !== \'splitown\'){ %} \r\n                                                {{  i18n(\'transfer.step2.includingVat\') }}\r\n                                            {% } %}\r\n                                            {{ l10nCurrency(transfer.vatAmount, transfer.currency) }} {{ transfer.currency }}\r\n                                        {% } %}\r\n                                    </dd>\r\n                                            \r\n                                        {% if (operation.multipleTransfers){ %}\r\n                                        {% if (summaryData.isSplitTransfer){ %}\r\n                                            <dt></dt>\r\n                                            <dd class="word-break margin-bottom"></dd>\r\n                                            <dt></dt>\r\n                                            <dd class="word-break">\r\n                                                {% if (summaryData.formType === \'splitown\'){ %} \r\n                                                    {{ summaryData.providerType }}: {{ summaryData.providerId }}\r\n                                                {% } else { %}\r\n                                                    {{ i18n(\'transfer.split.idType\') }}: {{ summaryData.providerType }} - {{ summaryData.providerId }}\r\n                                                {% } %}\r\n                                            </dd>\r\n                                            <dt></dt>\r\n                                            <dd class="word-break">{{ i18n(\'transfer.step2.transfers.invoiceNumber\') }} {{ transfer.invoiceNumber }}</dd>\r\n                                        {% } %}\r\n                                        {% if(transfer.title){%}\r\n                                                    <dt></dt>\r\n                                                    <dd class="word-break">{{ i18n(\'transfer.step2.transfers.title\') }} {{ transfer.title }}</dd>\r\n                                                {% } %}\r\n                                              <dt></dt>\r\n                                              <dd class="margin-bottom">{{ l10n("date.formats.default", transfer.date) }}</dd>\r\n                                        {% } else { %}\r\n                                                {% if (summaryData.isSplitTransfer){ %}\r\n                                                    <dt></dt>\r\n                                                    <dd class="word-break margin-bottom"></dd>\r\n                                                    <dt></dt>\r\n                                                    <dd class="word-break">\r\n                                                        {% if (summaryData.formType === \'splitown\'){ %} \r\n                                                            {{ summaryData.providerType }}: {{ summaryData.providerId }}\r\n                                                        {% } else { %}\r\n                                                            {{ i18n(\'transfer.split.idType\') }}: {{ summaryData.providerType }} - {{ summaryData.providerId }}\r\n                                                        {% } %}\r\n                                                    </dd>\r\n                                                    <dt></dt>\r\n                                                    <dd class="word-break">{{ i18n(\'transfer.step2.transfers.invoiceNumber\') }} {{ transfer.invoiceNumber }}</dd>\r\n                                                {% } %}\r\n                                                {% if(transfer.title){%}\r\n                                                    <dt></dt>\r\n                                                    <dd class="word-break margin-bottom">{{ i18n(\'transfer.step2.transfers.title\') }} {{ transfer.title }}</dd>\r\n                                                {% } %}\r\n                                            {% } %}\r\n                                            \r\n                                        {% }) %}\r\n                                        \r\n                                        <dt>{{  i18n(\'transfer.step2.toAccount\') }}</dt>\r\n                                        <dd class="toAccount">\r\n                                             {% if (summaryData.isAbroad) { %}\r\n                                                {% if (summaryData.isInEOG) { %}\r\n                                                    {{ formatGenericAccountNumber(operation.toAccount.value) }}\r\n                                                {% } else { %} \r\n                                                    {{ operation.toAccount.value }}\r\n                                                {% } %}\r\n                                             {% } else if (operation.toAccount.value && operation.toAccount.value.length == 26) { %}\r\n                                                 {{ formatAccount(operation.toAccount.value) }}\r\n                                            {% } else if (operation.toAccount.value && operation.toAccount.value.length > 20) { %} \r\n                                                {{ operation.toAccount.value }}\r\n                                             {% } else if (operation.toAccount.value && operation.toAccount.value.length > 8) { %} \r\n                                                {{ formatPhoneNumber(operation.toAccount.value) }}\r\n                                             {% } else { %} \r\n                                                {{ operation.toAccount.value }}\r\n                                             {% } %}\r\n                                        </dd>\r\n                                        \r\n                                        <dt></dt>\r\n                                         {% if (operation.toBank!=null) { %}\r\n                                            <dd>{{  i18n(\'transfer.step2.toBank\')  }} {{ operation.toBank.value }}</dd>\r\n                                        {% } %}\r\n                                        {% if (!operation.multipleTransfers && !summaryData.isRepeatableTransfer){ %}\r\n                                          <dt></dt>\r\n                                          <dd>{{ l10n("date.formats.default", operation.transfers[0].date) }}</dd>\r\n                                        {% } %}\r\n                                        \r\n                                    {% }) %}\r\n                                    \r\n                                    {% if(summaryData.isRepeatableTransfer) { %}\r\n                                        <dt></dt>\r\n                                        <dd>\r\n                                            {{ summaryData.repeatFor }}\r\n                                            {{ i18n(\'transfer.step2.repeatableTransfer.repeatFrom\') }}\r\n                                            {{ $.datepicker.formatDate(\'dd.mm.yy\', new Date(summaryData.repeatableTransfer.calendars.dateFrom)) }}\r\n                                            {% if(summaryData.repeatableTransfer.repeatRow.untilFurtherNotice) { %}\r\n                                                {{ i18n(\'transfer.step2.repeatableTransfer.untilCancellation\') }}\r\n                                            {% } else { %}\r\n                                                {{ i18n(\'transfer.step2.repeatableTransfer.repeatTo\') }}\r\n                                                {{ $.datepicker.formatDate(\'dd.mm.yy\', new Date(summaryData.repeatableTransfer.calendars.dateTo)) }}\r\n                                            {% } %}\r\n                                        </dd>\r\n                                    {% } %}\r\n                                {% } %}\r\n                            </dl>\r\n                        </div>\r\n                    </div>\r\n                    <hr />\r\n                    <div class="row">\r\n                        <div class="header">\r\n                            <span class="label">{{ i18n(\'transfer.step2.additionalInfo\') }}</span>\r\n                        </div>\r\n                        <div class="fields">\r\n                            <dl class="additional-info">\r\n                                {% if (summaryData.formType !== \'splitown\'){ %} \r\n                                    <dt>{{ i18n(\'transfer.step2.fromAccount\') }}</dt>\r\n                                    <dd>{{ summaryData.additionalInfo.fromAccount.label }}  <strong> (<span class="saldo">{{ l10n(\'currency\', summaryData.additionalInfo.fromAccount.balance) }} {{ summaryData.additionalInfo.fromAccount.currency }}</span>)</strong></dd>\r\n                                {% } %}\r\n                                {% if (summaryData.isSplitTransfer || summaryData.isVatUSTransfer){ %}\r\n                                <dt>\r\n                                    {% if (summaryData.formType === \'splitown\'){ %} \r\n                                        {{ i18n(\'transfer.step2.fromAccount\') }}\r\n                                    {% } else { %}\r\n                                        {{ i18n(\'transfer.step2.fromAccountVat\') }}\r\n                                    {% } %}\r\n                                </dt>\r\n                                <dd>{{ summaryData.additionalInfo.fromAccountVat.label }}  <strong> (<span class="saldo">{{ l10n(\'currency\', summaryData.additionalInfo.fromAccountVat.balance) }} {{ summaryData.additionalInfo.fromAccountVat.currency }}</span>)</strong></dd>\r\n                                <dt></dt>\r\n                                <dd class="word-break margin-bottom"></dd>\r\n                                {% } %}\r\n                                {% if (summaryData.formType !== \'splitown\'){ %} \r\n                                    {% _.each(summaryData.additionalInfo.additionalFields, function(extraField){ \r\n                                    \r\n                                    if ( extraField.value !== null && extraField.value !== undefined && extraField.value.trim() !== \'\' ){ %}\r\n                                    <dt>{{ extraField.label }}</dt>\r\n                                    <dd>{{ extraField.value }}</dd>\r\n                                    {% }}); %}\r\n                                {% } %}\r\n                                \r\n                                {% if (summaryData.recipientNameChanged) { %}\r\n                                    <dd class="blue">{{ i18n(\'transfer.step2.recipientNameChanged\') }}</dd>\r\n                                {% } %}\r\n    \r\n                                {% if(summaryData.isRepeatableTransfer) { %}\r\n                                    <dt>{{ i18n(\'transfer.step2.soPaymentName\') }}</dt>\r\n                                    <dd>{{ summaryData.ownPaymentName }}</dd>\r\n                                {% } %}\r\n    \r\n                                {% if(summaryData.isSeriesOfTransfers) { %}\r\n                                    <dt>{{ i18n(\'transfer.step2.seriesPaymentName\') }}</dt>\r\n                                    <dd>{{ summaryData.ownPaymentName }}</dd>\r\n                                {% } %}\r\n    \r\n                                {% _.each(summaryData.additionalInfo.extraFields, function(extraField){ %}\r\n                                  <dt class="muted">{{ extraField.label }}</dt>\r\n                                  <dd class="muted">{{ extraField.value }}</dd>\r\n                                {% }); %}\r\n                               {% if ( typeof incomeSourceName!=="undefined" && incomeSourceName!==null \r\n                                    && typeof paymentPurposeName!=="undefined" && paymentPurposeName!==null) { %}\r\n                                    <dt class="muted"></dt>\r\n                                    <dd class="muted">{{ i18n(\'transfer.domestic.pepLabel\') }}:  {{ paymentPurposeName }}, {{ incomeSourceName }}</dd>\r\n                                {% } %}         \r\n                                {% // if (!summaryData.isDefined){ %}\r\n                                  <dt class="muted clear"></dt>\r\n                                  <dd class="muted">\r\n                                      {% _.each(summaryData.additionalInfo.checkboxes, function(checkboxField){ %}\r\n                                        {% if(checkboxField.isChecked){ %}\r\n                                            <div class="step-2-additional-option {% if(checkboxField.label == \'addToTrustedList\' || checkboxField.label == \'addToAddressBook\') { %} inline {% } %}">\r\n                                                <label class="after-input" for="{{ checkboxField.label }}">\r\n                                                    {{ i18n(\'transfer.step2.checkboxes\', checkboxField.label) }}{% if(checkboxField.additionalLabel) { %}: {{ checkboxField.additionalLabel }}{% } %}{% if(checkboxField.additionalLabelNewLine) { %}\r\n                                                        <br />{{ checkboxField.additionalLabelNewLine }}\r\n                                                    {% } %}\r\n                                                </label>\r\n                                            </div>\r\n                                        {% } %}\r\n                                      {% }); %}\r\n                                  </dd>\r\n                                {% // } %}\r\n                                \r\n                                {% _.each(summaryData.additionalInfo.additionalOptions, function(option){ %}\r\n                                  <dt class="muted">{{ option.label }}</dt>\r\n                                  <dd class="muted">{{ option.value }}</dd>\r\n                                {% }); %}\r\n                                \r\n                                {% if (addToBasket) { %}\r\n                                    <dd class="blue">{{ i18n(\'transfer.step2.addingToBasket\') }}</dd>\r\n                                {% } %}\r\n                            </dl>\r\n                        </div>\r\n                    </div>  \r\n                    <hr />\r\n                        {% if (authType == \'sms\' && !(addToBasket && isBasketModified)) { %}\r\n                        {% if (addToBasket && !isBasketModified) { %}\r\n                        <div class="row">\r\n                            <div class="header">\r\n                            </div>\r\n                            <div class="fields">\r\n                                <span>\r\n                                    {{ i18n(\'transfer.step2.basketInit\') }}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        {% } %}\r\n                        <div class="row row-auth-code row-sms-pass auth-plugin">\r\n                            <div class="header">\r\n                                <label for="authorizationCode">\r\n                                    <span>{{ i18n(\'transfer.step2.auth.smsCode\') }}</span>\r\n                                    <span class="sms-id">\r\n                                        ({{ i18n(\'transfer.step2.auth.nr\') }} {{ authMessageParam1 }} {{ i18n(\'transfer.step2.auth.fromDay\') }}\r\n                                        {% if(authMessageParam2 && !_.isDate(authMessageParam2)) {  %}\r\n                                        {%    authMessageParam2 = $.datepicker.parseDate(\'yy-mm-dd\',authMessageParam2.substring(0,10)); %}\r\n                                        {% } %}\r\n                                        {{ $.datepicker.formatDate(\'dd.mm.yy\', authMessageParam2) }})\r\n                                    </span>\r\n                                </label>\r\n                            </div>\r\n                            <div class="fields">\r\n                                <span class="validation-icon"></span>\r\n                                <input type="text" id="authorizationCode" class="field-high" name="smsCode" maxlength=8 />\r\n                                <span class="validation-text"></span>\r\n                            </div>\r\n                        </div>\r\n                        {% } else if (authType == \'tan\'){ %}\r\n                        <div class="row row-auth-code row-sms-pass auth-plugin">\r\n                            <div class="header">\r\n                                <label for="authorizationCode">\r\n                                    <span>{{ i18n(\'transfer.step2.auth.tanCode\') }}</span>\r\n                                    <span class="tan-id">\r\n                                        (nr {{ authMessageParam1 }} z listy nr {{ authMessageParam2 }})\r\n                                    </span>\r\n                                </label>\r\n                            </div>\r\n                            <div class="fields">\r\n                                <span class="validation-icon"></span>\r\n                                <input type="password" id="authorizationCode" class="field-high" name="tanCode" maxlength=5 />\r\n                                <span class="validation-text"></span>\r\n                            </div>\r\n                        </div>\r\n                         {% } else if (authType == \'token\' && !(addToBasket && isBasketModified)){ %}\r\n                            <div class="auth-plugin"></div>\r\n                        {% } else { %}\r\n                        {% } %}\r\n                    <div class="row">\r\n                        <div class="fields action-buttons">\r\n                            {% _.each(actions, function(action, i){ %}\r\n                            <a href="#" title="{{ action.name }}" class="{{ action.action }}-action {% print(((!i && authType!=\'token\') || (authType==\'token\' && action.action==\'proceed\')) ? \'btn-red-gradient\' : \'btn-gray-gradient\') %}"\r\n                               {% print((action.action == "edit") ? \'data-gemius-event-type="action" data-gemius-event-action-id="\' + getGemiusActionId(\'transfer.step2.modify\') + \'" data-gemius-event-action-name="transfer.step2.modify"\':\'\') %}>\r\n                                    {{ action.name }}\r\n                                </a>\r\n                            {% }) %}\r\n                        </div>\r\n                    </div>\r\n                 \r\n                </fieldset>\r\n    \r\n            </form>\r\n        </section>\r\n    </div>'}),define("text!transfer/templates/transfer-step2-phone.html",[],function(){return'<div class="form-view">\r\n    <section class="form-transfer-domestic-summary">\r\n        <form onsubmit="javascript:return false;">\r\n            <fieldset>\r\n                <hr />\r\n                <div class="row">\r\n                    <div class="header">\r\n                        <span class="label">{{ i18n(\'transfer.step2.recipient\') }}</span>\r\n                    </div>\r\n                    <div class="fields">\r\n                        <dl>\r\n                            <dd class="word-break margin-bottom"><strong>{{ summaryData.recipientName }}</strong></dd>\r\n                            <dt></dt>\r\n                                {% _.each(summaryData.operations, function(operation){ %}\r\n                                    \r\n                                    {% _.each(operation.transfers, function(transfer){ %}\r\n\r\n                                        <dt></dt>\r\n                                        <dd class="amount-value">{{ l10n(\'currency\', transfer.amount) }} {{ transfer.currency }}</dd>\r\n                                                                                \r\n                                    {% }) %}\r\n                                {% }) %}\r\n                            {% if(phoneNumber){%}\r\n                                <dt></dt>\r\n                                <dd class="word-break">{{ i18n(\'transfer.step2.transfers.phoneNumber\') }} {{ phoneNumber }}</dd>\r\n                            {%}%}\r\n                            {% if(operatorId){%}\r\n                                <dt></dt>\r\n                                <dd class="word-break">{{ i18n(\'transfer.step2.transfers.operator\') }} {{ operatorId }}</dd>\r\n                            {%}%}\r\n\r\n                            \r\n                                {% _.each(summaryData.operations, function(operation){ %}                                    \r\n                                    {% _.each(operation.transfers, function(transfer){ %}\r\n                                        {% if (!operation.multipleTransfers && !summaryData.isRepeatableTransfer){ %}\r\n                                            <dt></dt>\r\n                                            <dd>{{ l10n("date.formats.default", operation.transfers[0].date) }}</dd>\r\n                                        {% } %}\r\n                                    {% }) %}\r\n                                {% }) %}                            \r\n                        </dl>\r\n                    </div>\r\n                </div>\r\n                <hr />\r\n                <div class="row">\r\n                    <div class="header">\r\n                        <span class="label">{{ i18n(\'transfer.step2.additionalInfo\') }}</span>\r\n                    </div>\r\n                    <div class="fields">\r\n                        <dl class="additional-info">\r\n                            <dt>{{ i18n(\'transfer.step2.fromAccount\') }}</dt>\r\n                            <dd>{{ summaryData.additionalInfo.fromAccount.label }}  <strong> (<span class="saldo">{{ l10n(\'currency\', summaryData.additionalInfo.fromAccount.balance) }} {{ summaryData.additionalInfo.fromAccount.currency }}</span>)</strong></dd>\r\n                            \r\n                            {% _.each(summaryData.additionalInfo.additionalFields, function(extraField){ %}\r\n                              <dt>{{ extraField.label }}</dt>\r\n                              <dd>{{ extraField.value }}</dd>\r\n                            {% }); %}\r\n                            \r\n                            {% if(summaryData.isRepeatableTransfer) { %}\r\n                                <dt>{{ i18n(\'transfer.step2.soPaymentName\') }}</dt>\r\n                                <dd>{{ summaryData.ownPaymentName }}</dd>\r\n                            {% } %}\r\n\r\n                            {% if(summaryData.isSeriesOfTransfers) { %}\r\n                                <dt>{{ i18n(\'transfer.step2.seriesPaymentName\') }}</dt>\r\n                                <dd>{{ summaryData.ownPaymentName }}</dd>\r\n                            {% } %}\r\n                            \r\n                            {% _.each(summaryData.additionalInfo.extraFields, function(extraField){ %}\r\n                              <dt class="muted">{{ extraField.label }}</dt>\r\n                              <dd class="muted">{{ extraField.value }}</dd>\r\n                            {% }); %}\r\n                            \r\n                            {% // if (!summaryData.isDefined){ %}\r\n                              <dt class="muted"></dt>\r\n                              <dd class="muted">\r\n                                  {% _.each(summaryData.additionalInfo.checkboxes, function(checkboxField){ %}\r\n                                    {% if(checkboxField.isChecked){ %}\r\n                                        <div class="step-2-additional-option {% if(checkboxField.label == \'addToTrustedList\' || checkboxField.label == \'addToAddressBook\') { %} inline {% } %}">\r\n                                            <label class="after-input" for="{{ checkboxField.label }}">\r\n                                                {{ i18n(\'transfer.step2.checkboxes\', checkboxField.label) }}{% if(checkboxField.additionalLabel) { %}: {{ checkboxField.additionalLabel }}{% } %}{% if(checkboxField.additionalLabelNewLine) { %}\r\n                                                    <br />{{ checkboxField.additionalLabelNewLine }}\r\n                                                {% } %}\r\n                                            </label>\r\n                                        </div>\r\n                                    {% } %}\r\n                                  {% }); %}\r\n                              </dd>\r\n                            {% // } %}\r\n                            \r\n                            {% _.each(summaryData.additionalInfo.additionalOptions, function(option){ %}\r\n                              <dt class="muted">{{ option.label }}</dt>\r\n                              <dd class="muted">{{ option.value }}</dd>\r\n                            {% }); %}\r\n                            \r\n                            {% if (addToBasket) { %}\r\n                                <dd class="blue">{{ i18n(\'transfer.step2.addingToBasket\') }}</dd>\r\n                            {% } %}\r\n                        </dl>\r\n                    </div>\r\n                </div>               \r\n                {% if (authType == \'sms\' && !(addToBasket && isBasketModified)) { %}\r\n                <hr />\r\n                {% if (addToBasket && !isBasketModified) { %}\r\n                <div class="row">\r\n                    <div class="header">\r\n                    </div>\r\n                    <div class="fields">\r\n                        <span>\r\n                            {{ i18n(\'transfer.step2.basketInit\') }}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                {% } %}\r\n                <div class="row row-auth-code row-sms-pass">\r\n                    <div class="header">\r\n                        <label for="authorizationCode">\r\n                            <span>{{ i18n(\'transfer.step2.auth.smsCode\') }}</span>\r\n                            <span class="sms-id">\r\n                                ({{ i18n(\'transfer.step2.auth.nr\') }} {{ authMessageParam1 }} {{ i18n(\'transfer.step2.auth.fromDay\') }} \r\n                                {% if(_.isDate(authMessageParam2)) { %}\r\n                                    {{ authMessageParam2 }})\r\n                                {% } else { %}\r\n                                    {{ $.datepicker.formatDate(\'dd.mm.yy\', $.datepicker.parseDate(\'yy-mm-dd\',authMessageParam2.substring(0,10))) }})\r\n                                {% } %}\r\n                            </span>\r\n                        </label>\r\n                    </div>\r\n                    <div class="fields">\r\n                        <span class="validation-icon"></span>\r\n                        <input type="text" id="authorizationCode" class="field-high" name="smsCode" maxlength="8" />\r\n                        <span class="validation-text"></span>\r\n                    </div>\r\n                </div>\r\n                {% } else if (authType == \'tan\'){ %}\r\n                <hr />\r\n                <div class="row row-auth-code row-sms-pass">\r\n                    <div class="header">\r\n                        <label for="authorizationCode">\r\n                            <span>{{ i18n(\'transfer.step2.auth.tanCode\') }}</span>\r\n                            <span class="tan-id">\r\n                                (nr {{ authMessageParam1 }} z listy nr {{ authMessageParam2 }})\r\n                            </span>\r\n                        </label>\r\n                    </div>\r\n                    <div class="fields">\r\n                        <span class="validation-icon"></span>\r\n                        <input type="password" id="authorizationCode" class="field-high" name="tanCode" maxlength="5"/>\r\n                        <span class="validation-text"></span>\r\n                    </div>\r\n                </div>\r\n                {% } else if (authType == \'token\' && !(addToBasket && isBasketModified)){ %}\r\n                <hr />\r\n                <div class="auth-plugin"></div>\r\n                {% } else { %}\r\n                                    \r\n                {% } %}\r\n                \r\n                <div class="row">\r\n                    <div class="fields action-buttons">\r\n                        {% _.each(actions, function(action, i){ %}\r\n                            <a href="#" title="{{ action.name }}" class="{{ action.action }}-action {% print(!i ? \'btn-red-gradient\' : \'btn-gray-gradient\') %}" \r\n                               {% print((action.action == "edit") ? \'data-gemius-event-type="action" data-gemius-event-action-id="\' + getGemiusActionId(\'transfer.step2.modify\') + \'" data-gemius-event-action-name="transfer.step2.modify"\':\'\') %}>\r\n                                {{ action.name }}\r\n                            </a>\r\n                        {% }) %}\r\n                    </div>\r\n                </div>\r\n             \r\n            </fieldset>\r\n\r\n        </form>\r\n    </section>\r\n</div>';
}),define("text!transfer/templates/transfer-step2-p2p.html",[],function(){return'<div class="form-view">\r\n    <section class="form-transfer-domestic-summary">\r\n        <form onsubmit="javascript:return false;">\r\n            <fieldset>\r\n                <hr />\r\n                <div class="row">\r\n                    <div class="header">\r\n                        <span class="label">{{ i18n(\'transfer.step2.recipient\') }}</span>\r\n                    </div>\r\n                    <div class="fields">\r\n                        {% if (p2pId && summaryType=="facebook") { %}\r\n                        <img class="fb-avatar" src="https://graph.facebook.com/{{ p2pId }}/picture?height=70&width=70" alt="{{ summaryData.facebookName }}" />\r\n                        {% } %}\r\n                        <dl>\r\n                            <dt></dt>\r\n                            <dd class="word-break margin-bottom">\r\n                                <strong>\r\n                                    {% if (summaryType=="facebook") { %}\r\n                                    {{ summaryData.facebookName }}\r\n                                    {% } else { %}\r\n                                    {{ summaryData.recipientName }}\r\n                                    {% } %}\r\n\r\n                                </strong>\r\n                            </dd>\r\n\r\n\r\n                            {% _.each(summaryData.operations, function(operation){ %}\r\n\r\n                            {% _.each(operation.transfers, function(transfer){ %}\r\n\r\n                            <dt></dt>\r\n                            <dd class="amount-value">{{ l10n(\'currency\', transfer.amount) }} {{ transfer.currency }}</dd>\r\n                            <dt>\r\n                                {% if (summaryType=="facebook") { %}\r\n                                {{ i18n(\'transfer.step2.toFacebook\') }}\r\n                                {% } else { %}\r\n                                {{ i18n(\'transfer.step2.toMobile\') }} {{ phoneNumber }}\r\n                                {% } %}\r\n                            </dt>\r\n                            <dd class="word-break"></dd>\r\n                            {% if(transfer.title){%}\r\n                            <dt></dt>\r\n                            <dd class="word-break">{{ i18n(\'transfer.step2.transfers.title\') }} {{ transfer.title }}</dd>\r\n                            {%}%}\r\n                            {% }) %}\r\n\r\n                            <dt></dt>\r\n                            <dd class="word-break">{{ l10n("date.formats.default", operation.transfers[0].date) }}</dd>\r\n\r\n                            {% }) %}\r\n                        </dl>\r\n                    </div>\r\n                </div>\r\n                <hr />\r\n                <div class="row">\r\n                    <div class="header">\r\n                        <span class="label">{{ i18n(\'transfer.step2.additionalInfo\') }}</span>\r\n                    </div>\r\n                    <div class="fields">\r\n                        <dl class="additional-info">\r\n                            <dt>{{ i18n(\'transfer.step2.fromAccount\') }}</dt>\r\n                            <dd> <strong>{{ summaryData.additionalInfo.fromAccount.label }}  (<span class="saldo">{{ l10n(\'currency\', summaryData.additionalInfo.fromAccount.balance) }} {{ summaryData.additionalInfo.fromAccount.currency }}</span>)</strong></dd>\r\n\r\n                            <dt class="facebook-additional-info"> {{ i18n(\'transfer.step2.additionalInfoForFacebook\') }}</dt> {% if ( typeof incomeSourceName!=="undefined" && incomeSourceName!==null\r\n                            && typeof paymentPurposeName!=="undefined" && paymentPurposeName!==null) { %}\r\n                            <dt class="muted"></dt>\r\n                            <dd class="muted">{{ i18n(\'transfer.domestic.pepLabel\') }}:  {{ paymentPurposeName }}, {{ incomeSourceName }}</dd>\r\n                            {% } %}\r\n                            {% // if (!summaryData.isDefined){ %}\r\n                            <dt class="muted clear"></dt>\r\n                            <dd class="muted">\r\n                                {% _.each(summaryData.additionalInfo.checkboxes, function(checkboxField){ %}\r\n                                {% if(checkboxField.isChecked){ %}\r\n                                <div class="step-2-additional-option {% if(checkboxField.label == \'addToTrustedList\' || checkboxField.label == \'addToAddressBook\') { %} inline {% } %}">\r\n                                    <label class="after-input" for="{{ checkboxField.label }}">\r\n                                        {{ i18n(\'transfer.p2p.checkboxes\', checkboxField.label) }}{% if(checkboxField.additionalLabel) { %}: {{ checkboxField.additionalLabel }}{% } %}{% if(checkboxField.additionalLabelNewLine) { %}\r\n                                        <br />{{ checkboxField.additionalLabelNewLine }}\r\n                                        {% } %}\r\n                                    </label>\r\n                                </div>\r\n                                {% } %}\r\n                                {% }); %}\r\n                            </dd>\r\n                            {% // } %}\r\n\r\n                            {% _.each(summaryData.additionalInfo.additionalOptions, function(option){ %}\r\n                            <dt class="muted">{{ option.label }}</dt>\r\n                            <dd class="muted">{{ option.value }}</dd>\r\n                            {% }); %}\r\n\r\n                        </dl>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <hr />\r\n                <div class="row row-auth-code row-sms-pass auth-plugin">\r\n                    {% if (authType == \'sms\') { %}\r\n                        <div class="header">\r\n                            <label for="authorizationCode">\r\n                                <span>{{ i18n(\'transfer.step2.auth.smsCode\') }}</span>\r\n                                <span class="sms-id">\r\n                                    ({{ i18n(\'transfer.step2.auth.nr\') }} {{ authMessageParam1 }} {{ i18n(\'transfer.step2.auth.fromDay\') }}\r\n                                    {% if(_.isDate(authMessageParam2)) { %}\r\n                                    {{ authMessageParam2 }})\r\n                                    {% } else { %}\r\n                                    {{ $.datepicker.formatDate(\'dd.mm.yy\', $.datepicker.parseDate(\'yy-mm-dd\',authMessageParam2.substring(0,10))) }})\r\n                                    {% } %}\r\n                                </span>\r\n                            </label>\r\n                        </div>\r\n                        <div class="fields">\r\n                            <span class="validation-icon"></span>\r\n                            <input type="text" id="authorizationCode" class="field-high" name="smsCode" maxlength="8" />\r\n                            <span class="validation-text"></span>\r\n                        </div>\r\n                   \r\n                    {% } else if (authType == \'tan\'){ %}\r\n                        <div class="header">\r\n                            <label for="authorizationCode">\r\n                                <span>{{ i18n(\'transfer.step2.auth.tanCode\') }}</span>\r\n                                <span class="tan-id">\r\n                                    (nr {{ authMessageParam1 }} z listy nr {{ authMessageParam2 }})\r\n                                </span>\r\n                            </label>\r\n                        </div>\r\n                        <div class="fields">\r\n                            <span class="validation-icon"></span>\r\n                            <input type="password" id="authorizationCode" class="field-high" name="tanCode" maxlength="5" />\r\n                            <span class="validation-text"></span>\r\n                        </div>\r\n                    {% } else { %}\r\n                    {% } %}\r\n                </div>\r\n                <div class="row">\r\n                    <div class="fields action-buttons">\r\n                        {% _.each(actions, function(action, i){ %}\r\n                        <a href="#" class="{{ action.action }}-action {% print(!i ? \'btn-red-gradient\' : \'btn-gray-gradient\') %}" \r\n                           {% print((action.action == "edit") ? \'data-gemius-event-type="action" data-gemius-event-action-id="\' + getGemiusActionId(\'transfer.step2.modify\') + \'" data-gemius-event-action-name="transfer.step2.modify"\':\'\') %}>\r\n                            {{ action.name }}\r\n                        </a>\r\n                        {% }) %}\r\n                    </div>\r\n                </div>\r\n\r\n            </fieldset>\r\n\r\n        </form>\r\n    </section>\r\n</div>'}),define("transfer/js/views/transfer-step2",["text!../../templates/transfer-step2.html","text!../../templates/transfer-step2-phone.html","text!../../templates/transfer-step2-p2p.html","../models/transfer-wizard","../app"],function(e,t,a,r,n){var i=Backbone.Marionette.ItemView.extend({events:{"click a.proceed-action":"proceed","click a.postpone-action":"postpone","click a.edit-action":"back","click a.cancel-action":"cancel","keypress #authorizationCode":"keypressOnInput"},authorization:null,templateHelpers:function(){return $.extend({},Backbone.Marionette.CompositeView.prototype.templateHelpers,{formatGenericAccountNumber:function(e){if(!e||e.length<4)return e;var t=e.replace(/\s/g,""),a=t.match(/(\w{1,4})/g);if(a){var r=[];return _.each(a,function(e){r.length?r.push(e):r.push(e.substr(0,2)+" "+e.substr(2,2))}),r.join(" ")}return e},formatAccount:function(e){var t=e.toString();if(t.length){for(var a=1,r=0;a<=5;a++,r++)t=[t.slice(0,2+4*a+r)," ",t.slice(2+4*a+r)].join("");t=[t.slice(0,2)," ",t.slice(2)].join("")}return t}})}(),keypressOnInput:function(e){e=e||window.event;var t="number"==typeof e.which?e.which:e.keyCode;return 13==t?(this.proceed(e),!1):!(!Ebre.Common.justNumber(e," ",".",0)||!Ebre.Common.justNumber(e," ",",",0))&&void 0},showValidationError:function(e){var t=$("#authorizationCode");e=e||I18n.t("errors.auth."+("SMS"==this.model.get("authType").toUpperCase()?"sms":"tan")),t.siblings(".validation-text").text(e).css({display:"block"}),t.parents(".row").addClass("validation error"),t.focus()},hideValidationError:function(){var e=$("#authorizationCode");e.siblings(".validation-text").text("").hide(),e.parents(".row").removeClass("validation error")},validateCodes:function(){var e,t=$("#authorizationCode");if("undefined"!=typeof t.val())switch(this.model.get("authType").toUpperCase()){case"SMS":e=8==t.val().length;break;case"TAN":e=5==t.val().length;break;default:return!0}else e=!0;return e?this.hideValidationError():this.showValidationError(),e},initialize:function(){Ebre.Modules.Payments.Transfer.handleCloseMessageWindow=function(e){n.trigger("transfer:unlock"),n.cache.p2pStatus=e,"success"==e?n.trigger("transfer:done",{transferCategory:"facebook"}):"error"!=e&&"invalidFacebookUser"!=e||n.trigger("transfer:p2p:cancel",e)}},getTemplate:function(){return!this.model||"p2p"!==this.model.get("summaryType")&&"facebook"!==this.model.get("summaryType")&&"mobile"!==this.model.get("summaryType")?this.model&&"phoneCharge"===this.model.get("summaryType")?t:e:a},onRender:function(){var e=this;this.styleCheckbox(),this.bindTo(this,"effects:done",function(){if(smsEl=this.$el.find("input[name='smsCode']"),this.model.get("isSmsSendError")&&"True"===this.model.get("isSmsSendError"))this.$el.find(".action-buttons .postpone-action").length?this.showValidationError(I18n.t("errors.smsSenderError")):this.showValidationError(I18n.t("errors.smsSenderErrorNoPostpone")),smsEl.prop("disabled",!0).removeClass("focused");else if(smsEl.length>0)smsEl.focus();else{var t=this.$el.find("input[name='tanCode']");t.length>0?t.focus():(this.$el.find(".action-buttons .proceed-action").focus(),this.$el.find(".action-buttons .proceed-action").on("blur",function(){$(this).css("-webkit-box-shadow","")}))}var a=this.model.get("addToBasket"),r=this.model.get("isBasketModified");a&&r||LoadAuthService(function(t){e.authorization=t,e.authorization.initialize({buttonsContainer:e.$el.find(".action-buttons"),hiddenButtons:e.$el.find(".postpone-action, .proceed-action"),placeholder:e.$el.find(".auth-plugin"),timeoutClassName:"validation error",areaName:e.model.get("areaName")?e.model.get("areaName"):"payments",requireAuthorization:"none"!==e.model.get("authType"),callbackTokenCancel:function(){n.trigger("show:dashboard")}}).done(function(){e.proceed.call(e,jQuery.Event())})})},this)},styleCheckbox:function(){var e=this.$el.find(".checkbox-wrapper").children('input[type="checkbox"]');e.on("change",function(e){var t=$(this);t.closest(".checkbox-wrapper").toggleClass("checked",t.is(":checked"))}).trigger("change")},proceed:function(e){if(!this.validateCodes()||this.disableSubmit)return!1;e.preventDefault();var t=this;"facebook"===this.model.get("summaryType")&&(/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent)||(n.cache.fbMessageDialog=n.openFbDialog(Ebre.Modules.Payments.Transfer.FacebookService.BeforeFacebookRedirect)));var a,i=this.model.get("authType");this.model.get("summaryData");a="sms"===i?r.finalSubmitWithSMSAuth({smsCodeValue:this.$("form [name=smsCode]").val()}):"tan"===i?r.finalSubmitWithTANAuth({tanCodeValue:this.$("form [name=tanCode]").val()}):r.finalSubmitWithoutAuth(),a.done(function(e){var a="transfer:done",r={transferCategory:e.transferCategory};e&&"facebook"==e.summaryType&&(a="fb:p2p:registered:pre",_.extend(r,e)),t.model.attributes.summaryData.isRepeatableTransfer!==!0&&t.model.attributes.summaryData.isSeriesOfTransfers!==!0||_.extend(r,{standingOrBulk:!0}),n.trigger(a,r)}),a.fail(function(e,a){if("QG_WrongSMSCode"===a.code||"QG_WrongTAN"===a.code)t.showValidationError(a.message);else{Ebre.Proxy.HandleDefaultError(a),t.disableSubmit=!0;var r=t.$el.find(".action-buttons .proceed-action");r.css("opacity",.5);var i=t.$el.find(".action-buttons .postpone-action");i.css("opacity",.5);var o=t.$el.find(".row-auth-code");o.hasClass("validation error")&&o.removeClass("validation error")}"undefined"!=typeof n.cache.fbMessageDialog&&n.cache.fbMessageDialog.close()})},postpone:function(e){if(e.preventDefault(),this.disableSubmit)return!1;var t=this;nmbServices.AuthorizeLater({loaderParent:$(".form-view"),success:function(){if(t.model.attributes.summaryData.isRepeatableTransfer===!0||t.model.attributes.summaryData.isSeriesOfTransfers===!0)n.trigger("show:payments-periodic-list-authorize",t.model.attributes.summaryData.isRepeatableTransfer===!0);else{var e=_.find(t.model.attributes.summaryData.additionalInfo.checkboxes,function(e){return"addToAddressBook"===e.label})||null;e&&e.isChecked?Ebre.Common.createSuccessMessage({title:I18n.t("transfer.step2.authorizeLaterTitle"),message:I18n.t("transfer.step2.authorizeLaterWithoutAddToAddressBook")}):Ebre.Common.createSuccessMessage({title:I18n.t("transfer.step2.authorizeLaterTitle"),message:I18n.t("transfer.step2.authorizeLater")}),n.trigger("show:dashboard"),setTimeout(function(){Ebre.Wizard.trigger("layout:nextStep")},800)}}})},back:function(e){e.preventDefault(),nmbServices.ModifyAction({loaderParent:$(".form-view"),success:function(){n.trigger("transfer:edit")},error:function(){}}),this.authorization&&this.authorization.stopServiceOnModify()},cancel:function(e){e.preventDefault(),this.authorization&&this.authorization.cancel(),n.trigger("transfer:cancel"),n.trigger("show:dashboard"),Ebre.Wizard.trigger("wizard:hide")},validationError:function(e){var t=e.type,a=this.$(".row-auth-code");a.addClass("validation error"),a.find(".validation-text").text(I18n.t("transfer.step2.error."+t))}});return i}),define("text!transfer/templates/transfer-not-loaded.html",[],function(){return"<div class=\"form-view form-not-loaded\">\r\n\r\n  <div>\r\n     {% if (message) { %}\r\n        {# message #}\r\n     {% } else { %}\r\n        {{ i18n('transfer.notLoaded') }}\r\n     {% } %}\r\n  </div>\r\n\r\n</div>"}),define("transfer/js/views/transfer-not-loaded",["text!../../templates/transfer-not-loaded.html"],function(e){return Backbone.Marionette.ItemView.extend({template:e,tagName:"div",events:{},initialize:function(){},onRender:function(){}})}),define("transfer/js/views/transfer-layout",["text!../../templates/transfer-layout.html","../app","../models/transfer-wizard","./transfer-falter","./transfer-recipient-search","./livesearch-phone-charging","./transfer-sidebar-menu","./transfer-step2","./transfer-not-loaded"],function(e,t,a,r,n,i,o,s,l){var d="transfer-form-locked",c=Backbone.Marionette.Layout.extend({template:e,tagName:"article",disableDefaultFocus:!0,attributes:{id:"transfer-container"},regions:{livesearch:".transfer-receiver-view",sidebar:".transfer-sidebar-view",form:{selector:".transfer-form-view",regionType:Backbone.nmb.FadingRegion}},events:{},initialize:function(){},showFalter:function(){var e=this.livesearch,t=this.form;e.currentView&&e.currentView.$el.animate({opacity:0,height:0,padding:0},600,function(){e.close()}),t.show(new r({model:new Backbone.Model(a.get("falterData"))}))},showStep2:function(){var e=this.livesearch,t=this.form;e.currentView&&e.currentView.$el.animate({opacity:0,height:0,padding:0},600,function(){e.close()}),"mobile"===a.get("formIntermediate").get("summaryType")&&a.get("formIntermediate").set("phoneNumber",a.get("formIntermediate").get("p2pId").match(/(\d{3})/g).join(" "));var r=a.get("formData").paymentPurpose,n=a.get("formData").incomeSource;"undefined"!=typeof r&&""!=r&&a.get("formIntermediate").set("paymentPurposeName",a.getPaymentPurposeName(r)),"undefined"!=typeof n&&""!=n&&a.get("formIntermediate").set("incomeSourceName",a.getIncomeSourceName(n)),t.show(new s({model:new Backbone.Model(a.get("formIntermediate"))}))},showNotLoaded:function(e,t){var a=this.form;this.model.set("formType",e.transferType),this.model.get("formData").templateId=e.definedTemplateId,a.show(new l({model:new Backbone.Model({message:t})})),this.adjustSidebar(),"undefined"!=typeof e.fromSidebar&&e.fromSidebar!==!1||(this.lockSidebar(),this.sidebar.currentView.collapseItems())},getFormAndSidebarRootNode:function(){var e=this.form.$el,t=this.sidebar.$el,a=t?t.parent():e?e.parent():$();return a},lockForm:function(){var e=this.getFormAndSidebarRootNode(),t=$(this.form.el);if(t){if(t.hasClass(d))return;t.addClass(d)}if(e.addClass("grayscale-box").find("input, radio, select, textarea, a").attr("disabled","disabled").attr("tabIndex",-1),0==e.parent().find(".grayscale-blocker").length){var a=$(".form-view").height();null==a&&(a=700);var r=$('<div id="ui-transfer-blocker-screen" class="grayscale-blocker"></div>').css({height:1.1*(0==e.height()&&0==t.height()?a:e.height()>t.height()?e.height():t.height())});e.after(r)}},isFormLocked:function(){return!!$(this.form.el)&&$(this.form.el).hasClass(d)},unlockForm:function(){var e=this.getFormAndSidebarRootNode();this.form.$el&&this.form.$el.removeClass("transfer-form-locked"),e.attr("style","position:relative").removeClass("grayscale-box").find("input, radio, select, textarea, a").removeAttr("disabled").removeAttr("tabindex"),e.parent().find(".grayscale-blocker").remove()},lockSidebar:function(){if(!document.getElementById("sidebar-blocker-screen")){var e=$("#transfer-app-root").find(".sidebar-view");e.prepend($('<div id="sidebar-blocker-screen"></div>').css({position:"absolute",top:"0px",left:"0px",width:e.outerWidth(),height:e.outerHeight(),"background-color":"#ddd",zIndex:999,opacity:.4}))}},unlockSidebar:function(){$("#sidebar-blocker-screen").remove()},loadModel:function(){this.model=a.get("formLoaded")},transferEditMode:function(){a.set("isEdited",!0),this.model=a.getPopulatedModel();var e=this.model.get("formData");e.addToBasket=!1,this.model.set("formData",e),this.renderForm()},renderSidebar:function(){var e=this.model,t=this.sidebar,a=new o({model:e,collection:new Backbone.Collection(e.get("sidebarData").templateTypes)});t.show(a)},adjustSidebar:function(){var e=this.model,t=this.sidebar;t.currentView?e?t.currentView.markActive({activeFormType:e.get("formType"),activeTemplateId:e.get("formData").templateId}):t.currentView.clearActive():this.renderSidebar()},renderLivesearch:function(){var e=this,t=this.model,a=t.get("formType"),r=this.livesearch;if("us"!==a&&"zus"!==a&&"onezus"!==a){var o={model:t,layout:e},s="phone"==a||"voip"==a?new i(o):new n(o);r.show(s)}},renderForm:function(){var e=this,t=this.model,a=t.get("formType"),r=this.form,n=$.Deferred();"voip"==a&&(a="phone");var i=this.getFormFile(a),o="transfer/js/views/forms/";return"onezus"===a&&(o="transfer/js/company/views/forms/"),require([o+i],function(i){var o=new i({model:new Backbone.Model(t.get("formData"))});if("phone"==a&&void 0!=t.get("formData").templateId){var s=$.Deferred();s.done(function(){r.show(o),n.resolve()}),o.checkPhoneOperator(s)}else r.show(o),n.resolve();o.bindTo(o,"effects:done",function(){!t.get("formData").recipientName&&_.contains(["phone","mobile","domestic"],t.get("formType"))&&e.lockForm(),"domestic"!=t.get("formType")&&(Ebre.Wizard.trigger("wizard:cleanupStepEvents"),Ebre.Wizard.trigger("wizard:hide"))})}),n.promise()},showFormPreloader:function(){var e=this.form,t=new Backbone.nmb.Preloader;e.show(t),t.$el.css({width:710,minHeight:350,right:0,left:"auto"})},refresh:function(){this.loadModel(),this.renderLivesearch(),this.adjustSidebar(),this.renderForm()},onRender:function(){var e,t=this;this.loadModel(),this.renderSidebar(),this.renderLivesearch(),e=this.renderForm(),this.on("sliding:done",function(){e.done(function(){t.form.currentView.trigger("effects:done")})})},updateRecipientName:function(e){var t=this.model,a=t.get("sidebarData"),r=t.get("formData");r.recipientName=e,a.receiverName=e,t.set("formData",r),t.set("sidebarData",a),this.form.currentView.updateRecipientName(e)},getCurrentFormData:function(){return this.form.currentView.getCurrentFormData()},getFormFile:function(e){var t;return t="domestic"==e&&Ebre.Entity.isCZSK()?Ebre.Entity.isSK()?e+"_sk":e+"_cz":_.contains(["facebook","mobile","abroad","own"],e)&&Ebre.Entity.isCZSK()?e+"_czsk":e}});return c}),define("text!transfer/templates/transfer-summary.html",[],function(){return'<div class="box box-status success transfer-summary">\r\n    <h2 class="inline">\r\n        {% if (addToBasket || firstAuthLimitReached || secondAuthLimitReached) { %}\r\n        {{ i18n(\'transfer.summary.addToBasketTitle\') }}\r\n        {% } else if(summary.transferParams.transferType === \'swift\' || summary.transferParams.transferType === \'future\') { %}\r\n        {{ i18n(\'transfer.summary.successSwiftTitle\') }}\r\n        {% } else if (summary.transferParams.transferType ==\'bulk\')  { %}\r\n        {{ i18n(\'transfer.summary.successTitleBulk\') }}\r\n        {% } else if (summary.transferParams.transferType ==\'phoneCharge\')  { %}\r\n        {{ i18n(\'transfer.summary.successTitlePhoneCharge\') }}\r\n        {% } else if(isStandingOrder) { %}\r\n        {{ i18n(\'transfer.summary.successStandingOrder\') }}\r\n        {% } else { %}\r\n        {{ i18n(\'transfer.summary.successTitle\') }}\r\n        {% } %}\r\n    </h2>\r\n    {% if (allowPrint) { %}\r\n    <a class="btn-gray-gradient print-button" href="#"><i class="icon-black-printer"></i></a>\r\n    {% } else { %}\r\n    <a href="#"><i class="icon-empty"></i></a>\r\n    {% } %}\r\n    \r\n    <ul class="categorization-items">\r\n        {% if (!addToBasket && !firstAuthLimitReached && !secondAuthLimitReached) { %}\r\n            {% _.each(operations, function(operation){ %}\r\n            <li>\r\n                {{ i18n(\'transfer.summary.operationLabel\') }}\r\n                {% if (summary.isSplitTransfer){ %}\r\n                    <span class="amount">{{ l10nCurrency(operation.grossAmount, operation.currency) }}</span>\r\n                    <span class="currency"> {{ operation.currency }}</span>\r\n                    {% if(typeof transferCategory !== \'undefined\' && (transferCategory !== \'splitown\')) { %}\r\n                        {{ i18n(\'transfer.summary.includingVat\') }}\r\n                        <span class="amount">{{ l10nCurrency(operation.vatAmount, operation.currency) }}</span>\r\n                        <span class="currency"> {{ operation.currency }}</span>\r\n                    {% } %}\r\n                {% } else { %}\r\n                    <span class="amount">{{ l10nCurrency(operation.amount, operation.currency) }}</span>\r\n                    <span class="currency"> {{ operation.currency }}</span>\r\n                {% } %}\r\n                {% if (typeof operation.orgAmount !== \'undefined\' && !(summary.transferParams.transferType === \'swift\' && !summary.transferParams.blockResources)) { %}\r\n                    ({{ l10nCurrency(operation.orgAmount, operation.orgCurrency) }} {{ operation.orgCurrency }} {{ i18n(\'transfer.summary.exchangeRate\') }} {{ operation.exchangeRate }})\r\n                {% } %}\r\n                {% if (isStandingOrder) { %}  \r\n                    {{ i18n(\'transfer.summary.standingOrderLabel\') }}\r\n                    {{ standingOrderMessage }}\r\n                    {{ i18n(\'transfer.summary.from\')}}\r\n                    {{ dateFrom }}\r\n                    {{ i18n(\'transfer.summary.to\')}}\r\n                    {% if (dateTo) { %}\r\n                        {{ dateTo }}\r\n                    {% } else { %}\r\n                        {{ i18n(\'transfer.summary.standingOrderNoLimit\') }}\r\n                    {% } %}\r\n                    {{ i18n(\'transfer.summary.and\')}}\r\n                {% } %}\r\n                {% if(summary.transferParams.transferType === \'future\') { %}\r\n                      {{ i18n(\'transfer.summary.operationCategorizedLabel\') }}    \r\n                {% } else if (summary.transferParams.transferType === \'swift\') { %}\r\n                      {{ i18n(\'transfer.summary.operationSwiftLabel\') }} \r\n                {% } else { %} \r\n                      {{ i18n(\'transfer.summary.operationLabelNow\') }}   \r\n                {% } %}   \r\n              \r\n            </li>\r\n            {% }); %}\r\n      \r\n            {% if(summary.transferParams.transferType === \'swift\' && summary.transferParams.blockResources) { %}\r\n            <li>{{ i18n(\'transfer.summary.amountMayDiffer\') }}</li>\r\n            {% } %}\r\n        {% } else { %}\r\n        <li>\r\n            {% if (addToBasket && !firstAuthLimitReached && !secondAuthLimitReached) { %}\r\n                {{ i18n(\'transfer.summary.addToBasket\') }}\r\n            {% } if (firstAuthLimitReached) { %}\r\n                {{ i18n(\'transfer.summary.firstLimitReached\') }}\r\n            {% } if (secondAuthLimitReached) { %}\r\n                {{ i18n(\'transfer.summary.secondLimitReached\') }}\r\n            {% } %}\r\n        </li>\r\n        {% } %}\r\n    \r\n        {% if (additionalOperationInfo && additionalOperationInfo.length) { %}              \r\n            {% _.each(additionalOperationInfo, function(info){ %}\r\n            <li>\r\n                {{ info }}\r\n            </li>\r\n            {% }); %}        \r\n        {% } %}\r\n\r\n        {% if(typeof transferCategory !== \'undefined\' && (transferCategory === \'splitown\')) { %}\r\n            <li>\r\n                {{ i18n(\'transfer.summary.splitOwnRelatedAccountsInfo\') }}\r\n            </li>\r\n        {% } %}\r\n        \r\n        {% if (showRepeatFromBasketWarning) { %}              \r\n            <li>\r\n                {{ i18n(\'transfer.summary.repeatFromBasketWarning\') }}\r\n            </li>       \r\n        {% } %}\r\n    </ul>\r\n    \r\n\r\n    {% if((!(summary.transferParams.transferType === \'swift\' && !summary.transferParams.blockResources) && summary.fromAccount != null && !isStandingOrder) || (addToBasket || firstAuthLimitReached || secondAuthLimitReached)) { %}                        \r\n        <h3 class="border-bottom">{{ i18n(\'transfer.summary.balanceTitle\') }}</h3>\r\n\r\n    {% if(!addToBasket && !firstAuthLimitReached && !secondAuthLimitReached) { %} \r\n    <div class="account-container">\r\n        <div class="transfer-details account-from">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                        <li class="account-name">{{ summary.fromAccount.name }}</li>\r\n                    </ul>\r\n                </li>\r\n                <li>\r\n                    <ul class="operation-details">\r\n                        <li class="saldo-before"><span class="amount">{{ l10nCurrency(summary.fromAccount.prevBalance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        {% if (typeof summary.fromVatAccount !== \'undefined\' && (typeof transferCategory === \'undefined\' || transferCategory !== \'splitown\') && typeof summary.fromVatAccount.operationValue !== 0 && typeof summary.fromVatAccount.name !== \'undefined\' && summary.fromVatAccount.name !== null){ %}\r\n                        <li class="saldo-before"><span class="amount">+ {{ l10nCurrency(summary.fromVatAccount.operationValue, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        {% } %}\r\n                        <li class="operation-balance"><span class="amount">- {{ l10nCurrency(summary.fromAccount.operationValue, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        <li class="saldo-after"><span class="amount">{{ l10nCurrency(summary.fromAccount.balance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n\t{% if (typeof summary.fromVatAccount !== \'undefined\' && typeof summary.fromVatAccount.name !== \'undefined\' && summary.fromVatAccount.name !== null && (typeof transferCategory === \'undefined\' || transferCategory !== \'splitown\')){ %}  <!-- podsumowanie konta VAT dla Splita i US vatowego-->\r\n        <div class="transfer-details vat-divider"></div>\r\n        <div class="transfer-details account-vat-from">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                        <li class="account-name">{{ summary.fromVatAccount.name }}</li>\r\n                    </ul>\r\n                </li>\r\n                <li>\r\n                    <ul class="operation-details">\r\n                        <li class="saldo-before"><span class="amount">{{ l10nCurrency(summary.fromVatAccount.prevBalance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        <li class="operation-balance"><span class="amount">- {{ l10nCurrency(summary.fromVatAccount.operationValue, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        <li class="saldo-after"><span class="amount">{{ l10nCurrency(summary.fromVatAccount.balance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        {% } %}\r\n        {% } else { %}\r\n        <div class="transfer-details account-from">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                        <li class="basket-count">{{ i18nPl(\'transfer.summary.basketOperations\', 1) }}<br/>{{ summary.fromAccount.name }}</li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="transfer-details account-to no-arrow">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                    <a href="#/Koszyk" class="btn-basket-count btn btn-gray-gradient">{{i18n(\'transfer.summary.authorizeBasket\')}}</a>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        {% } %}\r\n        {% if(typeof transferCategory !== \'undefined\' && (transferCategory === \'own\' || transferCategory === \'splitown\') && typeof summary.toAccount !== \'undefined\' && summary.toAccount.name != null && (!addToBasket && !firstAuthLimitReached && !secondAuthLimitReached)) { %}\r\n        <div class="transfer-details account-to">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                        <li class="account-name">{{ summary.toAccount.name }}</li> \r\n                    </ul>\r\n                </li>\r\n                <li>\r\n                    <ul class="operation-details">\r\n                        <li class="saldo-before"><span class="amount">{{ l10nCurrency(summary.toAccount.prevBalance, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                        <li class="operation-balance"><span class="amount">+ {{ l10nCurrency(summary.toAccount.operationValue, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                        <li class="saldo-after"><span class="amount">{{ l10nCurrency(summary.toAccount.balance, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                    </ul>  \r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n            \r\n        {% } %}\r\n    {% } %}\r\n  \r\n    <div class="clear"></div>\r\n    <div class="dd-list-placeholder"></div>     \r\n    <div class="rtm-placeholder-ikp"></div>\r\n    <div class="clear"></div>\r\n    <span class="status-field"></span>\r\n    <a class="close-trigger" href="#"><i class="icon-close"></i></a>\r\n</div>\r\n';
}),define("text!transfer/templates/transfer-summary-p2p.html",[],function(){return'<div class="box box-status success transfer-summary">\r\n    <h2 class="inline">\r\n            {{ i18n(\'transfer.summary.successTitleP2p\') }}\r\n    </h2>\r\n\r\n    <div class="clear"></div>\r\n    <ul class="categorization-items">\r\n        {% _.each(operations, function(operation){ %}\r\n        <li>\r\n            {{ i18n(\'transfer.summary.operationLabel\') }}\r\n            <span class="amount">{{ l10n(\'currency\', operation.amount) }}</span>\r\n            <span class="currency"> {{ operation.currency }}</span>\r\n            {{ i18n(\'transfer.summary.operationLabelP2p\') }}\r\n        </li>\r\n        {% }); %}\r\n\r\n        {% if (additionalOperationInfo && additionalOperationInfo.length) { %}              \r\n            {% _.each(additionalOperationInfo, function(info){ %}\r\n            <li>\r\n                {{ info }}\r\n            </li>\r\n            {% }); %}        \r\n        {% } %}       \r\n    </ul>\r\n    \r\n    {% if(summary.fromAccount != null && !isStandingOrder) { %}\r\n        <h3 class="border-bottom">{{ i18n(\'transfer.summary.balanceTitle\') }}</h3>\r\n        \r\n        <div class="transfer-details account-from">\r\n            <ul class="details">\r\n                <li>\r\n                    <ul class="account-details">\r\n                        <li class="account-name">{{ summary.fromAccount.name }}</li>\r\n                    </ul>\r\n                </li>\r\n                <li>\r\n                    <ul class="operation-details">\r\n                        <li class="saldo-before"><span class="amount">{{ l10n(\'currency\', summary.fromAccount.prevBalance) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        <li class="operation-balance"><span class="amount">- {{ l10n(\'currency\', summary.fromAccount.operationValue) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                        <li class="saldo-after"><span class="amount">{{ l10n(\'currency\', summary.fromAccount.balance) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                    </ul>  \r\n                </li>\r\n            </ul>\r\n        </div>\r\n    {% } %}\r\n    <div class="rtm-placeholder-ikp"></div>\r\n    <div class="clear"></div>\r\n    <span class="status-field"></span>\r\n\r\n    <a class="close-trigger" href="#"><i class="icon-close"></i></a>\r\n</div>\r\n'}),define("text!transfer/templates/transfer-summary-hold.html",[],function(){return'<div class="box box-status warning-conditional transfer-summary">\r\n    <h2>\r\n        {{ i18n(\'transfer.summary.transferHoldTitle\') }}\r\n    </h2>\r\n    <p>\r\n    {# i18n(\'transfer.summary.transferHoldMessage\') #}\r\n    </p>\r\n    {% if((!(summary.transferParams.transferType == \'swift\' && !summary.transferParams.blockResources) && summary.fromAccount != null && !isStandingOrder) || (addToBasket || firstAuthLimitReached || secondAuthLimitReached)) { %}                        \r\n        <h3 class="border-bottom">{{ i18n(\'transfer.summary.balanceTitle\') }}</h3>\r\n\r\n    {% if(!addToBasket && !firstAuthLimitReached && !secondAuthLimitReached) { %}        \r\n    <div class="transfer-details account-from">\r\n        <ul class="details">\r\n            <li>\r\n                <ul class="account-details">\r\n                    <li class="account-name">{{ summary.fromAccount.name }}</li>\r\n                </ul>\r\n            </li>\r\n            <li>\r\n                <ul class="operation-details">\r\n                    <li class="saldo-before"><span class="amount">{{ l10nCurrency(summary.fromAccount.prevBalance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                    <li class="operation-balance"><span class="amount">- {{ l10nCurrency(summary.fromAccount.operationValue, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                    <li class="saldo-after"><span class="amount">{{ l10nCurrency(summary.fromAccount.balance, summary.fromAccount.currency) }}</span> <span class="currency">{{ summary.fromAccount.currency }}</span></li>\r\n                </ul>  \r\n            </li>\r\n        </ul>\r\n    </div>\r\n    {% } else { %}\r\n    <div class="transfer-details account-from">\r\n        <ul class="details">\r\n            <li>\r\n                <ul class="account-details">\r\n                    <li class="basket-count">{{ i18nPl(\'transfer.summary.basketOperations\', 1) }}<br/>{{ summary.fromAccount.name }}</li>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class="transfer-details account-to no-arrow">\r\n        <ul class="details">\r\n            <li>\r\n                <ul class="account-details">\r\n                    <a href="#/Koszyk" class="btn-basket-count btn btn-gray-gradient">{{i18n(\'transfer.summary.authorizeBasket\')}}</a>\r\n                </ul>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    {% } %}\r\n        {% if(typeof transferCategory !== \'undefined\' && (transferCategory == \'own\') && typeof summary.toAccount !== \'undefined\' && summary.toAccount.name != null && (!addToBasket && !firstAuthLimitReached && !secondAuthLimitReached)) { %}\r\n            <div class="transfer-details account-to">\r\n                <ul class="details">\r\n                    <li>\r\n                        <ul class="account-details">\r\n                            <li class="account-name">{{ summary.toAccount.name }}</li> \r\n                        </ul>\r\n                    </li>\r\n                    <li>\r\n                        <ul class="operation-details">\r\n                            <li class="saldo-before"><span class="amount">{{ l10nCurrency(summary.toAccount.prevBalance, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                            <li class="operation-balance"><span class="amount">+ {{ l10nCurrency(summary.toAccount.operationValue, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                            <li class="saldo-after"><span class="amount">{{ l10nCurrency(summary.toAccount.balance, summary.toAccount.currency) }}</span> <span class="currency">{{ summary.toAccount.currency }}</span></li>\r\n                        </ul>  \r\n                    </li>\r\n                </ul>\r\n            </div>\r\n            \r\n        {% } %}\r\n    {% } %}\r\n  \r\n    <div class="clear"></div>\r\n    <span class="status-field"></span>\r\n    <a class="close-trigger" href="#"><i class="icon-close"></i></a>\r\n</div>\r\n'}),define("transfer/js/views/transfer-summary",["text!../../templates/transfer-summary.html","text!../../templates/transfer-summary-p2p.html","text!../../templates/transfer-summary-hold.html","../app"],function(e,t,a,r){var n=Backbone.Marionette.ItemView.extend({template:e,className:"transfer-summary-view",events:{"click .close-trigger":"closePopup","click .print-button":"pdfConfirmation","click .pz-button":"sendPZ"},initialize:function(){if(this.model.get("transactionHolded")===!0)this.template=a;else if(this.model&&_.contains(["mobile","facebook"],this.model.get("summaryType")))this.template=t;else{var e=this.getDirectDebitItemsListFromModel(this.model);if(e){var r=this.fetchDirectDebitOptionsFromList(e);if(r){var n=Backbone.Model.extend({schema:{title:{type:"Select",options:r,title:Ebre.Extensions.format(I18n.t("transfer.domestic.infoPZ"),this.model.get("recipientName")),editorAttrs:{id:"ddList",placeholder:I18n.t("transfer.standingOrder.select")}},submit:{text:I18n.t("transfer.domestic.buttonPZ"),type:"AnchorButton",template:"fieldAlone",fieldClass:"fl",editorClass:"cancel-form btn-gray-gradient pz-button"}}});this.ddListForm=new Backbone.Form({model:new n})}}}},onRender:function(){void 0!==this.ddListForm&&(this.ddListForm.render(),this.ddListForm.$el.attr("id","transfer-summary-form"),this.$el.find(".dd-list-placeholder").append(this.ddListForm.el),this.$el.find("#ddList").sSelect({defaultText:I18n.t("transfer.standingOrder.select")}))},pdfConfirmation:function(){window.open(this.model.get("pdfLink"),"pdf")},closePopup:function(e){var t=this;return this.$el.animate({opacity:0,height:0,padding:0},600,function(){t.close()}),!1},getDirectDebitItemsListFromModel:function(){return!(!this.model.get("recipientGroups")||!this.model.get("recipientGroups").directDebitItemsList||Ebre.Entity.isSK())&&this.model.get("recipientGroups").directDebitItemsList},fetchDirectDebitOptionsFromList:function(e){var t=new Array;for(var a in e)t[a]={val:e[a].id,label:e[a].name+" "+e[a].address};return t.length>0&&t},getDirectDebitObjectById:function(e){var t=this.model.attributes.recipientGroups.directDebitItemsList;return _.find(t,function(t){return t.id==e})||{}},sendPZ:function(e){var t=this.$el.find("#ddList").val(),a=this.getDirectDebitObjectById(t);a.isBreCorpo?nmbServices.uwRedirect({loaderParent:$(".dd-list-placeholder"),url:this.model.get("directDebitUWUrl"),rurl:"#transfer",uwId:a.uwId,success:function(e){$(".dd-list-placeholder").html(e)}}):nmbServices.NavigateToDirectDebit({data:a,success:function(e){Ebre.Common.NavigateTo(e)}})}});return n}),define("text!transfer/templates/forms/generic-wrapper.html",[],function(){return'<div class="form-transfer-{{ formType }}">\r\n    <div id="form-container"></div>\r\n</div>'}),define("transfer/js/models/nmb-account-validate-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.transfer.validateAccountNumber(a)}});return e}),define("transfer/js/models/nmb-account-coowners-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.getCoowners(a)}});return e}),define("transfer/js/models/nmb-account-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.transfer.checkAccountNumber(a)}});return e}),define("transfer/templates/forms/templates",["../../js/views/view-helpers"],function(e){return{form:"      <form>{# fieldsets #}</form>    ",fieldset:"      <fieldset>        <hr />        {# fields #}      </fieldset>    ",field:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>          {% if(typeof _params !== "undefined" && _params.tooltip) { %}          <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">            <i class="icon-question-mark">{# I18n.t("transfer.help") #}: <span class="accessability-nohide">{# _params.tooltip #}</span></i>          </a>          {% } %}        </div>        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          {% if(typeof _params !== "undefined" && typeof _params.info !== "undefined") { %}            <div class="info-text">{# _params.info #}</div>          {% } %}          <div role="alert" class="validation-text">{# help #}</div>        </div>      </div>    ',fieldWithLegendAsLabel:'      <div class="row row-{# key #}">        <fieldset>        <div class="header">          <legend>{# title #}</legend>          {% if(typeof _params !== "undefined" && _params.tooltip) { %}          <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">            <i class="icon-question-mark">{# I18n.t("transfer.help") #}: <span class="accessability-nohide">{# _params.tooltip #}</span></i>          </a>          {% } %}        </div>        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          {% if(typeof _params !== "undefined" && typeof _params.info !== "undefined") { %}            <div class="info-text">{# _params.info #}</div>          {% } %}          <div class="validation-text">{# help #}</div>        </div>        </fieldset>      </div>    ',fieldWithTooltipAfterInput:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          {% if(typeof _params !== "undefined" && _params.tooltip) { %}          <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">            <i class="icon-question-mark">{# I18n.t("transfer.help") #}: <span class="accessability-nohide">{# _params.tooltip #}</span></i>          </a>          {% } %}          {% if(typeof _params !== "undefined" && typeof _params.info !== "undefined") { %}            <div class="info-text">{# _params.info #}</div>          {% } %}          <div class="validation-text">{# help #}</div>        </div>      </div>    ',nestedField:'      <div class="fields-row field-{# key #}">        <span class="validation-icon"></span>        <label for="{# editorLabelFor #}" class="hide">{# title #}</label>        {# editor #}        <div class="validation-text">{# help #}</div>      </div>    ',withoutFieldsRow:'      <div class="row row-{# key #}">      <fieldset>        <div class="header">            <legend>{# title #}</legend>            {% if(typeof _params !== "undefined" && _params.tooltip) { %}            <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">              <i class="icon-question-mark">{# I18n.t("transfer.help") #} <span class="accessability-nohide">{# _params.tooltip #}</span></i>            </a>            {% } %}        </div>        {# editor #}        </fieldset>      </div>    ',DeliveryTimeRow:'      <div class="row row-{# key #}">      <fieldset>        <div class="header">            <legend>{# title #}</legend>            {% if(typeof _params !== "undefined" && _params.tooltip) { %}            <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">              <i class="icon-question-mark">{# I18n.t("transfer.help") #} <span class="accessability-nohide">{# _params.tooltip #}</span></i>            </a>            {% } %}            {% if(typeof _params !== "undefined" && _params.rowSubDesc1) { %}                <span class="rowSubDesc rowSubDesc1">{#  _params.rowSubDesc1 #}</span>            {% } %}            {% if(typeof _params !== "undefined" && _params.rowSubDesc2) { %}                <span class="rowSubDesc rowSubDesc2">{#  _params.rowSubDesc2 #}</span>            {% } %}        </div>        {# editor #}        </fieldset>      </div>    ',fieldAlone:'      <div>        <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>        {# editor #}      </div>    ',fieldAloneNoLabel:"      <div>        {# editor #}      </div>    ",seriesOfTransfersAmount:'      <div>        <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>        {# editor #}        <span class="label-currency">PLN</span>      </div>    ',rowPeriod:'      <div>        {# editor #}        <div class="validation-text">{# help #}</div>      </div>    ',labelBeforeInputField:'      <div class="row-{# key #}">        <div class="fields">          <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>          {# editor #}        </div>      </div>    ',labelBeforeInputDate:'      <div>        <label for="{# editorLabelFor #}" class="before-input-date">{# title #}</label>        {# editor #}      </div>    ',labelBeforeInput:'      <div>        <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>        {# editor #}      </div>    ',inputWithHiddenLabel:'      <div>        <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>        {# editor #}      </div>    ',labelBeforeSecondInput:'      <div>        <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>        {# editor #}        <div class="validation-text">{# help #}</div>      </div>    ',labelAfterInput:'      <div>        {# editor #}        <label for="{# editorLabelFor #}" class="after-input">{# title #}</label>      </div>    ',simpleRow:'      <div class="fields-row flclr">        <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>        {# editor #}        <div class="validation-text">{# help #}</div>      </div>    ',TextPrefixPhone:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <div class="wrapper input-decorated left">        <span class="input-decorations left text prefix">{# _params.prefix #} </span>          {# editor #}            </div>          <div class="validation-text">{# help #}</div>        </div>      </div>    ',SimpleTextPrefixPhone:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <span class="prefix"> {# _params.prefix #} </span>          {# editor #}          <div class="validation-text">{# help #}</div>        </div>      </div>    ',fieldsRowWithoutHeader:'      <div class="fields-row row-{# key #}">        <span class="validation-icon"></span>        <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>        {# editor #}        <div role="alert" class="validation-text">{# help #}</div>      </div>    ',additionalOptionsListWrapper:'      <div class="fields-row row-{# key #}">        {# editor #}      </div>    ',buttons:'      <div class="row-{# key #}">        <div class="fields">            {# editor #}        </div>      </div>    ',formAsDiv:"      <div>{# fieldsets #}</div>    ",fieldsetAsDiv:"      <div>{# fields #}</div>    ",noHeader:'      <div class="row row-{# key #}">        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          <div class="validation-text">{# help #}</div>        </div>      </div>    ',noHeaderNoValidation:'      <div class="row row-{# key #}">        <div class="fields">          {# editor #}        </div>      </div>    ',address:'      <div>        <div class="row">          <div class="fields">            <a href="#" class="address-expander expand-group-trigger with-icon">                <span class="btn-gray-gradient btn-mini">                  +                </span>                <span id="addressExpanderLabel" class="text">{# I18n.t("transfer.addAddress") #}</span>            </a>          </div>        </div>        <div class="row row-{# key #} expand-group">          <div class="header">            <label id="addressLabel" for="{# editorLabelFor #}">{# title #}</label>          </div>          <div class="fields">            <span class="validation-icon"></span>            {# editor #}            <div class="validation-text">{# help #}</div>          </div>        </div>      </div>    ',expandableFields:'      <div>        <div class="row">          <div class="fields">            <a href="#" class="generic-expander trigger">                <span class="btn-gray-gradient btn-mini expand-icon">                  +                </span>                <span class="text-expand">{# _params.expandText #}</span>                <span class="text-collapse">{# _params.collapseText #}</span>            </a>          </div>        </div>        <div class="row row-{# key #} expander-area">          <div class="header">            <label id="expanderLabel" for="{# editorLabelFor #}">{# title #}</label>          </div>          <div class="fields">            <span class="validation-icon"></span>            {# editor #}            <div class="validation-text">{# help #}</div>          </div>        </div>      </div>    ',expandableArea:'      <div>        <div class="row">          <div class="fields">            <a href="#" class="generic-expander trigger">                <span class="btn-gray-gradient btn-mini expand-icon">                  +                </span>                <span class="text-expand">{# _params.expandText #}</span>                <span class="text-collapse">{# _params.collapseText #}</span>            </a>          </div>        </div>        <div class="row-{# key #} expander-area">            {# editor #}        </div>      </div>    ',pepCZSZ:'      <div>        <div class="row row-{# key #} expand-group">          <div class="header">            <label id="addressLabel" for="{# editorLabelFor #}">{# title #}</label>          </div>          <div class="fields">            <span class="validation-icon"></span>            {# editor #}            <div class="validation-text">{# help #}</div>          </div>        </div>      </div>    ',amount:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          <div role="alert" class="validation-text">{# help #}</div>        </div>      </div>    ',amountWithCurrency:'      <div class="row row-{# key #}">        <div class="header">          <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          {# editor #}          <span for="{# editorLabelFor #}" class="after-input currency">PLN</span>          <div class="validation-text">{# help #}</div>        </div>      </div>    ',additionalOptionsCheckbox:'      <div class="fields-row row-{# key #}">        <span class="validation-icon"></span>        <span class="checkbox-wrapper">          {# editor #}        </span>        <label class="after-input" for="{# editorLabelFor #}">{# title #}</label>        <div class="validation-text">{# help #}</div>      </div>    ',additionalOptionsCheckboxNested:'      <div class="row-{# key #}">        <span class="validation-icon"></span>        <span class="checkbox-wrapper">          {# editor #}        </span>        <label class="after-input" for="{# editorLabelFor #}">{# title #}</label>        <div class="validation-text">{# help #}</div>      </div>    ',additionalOptionsCheckboxInline:'      <div class="checkbox-inline-wrapper">        <span class="checkbox-wrapper">          {# editor #}        </span>        <label class="after-input" for="{# editorLabelFor #}">{# title #}</label>      </div>    ',standaloneCheckbox:'      <div class="row row-wrapper additional-options-wrapper row-{# key #}">        <div class="header"></div>        <div class="fields">          <div class="fields-row checkbox-inline-wrapper">            <span class="checkbox-wrapper">              {# editor #}            </span>            <label class="after-input" for="{# editorLabelFor #}">{# title #}             {% if(typeof _params !== "undefined" && _params.tooltip) { %}            <a rel="tooltip" class="btn-gray-gradient btn-small" href="#" data-original-title="{# _params.tooltip #}">              <i class="icon-question-mark">{# I18n.t("transfer.help") #}: <span class="accessability-nohide">{# _params.tooltip #}</span></i>            </a>            {% } %}            </label>          </div>        </div>        <span class="validation-text"></span>      </div>    ',deliveryTimeDate:'      <div class="row row-{# key #}">        <div class="header">              <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <span class="uiDateInput">            {# editor #}          <div class="calendar-trigger date-picker-replacer">            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small"              data-gemius-event-type="action"             data-gemius-event-action-id="'+e.getGemiusActionId("transfer.calendar.select")+'"             data-gemius-event-action-name="transfer.tab.series.trasnfer">                <i class="icon-calendar">{# I18n.t("transfer.selectDate") #}</i>            </a>          </div>          </span>          <div class="save-options">            <span class="label">{# I18n.t("transfer.domestic.change") #}</span>            <span class="serie-trigger">             <a href="#"                 data-gemius-event-type="action"                 data-gemius-event-action-id="'+e.getGemiusActionId("transfer.tab.series.transfer")+'"                 data-gemius-event-action-name="transfer.tab.series.trasnfer">                <span class="btn-gray-gradient-darker btn-small">                  <i class="icon-list"></i>                </span>                <span class="accessability-nohide">Zmie na: </span>                {# I18n.t("transfer.domestic.series") #}              </a>              <a href="#" class="icon-close"><span class="accessability-nohide">Zamknij zakadk {# I18n.t("transfer.domestic.series") #}</span></a>            </span>            <span class="recurrent-trigger">               <a href="#"                 data-gemius-event-type="action"                 data-gemius-event-action-id="'+e.getGemiusActionId("transfer.tab.standing.order")+'"                 data-gemius-event-action-name="transfer.tab.standing.order">                <span class="btn-gray-gradient-darker btn-small">                  <i class="icon-star"></i>                </span>                <span class="accessability-nohide">Zmie na: </span>                {# I18n.t("transfer.domestic.planned") #}              </a>              <a href="#" class="icon-close"><span class="accessability-nohide">Zamknij zakadk {# I18n.t("transfer.domestic.planned") #}</span></a>            </span>          </div>          <span role="alert" class="validation-text"></span>        </div>      </div>    ',deliveryTimeDateNonRecurrentWithLabel:'      <div class="row row-{# key #}">        <div class="header">              <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <span class="uiDateInput">            {# editor #}          <div class="calendar-trigger date-picker-replacer">            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </a>          </div>          </span>          <span class="validation-text"></span>        </div>      </div>      </div>    ',deliveryTimeDateCZSK:'      <div class="row row-{# key #}">        <div class="header">              <label for="{# editorLabelFor #}">{# title #}</label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <span class="uiDateInput">            {# editor #}          <div class="calendar-trigger date-picker-replacer">            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </a>          </div>          </span>          <div class="save-options">            <span class="label">{# I18n.t("transfer.domestic.change") #}</span>            <span class="recurrent-trigger">            <a href="#">              <span class="btn-gray-gradient-darker btn-small">                <i class="icon-star"></i>              </span>              {# I18n.t("transfer.domestic.planned") #}            </a>            <a href="#" class="icon-close"></a>          </div>          <span class="validation-text"></span>        </div>      </div>    ',deliveryTimeDateAlone:'      <div class="row row-{# key #}">        <div class="fields">          <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>          <span class="validation-icon"></span>          <span class="uiDateInput">            {# editor #}          <div class="calendar-trigger date-picker-replacer">            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </a>          </div>          </span>          <span class="validation-text"></span>        </div>      </div>      </div>    ',simpleDate:'      <div class="row row-{# key #}">        <div class="fields">          <div class="calendar-trigger date-picker-replacer">            {# editor #}            <span class="content"></span>            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </a>          </div>          <div class="save-options">            <span class="label">Zamie na:</span>            <span class="recurrent-trigger">              <span class="btn-gray-gradient-darker btn-small">                <i class="icon-star"></i>              </span>              <span class="text">Zlecenie stae</span>              <i class="icon-close"></i>            </span>          </div>        </div>      </div>    ',onlyDate:'      <div class="calendar-trigger date-picker-replacer">        {# editor #}        <span class="content"></span>        <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">          <i class="icon-calendar"></i>        </a>      </div>    ',onlyDateNonRecurent:'      <div class="row row-{# key #}">        <div class="fields">          <div class="calendar-trigger date-picker-replacer">            {# editor #}            <span class="content"></span>            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </a>          </div>        </div>      </div>    ',onlyDateInputNonRecurent:'      <div class="row row-{# key #}">        <div class="fields">          <span class="validation-icon"></span>          <span class="uiDateInput">            <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>            {# editor #}          <div class="calendar-trigger date-picker-replacer">            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar">{# I18n.t("transfer.selectDate") #}</i>            </a>          </div>          </span>          <span class="validation-text"></span>        </div>      </div>    ',onlyDateInput:'      <div class="calendar-trigger date-picker-replacer input">        {# editor #}        <input aria-label="{# title #}" type="text" class="content calendar-input" {% if (typeof _params.enabledInput == "undefined" ||  _params.enabledInput===false) { %} disabled="disabled" {% } %}/>        <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">          <i class="icon-calendar">{# I18n.t("transfer.selectDate") #} </i>        </a>        <span class="clickable-overlay"></span>      </div>    ',dateAndReplace:'      <div class="row row-{# key #}">        <div class="fields">          <div class="calendar-trigger date-picker-replacer">            {# editor #}            <span class="content"></span>            <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small">              <i class="icon-calendar"></i>            </a>          </div>          <div class="save-options">            <span class="label">Zamie na:</span>            <span class="serie-trigger">              <span class="btn-gray-gradient-darker btn-small">                <i class="icon-list"></i>              </span>              <span class="text">Seri przeleww</span>            </span>            <span class="recurrent-trigger">              <span class="btn-gray-gradient-darker btn-small">                <i class="icon-star"></i>              </span>              <span class="text">Zlecenie stae</span>              <i class="icon-close"></i>            </span>          </div>        </div>      </div>    ',
seriesOfTransfers:'      <div class="row row-serie-transfer">        <div class="fields">          <div class="fields-row row-labels">            <span class="label amount-label">Kwota</span>            <span class="label title-label">Tytu</span>          </div>          <div>            {# items #}          </div>          <div class="fields-row row-next-transfer" data-action="add">            <a href="javascript:void(0);" class="a-trigger">              <span class="btn-gray-gradient btn-mini">                  +              </span>              <span class="text">{# I18n.t("transfer.bulkPayment.addNewTransfer") #}</span>            </a>          </div>      <div class="fields-row row-summary">        <div class="message">          {# I18n.t("transfer.summary.bulkSummary") #}        </div>      </div>        </div>      </div>    ',seriesOfTransfersItem:'      <div class="fields-row transfer-row">        <span class="validation-icon"></span>        <span class="before-input">            <label class="row-counter" for="seriesOfTransfersItem{# index #}_amount">                <span class="hide">Kwota </span>{# index #}.            </label>        </span>        {# editor #}        <a href="javascript:void(0)" class="remove-row-icon" data-action="remove">          <i class="icon-close">{# I18n.t("transfer.bulkPayment.removePosition") #} {# index #}</i>        </a>        <span role="alert" class="validation-text"></span>      </div>    ',nameAndAddress:'      <div>        <div class="row">          <div class="fields">            <span class="address-expander expand-group-trigger with-icon">              <span class="btn-gray-gradient btn-mini">                +              </span>              <span class="text">{# I18n.t("transfer.addPayerAddress") #}</span>            </span>          </div>        </div>        <div class="row row-{# key #} expand-group">          <div class="header">            <label for="{# editorLabelFor #}">{# title #}</label>          </div>          <div class="fields">            <span class="validation-icon"></span>            {# editor #}            <div class="validation-text">{# help #}</div>          </div>        </div>      </div>    ',fieldsPanel:'      <div class="row row-{# key #} row-fields-panel">        <div class="fields">          <span class="validation-icon"></span>          <div class="fields-panel">            <div class="status-area"></div>            <div class="fields-area">              {# editor #}            </div>          </div>          <span class="validation-text">{# help #}</span>        </div>      </div>    ',fieldsPanelWithHeader:'      <div class="row row-{# key #} row-fields-panel">        <div class="header">          <span class="label">{# title #}</span>        </div>        <div class="fields">          <span class="validation-icon"></span>          <div class="fields-panel">            <div class="status-area"></div>            <div class="fields-area">              {# editor #}            </div>          </div>          <span class="validation-text">{# help #}</span>        </div>      </div>    ',bicWizard:'      <div class="bic-wizard-wrapper">        <div class="row bic-wizard-info">          <div class="fields">            <p>{# title #}</p>            <a href="#" class="remove-bic-wizard-icon">              <i class="icon-close">{# I18n.t("transfer.abroad.label.bicWzardClose") #}</i>            </a>          </div>        </div>        <div>          {# editor #}        </div>      </div>    ',taxAuthoritySymbol:'      <div>        <label for="{# editorLabelFor #}">{# title #}          {% if(typeof _params !== "undefined" && _params.tooltip) { %}          <a rel="tooltip" class="btn-gray-gradient-darker btn-small" href="#" data-original-title="{# _params.tooltip #}">            <i class="icon-question-mark">Pomoc: <span class="accessability-nohide">{# _params.tooltip #}</span></i>          </a>          {% } %}        </label>        <div class="input-decorated extrashort">            {# editor #}        </div>      </div>    ',taxAuthorityToAnother:'      <div>        <span class="checkbox-wrapper">          {# editor #}        </span>        <label class="after-input" for="{# editorLabelFor #}">{# title #}</label>      </div>    ',fieldsPanelNoLoupe:'      <div>        <label for="{# editorLabelFor #}">{# title #}</label>        <div class="input-decorated extralong">          {# editor #}        </div>      </div>    ',fieldsPanelLoupe:'      <div>        <label for="{# editorLabelFor #}">{# title #}</label>        <div class="input-decorated extralong">          <span class="input-decorations right zoomglass"></span>          {# editor #}        </div>      </div>    ',bicSwiftInput:'      <div class="row row-{# key #} bic-input-wrapper">        <div class="header">          <label for="bic-input">            <span>{# title #}</span>             {% if(typeof _params !== "undefined" && _params.tooltip) { %}            <a href="#" rel="tooltip" class="btn-gray-gradient-darker btn-small" data-original-title="{# _params.tooltip #}">              <i class="icon-question-mark">Pomoc: <span class="accessability-nohide">{# _params.tooltip #}</span></i>            </a>             {% } %}          </label>        </div>        <div class="fields">          <span class="validation-icon"></span>          <div class="fl">            {# editor #}          </div>          <div class="validation-text">{# help #}</div>        </div>      </div>    ',bicUnknown:'      <div class="bic-unknown-wrapper">        <div class="hide">          {# editor #}        </div>        <a href="#" class="after-input expand-bic" for="{# editorLabelFor #}">          {# title #}        </a>      </div>    ',bicList:'      <div class="row row-{# key #}">        <div class="fields">          <div class="bic-swift-summary">            <div class="description">{# title #}</div>            {# editor #}          </div>        </div>      </div>    ',zusAccountCheckbox:'      <div class="checkbox-area">        <span class="checkbox-wrapper">        <label for="{# editorLabelFor #}" class="hide">{# title #}</label>        {# editor #}        </span>      </div>    ',zusTotalField:'    <div class="checkbox-label">      <span>{# title #}</span>      <span>{# help #}</span>      {# editor #}      <span class="currency after-input">PLN</span>    </div>  ',zusAccountContent:'      <div class="checkbox-label">        <span>{# title #}</span>        <span>{# help #}</span>        <div class="zus-new-contribution">        <label for="{# editorLabelFor #}">Kwota</label>        {# editor #}       <span class="currency after-input">PLN</span>       </div>      </div>    ',calendars:'      <div class="fields-row row-calendars">        {# editor #}      </div>    ',repeatableTransfer:'      <div class="recurrent-container expand-group tab">        <div class="row row-standing-orders">          <div class="fields">            {# editor #}          </div>        </div>      </div>    ',labelAfterCheckbox:'      <div>        <span class="checkbox-wrapper">          {# editor #}        </span>        <label class="after-input" for="{# editorLabelFor #}">{# title #}</label>      </div>    ',calendarMessages:'      <div class="fields-row row-summary">        <div class="message">          {# I18n.t("transfer.standingOrder.noOfPaymentsBegin") #} <span class="transfer-counter">{# editor #}</span> {# I18n.t("transfer.standingOrder.noOfPaymentsEnd") #}        </div>        <div class="message">          {# I18n.t("transfer.standingOrder.message") #}        </div>        <div class="message">          {# I18n.t("transfer.summary.bulkSummary") #}        </div>      </div>    ',sendTransferConfirmation:'      <div class="fields">        <label class="before-input">Wylij potwierdzenie na adres</label>        <div class="inputs-column">          <div>            {# items #}          </div>          <span class="btn-gray-gradient btn-small" data-action="add">            <i class="icon-plus"></i>          </span>         </div>      </div>    ',sendTransferConfirmationOptions:'      <div class="emails-wrapper">        <div class="inputs-column">          <div>            {# items #}          </div>          <a href="" title="{# I18n.t("transfer.addNextConfirmationEmail")  #}" class="btn-gray-gradient btn-mini" data-action="add"><span class="h">&nbsp;</span>+<span class="h">&nbsp;</span></a>        </div>      </div>    ',sendTransferConfirmationOptionsRadio:'        <div class="first-row-without-close-icon">        <div>          {# items #}        </div>        <a href="" title="{# I18n.t("transfer.addNextConfirmationEmail")  #}" class="btn-gray-gradient btn-mini" data-action="add"><span class="h">&nbsp;</span>+<span class="h">&nbsp;</span></a>      </div>    ',sendTransferConfirmationItem:'      <div class="row-input fields-row">        <span class="validation-icon"></span>        {# editor #}        <a href="javascript:void(0)" class="remove-row-icon" data-action="remove">          <i class="icon-close">{# I18n.t("transfer.removeAdditionalConfirmationEmail")  #}</i>        </a>        <div class="validation-text"></div>      </div>    ',customRadioWithLabel:'      <div class="radio-section">        <div class="radio-wrapper">          {# editor #}        </div>        <label for="{# editorLabelFor #}" class="after-input">{# title #}</label>      </div>    ',amountCurrency:'      <div>        <label for="{# editorLabelFor #}" class="hide">{# title #}</label>        {# editor #}      </div>    ',zusFieldWithCurrency:'      <div class="row row-{# key #}">        <div class="header">{# title #}</div>        <div class="fields">          {# editor #}        </div>      </div>    ',phoneChargeConvertToPeriodic:'     <div class="row row-convertToPeriodicPhoneCharge">        <div class="fields">          <div class="save-options">            <span class="label">{# I18n.t("transfer.domestic.change") #}</span>            <a href="#" class="convertToPeriodicPhoneCharge-trigger">              <span class="btn-gray-gradient-darker btn-small">                <i class="icon-star"></i>              </span>              {# I18n.t("transfer.domestic.phonecharge") #}            </a>          </div>        </div>      </div>      ',longDate:'      <div class="">        <div class="">          <div class="calendar-trigger date-picker-replacer">            {# editor #}            <div class="btn-gray-gradient-darker btn-small">                <i class="icon-calendar"></i>            </div>          </div>        </div>      </div>    ',onlyEditor:'<span class="only-editor-container">{# editor #}</span>',onlyEditorAndLabel:'      <span class="only-editor-container">        <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>        {# editor #}      </span>',zusNewTotalCheckbox:'      <div class="checkbox-area zus-total">        <span class="checkbox-wrapper zus-total">          {# editor #}        </span>        <span class="zus-total-label">{# title #}</span>      </div>      ',zusDeliveryTimeDate:'        <div class="row row-{# key #}">          <div class="header">                <label for="{# editorLabelFor #}">{# title #}</label>          </div>          <div class="fields">            <span class="validation-icon"></span>            <span class="uiDateInput">              {# editor #}            <div class="calendar-trigger date-picker-replacer">              <a href="javascript:void(0)" class="btn-gray-gradient-darker btn-small"                data-gemius-event-type="action"               data-gemius-event-action-id="'+e.getGemiusActionId("transfer.calendar.select")+'"               data-gemius-event-action-name="transfer.tab.series.trasnfer">                  <i class="icon-calendar">{# I18n.t("transfer.selectDate") #}</i>              </a>            </div>            </span>            <span role="alert" class="validation-text"></span>          </div>        </div>      ',innerAmountWithCurrency:'      <div>        <label for="{# editorLabelFor #}" class="accessible-not-visible">{# title #}</label>        {# editor #}        <span class="label-currency">PLN</span>      </div>    ',innerAmountWithCurrencyAndLabelBeforeInput:'      <div>        <label for="{# editorLabelFor #}" class="before-input">{# title #}</label>        {# editor #}        <span class="label-currency">PLN</span>      </div>    '}}),define("text!transfer/templates/tooltips/transfer-form-text.html",[],function(){return'<span class="gray-gradient">\r\n\t<span class="text">\r\n\t{% if (obj && obj.text) { %}\r\n\t\t{{ text }}\r\n\t{% } %}\r\n\t</span>\r\n</span>\r\n'}),define("transfer/js/logic/permitted-characters",[],function(){return function(e){var t=e.keyCode?e.keyCode:e.charCode,a=String.fromCharCode(t);if(/["'%&\(\)\.,!\?#\^\*\|\[\]\{\}\@~\+\_\/\\\$\<\>\~\`]/.test(a))return!1;var r=[9,37,39];if(e.shiftKey&&_.contains(r,t))return!0;var n=[8,9,13,27,33,34,36,37,38,39,40,46],i=Ebre.Entity.isPL()||Ebre.Entity.isOF();return!!((i===!1||e.shiftKey===!1)&&_.contains(n,t)||e.ctrlKey&&_.contains([120,118,99,97,88,86,67],t))}}),define("transfer/js/logic/numbers-input-constraint",["./permitted-characters"],function(e){return function(t){if(e(t))return!0;var a=t.keyCode?t.keyCode:t.charCode,r=String.fromCharCode(a),n=$(this),i=n.val(),o=n.data(),s=o?o.length:null;return!(_.isNumber(s)&&i&&this.selectionStart==this.selectionEnd&&i.match(/\d/g).length>=s)&&!!r.match(/[0-9\s]/)}}),define("transfer/js/views/forms/_generic",["text!../../../templates/forms/generic-wrapper.html","../../app",nmbPaths.global.js+"validator","../../models/nmb-account-validate-service","../../models/nmb-account-coowners-service","../../models/nmb-date-check-service","../../models/nmb-account-check-service","../../../templates/forms/templates","text!../../../templates/tooltips/transfer-form-text.html","../../logic/numbers-input-constraint"],function(e,t,a,r,n,i,o,s,l,d){var c=Backbone.Marionette.ItemView.extend({template:e,tagName:"section",className:"form-view",events:{"click .save-form":"submitTransfer","click .cancel-form":"cancelTransfer","click .recurrent-trigger":"toggleRecurrent","click .serie-trigger":"toggleSeries","click .addToBasket":"addToBasket"},initialize:function(){Backbone.Form.setTemplateCompiler(_.template),Backbone.Form.setTemplates(s,{error:"validation error"}),this.on("item:before:close",function(){$("#transfer-app-root").find("#series-trigger-tooltip, #recurrent-trigger-tooltip").remove()})},checkServicePromise:null,submitTransfer:function(e,r){var n=this,i=this.form,o=this.model.toJSON(),s=$.Deferred();this.turnOffOnBlurValidation(),Ebre.Proxy.showPreloader("#form-container"),$(e.target).mytooltip("close").mytooltip("disable"),"facebook"!=o.formType&&"mobile"!=o.formType&&i.fields.addToBasket.setValue(!(!r&&i.fields.addToBasket)),"abroad"!=o.formType||"swift"!=n.model.get("transferType")||n.model.get("isEOG")||$(".row-address:visible").length<1&&(i.getValue("address").street.length<1||i.getValue("address").city.length<1)&&n.slidingAddress(i.fields.address.$(".address-expander"),!1,i,n.model.toJSON(),!0),n.validationFromSubmitButton=!0;var l=$.when.apply($,a.validateForm(i)).pipe(function(){var e=$.Deferred();if(a.checkStatus(i)){try{Ebre.Common.announceAlert(a.getAccessibleError(i))}catch(e){}e.reject()}else e.resolve();return e.promise()});n.validationFromSubmitButton=null;var d=l.pipe(function(){return"function"==typeof n.checkOnSubmit?n.checkOnSubmit():n.checkServicePromise}),c=d.pipe(function(){return n.formTypeChangeSuggestion?(n.showSuggestPopup(n.formTypeChangeSuggestion,s),s.always(function(){var e;n.formTypeChangeSuggestion&&n.formTypeChangeSuggestion.validationMessage&&(e=n.form.fields.toAccount,e.$el.removeClass("success").addClass("validation error"),e.$(".validation-text").text(n.formTypeChangeSuggestion.validationMessage))}),n.formTypeChangeSuggestion.validationMessage||(n.formTypeChangeSuggestion=null)):s.resolve(),s}),u=c.then(function(e){var t=$.Deferred();return n.modalMessageBeforeSend?(n.showModalPopup(n.modalMessageBeforeSend,t,n.modalMessageType),n.modalMessageBeforeSend=null,n.messageType=null):t.resolve(),t});u.done(function(){a.checkStatus(i)||("splitdomestic"===o.formType?t.trigger("transfer:submit",{form:i}):t.trigger("transfer:checkFalter",{form:i}))}),c.always(function(){Ebre.Proxy.hidePreloader("#form-container")})},addToBasket:function(e){this.submitTransfer(e,!0)},cancelTransfer:function(){this.turnOffOnBlurValidation(),t.trigger("transfer:cancel"),this.lastCheckedValues={},t.trigger("show:dashboard"),Ebre.Wizard.trigger("wizard:hide")},turnOffOnBlurValidation:function(){"undefined"!=typeof this.onBlurValidationTimeout&&_.each(this.onBlurValidationTimeout,function(e){clearTimeout(e)})},styleSelects:function(){this.$(".beautify-select:not([data-default-text])").each(function(){var e=$(this),t={},a=e.attr("placeholder");a&&(t.defaultText=a),e.sSelect(t)})},styleSelectsDefault:function(){this.$(".beautify-select[data-default-text]").each(function(){$(this).sSelect({defaultText:$(this).data("default-text")})})},styleSelectOne:function(e){setTimeout(function(){e.sSelect({defaultText:"Wybierz"})},0)},chosen:function(e){var t=this.$(".chzn-select"),a={no_results_text:I18n.t("transfer.forms.chosen.noResults")},r=_.extend(a,e);t.each(function(){e=_.extend({},r,$(this).data()),$(this).chosen(e)})},styleCheckbox:function(){var e=this.$el.find(".checkbox-wrapper").children('input[type="checkbox"]');e.on("change",function(e){var t=$(this);t.closest(".checkbox-wrapper").toggleClass("checked",t.is(":checked"))}).trigger("change"),e.on("focus",function(e){var t=$(this);t.closest(".checkbox-wrapper").addClass("focus")}),e.on("blur",function(e){var t=$(this);t.closest(".checkbox-wrapper").removeClass("focus")})},elasticTextAreas:function(){this.$el.find("textarea.expanding").elastic()},styleRadioPanels:function(){var e=this.$el.find(".radio-panel"),t=e.find(".radio-wrapper"),a=t.children('input[type="radio"]:not([disabled])'),r=a.parents(".radio-area");r.off("click.setup").on("click.setup",function(a){var r=$(this).find('input[type="radio"]');r.prop("checked",!0);var n=r.parents(".radio-wrapper").addClass("checked"),i=r.parents(".radio-panel").addClass("selected");t.has("[name="+r.attr("name")+"]").not(n).removeClass("checked"),e.has("[name="+r.attr("name")+"]").not(i).removeClass("selected"),$(t).find("input").change()}),a.off("change.setup click.setup").on("change.setup click.setup",function(a){var r=$(this);if(r.is(":checked")){var n=r.parents(".radio-wrapper").addClass("checked"),i=r.parents(".radio-panel").addClass("selected");t.has("[name="+r.attr("name")+"]").not(n).removeClass("checked"),e.has("[name="+r.attr("name")+"]").not(i).removeClass("selected")}}),a.off("focus.setup blur.setup").on("focus.scripts",function(){$(this).closest(".radio-panel").addClass("focused")}).on("blur.scripts",function(){$(this).closest(".radio-panel").removeClass("focused")}),a.trigger("change")},styleRadioButtons:function(){var e=this.$el;e.on("change",'input[type="radio"]',function(t){var a=$(this);if(a.is(":checked")){var r=a.parents(".radio-wrapper").addClass("checked");e.find(".radio-wrapper").has("[name="+a.attr("name")+"]").not(r).removeClass("checked")}}),e.find('input[type="radio"]').trigger("change")},styleCheckboxPanels:function(){this.$el.find(".checkbox-panel").each(function(){function e(e,t){e.is(":checked")?(e.parents(".checkbox-wrapper").addClass("checked"),e.parents(".checkbox-panel").addClass("selected"),t||a.focus()):(e.parents(".checkbox-wrapper").removeClass("checked"),e.parents(".checkbox-panel").removeClass("selected"),t||""===a.val()||a.val("").blur())}var t=$(this).find("input[type=checkbox]"),a=$(this).find('input[type="text"]');$(this).on("click",function(e){if(e.target!=t.get(0)){var a=!$(e.target).is("input[type=text]")&&t.prop("checked");t.prop("checked",!a).trigger("change")}}),$(this).on("mouseenter",function(e){t.parents(".checkbox-wrapper").addClass("hover")}),$(this).on("mouseleave",function(e){t.parents(".checkbox-wrapper").removeClass("hover")}),t.on("change",function(t,a){e($(this),a)}),a.on("blur",function(e){var r=a.val();t.prop("checked",""!=r).trigger("change",!0)}),e(t,!0)})},getFormAccount:function(e,t,a){var r=[];return t="undefined"!=typeof t&&t,_.each(e,function(e,n){var i=I18n.l("currency",e.balance),o=I18n.t("transfer.form.fromAccount.balance"),s=I18n.l("currency",e.ownFunds),l=I18n.t("transfer.form.fromAccount.ownFunds"),d=_.template("({{label1}}{{amount1}} {{currency1}} / {{label2}}{{amount2}} {{currency2}})",{accountNo:e.displayName,label1:o,amount1:i,currency1:e.currency,label2:l,amount2:s,currency2:e.currency}),c=e.showOwnFunds&&!e.showBalance?s:i,u=e.showOwnFunds&&!e.showBalance?l:o,m=_.template("({{label}}{{amount}} {{currency}})",{accountNo:e.displayName,label:u,amount:c,currency:e.currency}),p=e.showOwnFunds&&e.showBalance?d:m,f=_.template("{{accountNo}} {{accountBalanceInfoBold}}",{accountNo:e.displayName,accountBalanceInfoBold:p});if(!t||t&&!e.isCreditCard)if("not_defined"==e.number)r.push({val:e.number,label:_.template("{{accountNo}}",{accountNo:e.displayName})});else if(e.relatedAccount&&e.relatedAccount.displayName){var h=I18n.l("currency",e.relatedAccount.balance),b=_.template("({{label}}{{amount}} {{currency}})",{accountNo:e.relatedAccount.displayName,label:o,amount:h,currency:e.currency}),v="";e.relatedAccount.displayName&&null!==e.relatedAccount.displayName&&(v=_.template("{{accountNo}} {{accountBalanceInfoBold}}",{accountNo:e.relatedAccount.displayName,accountBalanceInfoBold:b}));var y=!!a&&"splitown"===a;r.push({val:e.number,label:y?v:f,boldText:y?b:p,isVatCompliant:e.isVatCompliant,secondaryAccountLabel:y?f:v,secondaryAccountBoldText:y?p:b})}else r.push({val:e.number,label:f,boldText:p})}),r},showSuggestPopup:function(e,a){var r=this,n=r.form,i=_.extend(e,{recipientId:r.model.get("recipientId"),formValues:n.getValue(),fromAccount:n.getField("fromAccount").editor.value,deferred:a});t.trigger("dialog","formTypeChange",new Backbone.Model(i))},showModalPopup:function(e,a,r){var n=this,i=(n.form,{message:e,deferred:a}),o=["confirm","info"],s="undefined"!=typeof r&&r&&_.contains(o,r)?r:"confirm";t.trigger("dialog",s,new Backbone.Model(i))},displayValidationMessage:function(e,t){e.$el.removeClass("validation info").addClass("validation info"),t&&e.$el.find(".fields > .validation-text").html(t)},getPaymentTypes:function(e){var t=[];return _.each(e.types,function(e,a){t.push({val:e.type,label:e.label})}),t},triggerDatepicker:_.debounce(function(e){function t(e,t){var a=e.val(),r=t.find(".content");t.hasClass("input")?(r.val(a),r.on("change",function(){var t=r.val(),a=t.substr(6,4)+"/"+t.substr(3,2)+"/"+t.substr(0,2);isFinite(new Date(a))&&e.datepicker("setDate",r.val()),r.val($.datepicker.formatDate("dd.mm.yy",e.datepicker("getDate")))})):r.html(a)}var a=this,r=this.$("form .hasDatepicker");a.$el.find(".bbf-jui-date-input").siblings().find(".btn-small").each(function(){$(this).off("click.setdatepicker").on("click.setdatepicker",function(){$(".bbf-jui-date-input").datepicker("show")})}),r.length&&(a.$(".bbf-jui-date .hasDatepicker").each(function(){var e=$(this),a=e.closest(".date-picker-replacer");t(e,a),a.off("click.datepickersetup change.datepickersetup").on("click.datepickersetup change.datepickersetup",function(t){if(!$(t.target).hasClass("static-date")){$(t.currentTarget).hasClass("series")&&!$(t.target).hasClass("clickable-overlay")||e.datepicker("show");var a=$(document),r=$("#ui-datepicker-div"),n={};a.height()>$("#header").height()+$("#form-container").height()+$("#transfer-container").height()+$(".submenu-region:first").height()&&(n.scrollTop=r.offset().top),a.width()>960&&(n.scrollLeft=r.offset().left),$.isEmptyObject(n)||$("html, body").stop().animate({scrollTop:n.scrollTop,scrollLeft:n.scrollLeft},1e3)}})}),e&&t(e.$el.find(".hasDatepicker"),e.$el.closest(".date-picker-replacer")))},100),bindOnChangeValidation:function(e){var t=this;_.each(e,function(e){var r=e.split(" "),n=r[0];t.bindTo(t.form,r[1]+":change",function(e){var t=e.getField(r[0].replace(/:/g,"."));n=n.replace(":item",":0"),a.validateField(e,n,t)})})},bindOnBlurValidation:function(e){var t=this;t.onBlurValidationTimeout=this.onBlurValidationTimeout||{},_.each(e,function(e){t.bindTo(t.form,e+":blur",function(r){var n=_.toArray(arguments),i=n.pop(),o=e.replace(":item",":0"),s=0,l=e.replace(/:/g,"_");t.onBlurValidationTimeout[l]=setTimeout(function(){if(o!==e&&n[1]&&n[1].items){var l=_.any(n[1].items,function(e,t){return s=t,e.$el.find(i.$el).length>0});l&&(o=e.replace(":item",":"+s))}a.validateField(r,o,i),"us"!==t.model.get("formType")||"period:currentValue"!==e&&"period:currentYear"!==e&&"period:currentMonth"!==e||t.periodInfo()},200)})})},wrapFunctionWithCheck:function(e,t){var r=this,n=this.form;return function(){isInvalid=!1,_.each(e,function(e){if(""!==n.getField(e.replace(":",".")).getValue()){clearTimeout(r.onBlurValidationTimeout[e.replace(/:/g,"_")]),a.validateField(n,e,n.getField(e.replace(":",".")));var t=a.getFieldState(n,e);isInvalid||(isInvalid=_.some(t,function(e,t){return"error"===e.type}))}});var i=!0;_.each(e,function(e){n.getField(e.replace(":",".")).editor.getValue()||(i=!1)}),i||(isInvalid=!0),isInvalid||t.apply(this,arguments)}},bindToWithValidityCheck:function(e,t,a,r,n){var i=this,o=_.bind(a,i,e),s=_.wrap(i.wrapFunctionWithCheck(n,o),function(e){e()});i.bindTo(e,t,s,r)},toggleRecurrent:function(e){e.preventDefault();var t=this.form,a=t.getField("isSeriesOfTransfers").editor,r=t.getField("isRepeatableTransfer").editor,n=a.getValue(),i=r.getValue();return n&&(a.setValue(!1),t.trigger("isSeriesOfTransfers:change",t,{withoutServiceSideCheck:!0})),r.setValue(!i),r.trigger("change"),t.trigger("deliveryTime:change",t),!1},toggleSeries:function(){var e=this.form,t=e.getField("isSeriesOfTransfers").editor,a=e.getField("isRepeatableTransfer").editor,r=t.getValue(),n=a.getValue();return n&&(a.setValue(!1),e.trigger("isRepeatableTransfer:change",e,{withoutServiceSideCheck:!0})),r||e.trigger("seriesOfTransfers:refresh",e,!0),t.setValue(!r),t.trigger("change"),e.trigger("deliveryTime:change",e),!1},initFormZusNew:function(e){var t="zus-input-disabled",a=this,r=a.$el.find(".total-checkbox");r.on("change",function(e){var r=a.form.$el.find(".zus-transfer-total-content"),n=a.form.$el.find(".row-zus-transfer-types");this.checked?(n.show(),r[0].disabled=!0,r.addClass(t)):(n.hide(),r[0].disabled=!1,r.hasClass(t)&&r.removeClass(t))});var n=a.$el.find(".zus-transfer-total-content");n.on("change",function(e){function t(){$(this);r.find(".checkbox-panel").each(function(){var e=$(this).find("input[type=checkbox]");$(this).removeClass("selected").removeClass("checked");var t=$(this).find(".checkbox-wrapper"),a=$(this).find("input[type=text]");a[0].value="",e[0].checked=!1,t.removeClass("checked")})}var r=a.$el.find(".row-selectZus");t()})},slidingTabs:function(){function e(e,a){var e=this.form.getValue(),i=e.isSeriesOfTransfers,o=e.isRepeatableTransfer||!1,s=r||this.model.get("availableCurrency"),l=n||this.model.get("currency"),d=i||o,m=this.getDomesticCurrency();a||(r=this.model.get("availableCurrency")),c(i,a),u(o,a),d?(n=this.form.getField("currencies").getValue(),this.model.set("availableCurrency",[m]),this.form.getField("currencies").editor.setOptions({id:m,val:m}),this.form.getField("currencies").editor.setValue(m),this.form.getField("currency").setValue(m),this.model.set("currency",m)):(this.model.set("availableCurrency",s),this.form.getField("currencies").editor.setOptions(this.mapListToOptions(s,!1)),this.form.getField("currencies").editor.setValue(l),this.form.getField("currency").setValue(l),this.model.set("currency",l)),t.checkAvailableCurrency(t.form),t.transferModeCheckVisibility(),a!==!0&&Ebre.Wizard.trigger("layout:removepoints")}var t=this,a=this.$el,r=r||null,n=n||null,i=a.find(".serie-trigger"),o=i.parents(".row:first").nextAll(".series-container.expand-group:first"),s=a.find(".recurrent-trigger"),l=s.parents(".row:first").nextAll(".recurrent-container.expand-group:first"),d=a.find(".row-date .uiDateInput"),c=function(e,r){e?(r?(o.show(),a.find(".row.row-amount").hide(),a.find(".row.row-title").hide()):(o.slideDown("normal",function(){t.elasticTextAreas()}),i.addClass("expanded tab"),$(".series-trigger-tooltip").children(".text").text(I18n.t("transfer.domestic.tooltips.seriesTooltipClose")),a.find(".serie-trigger").mytooltip("reposition"),a.find(".row.row-amount").slideUp(),a.find(".row.row-title").slideUp()),i.addClass("expanded tab")):(o.hide("normal",function(){t.elasticTextAreas()}),i.removeClass("expanded tab"),$(".series-trigger-tooltip").children(".text").text(I18n.t("transfer.domestic.tooltips.seriesTooltip")),a.find(".serie-trigger").mytooltip("reposition"),a.find(".row.row-amount").slideDown(),a.find(".row.row-title").slideDown()),s.hasClass("expanded")||i.hasClass("expanded")?d.hide():d.show()},u=function(e,t){e?(l.slideDown("normal",function(){}),s.addClass("expanded tab"),$(".recurrent-trigger-tooltip").children(".text").text(I18n.t("transfer.domestic.tooltips.recurrentTooltipClose")),a.find(".recurrent-trigger").mytooltip("reposition"),d.hide()):(l.hide(),s.removeClass("expanded tab"),$(".recurrent-trigger-tooltip").children(".text").text(I18n.t("transfer.domestic.tooltips.recurrentTooltip")),a.find(".recurrent-trigger").mytooltip("reposition"),d.show()),s.hasClass("expanded")||i.hasClass("expanded")?d.hide():d.show()};this.bindTo(this.form,"isSeriesOfTransfers:change isRepeatableTransfer:change",e,this),e.call(this,this.form,!0)},slidingAddressFunction:function(e,t,a,r){var n=this;if(e instanceof jQuery)var i=e;else var i=$(e.currentTarget);var o=i.parents(".row:first").next(".expand-group"),s=i.find(".text");"undefined"==typeof r&&o.is(":visible")||"undefined"!=typeof r&&!r?o.slideUp("normal",function(){s.text(t),i.find(".btn-mini").text("+").removeClass("expanded")}):o.slideDown("normal",function(){s.text(a),i.find(".btn-mini").text("-").addClass("expanded"),n.initFocusedPlaceholders($(this).find("input"),!1)})},slidingAddress:function(e,t,a,r,n){e&&e.preventDefault&&e.preventDefault(),a&&r||(a=this.form,r=this.model.toJSON());var i;"abroad"==r.formType&&(i=a.getField("transferType"));var o,s=i&&"sepa"==i.getValue(),l=this.model.get("isEOG"),d=a.getField("address").$(".text"),c=r.address,u=I18n.t("transfer.hideAddress");o=!c||""===c.city&&""===c.street?I18n.t("transfer.addAddress"):"abroad"!=r.formType||s||l?I18n.t("transfer.showAddress"):I18n.t("transfer.showAddressNoSwift"),t?d.text(I18n.t("transfer.showAddress")):this.slidingAddressFunction(e,o,u,n)},slidingAddressZusOrUs:function(e,t,a,r,n){a&&r||(a=this.form,r=this.model.toJSON());var i,o=a.fields.nameAndAddress.$el.find(".text"),s=r.nameAndAddress,l=I18n.t("transfer.hideZusOrUsAddress");i=""!==s.name||""!==s.street||""!==s.city?I18n.t("transfer.showZusOrUsAddress"):I18n.t("transfer.addZusOrUsAddress"),t?o.text(i):this.slidingAddressFunction(e,i,l,n)},initializeSlidingAddress:function(){var e=this,t=e.model,a=e.form;this.slidingAddress(null,!0,a,t.toJSON())},tooltip:function(){var e="ui-payments-general-purpose-tooltip",t=$(document.getElementById(e)||$(_.template(l)()).attr("id",e).appendTo("#transfer-app-root"));this.$("[rel=tooltip]").each(function(){var e=$(this),a=e.attr("title");a&&(e.attr("title",""),$.data(this,"originalTitle",a)),e.hasClass("ui-tooltip-caller")||e.mytooltip({tooltip:t,width:250,outDelay:60,offset:{top:-12},onShow:function(e,t){t.find(".text").html(e.data().originalTitle),e.mytooltip("reposition")}})}).off("click.tooltipcaller").on("click.tooltipcaller",function(e){e.preventDefault()})},generateSeriesAndRecurrentTooltip:function(){var e=this.$(".serie-trigger");if(!e.hasClass("ui-tooltip-caller")){var t="series-trigger-tooltip";e.mytooltip({tooltip:$(document.getElementById(t)||$(_.template(l)({text:I18n.t("transfer.domestic.tooltips.seriesTooltip")})).attr("id",t)),
inDelay:10,outDelay:0,side:"top",position:"center bottom",offset:"0 -6",parentElement:"#transfer-app-root"})}var a=this.$(".recurrent-trigger");if(!a.hasClass("ui-tooltip-caller")){var r="recurrent-trigger-tooltip";a.mytooltip({tooltip:$(document.getElementById(r)||$(_.template(l)({text:I18n.t("transfer.domestic.tooltips.recurrentTooltip")})).attr("id",r)),inDelay:10,outDelay:0,side:"top",position:"center bottom",offset:"0 -6",parentElement:"#transfer-app-root"})}},generateSenderSelect:function(){var e,t,a,r=this.model.toJSON(),n=this.form.getValue(),i=n.fromAccount,o=r.availableFromAccounts,s=_.find(o,function(e){return i===e.number}),l=this.form.fields.sender,d=[];e=s.coowners;var c=null;n.idType&&n.idType.type&&n.idType.series&&(c=_.find(e,function(e){switch(n.idType.type){case"P":return n.idType.series.toLowerCase()===e.pesel.toLowerCase();case"2":return n.idType.series.toLowerCase()===e.passport.toLowerCase();case"1":return n.idType.series.toLowerCase()===e.personalID.toLowerCase();case"R":return n.idType.series.toLowerCase()===e.regon.toLowerCase();default:return!1}})),a=c?c.coownerId:s.activeCoownerId,t=l.$("select"),l.$el.toggle(e.length>1),_.map(e,function(e){d.push({label:e.displayName,val:e.coownerId})}),l.editor.setOptions(d),r.sender&&l.editor.setOptions(d),a&&l.setValue(a),t.next(".newListSelected").length&&t.resetSS()},checkSender:function(){var e=this,t=this.model.toJSON(),a=this.form.getValue(),r=a.fromAccount,i=t.availableFromAccounts,o=(this.form.fields.sender,_.find(i,function(e){return r===e.number})),s=new n,l=new $.Deferred;return o?s.fetch({accountNo:o.number,accountParams:o.accountParams,success:function(){var t=s.toJSON();o.coowners=t.coowners,o.activeCoownerId=t.activeCoownerId,"mobile"!=e.model.get("formType")&&"facebook"!=e.model.get("formType")&&e.generateSenderSelect(),l.resolve(t)}}):l.resolve(void 0),l},updateSenderData:function(){var e,t=this.model.get("formType"),a=this.form.getValue(),r=this.form.getField("sender"),n=_.find(this.coowners,function(e){return e.coownerId==r.getValue()});if("zus"===t||"us"===t){"1"===a.idType.type?e="personalID":"2"===a.idType.type?e="passport":"P"===a.idType.type?e="pesel":"R"===a.idType.type?e="regon":"N"===a.idType.type?e="nip":"3"===a.idType.type&&(e="other");var i="undefined"!=typeof n&&n.hasOwnProperty(e)?n[e]:"";if(this.form.$(".row-idType input[name=series]").val(i),!("zus"==t&&n&&n.hasOwnProperty("nip")&&n.nip)||a.nip&&this.form.model.get("isNipDirty")||this.form.$(".row-nip input[name=nip]").val(n.nip),this.form.$(".row-idType").hasClass("validation error")&&this.form.$(".row-idType").removeClass("validation error"),i){var o=this.form.fields.idType.editor.form.fields.series;this.form.trigger("idType:series:blur",this.form,o)}}},updateCostInformation:function(e){var t=this;nmbServices.GetCostInformation({fromAccount:e,success:function(e){t.model.set("transferModes",e);var a=t.prepareDataForTransferModes(e);t.form.fields.transferMode.editor.setOptions(a),t.form.fields.transferMode.editor.setValue(a[0].val),t.styleRadioPanels()}})},checkCreditCard:function(e){var t=this.form,a=this.form.fields.fromAccount,r=this.model.toJSON().availableFromAccounts,n=a.getValue(),i=t.$el.find(".date-picker-replacer"),o=!1,s=this.model.toJSON().deactivateDateField;"domestic"===this.model.toJSON().formType&&this.form&&_.contains(["express","sorbnet","sepa","swift_own","swift_sha"],this.form.getValue("deliveryTime"))&&(o=!0),"domestic"===this.model.toJSON().formType&&this.form.fields.deactivateDateField.setValue(s);var l=!1;if(_.each(r,function(e){e.number==n&&(l=e.isCreditCard)}),l?this.model.set("canAddToBasketCC",!1):this.model.set("canAddToBasketCC",!0),l||s||o?this.setCurrentDateAndDisableDatepicker(i):this.enableDatepicker(i),e)return l},toggleBlockResources:function(e){var t=e.fields.additionalOptions,a=t.editor.form.fields.blockResources.$el,r=!1,n=$.Deferred(),o=new i;return o.fetch({date:e.getValue().date,success:function(e){n.resolve(e);var t=!(e.toJSON().isPastDate||e.toJSON().isTodaysDate);t||(a.find(" .checkbox-wrapper").removeClass("checked"),r=!0),a.toggle(t)}}),r&&this.form.fields.additionalOptions.editor.form.fields.blockResources.setValue(!1),n.promise()},toggleTransferSendDateText:function(e){var t=e.$el.find(".row-transferMode.row-delivery-time").find(".time"),a=$.Deferred(),r=new i;return r.fetch({date:e.getValue().date,success:function(e){a.resolve(e);var r=!(e.toJSON().isPastDate||e.toJSON().isTodaysDate);r?t.hide():t.show()}}),a.promise()},setCurrentDateAndDisableDatepicker:function(e){if($(".transfer-form-view").length){var t=this.$el.find(".hasDatepicker");if(void 0!=t&&null!=t){var a=null,r=this.model.get("formType");if("onezus"===r){var n=new Date;a=$.datepicker.formatDate("dd.mm.yy",n)}else a=$.datepicker.formatDate("dd.mm.yy",this.model.get("dateNow"));var i=$.datepicker.formatDate("dd.mm.yy",this.form.getField("date").getValue());t.val(a),""==i&&i!=a&&(Ebre.Common.createMessage(I18n.t("transfer.transferDateChanged")),this.triggerDatepicker())}"undefined"!=typeof this.form.fields.isFutureDate&&this.form.fields.isFutureDate.setValue(!1),e=e.not(".series"),this.$el.find(".calendar-trigger").not(".series").hide(),e.parent(".uiDateInput").addClass("disabled"),e.parent(".uiDateInput").find("input").attr({disabled:"disabled"}),e.off("click"),e.add(e.children()).css("cursor","default"),e.find(".content").addClass("static-date"),e.find(".btn-small").hide()}},enableDatepicker:function(e){this.triggerDatepicker(),e.add(e.children()).css("cursor","pointer"),e.find(".content").removeClass("static-date"),e.find(".btn-small").show(),e.parent(".uiDateInput").find("input").attr({disabled:!1}),this.$el.find(".calendar-trigger").show(),e.parent(".uiDateInput").removeClass("disabled")},plainAccountNumber:function(e){if(e)return e=e.replace(/\s+/g,""),/^\D.*/.test(e)&&(e=e.substring(2,e.length)),e},formatAccountNumber:function(e){return/^\D.*/.test(e)&&(e=e.substring(2,e.length)),currenciesField.$el.find("select").resetSS(),("00"+(""+e).replace(/\D/g,"")).match(/(\d{4})/g).join(" ").substring(2)},toggleAddToBasket:function(e){var t=this.model.toJSON(),a=void 0==t.canAddToBasket||t.canAddToBasket,r=void 0==t.canAddToBasketDT||t.canAddToBasketDT,n=void 0==t.canAddToBasketCC||t.canAddToBasketCC,i=1==a&&1==r&&1==n,o=this.$el.find("input[name=addToAddressBook]").is(":checked"),s=e.getValue();if(void 0!=s.additionalOptions)var l=s.additionalOptions.addReceiver.addToAddressBook||!1;else var l=!1;var d=this.model.get("formType");if("zus"!=d&&"us"!=d)var c=s.isRepeatableTransfer,u=s.isSeriesOfTransfers,m=!c&&!u;else var m=!0;i&&m&&!l&&!o?e.fields.submitButtons.editor.form.fields.addToBasket.$el.show():e.fields.submitButtons.editor.form.fields.addToBasket.$el.hide()},hideListRemoveButton:function(e){e&&(1==e.length?e[0].$el.find(".remove-row-icon").hide():e[0].$el.find(".remove-row-icon").show())},checkAccountNumber:function(e){var t=new o,a=$.Deferred(),e=this.plainAccountNumber(e);return t.fetch({number:e,success:function(e){var e=t.toJSON();a.resolve(e)}}),a.promise()},checkAvailableCurrency:function(e){var t,a=this,r=a.model.toJSON(),n=e.fields.currency,i=e.fields.currencies,o=r.availableCurrency;e.fields.isSeriesOfTransfers&&(t=e.fields.isSeriesOfTransfers.getValue()),t||(i.editor.setOptions(o),i.setValue(n.getValue()),i.$el.find("select").resetSS(),n.setValue(r.currency),o&&o.length>1?(i.$el.addClass("active").show(),n.$el.removeClass("active").hide()):(i.$el.removeClass("active").hide(),n.$el.addClass("active").show()))},initializeCurrencies:function(){var e=this,t=this.model.toJSON(),a=e.model.toJSON().availableCurrency,r=this.form.fields.currency,n=this.form.fields.currencies,i=t.currency;t.availableCurrency;a&&a.length>1?(n.editor.setOptions(a),n.setValue(i),n.$el.find("select").resetSS(),n.$el.addClass("active").show(),r.$el.removeClass("active").hide()):(n.$el.removeClass("active").hide(),r.$el.addClass("active").show()),e.currenciesInitialized=!0},rememberModalMessage:function(e){e&&e.available&&e.available.modalBeforeSend&&""!=e.available.modalBeforeSend.messageKey&&!this.formTypeChangeSuggestion?(this.modalMessageBeforeSend=I18n.t(e.available.modalBeforeSend.messageKey),this.modalMessageType=e.available.modalBeforeSend.messageType):(this.modalMessageBeforeSend=null,this.modalMessageType=null)},rememberFormTypeChangeSuggestion:function(e){function t(e){var t,a=e&&e.available&&e.available.accountVerifyInfo;return!a.isFormCorrect&&a.changeFormTo&&(t={type:a.changeFormTo,message:a.message,validationMessage:a.validationMessage}),t}var a,r,n=this,i=n.form.model.get("formType"),o="domestic"==i&&(n.form.fields.isRepeatableTransfer.getValue()||n.form.fields.isSeriesOfTransfers.getValue());a=t(e),a&&a.type!==i&&(r=a),o||"domestic"==i&&n.model.get("defaultData").isDefined||(n.formTypeChangeSuggestion=r)},verifyAmount:function(e){var t=e.toString().replace(".",",");return t.indexOf(",")==-1&&(t+=","),t=this.padRight(t,"0",t.indexOf(",")+3)},padRight:function(e,t,a){for(var r=e;r.length<a;)r+=t;return r},parseDecimal:function(e){return parseFloat(e.replace(",",".").replace(/\s/g,""))},setFocusOnInput:function(e,t){if(!e&&!t)return void this.$el.find('input[type="text"]:not([autocomplete]):first').trigger("focus");var a=0==e.length?"":this.$el.find('#form-container input[name="'+e+'"][type="text"]');0==a.length&&(a=this.$el.find('#form-container input[name="'+t+'"]')),a.trigger("focus")},getLoaderParamSelector:function(){return $("."+this.el.className)},initFocusedPlaceholders:function(e,t){if("undefined"==typeof e||""==e)var e=$(":input[placeholder]");var a="placeholder"in document.createElement("input"),r=navigator.userAgent.toLowerCase(),n=r.indexOf("android")>-1,i=($.browser.opera&&$.browser.version<10.5,{inputWrapper:'<span style="position:relative; display:block"></span>',placeholderCSS:{position:"absolute",top:"0px",overflow:"hidden",display:"block"}});return t&&e.length>=1&&setTimeout(function(){e[0].focus()},0),!a||$.browser.opera||n||$.browser.msie?e.each(function(){var e=$(this),t=$.trim(e.val()),r=e.width(),n=e.height(),o=this.id?this.id:"placeholder"+Math.floor(1123456789*Math.random()),s=e.attr("placeholder"),l=$('<label class="placeholder placeholder-'+o+'" for='+o+">"+(s?s:e.attr("oryginal-placeholder")||"")+"</label>");i.placeholderCSS.width=r,i.placeholderCSS.height=n,i.placeholderCSS["line-height"]=i.placeholderCSS.height+"px",i.placeholderCSS.fontSize=e.css("fontSize"),i.placeholderCSS.fontWeight=e.css("fontWeight"),i.placeholderCSS.fontFamily=e.css("fontFamily"),i.placeholderCSS.top="14%",i.placeholderCSS.padding=0,i.placeholderCSS.paddingLeft=parseInt(e.css("paddingLeft").replace("px",""))+1+"px";var d=$(i.inputWrapper);d.css({float:e.css("float")}),l.css(i.placeholderCSS),e.wrap(d),$("label.placeholder-"+o).remove(),e.attr("id",o).after(l),t&&l.hide(),e.live("focus",function(){$.trim(e.val())||""===$.trim(e.val())||l.hide()}),e.live("keyup",function(){""!==$.trim(e.val())?l.hide():l.show()}),e.live("keypress",function(){l.hide()}),e.live("blur",function(){$.trim(e.val())||l.show()}),a&&(e.attr("oryginal-placeholder",s),e.attr("placeholder",""))}):e},initExpandableFields:function(e){"strict mode";function t(e,t){t.is(":visible")?(e.removeClass("expanded").find(".expand-icon").text("+").removeClass("expanded"),t.slideUp()):(e.addClass("expanded").find(".expand-icon").text("-").addClass("expanded"),t.slideDown(function(){r.initFocusedPlaceholders($(this).find('input[placeholder!=""]'),!1)}))}function a(t,a){var r=!1;a.find("input,select,textarea").each(function(){if(""!=$(this).val())return r=!0,!1}),!r||"undefined"!=typeof e&&e.collapsedOnStart===!0?(a.hide(),t.removeClass("expanded").find(".expand-icon").text("+")):(a.show(),t.addClass("expanded").find(".expand-icon").text("-"))}var r=this,n=r.$el.find(".generic-expander");n.each(function(){var e=$(this).parent().parent().siblings(".expander-area");$(this).css({display:"block"}).on("click",function(){return t($(this),e),!1}),a($(this),e)})},setIncomeSource:function(e){var t=this.form.$("#incsour");$.browser.mobile&&Modernizr.touch?this.form.fields.pep.getField("incsour").editor.setOptions(this.mapDictionariesToOptions(e,t.data("placeholder"))):this.form.fields.pep.getField("incsour").editor.setOptions(this.mapDictionariesToOptions(e,!0)),t.trigger("liszt:updated")},setPaymentPurpose:function(e){var t=this.form.$("#purposes");$.browser.mobile&&Modernizr.touch?this.form.fields.pep.getField("purposes").editor.setOptions(this.mapDictionariesToOptions(e,t.data("placeholder"))):this.form.fields.pep.getField("purposes").editor.setOptions(this.mapDictionariesToOptions(e,!0)),t.trigger("liszt:updated")},mapDictionariesToOptions:function(e,t){var a=[],r=_.map(e,function(e,t){return{val:e.id,label:e.name}});return t===!0?a[0]={val:"",label:""}:t!==!1&&""!=t&&(a[0]={val:"",label:t}),a.concat(r)},mapListToOptions:function(e){var t=_.map(e,function(e){return{val:e,label:e}});return t},allowOnlyNumbersOnInput:function(e,t){_.isNumber(t)&&e.data("length",t),e.on("keypress.constraint",d)},restrictKeybordInputByRegex:function(e,t){_.isNumber(length)&&e.data("length",length),e.on("keypress.constraint",function(e){var a=e.keyCode||e.charCode,r=String.fromCharCode(a);console.log(r);var n=[8,9,13,27,33,34,36,37,38,39,40,46],i=_.contains(n,a);return!(!i&&!e.ctrlKey)||t.test(r)})},updateRecipientName:function(e){this.form.fields.recipientName.setValue(e),this.model.set("recipientName",e)},getCurrentFormData:function(){return null},preventSubmitByEnterOnTouchDevices:function(e){Modernizr.touch&&e.$el.find("input,select").keypress(function(e){13==e.keyCode&&e.preventDefault()})},prepareDataForTransferModes:function(e){return e?_.compact(_.map(e.modes||e,function(e){if(_.isObject(e)&&null!=e)return{val:e.name,label:e.label.replace(" do "," <br/>do "),help:e.doneTime,priceStr:e.priceStr,tooltip:e.tooltip,usePoints:e.usePoints,commissionsAndFees:"OWN"==e.commissionsAndFees?I18n.t("transfer.domestic.deliveryTime.commissionsAndFeesOwn"):null!=e.commissionsAndFees?I18n.t("transfer.domestic.deliveryTime.commissionsAndFeesSha"):null}})):null},getDomesticCurrency:function(){var e={1140:"PLN",1142:"PLN",6210:"CZK",8360:"EUR"};return e[Ebre.Entity.Current]},handleAdditionalOptionsIfEmpty:function(){function e(){var e=!0;return t.$el.find(".row-additionalOptions .fields .bbf-object > div > div > .fields-row").each(function(){if(!$(this).hasClass("hide")||"none"!=$(this).css("display"))return e=!1,!1}),e}var t=this,a=this.$el.find(".row-additionalOptions");a.css({display:e()?"none":"block"})}});return c}),define("transfer/js/models/bank_info",["../app"],function(e){function t(t){e.trigger("error",t)}var a=Backbone.Model.extend({sync:function(e,a,r){"read"===e&&nmbServices.getBankBic({id:this.id,success:r.success,error:t||r.error,fail:r.fail})},formOptions:function(){return[{type:"country",val:this.get("country")},{type:"displayName",val:this.get("displayName")},{type:"branch",val:this.get("branch")}]}});return a}),define("transfer/js/models/country",["../app"],function(e){var t=Backbone.Model.extend({toJSON:function(){return{label:this.get("name"),val:this.id}}});return t}),define("transfer/js/collections/countries",["../app","../models/country"],function(e,t){function a(t){e.trigger("error",t)}var r=Backbone.Collection.extend({model:t,sync:function(e,t,r){"read"===e&&nmbServices.getCountries({success:r.success,error:a||r.error})}});return r}),define("transfer/js/models/bank",["../app"],function(e){var t=Backbone.Model.extend({toJSON:function(){return{label:this.get("name"),val:this.id}}});return t}),define("transfer/js/collections/banks",["../app","../models/bank"],function(e,t){function a(t){e.trigger("error",t)}var r=Backbone.Collection.extend({model:t,sync:function(e,t,r){"read"===e&&nmbServices.getBanks({id:r.id,success:r.success,error:a||r.error})}});return r}),define("transfer/js/models/branch",["../app"],function(e){var t=Backbone.Model.extend({toJSON:function(){return{label:this.get("name"),val:this.id}}});return t}),define("transfer/js/collections/branches",["../app","../models/branch"],function(e,t){function a(t){e.trigger("error",t)}var r=Backbone.Collection.extend({model:t,sync:function(e,t,r){"read"===e&&nmbServices.getBranches({id:r.id,success:r.success,error:a||r.error})}});return r}),define("transfer/js/models/nmb-transfer-abroad-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.getAvailableAbroadTransferTypes(a)}});return e}),define("transfer/js/views/forms/schemes/abroad-schema",[],function(){function e(e){return{addToBasket:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},isDefined:{type:"Hidden"},ibanCountryCode:{type:"Hidden"},transferTypeUpdate:{type:"Hidden"},receiverAccountAlreadyChecked:{type:"Hidden"},lastCheckedValues:{type:"Hidden"},bic:{type:"MultipleFields",template:"fieldAlone",subSchema:{bicSwiftInput:{title:I18n.t("transfer.abroad.label.bicSwiftInput"),template:"bicSwiftInput",editorClass:"short",type:e.isTransferDefined||e.isFromBasket?"SimpleTextValue":"Text",editorAttrs:e.isFromBasket?{id:"bic-input",maxlength:15,readonly:"readonly"}:{id:"bic-input",maxlength:15},_params:{tooltip:I18n.t("transfer.abroad.tooltips.bic")}},bicUnknown:{title:I18n.t("transfer.abroad.label.bicUnknown"),type:e.isTransferDefined||e.isFromBasket?"Hidden":"Checkbox",template:"bicUnknown"},bankDetails:{title:I18n.t("transfer.abroad.label.bankDetails"),type:"MultipleFields",template:"bicList",fieldClass:"bic-list-wrapper",subSchema:{country:{type:"SimpleTextValue",help:I18n.t("transfer.abroad.label.country")},displayName:{type:"SimpleTextValue",help:I18n.t("transfer.abroad.label.displayName")},branch:{type:"SimpleTextValue",help:I18n.t("transfer.abroad.label.branch")}}},bicWizard:{title:I18n.t("transfer.abroad.label.bicWizard"),type:"MultipleFields",template:"bicWizard",subSchema:{bicCountry:{type:"MultipleFields",template:"fieldsPanel",subSchema:{country:{title:I18n.t("transfer.abroad.label.country"),type:"Select",template:"labelBeforeInput",editorClass:"chzn-select select-medium",editorAttrs:{id:"form-select-bic-country","data-placeholder":I18n.t("transfer.abroad.placeholder.country"),"data-max_results":10},options:[{label:"",val:""}]}}},bicBank:{type:"MultipleFields",template:"fieldsPanel",subSchema:{name:{title:I18n.t("transfer.abroad.label.bicBank"),type:"Select",template:"labelBeforeInput",editorClass:"chzn-select select-medium",editorAttrs:{id:"form-select-bic-bank","data-placeholder":I18n.t("transfer.abroad.placeholder.bicBank"),"data-max_results":10,"data-always_visible_item":"NONSWIFT"},options:[{label:"",val:""}]}}},bicBranch:{type:"MultipleFields",template:"fieldsPanel",subSchema:{name:{title:I18n.t("transfer.abroad.label.bicBranch"),type:"Select",template:"labelBeforeInput",editorClass:"chzn-select select-medium",editorAttrs:{id:"form-select-bic-branch","data-placeholder":I18n.t("transfer.abroad.placeholder.bicBranch"),"data-max_results":10},options:[{label:"",val:""}]},input:{title:I18n.t("transfer.abroad.label.bicBranchInput"),type:"TextArea",template:"labelBeforeInput",fieldClass:"extralong hide",editorClass:"single-row expanding",editorAttrs:{id:"form-select-bic-branch-input",maxlength:137}}}}}}}},fromAccount:{title:I18n.t("transfer.abroad.fromAccount"),type:"Select",editorClass:"beautify-select  select-long",options:e.fromAccountOptions,editorAttrs:e.isFromBasket?{disabled:"disabled"}:{}},sender:{title:I18n.t("transfer.abroad.label.sender"),type:"Select",editorClass:"beautify-select select-medium",editorAttrs:{id:"form-select-sender"},options:[]},toAccount:{title:I18n.t("transfer.abroad.toAccount"),type:e.isTransferDefined||e.isFromBasket?"SimpleTextValue":"Text",editorClass:"extralong",editorAttrs:e.isFromBasket?{readonly:"readonly"}:{maxlength:38}},address:{title:I18n.t("transfer.abroad.address"),type:"MultipleFields",fieldClass:"row-wrapper two-lines",subSchema:{street:{template:"fieldsRowWithoutHeader",title:I18n.t("transfer.abroad.placeholder.street"),editorClass:"long optional",editorAttrs:{placeholder:I18n.t("transfer.abroad.placeholder.street"),maxlength:35}},city:{template:"fieldsRowWithoutHeader",title:I18n.t("transfer.abroad.placeholder.city"),editorClass:"long optional",editorAttrs:{placeholder:I18n.t("transfer.abroad.placeholder.city"),maxlength:35}}}},amount:{title:I18n.t("transfer.abroad.label.amount"),editorLabelFor:"amount-value",type:"MultipleFields",subSchema:{value:{template:"fieldAloneNoLabel",editorClass:"extrashort",editorAttrs:{id:"amount-value"}},currency:e.availableCurrency.length>1?{title:"Waluta",type:"Select",template:"amountCurrency",editorClass:"after-input beautify-select select-short",editorLabelFor:"form-select-currency-amount",editorAttrs:e.isFromBasket?{id:"form-select-currency-amount",disabled:"disabled"}:{id:"form-select-currency-amount"},options:e.availableCurrency}:{type:"SimpleTextValue",template:"amountCurrency",editorClass:"after-input currency"}}},title:{title:I18n.t("transfer.abroad.title"),type:"TextArea",editorClass:"extralong single-row expanding",editorAttrs:{maxlength:140}},date:{type:"SimpleDate",template:"noHeader",editorClass:"static-date"},transferType:{title:I18n.t("transfer.abroad.label.transferType"),type:"DeliveryTimeRadio",template:"DeliveryTimeRow",fieldClass:"row-delivery-time",options:[],_params:{tooltip:I18n.t("transfer.domestic.tooltips.deliveryTime"),rowSubDesc1:I18n.t("transfer.domestic.deliveryTime.rowSubDesc1"),rowSubDesc2:I18n.t("transfer.domestic.deliveryTime.rowSubDesc2")}},additionalOptions:{title:I18n.t("transfer.abroad.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.abroad.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources hide"},sendConfirmation:{title:I18n.t("transfer.abroad.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox"},sendConfirmationOptions:{type:"MultipleFields",template:"fieldsRowWithoutHeader",editorClass:"radio-buttons-wrapper",fieldClass:"send-confirmation-options hide",subSchema:{emailsList:{type:"MultipleFields",template:"fieldAlone",editorClass:"radio-section",subSchema:{radio:{type:"CustomRadio",name:"send-confirmation",template:"fieldAlone",fieldClass:"radio-wrapper",title:"Chc otrzyma potwierdzenie poczt elektroniczn"},list:{type:"List",template:"fieldAlone",listTemplate:"sendTransferConfirmationOptionsRadio",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"inputs-column",editorClass:"short",itemsLimit:2,editorAttrs:{maxlength:40,"aria-label":"E-mail"}}}},traditionalMail:{title:I18n.t("transfer.abroad.label.traditionalMail"),type:"CustomRadio",name:"send-confirmation",template:"customRadioWithLabel"}}},addReceiver:{type:e.isTransferDefined?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",subSchema:{addToAddressBook:{title:I18n.t("transfer.abroad.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"}}},changeAccountFee:{type:"MultipleFields",template:"fieldsRowWithoutHeader",fieldClass:"row-change-account-fee",subSchema:{checkbox:{title:I18n.t("transfer.abroad.label.changeAccountFee"),type:"Checkbox",template:"additionalOptionsCheckboxNested"},select:{type:"Select",template:"fieldAlone",fieldClass:"change-account-fee fields-row flclr hide",editorClass:"beautify-select",options:e.fromAccountOptions}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.abroad.button.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:e.canAddToBasket?"AnchorButton":"Hidden",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.abroad.button.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["templateId","recipientName","isDefined","ibanCountryCode","transferTypeUpdate","receiverAccountAlreadyChecked","bic"],["fromAccount","sender","toAccount","address","amount","title","date","transferType","additionalOptions","submitButtons","lastCheckedValues","addToBasket"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/views/forms/abroad",["./_generic","../../models/bank_info","../../collections/countries","../../collections/banks","../../collections/branches","../../models/transfer-wizard","../../models/nmb-transfer-abroad-check-service","./schemes/abroad-schema",nmbPaths.global.js+"validator","../../logic/livesearch-common"],function(e,t,a,r,n,i,o,s,l,d){var c={bicBlackList:{},transferTypeChange:{}};l.validators.validBic=_.wrap(function(e){var e=$.trim(e).toUpperCase();if(c.bicBlackList[e]){var t="EogBIC"===c.bicBlackList[e].code?c.bicBlackList[e].message:I18n.t("errors.bic");return{error:!0,message:t}}return this.setValue(e),{}},function(e){var t=_.toArray(arguments),a=$.Deferred();return a.resolve(e.apply(this,t.slice(1,t.length))),a.promise()});var u={formatAccount:function(e){if(!e||e.length<4)return e;var t=e.replace(/\s/g,""),a=t.match(/(\w{1,4})/g);if(a){var r=[];return _.each(a,function(e){r.length?r.push(e):r.push(e.substr(0,2)+" "+e.substr(2,2))}),r.join(" ")}return e}},m=e.extend({events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddress","focus textarea.single-row.expanding":"elasticTextAreas"})},validator:l,getFormSchema:function(){var e=this.model;return s.getSchema({isTransferDefined:e.get("isDefined"),fromAccountOptions:this.getFormAccount(e.get("availableFromAccounts")),availableCurrency:e.get("availableCurrency"),canAddToBasket:e.get("canAddToBasket"),isFromBasket:e.get("isFromBasket")})},getRules:function(){function e(){function e(e){return{name:"maxLength",params:[e]}}var a=t.form,r=a.getValue(),n={};if(r.additionalOptions.sendConfirmation&&r.additionalOptions.sendConfirmationOptions.emailsList.radio&&(n["additionalOptions:sendConfirmationOptions:emailsList:list:{d}"]=["required","email","trim",e(40)]),n.title=["required","trim","filterInternationalChars",e(140)],n["amount:value"]=["required","amountAddZero","amountFilter",e(35),"trim",{name:"amount",params:[a.getValue().amount.currency,!0,!0]}],n.transferType=["required",{name:"remote",params:[function(e){var t=new $.Deferred;return"undefined"==typeof e||""==e?(Ebre.Common.createInfoMessage("",I18n.t("errors.abroadTransferUnavaliable")),t.resolve({error:!0,message:" "})):t.resolve({})}]}],"NONSWIFT"===r.bic.bicWizard.bicBank.name&&(n["bic:bicWizard:bicBranch:input"]=["filterInternationalChars",e(137),"trim","required"]),a.fields.bic.getValue().bicUnknown&&(n["bic:bicWizard:bicCountry:country"]=["required"],n["bic:bicWizard:bicBank:name"]=["required"],"NONSWIFT"!=r.bic.bicWizard.bicBank.name&&(n["bic:bicWizard:bicBranch:name"]=["required"])),n["address:street"]=["required","trim","filterInternationalChars",e(35)],n["address:city"]=["required","trim","filterInternationalChars",e(35)],Ebre.Entity.isCZSK()&&t.form.$(".row-pep").is(":visible")&&(n["pep:purposes"]=["required"],n["pep:incsour"]=["required"],n.title=["required","trim",Ebre.Entity.isCZ()===!0?"certis":"sips","filterInternationalChars",{name:"maxLength",params:[105]}]),!r.isDefined){n.toAccount=["required"];var i=t.$el.find(".row-toAccount .input-decorations.left.text").text(),o=r.ibanCountryCode||(""!==i?i:""),s=null;if(r.bic.bankDetails.country){var l=c.countriesCollecion.find(function(e){return e.attributes.name==r.bic.bankDetails.country});l&&(s=l.attributes.isEOG)}var d=o&&!s;n.toAccount.push({name:"accountNRBabroad",params:[o,s,d]}),r.bic.bicUnknown&&"NONSWIFT"!==!r.bic.bicWizard.bicBank.name||(n["bic:bicSwiftInput"]=["required","bic","validBic","elixir"])}return n}var t=this;return e},getDefaults:function(){var e=this.model.toJSON();return e.date=e.dateNow,e},initialize:function(){var t=this;t.updateAddressVisibility.cache=null,e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","abroad");var a=Backbone.Model.extend({schema:t.getFormSchema(),defaults:t.getDefaults(),rules:t.getRules()}),r=new a,n=new Backbone.Form({model:r,fieldsets:s.fieldsets});this.form=n,n.render(),t.preventSubmitByEnterOnTouchDevices(n),t.setupFormBindings(),this.model.get("isInvalid")&&Ebre.Common.createErrorMessage({message:this.model.get("errorMessage")})},setupFormBindings:function(){var e=this,t=e.form;this.bindValidators(),e.bindToBICUnknownToggle(),e.bindToBICChange(),this.loadCountries(),e.bindAddtionalOptionsEvents(),e.bindToTransferTypeChange(),Ebre.Entity.isCZSK()||this.bindTo(this.form,"fromAccount:change",this.setDefaultCurrency,this),this.bindToWithValidityCheck(this.form,"fromAccount:change toAccount:blur amount:blur amount:currency:change",this.checkTransferData,this,["amount:value","toAccount"]),this.bindTo(this.form,"fromAccount:change",this.checkSender),this.bindTo(this.form,"fromAccount:change",function(){t.getField("additionalOptions.changeAccountFee.checkbox").getValue()||t.getField("additionalOptions.changeAccountFee.select").setValue(t.getField("fromAccount").getValue())})},bindValidators:function(){var e=this,t=this.form;e.bindOnBlurValidation(["bic:bicSwiftInput","toAccount","title","amount:value","address:street","address:city","bic:bicWizard:bicBranch:input","additionalOptions:sendConfirmationOptions:emailsList:list:item"]),this.bindTo(t,"address:street:blur",function(e,t){l.validateField(e,"address:city",e.getField("address.city"))}),this.bindTo(t,"address:city:blur",function(e,t){l.validateField(e,"address:street",e.getField("address.street"))})},bindToBICUnknownToggle:function(){this.bindTo(this.form,"bic:bicUnknown:change",function(e,t,a){e.$(".row-bicSwiftInput").removeClass("validation error");var r=e.fields.bic.getValue().bicUnknown,n=this,i=e.$(".bic-unknown-wrapper"),o=e.$(".bic-input-wrapper input"),s=e.$(".bic-list-wrapper"),l=e.$(".bic-wizard-wrapper"),d=e.$(".bic-wizard-wrapper .remove-bic-wizard-icon"),c=function(){l.fadeOut(),o.attr("disabled",!1).trigger("focus"),o.parent().off("click"),i.find("input:first").prop("checked",!1),i.fadeIn(),$(".row-bicCountry").removeClass("complete"),$(".row-bicBank").removeClass("complete"),$(".row-bicBranch").removeClass("complete"),$(".row-bicCountry").removeClass("validation error"),$(".row-bicBank").removeClass("validation error"),$(".row-bicBranch").removeClass("validation error");var t=e.getField("bic.bicWizard.bicCountry.country");t.setValue(""),t.$("select").trigger("liszt:updated"),e.trigger("bic:bicWizard:bicCountry:country:change",e,e.getField("bic")),$("#form-select-bic-branch-input").val(""),$("#form-select-bic-branch-input").parent().hide(),$("#form-select-bic-branch").parent().show(),o.val("")};r||a?(n.form.bicWizardInitialized||(n.form.bicWizardInitialized=!0,n.initializeBicWizard()),l.fadeIn({complete:function(){e.getField("bic.bicWizard.bicCountry.country").$el.find("a").focus()}}),i.fadeOut(),s.fadeOut("fast"),o.attr("disabled",!0)):c(),d.off(".closeWizzard").on("click.closeWizzard",function(e){e.preventDefault(),c()})})},bindToBICChange:function(){this.bindTo(this.form,"bic:bicSwiftInput:blur",function(e,a,r,n,i){var o=this;if(o.checkTransferData(e,null,null),e.fields.receiverAccountAlreadyChecked.getValue()||e.getField("bic").getField("bicUnknown").getValue()){if(e.model.attributes.bic.bicUnknown){var e=this.form;e.trigger("bic:bicUnknown:change",e,e.getField("bic"),e.getField("bic.bicUnknown")),e.fields.bic.editor.value.bicWizard.bicBranch.input&&($("#form-select-bic-branch-input").val(e.fields.bic.editor.value.bicWizard.bicBranch.input),e.trigger("bic:bicWizard:bicBranch:input:focus bic:bicWizard:bicBranch:input:blur",e,e.getField("bic"),e.getField("bic.bicWizard"),e.getField("bic.bicWizard.bicBranch"),e.getField("bic.bicWizard.bicBranch.input")));
}}else{e.fields.bic.editor.form.fields.bicSwiftInput.setValue($.trim(a.getValue().bicSwiftInput));var s=e.fields.bic.editor.form.fields,d=s.bankDetails.editor.form.fields.country,u=s.bankDetails.editor.form.fields.displayName,m=s.bankDetails.editor.form.fields.branch,p=this.model.toJSON(),f=a.getValue();if(f.bicSwiftInput.length>11&&s.bicSwiftInput.setValue(f.bicSwiftInput.substr(0,11)),8===f.bicSwiftInput.length||11===f.bicSwiftInput.length)if(s.bicSwiftInput.setValue(f.bicSwiftInput.toUpperCase()),p.isDefined)s.bankDetails.$el.show();else{var h=a.getValue().bicSwiftInput.toUpperCase();if(c.bicBlackList[h]){s.bankDetails.$el.fadeOut();var b=e.fields.toAccount.$("input");b.closest("div").removeClass("input-decorated left"),b.prevAll(".input-decorations").remove()}else{11!==h.length||"BREXPLPW"!==h.substring(0,8)||Ebre.Entity.isCZSK()?11===h.length&&"XXX"==h.substring(8,11)&&(s.bicSwiftInput.setValue(h.substring(0,8)),s.bicSwiftInput.$el.removeClass("error success").addClass("validation info").find(".validation-text").text(I18n.t("transfer.forms.validation.bicXXX"))):(s.bicSwiftInput.setValue("BREXPLPW"),s.bicSwiftInput.$el.removeClass("error success").addClass("validation info").find(".validation-text").text(I18n.t("transfer.forms.validation.bicBRE")));var v=new t({id:h});v.fetch({loaderParent:o.getLoaderParamSelector(),success:function(t){n&&"undefined"!=typeof p.bic&&"undefined"!=typeof p.bic.bankDetails?(d.setValue(p.bic.bankDetails.country),u.setValue(p.bic.bankDetails.displayName),m.setValue(p.bic.bankDetails.branch)):_.each(v.formOptions(),function(e){"country"===e.type?d.setValue(e.val):"displayName"===e.type?u.setValue(e.val):"branch"===e.type&&m.setValue(e.val)});var a=e.$(".bic-wizard-wrapper").css("display");t.attributes.country&&t.attributes.displayName&&t.attributes.branch&&("none"==a||""==a)?(t.attributes.country===d.getValue()&&d.$(".simple-value").text(t.attributes.country),t.attributes.displayName===u.getValue()&&u.$(".simple-value").text(t.attributes.displayName),t.attributes.branch===m.getValue()&&m.$(".simple-value").text(t.attributes.branch),s.bankDetails.$el.fadeIn()):s.bankDetails.$el.hide(),o.model.set("isEOG",t.get("isEOG"));var r=e.fields.toAccount.$("input");if(t.get("isEOG")&&t.get("ibanCountryCode")&&""!==t.get("ibanCountryCode")){r.parent(".wrapper").length?r.parent().addClass("input-decorated left"):r.wrap('<div class="wrapper input-decorated left"></div>'),r.prevAll(".input-decorations").remove().end().before('<span class="input-decorations left text">'+t.get("ibanCountryCode")+"</span>");var i=e.fields.toAccount.editor.getValue();"SimpleTextValue"!=e.fields.toAccount.editor.schema.type&&(i&&i.substr(0,2)==t.get("ibanCountryCode")&&e.fields.toAccount.editor.setValue(i.substr(2,i.length).replace(/^\s+/,"")),o.form.fields.toAccount.getValue()&&l.validateField(o.form,"toAccount",o.form.fields.toAccount))}else r.closest("div").removeClass("input-decorated left").find(".input-decorations").remove(),o.form.fields.toAccount.getValue()&&l.validateField(o.form,"toAccount",o.form.fields.toAccount);e.fields.ibanCountryCode.setValue(t.get("ibanCountryCode"))},fail:function(t){c.bicBlackList[h]=t,$("#bic-input").trigger("blur"),s.bankDetails.$el.fadeOut();var a=e.fields.toAccount.$("input");a.closest("div").removeClass("input-decorated left"),a.prevAll(".input-decorations").remove()}})}}else{s.bankDetails.$el.fadeOut();var b=e.fields.toAccount.$("input");b.closest("div").removeClass("input-decorated left"),b.prevAll(".input-decorations").remove()}}}),this.bindTo(this.form,"bic:bicSwiftInput:change",function(e,t,a){a.setValue($.trim(a.getValue().replace(" ","")));var r=a.getValue();if(!c.bicBlackList[r]){var n=a.getValue().replace(/\s/g,"");if(n.length>11)return void a.setValue(n.substring(0,11));if(8===n.length||11===n.length){var i=a.form.fields.bicSwiftInput;11!==n.length||"BREXPLPW"!==n.substring(0,8).toUpperCase()||Ebre.Entity.isCZSK()?11===n.length&&"XXX"===n.substring(8,11).toUpperCase()&&(a.setValue(n.substring(0,8)),i.$el.removeClass("error success").addClass("validation info").find(".validation-text").text(I18n.t("transfer.forms.validation.bicXXX"))):(a.setValue("BREXPLPW"),i.$el.removeClass("error success").addClass("validation info").find(".validation-text").text(I18n.t("transfer.forms.validation.bicBRE")))}}})},loadCountries:function(){var e=this,t=new a,r=$.Deferred();return c.countriesCollecion?r.resolve(c.countriesCollecion):t.fetch({loaderParent:e.getLoaderParamSelector(),success:function(e){c.countriesCollecion=e,r.resolve(c.countriesCollecion)}}),r.promise()},initializeBicWizard:function(){function e(){var e=s,t=e.form;e.loadCountries().done(function(e){o=e;var a=s.form.getField("bic.bicWizard.bicCountry.country");a.editor.setOptions(e.toJSON()),a.$("select").trigger("liszt:updated"),t.trigger("bic:bicWizard:bicCountry:country:change",t,t.getField("bic"))})}function t(){var e=s.form.model.defaults,t="";e.bic&&(t=e.bic.bicWizard.bicBank.name,e.bic.bicWizard.bicBank.name=""),s.bindTo(s.form,"bic:bicWizard:bicCountry:country:change",function(e,a){var n=a.getValue().bicWizard.bicCountry.country,i=o.find(function(e){return e.id===n}),d=!!i&&i.get("isEOG");"sepa"==e.fields.transferType.getValue();s.model.set("isEOG",d);var c=e.fields.toAccount.$("input");$(".row-bicBank").removeClass("validation error"),$(".row-bicBranch").removeClass("validation error"),s.updateAddressVisibility(),d&&i&&i.get("id")&&""!==i.get("id")?(c.parent(".wrapper").length?c.parent().addClass("input-decorated left"):c.wrap('<div class="wrapper input-decorated left"></div>'),c.prevAll(".input-decorations").remove().end().before('<span class="input-decorations left text">'+i.get("id")+"</span>"),e.fields.ibanCountryCode.setValue(i.get("id"))):c.closest("div").removeClass("input-decorated left").find(".input-decorations").remove();var u=new r;if(a.getValue().bicWizard.bicCountry.country)u.fetch({loaderParent:s.getLoaderParamSelector(),id:a.getValue().bicWizard.bicCountry.country,success:function(){var a=s.form.getField("bic.bicWizard.bicBank.name");a.editor.setOptions(u.toJSON()),a.setValue(t||""),a.$("select").trigger("liszt:updated"),$(".row-bicCountry").addClass("complete"),t="",e.trigger("bic:bicWizard:bicBank:name:change",e,e.getField("bic"),e.getField("bic.bicWizard"),e.getField("bic.bicWizard.bicBank"),e.getField("bic.bicWizard.bicBank.name"))}});else{u.unshift({id:0,name:""});var m=s.form.getField("bic.bicWizard.bicBank.name");m.setValue(0),m.value="",m.editor.setOptions(u.toJSON()),m.$("select").trigger("liszt:updated"),e.trigger("bic:bicWizard:bicBank:name:change",e,e.getField("bic"),e.getField("bic.bicWizard"),e.getField("bic.bicWizard.bicBank"),e.getField("bic.bicWizard.bicBank.name"))}i&&(e.getField("bic.bankDetails.country").setValue(i.get("name")),$.trim(e.getField("toAccount").getValue())&&l.validateField(e,"toAccount",e.getField("toAccount"))),s.form.fields.bic.editor.form.fields.bicWizard.editor.form.fields.bicBranch.editor.form.fields.name.editor.setOptions({id:0,name:""}),setTimeout(function(){$("#form-select-bic-branch").trigger("liszt:updated")},1),$(".row-bicBank").removeClass("complete"),$(".row-bicBranch").removeClass("complete"),$("#form-select-bic-branch-input").val(""),$("#form-select-bic-branch-input").parent().hide(),$("#form-select-bic-branch").parent().show()})}function a(){var e=s.form.model.defaults,t="";e.bic&&(t=e.bic.bicWizard.bicBranch.name,e.bic.bicWizard.bicBranch.name=""),s.bindTo(s.form,"bic:bicWizard:bicBank:name:change",function(e,a,r,i,o){var s=this,l=e.getField("bic.bicWizard.bicBranch.name"),d=o.getValue();if("NONSWIFT"==d)e.$(".bic-input-wrapper input").val(""),$("#form-select-bic-branch").parent().hide(),$("#form-select-bic-branch-input").parent().show(),e.fields.additionalOptions.editor.form.fields.addReceiver.$el.hide(),e.getField("bic").getField("bicUnknown").setValue(!0),e.getField("additionalOptions.addReceiver.addToAddressBook").setValue(!1),s.updateAddressVisibility({forceVisibility:!0}),s.checkTransferData(e);else{$(".row-bicBranch").removeClass("validation error"),$("#form-select-bic-branch-input").parent().hide(),e.fields.additionalOptions.editor.form.fields.addReceiver.$el.show();var c=new n;d?c.fetch({loaderParent:s.getLoaderParamSelector(),id:d,success:function(){l.editor.setOptions(c.toJSON()),l.setValue(t||""),l.$("select").trigger("liszt:updated"),$("#form-select-bic-branch").parent().show(),$(".row-bicBranch").removeClass("complete"),e.getField("bic.bicWizard.bicBranch.name").getValue()&&e.trigger("bic:bicWizard:bicBranch:name:change",e),t=""}}):(c.unshift({id:0,name:""}),l.setValue(0),l.value="",l.editor.setOptions(c.toJSON()),l.$("select").trigger("liszt:updated"),e.trigger("bic:bicWizard:bicBranch:name:change",e)),s.updateAddressVisibility()}e.getField("bic.bicWizard.bicBank.name").getValue()?(e.$(".row-bicBank").removeClass("validation error"),e.$(".row-bicBank").addClass("complete")):e.$(".row-bicBank").removeClass("complete")})}function i(){s.form.getField("bic.bicWizard.bicBranch.name").getValue();s.bindTo(s.form,"bic:bicWizard:bicBranch:name:change",function(e){var t=this,a=e.getField("bic.bicSwiftInput"),r=e.getField("bic.bicWizard.bicBranch.name");a.setValue(r.getValue()),11!=a.getValue().length||"BREXPLPW"!=a.getValue().substring(0,8)||Ebre.Entity.isCZSK()?11==a.getValue().length&&"XXX"==a.getValue().substring(8,11)&&a.setValue(a.getValue().substring(0,8)):a.setValue("BREXPLPW"),t.checkTransferData(e),e.getField("bic.bicWizard.bicBranch.name").getValue()?(e.$(".row-bicBranch").removeClass("validation error"),e.$(".row-bicBranch").addClass("complete"),e.$(".bic-unknown-wrapper").find("input:first").prop("checked",!1)):e.$(".row-bicBranch").removeClass("complete")}),s.bindTo(s.form,"bic:bicWizard:bicBranch:input:focus bic:bicWizard:bicBranch:input:blur",function(e,t){var a=e.getField("bic.bicWizard.bicBank.name"),r=a.getValue()||a.value,n=e.getField("bic.bicWizard.bicBranch.input");"NONSWIFT"===r&&(n.getValue()?n.$el.closest(".row").addClass("complete"):n.$el.closest(".row").removeClass("complete"))})}var o,s=this;t(),a(),i(),e()},bindAddtionalOptionsEvents:function(){this.form;this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e,t){var a=this.form.fields.additionalOptions,r=this;a.getValue().addReceiver.addToAddressBook?(a.$(".add-to-trusted-list").fadeIn(),r.model.set("canAddToBasketDT",!1),r.toggleAddToBasket(e)):"undefined"!=typeof a.getValue().addReceiver.addToAddressBook&&(a.$(".add-to-trusted-list").fadeOut(function(){$(this).find("span.checkbox-wrapper").removeClass("checked")}),r.model.set("canAddToBasketDT",!0),r.toggleAddToBasket(e))}),this.bindTo(this.form,"additionalOptions:changeAccountFee:checkbox:change",function(e){var t=e.fields.additionalOptions;t.getValue().changeAccountFee.checkbox?(t.$("select").resetSS(),t.$(".change-account-fee").fadeIn()):t.$(".change-account-fee").fadeOut()}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:emailsList:list:focus",function(){this.form.fields.additionalOptions.$('[name="emailsList"]').find('input[type="radio"]').prop("checked",!0),this.form.fields.additionalOptions.$('input[type="radio"]').change()}),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;a.getValue()?r.$el.slideDown():r.$el.slideUp()}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:change",function(e){this.hideListRemoveButton(e.fields.additionalOptions.editor.form.fields.sendConfirmationOptions.editor.items)})},bindToTransferTypeChange:function(){this.bindTo(this.form,"transferType:change",function(e,t){this.model.set("transferType",t.getValue());var a=this;a.model.get("isEOG");a.updateAddressVisibility({forceVisibility:"NONSWIFT"==a.form.getValue().bic.bicWizard.bicBank.name}),e.$(".row-change-account-fee").toggle(!0);var r=e.fields.additionalOptions.editor.form.fields.blockResources;"BREXPLPW"===e.getValue().bic.bicSwiftInput?(r.editor.setValue(!1),r.$("span").removeClass("checked"),r.$el.hide()):r.$el.show(),d.validateLiveSearch(t.getValue())})},checkTransferData:function(e,t,a,r){var n=this,s=n.form.getValue(),l=new o,d=new $.Deferred;n.checkServicePromise=d.promise();var c=n.model.get("lastCheckedValues"),u=this.model.get("useCache"),m={fromAccount:s.fromAccount.replace(/\s/g,""),fromAccountCurrency:_.find(this.model.get("availableFromAccounts"),function(e){return e.number===s.fromAccount}).currency,toAccount:s.toAccount.replace(/\s/g,""),BIC:s.bic.bicSwiftInput.toUpperCase(),currency:s.amount.currency,countryCode:s.ibanCountryCode,amount:s.amount.value,isDefined:n.model.get("isDefined"),noSWIFT:"NONSWIFT"===s.bic.bicWizard.bicBank.name,isTrusted:n.model.get("isTrusted")},p=0,f={},h=_.keys(m);return _.each(h,function(e){m[e]===c[e]&&u||(f[e]=m[e],c[e]=m[e],p++)}),!Ebre.Entity.isPL()&&!Ebre.Entity.isOF()&&p>0&&(f.pepListsLoaded="undefined"!=typeof r&&r),p>0?l.fetch({loaderParent:null,data:{input:f},success:function(){var t=l.toJSON();n.model.set("canAddToBasket",t.available.showAddToBasket),n.toggleAddToBasket(e);var a=l.toJSON().transferTypeUpdate,r=a.modes;n.model.set("isEOG",t.available.accountVerifyInfo.isEOG),i.updatePopulatedModel("isEOG",t.available.accountVerifyInfo.isEOG),i.updatePopulatedModel("availableTypes",r),0==r.length?(n.$el.find(".row-transferType").slideUp(),n.model.set("transferType",null)):(n.model.set("transferType",r[0].name),n.$el.find(".row-transferType").slideDown(),n.updateTransferType(r)),e.fields.receiverAccountAlreadyChecked.getValue()&&!t.available.accountVerifyInfo.isGroup&&e.fields.receiverAccountAlreadyChecked.editor.setValue(!1),n.model.set("transferTypeUpdate",a),n.tooltip(),n.rememberFormTypeChangeSuggestion(t),d.resolve(t)},fail:function(e){d.reject();var t=$.parseJSON(e.responseText);"paym_SameAccount"==t.code&&(n.form.fields.toAccount.$el.addClass("validation error").removeClass("success"),n.form.fields.toAccount.$el.find(".validation-text").text(t.title))}}):d.resolve(),n.checkServicePromise},updateTransferType:function(e){var t=this.form,a=this.model.toJSON();if(a.transferTypeUpdate){var e=(t.fields.transferType.getValue(),this.getTransferModesAbroad(e));t.fields.transferType.editor.setOptions(e),t.fields.transferTypeUpdate.setValue(a.transferTypeUpdate);var r=t.$(".row-transfer-type");if(r.find(".radio-panel").css({opacity:.4}).find("input").prop("disabled",!0),e){var n=e[0],i=this.model.get("transferType"),o=_.filter(e,function(e){return e.val==i}),s=o.length?o[0]:n;t.fields.transferType.setValue(s.val)}this.styleRadioPanels()}},onRender:function(){function e(){r.$("#form-container").html(n.el)}function t(){r.styleCheckbox(),r.styleRadioPanels(),r.styleRadioButtons(),r.triggerDatepicker(),r.tooltip()}function a(){var e=r.model,t=r.form,a=t.model;if(r.updateTransferType(null),Ebre.Common.setBehaviourForAmountInput(t.$("input#amount-value"),11),r.styleSelects(),r.chosen(),i||o?(t.trigger("bic:bicSwiftInput:blur",t,t.getField("bic"),t.getField("bic").editor),r.updateTransferType(a.get("availableTypes"))):t.$(".row-transfer-type").toggle(!1).find(".radio-panel").hide(),t.trigger("additionalOptions:addReceiver:addToAddressBook:change",t),t.trigger("additionalOptions:sendConfirmation:change",t),t.trigger("additionalOptions:changeAccountFee:checkbox:change",t),e.get("senderAccChanged")&&r.displayValidationMessage(t.getField("fromAccount"),I18n.t("errors.fromAccNotAllowed")),r.setFocusOnInput("bicSwiftInput","value"),this.model.get("bic")&&this.model.get("bic").bicWizard&&this.model.get("bic").bicWizard.bicBank&&this.model.get("bic").bicWizard.bicBank.name&&t.trigger("bic:bicUnknown:change",t,t.getField("bic"),!0),r.$(".radio-area input").on("focus",function(){$(this).closest(".radio-panel").addClass("focused")}).on("blur",function(){$(this).closest(".radio-panel").removeClass("focused")}),t.trigger("toAccount:change",t),t.getField("isDefined").getValue()&&a.get("isEOG")){var n=t.getField("toAccount").editor.getValue();t.getField("toAccount").editor.setValue(u.formatAccount(n))}r.tooltip(),r.$el.find(".expand-bic").on("click",function(e){e.preventDefault();var a=$(this).parent().find("input[type=checkbox]");a.prop("checked",!a.prop("checked")),t.trigger("bic:bicUnknown:change",t,t.getField("bic"),t.getField("bic.bicUnknown"))})}var r=this,n=r.form,i=(r.model,this.model.get("isDefined")),o=this.model.get("amount").value;e(),t(),r.initializeSlidingAddress(),r.setDefaultCurrency(),r.bindTo(r,"effects:done",a,r)},onShow:function(){function e(){o.get("additionalOptions").changeAccountFee||(i.getField("additionalOptions.changeAccountFee.select").setValue(i.getField("fromAccount").getValue()),n.$(".row-change-account-fee").hide())}function t(){i.trigger("additionalOptions:sendConfirmationOptions:change",i)}function a(){n.$("input:not([autocomplete]):visible:first").trigger("focus")}function r(){t(),a()}var n=this,i=n.form,o=n.model;n.generateSenderSelect(),e(),n.bindTo(n,"fading:done",r),n.checkAmountAbroad()},setDefaultCurrency:function(){var e=this.form,t=e.getValue(),a=e.getField("amount").getField("currency"),r=_.find(this.model.get("availableFromAccounts"),function(e){return e.number===t.fromAccount}).currency;""!=r&&(a.setValue("PLN"!==r?r:"EUR"),this.$el.find("#form-select-currency-amount").trigger("liszt:updated"))},checkAmountAbroad:function(){var e=this.model.get("amount");e.value&&(e.value=this.verifyAmount(e.value),this.form.fields.amount.setValue(e))},updateAddressVisibility:function(e){function t(){var e,t,a=i.getField("transferType").getValue(),r=!1;return"undefined"!=typeof a&&(e="sepa"==a,t=o.get("isEOG"),r=!e&&!t),r}function a(e){function t(){var t=n.updateAddressVisibility,a="undefined"!=typeof t.cache?t.cache:null;return t.cache=e,a!==e}function a(){var t=$("#addressLabel"),a=$("#addressExpanderLabel"),r=e?"NoSwift":"";t.text(I18n.t("transfer.abroad.address"+r)),a.text(I18n.t("transfer.showAddress"+r))}function r(){n.slidingAddress(i.getField("address").$(".address-expander"),!1,i,o.toJSON(),e)}t()&&(a(),r())}var r,n=this,i=this.form,o=this.model;r=e&&e.forceVisibility||t(),a(r)},getTransferModesAbroad:function(e){var t=e||this.model.get("transferTypeUpdate").modes;return t=_.filter(t,function(e){return null!==e}),this.prepareDataForTransferModes(t)}});return m}),define("transfer/js/views/forms/schemes/abroad_czsk-schema",["./abroad-schema"],function(e){function t(t){var a=e.getSchema(t);return a.additionalOptions.subSchema.sendConfirmation={type:"Hidden"},a.title.editorAttrs.maxlength=105,schema=_.extend(a,{pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets,r=a[1].splice(a[1].indexOf("title")+1,0,"pep");return{fieldsets:[r],getSchema:t}}),define("transfer/js/views/forms/abroad_czsk",["./_generic","./abroad","./schemes/abroad_czsk-schema","../../models/transfer-wizard"],function(e,t,a,r){var n={incomeSourceDict:[],paymentPurposeDict:[],enablePEP:null,bicBlackList:[],transferTypeChange:{}},i=t.extend({initialize:function(){var e=this;t.prototype.initialize.apply(this,_.toArray(arguments)),n.paymentPurposeDict=this.model.get("paymentPurposeDict"),n.incomeSourceDict=this.model.get("incomeSourceDict"),n.enablePEP=this.model.get("enablePEP"),this.setIncomeSource(n.incomeSourceDict),this.setPaymentPurpose(n.paymentPurposeDict),this.checkToEnablePep(e.form)},checkSender:function(){thisView=this;var t=e.prototype.checkSender.apply(this);return checkSenderDeferrerCZSK=t.pipe(function(e){var t=new $.Deferred;return e?(thisView.model.set("enablePEP",e.enablePEP),r.get("formLoaded").get("formData").incomeSourceDict=thisView.model.get("incomeSourceDict"),r.get("formLoaded").get("formData").paymentPurposeDict=thisView.model.get("paymentPurposeDict"),thisView.checkToEnablePep(thisView.form)?(thisView.form.$(".row-pep").is(":visible")||(thisView.setIncomeSource(thisView.model.get("incomeSourceDict")),thisView.setPaymentPurpose(thisView.model.get("paymentPurposeDict"))),thisView.form.$(".row-pep").show(),n.enablePEP=!0,thisView.validator.validateForm(thisView.form),t.reject()):(thisView.form.$(".row-pep").hide(),thisView.form.fields.pep.getField("purposes").setValue(""),thisView.form.fields.pep.getField("incsour").setValue(""),n.enablePEP=!1,t.resolve())):t.resolve(),t.promise()}),checkSenderDeferrerCZSK},checkToEnablePep:function(e){var t=this,a=e.fields.amount.getValue().value.replace(/\s/g,""),r=e.fields.amount.getValue().currency.replace(/\s/g,""),n=this.model.get("thresholds");if(void 0!==n&&n.length)var i=_.find(n,function(e,t){return e.id==r}),o=i.name;var s=!!("undefined"!=typeof o&&parseFloat(a)>=parseFloat(o)&&!Ebre.Entity.isSK()||this.model.get("enablePEP"));return s?t.form.$(".row-pep").show():(t.form.$(".row-pep").hide(),e.getField("pep").getField("purposes").setValue(""),e.getField("pep").getField("incsour").setValue(""),$("#incsour,#purposes").trigger("liszt:updated")),s},getFormSchema:function(){return a.getSchema({isTransferDefined:this.model.get("isDefined"),fromAccountOptions:this.getFormAccount(this.model.get("availableFromAccounts")),availableCurrency:this.model.get("availableCurrency"),canAddToBasket:this.model.get("canAddToBasket"),isFromBasket:this.model.get("isFromBasket")})},onRender:function(){t.prototype.onRender.apply(this,_.rest(arguments)),this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(e,t){thisView.validator.validateField(this.form,"pep:incsour",e.getField("pep.incsour")),thisView.validator.validateField(this.form,"pep:purposes",e.getField("pep.purposes"))})},checkTransferData:function(e,a,r){thisView=this;var i=n.incomeSourceDict.length>0&&n.paymentPurposeDict.length>0,o=t.prototype.checkTransferData.apply(this,[e,a,r,i]);return checkTransferDataDeferrerCZSK=o.pipe(function(e){var t=new $.Deferred;return e?thisView.checkToEnablePep(thisView.form)?(thisView.setIncomeSource(e.incomeSourceDict||n.incomeSourceDict),thisView.setPaymentPurpose(e.paymentPurposeDict||n.paymentPurposeDict),thisView.form.$(".row-pep").show(),n.enablePEP=!0,t.reject()):(thisView.form.$(".row-pep").hide(),thisView.form.fields.pep.getField("purposes").setValue(""),thisView.form.fields.pep.getField("incsour").setValue(""),n.enablePEP=!1,t.resolve()):t.resolve(),t.promise()}),checkTransferDataDeferrerCZSK}});return i}),define("transfer/js/models/nmb-transfer-domestic-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.DomesticCheckService(a)}});return e}),define("transfer/js/models/nmb-refresh-accounts-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.RefreshAvailableFromAccounts(a)}});return e}),define("transfer/js/views/forms/schemes/domestic-schema",[],function(){function e(e){return{isFutureDate:{type:"Hidden"},addToBasket:{type:"Hidden"},lastCheckedValues:{type:"Hidden"},dtmsg:{type:"Hidden"},changedFromAcc:{type:"Hidden"},srcAccChangeToTemplate:{type:"Hidden"},deliveryTimeUpdate:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},isRepeatableTransfer:{type:"Hidden"},isDefined:{type:"Hidden"},formType:{type:"Hidden"},deactivateDateField:{type:"Hidden"},isTrusted:{type:"Hidden"},perfToken:{type:"Hidden"},BIC:{type:"Hidden"},priceStr:{type:"Hidden"},fromAccount:{title:I18n.t("transfer.domestic.fromAccount"),type:"Select",editorClass:"beautify-select select-long",options:e.availableFromAccounts,editorAttrs:e.isFromBasket?{disabled:"disabled"}:{placeholder:I18n.t("transfer.domestic.accountSourceNumber")}},sender:{title:I18n.t("transfer.domestic.sender"),type:"Select",editorClass:"beautify-select select-medium",editorAttrs:{id:"form-select-sender"},fieldClass:"hide",options:[]},senderName:{type:"Hidden"},toAccount:{type:e.isDefined||e.performed||e.isFromBasket?"SimpleTextValue":"Text",title:I18n.t("transfer.domestic.toAccount"),editorClass:"extralong",editorAttrs:{id:"toAccount",maxlength:38,placeholder:I18n.t("transfer.domestic.placeholders.toAccount")},_params:{tooltip:I18n.t("transfer.domestic.tooltips.toAccountTooltip")}},address:{title:I18n.t("transfer.domestic.address"),type:"MultipleFields",template:"address",fieldClass:"row-wrapper two-lines",subSchema:{street:{template:"fieldsRowWithoutHeader",title:I18n.t("transfer.domestic.placeholders.address"),fieldClass:"fields-row",editorClass:"long optional",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.address"),maxlength:35}},city:{editorClass:"long optional",fieldClass:"fields-row",title:I18n.t("transfer.domestic.placeholders.city"),template:"fieldsRowWithoutHeader",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.city"),maxlength:35}}}},amount:{title:I18n.t("transfer.domestic.amount"),template:"amount",editorAttrs:{id:"amount"}},currency:{type:"SimpleTextValue",template:"fieldAloneNoLabel",fieldClass:"row-currency"},currencies:{type:"Select",template:"fieldAlone",fieldClass:"row-available-currency",editorClass:"beautify-select select-short",editorLabelFor:"form-select-currency-amount",editorAttrs:{id:"form-select-currency-amount"},options:[]},title:{title:I18n.t("transfer.domestic.title"),type:"TextArea",editorClass:"extralong single-row expanding",editorAttrs:{maxlength:140,id:"title"}},date:{type:"uiDateInput",title:I18n.t("transfer.domestic.deliveryDate"),template:"deliveryTimeDate",editorAttrs:{id:"uiDateInput"},fieldClass:"row-additional-options",editorClass:"style-tab",minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},isSeriesOfTransfers:{type:"Hidden"},seriesOfTransfers:{type:"List",template:"fieldAlone",listTemplate:"seriesOfTransfers",itemType:"MultipleFields",listItemTemplate:"seriesOfTransfersItem",fieldClass:"series-container expand-group tab",itemsLimit:e.itemsLimit,subSchema:{amount:{title:"Kwota",editorClass:"input-amount",template:"seriesOfTransfersAmount",editorAttrs:{maxlength:13}},title:{title:"Tytu",type:"TextArea",template:"inputWithHiddenLabel",editorClass:"input-title extralong single-row expanding",editorAttrs:{maxlength:140}},date:{title:"Data",type:"uiDate",template:"onlyDateInput",fieldClass:"series",emptyDate:!0,minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min"),_params:{enabledInput:!0}}}},repeatableTransfer:{type:"MultipleFields",template:"repeatableTransfer",subSchema:{repeatRow:{type:"MultipleFields",template:"rowPeriod",fieldClass:"fields-row row-period",subSchema:{value:{title:I18n.t("transfer.standingOrder.repeatEach"),template:"labelBeforeInput",editorClass:"counter",editorAttrs:{maxlength:3}},period:{type:"Select",template:"fieldAlone",editorClass:"beautify-select",editorAttrs:{id:"form-select-period","data-default-text":I18n.t("transfer.standingOrder.select")},options:e.soPeriodTypes},untilFurtherNotice:{title:I18n.t("transfer.standingOrder.tillRevokation"),type:"Checkbox",template:"labelAfterCheckbox"}}},calendars:{type:"uiDateRepeatable",template:"calendars",minDate:e.calendar.minDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},calendarMessages:{type:"SimpleTextValue",template:"calendarMessages"}}},deliveryTime:{title:I18n.t("transfer.domestic.deliveryTime.title"),type:"DeliveryTimeSelect",template:"DeliveryTimeRow",fieldClass:"row-delivery-time",options:e.transferModes,_params:{tooltip:I18n.t("transfer.domestic.tooltips.deliveryTime"),rowSubDesc1:I18n.t("transfer.domestic.deliveryTime.rowSubDesc1"),rowSubDesc2:I18n.t("transfer.domestic.deliveryTime.rowSubDesc2")}},additionalOptions:{title:I18n.t("transfer.domestic.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.domestic.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources hide"},sendConfirmation:{title:I18n.t("transfer.domestic.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-send-confirmation"},sendConfirmationOptions:{type:"List",template:"additionalOptionsListWrapper",listTemplate:"sendTransferConfirmationOptions",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"send-confirmation-options hide",editorClass:"short",itemsLimit:2,editorAttrs:{maxlength:40,"aria-label":"E-mail"}},addReceiver:{type:e.isDefined?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",fieldClass:"row-add-receiver",subSchema:{addToAddressBook:{title:I18n.t("transfer.domestic.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"}}},changeAccountFee:{type:"MultipleFields",template:"fieldsRowWithoutHeader",fieldClass:"row-change-account-fee hide",subSchema:{checkbox:{title:I18n.t("transfer.abroad.label.changeAccountFee"),type:"Checkbox",template:"additionalOptionsCheckboxNested"},select:{type:"Select",template:"fieldAlone",title:I18n.t("transfer.abroad.label.changeAccountFee"),fieldClass:"change-account-fee fields-row flclr hide",editorClass:"beautify-select",options:e.availableFromAccountsForFees}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.abroad.button.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.abroad.button.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["changedFromAcc","srcAccChangeToTemplate","deliveryTimeUpdate","templateId","isDefined","formType","recipientName","fromAccount","sender","toAccount","address","amount","currency","currencies","title","date","seriesOfTransfers","repeatableTransfer","deliveryTime","additionalOptions","submitButtons","isSeriesOfTransfers","isRepeatableTransfer","lastCheckedValues","addToBasket","isFutureDate","deactivateDateField","isTrusted","BIC","priceStr"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/logic/local-validators",[],function(){var e={};return e.checkAccountsCouple=function(e,t){var a=(_.toArray(arguments),$.Deferred());e=e.replace(/\s/g,""),$.isEmptyObject(t.accounts.invalidCouples)&&a.resolve({});var r=$("#transfer-app-view").find('select[name="fromAccount"]').val()+"|"+e;return t.accounts.invalidCouples.hasOwnProperty(r)?a.resolve({error:!0,message:t.accounts.sameAccountsErrorText}):a.resolve({}),a.promise()},e.checkDateFormat=function(e){var t=new $.Deferred,a=this.$el.find("input[name=date]").val();return/[0-3][0-9]\.([0][1-9]|[1][0-2])\.[0-9]{4}/.test(a)?(t.resolve({error:!1}),t.promise()):t.resolve({error:!0,message:I18n.t("transfer.forms.validation.wrongDateFormat")})},e.removeDashes=function(e){
var t=new $.Deferred;return this.setValue(e.replace(/-/g,"")),t.resolve({}),t.promise()},e.checkIsSepaBankBlocked=function(e,t){var a=new $.Deferred;return _.indexOf(t,e)>=0?a.resolve({error:!0,message:I18n.t("transfer.forms.validation.sepaBlocked")}):a.resolve({error:!1}),a.promise()},e.stripSlashes=function(e){var t=new $.Deferred;return""!=$.trim(e)&&e.match(/^\/+|\/+$|\/{2}/g)?(this.setValue(e.replace(/^\/+|\/+$|\/{2}/g,"")),t.resolve({info:!0,message:I18n.t("errors.fixedCharacters")})):t.resolve({}),t.promise()},e.removeSpaces=function(e){var t=new $.Deferred;return/\s/g.test(e)?(this.setValue(e.replace(/\s/g,"")),t.resolve({info:!0,message:I18n.t("infos.trim")})):(t.resolve({error:!1}),t.promise())},e.isIbanFormat=function(e){var t=new $.Deferred,a=/^[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/.test(e.replace(/\s/g,""));return a?(t.resolve({}),t.promise()):t.resolve({error:!0,message:I18n.t("errors.accountNRBabroadInsideEOG")})},e.removePLCountryCode=function(e){var t=new $.Deferred;return this.setValue($.trim(e.replace(/^(PL)/g,""))),t.resolve({}),t.promise()},e.formatBbanCzPrefix=function(e){var t=new $.Deferred,a=/^([0-9]{0,6}-{1}|)([0-9]{1,10})\/([0-9]{4})$/;if(a.test(e)){var r=e.match(a);r[1]=r[1].replace("-",""),r[1]=Array(6-String(r[1]).length+1).join("0")+r[1],r[2]=Array(10-String(r[2]).length+1).join("0")+r[2],this.setValue(r[1]+"-"+r[2]+"/"+r[3])}return t.resolve({}),t.promise()},e.forbidBbanCzTransferInForeignCurrency=function(e,t){for(var a=new $.Deferred,r="",n=0;n<t.model.attributes.availableFromAccounts.length;n++)if(t.model.attributes.availableFromAccounts[n].number===t.fields.fromAccount.getValue()){r=t.model.attributes.availableFromAccounts[n].currency;break}return r&&"CZK"!==r?a.resolve({error:!0,message:I18n.t("errors.transferInForeignCurrencyNotForBban")}):(a.resolve({}),a.promise())},e.forbidIbanForSeriesAndRepeatable=function(e,t){var a=new $.Deferred,r=t.fields.isSeriesOfTransfers.getValue()||!1,n=t.fields.isRepeatableTransfer.getValue()||!1;return r||n?a.resolve({error:!0,message:I18n.t("errors.seriesAndRepeatableNotForIban")}):(a.resolve({}),a.promise())},e.isDomesticCurrency=function(t){var a=new $.Deferred;return t!==e.helpers.getDomesticCurrency()?a.resolve({error:!0,message:"Ten rodzaj przelewu jest dostpny tylko w krajowej walucie"}):(a.resolve({}),a.promise())},e.forbidNotSkIbanForSeriesAndRepeatable=function(e,t){var a=new $.Deferred,r=t.fields.isSeriesOfTransfers.getValue()||!1,n=t.fields.isRepeatableTransfer.getValue()||!1,i=t.fields.toAccount.getValue();return i.match(/^SK/i)||!r&&!n?(a.resolve({}),a.promise()):a.resolve({error:!0,message:I18n.t("errors.seriesAndRepeatableNotForIban")})},e.accountZus=function(e){var t=new $.Deferred,a=/^[0-9]{2}60000002026[0-9]{13}$/.test(e.replace(/\s/g,""));return a?(t.resolve({}),t.promise()):t.resolve({error:!0,message:I18n.t("errors.accountZus")})},e.splitVatAmount=function(e,t){var a=new $.Deferred,r=t.fields.amount.getValue().grossAmount,n=$.trim(e).replace(/[^\d\.,]/gi,"").replace(",","."),i=parseFloat(n),o=$.trim(r).replace(/[^\d\.,]/gi,"").replace(",","."),s=parseFloat(o);return!s||i>s?a.resolve({error:!0,message:I18n.t("transfer.split.errors.must_be_less_than_gross_amount")}):(a.resolve({}),a.promise())},e.splitTitle=function(e,t){return splitIncorrectCharsString(e,[{expr:/\/TXT\//,literal:"title_incorrect_tag"}])},e.splitInvoiceNumber=function(e,t){return splitIncorrectCharsString(e,[{expr:/\/TXT\//,literal:"invoiceNumber_incorrect_tag"}])},e.splitIdNumber=function(e,t){return splitIncorrectCharsString(e,[{expr:/\/INV\//,literal:"idNumber_incorrect_tag_inv"},{expr:/\/TXT\//,literal:"idNumber_incorrect_tag_txt"}])},splitIncorrectCharsString=function(e,t){for(var a=new $.Deferred,r=0;r<t.length;r++)if(t[r].expr.test(e.toUpperCase()))return a.resolve({error:!0,message:I18n.t("transfer.split.errors."+t[r].literal)});return a.resolve({}),a.promise()},e}),define("transfer/js/views/forms/domestic",["./_generic",nmbPaths.global.js+"validator","../../models/nmb-transfer-domestic-check-service","../../models/nmb-refresh-accounts-service","./schemes/domestic-schema","../../models/transfer-wizard","../../logic/livesearch-common","../../logic/local-validators"],function(e,t,a,r,n,i,o,s){var l={accounts:{invalidCouples:{}}},d=e.extend({events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddress","focus textarea.single-row.expanding":"elasticTextAreas"})},validator:t,formLoaded:!1,getFormSchema:function(){return n.getSchema({calendar:this.model.get("calendar"),unavailableDates:this.model.get("calendar").unavailableDates,itemsLimit:this.model.get("itemsLimit"),availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableFromAccountsForFees:this.getFormAccount(this.model.get("availableFromAccounts"),!0),soPeriodTypes:this.getPeriodTypes(this.model.get("soPeriodTypes")),isDefined:this.model.get("isDefined"),transferModes:this.prepareDataForTransferModes(this.model.get("transferModes")),isTrusted:this.model.get("isTrusted"),performed:!!this.model.get("performed"),isFromBasket:this.model.get("isFromBasket")})},getRules:function(){function e(){if("undefined"==typeof t.form)return{};var e=t.form.getValue(),a=$.trim(e.toAccount).match(/^([A-Z]{2})/i)||null,r={};if(r.toAccount=["required","trim"],!a||a.length&&"PL"==a[0])r.toAccount.push({name:"remote",params:[s.removePLCountryCode]}),r.toAccount.push("accountNRBnotAbroad"),r.toAccount.push("accountNRB");else if(a&&a.length){var n=_.contains(t.model.get("EOGCountries"),a[0].toUpperCase());r.toAccount.push({name:"accountNRBabroad",params:[a[0],n,!0]}),r.toAccount.push({name:"remote",params:[s.forbidIbanForSeriesAndRepeatable,t.form]})}r.toAccount.push({name:"remote",params:[s.checkAccountsCouple,l]}),r.amount=["required","amountAddZero",{name:"amount",params:[t.form.getValue().currencies,!1,!1]}];var i,o,d="sepa"===e.deliveryTime;switch(e.deliveryTime){case"express":i="bluemedia",o=129;break;case"swift_sha":case"swift_own":case"sepa":i={name:"filterInternationalChars",params:[d]},o=Ebre.Entity.isCZSK()&&t.form.$(".row-pep").is(":visible")?105:140;break;default:i="elixir",o=140}return r.title=["required",i,{name:"maxLength",params:[o]},"trim"],r["address:street"]=["elixir"],r["address:city"]=["elixir"],t.model.get("currentDateMockingEnabled")?r.date=["required",{name:"remote",params:[s.checkDateFormat]}]:r.date=["required",{name:"remote",params:[s.checkDateFormat]},"dateNotPast"],$(".row-address:visible").length>0&&(r["address:street"]=["trim","express"===e.deliveryTime?"bluemedia":"elixir",{name:"maxLength",params:[35]}],r["address:city"]=["trim","express"===e.deliveryTime?"bluemedia":"elixir",{name:"maxLength",params:[35]}]),e.isSeriesOfTransfers&&(r["seriesOfTransfers:{d}:amount"]=["required",{name:"amount",params:[e.currency,!1,!1]},{name:"maxAmount",params:[999999999,e.currency]}],r["seriesOfTransfers:{d}:title"]=["required","elixir",{name:"maxLength",params:[140]},"trim"]),e.isRepeatableTransfer&&(r["repeatableTransfer:repeatRow:value"]=["required",{name:"integerRange",params:"d"==e.repeatableTransfer.repeatRow.period?[7,360]:[1,99]}]),e.additionalOptions.sendConfirmation&&(r["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),r}var t=this;return e},initialize:function(){var a=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","domestic"),this.setFromAccount(this.model);var r=Backbone.Model.extend({schema:this.getFormSchema(),defaults:a.model.toJSON(),rules:a.getRules()}),s=new r;this.form=new Backbone.Form({model:s,fieldsets:n.fieldsets}).render(),a.preventSubmitByEnterOnTouchDevices(a.form),this.model.get("isInvalid")&&Ebre.Common.createErrorMessage({message:this.model.get("errorMessage")});var d=this.fields;this.form.onClose=function(){for(c in d)d.hasOwnProperty(c)&&(this.fields[c].el.parentElement||this.fields[c].$el.hide().appendTo($("body")),this.fields[c].close(),delete this.fields[c])};var d=this.form.fields;for(var c in d)d.hasOwnProperty(c)&&(this.form.fields[c].onClose=function(){this.$help&&(this.$help.remove(),delete this.$help)});if(a.bindOnBlurValidation(["toAccount","amount","title","seriesOfTransfers:item:amount","seriesOfTransfers:item:title","additionalOptions:sendConfirmationOptions:item","repeatableTransfer:repeatRow:value","date"]),Ebre.Entity.isCZSK()||a.bindOnBlurValidation(["address:street","address:city"]),!this.form.fields.isRepeatableTransfer.getValue()){var u=this.form.fields.repeatableTransfer.editor.form.fields.repeatRow.editor.form.fields;u.period.setValue("m"),u.untilFurtherNotice.setValue("true"),u.value.setValue("1")}if(Ebre.Entity.isCZSK()||(this.bindTo(this.form,"address:street:blur",function(e,a){t.validateField(e,"address:city",e.fields.address.editor.form.fields.city)}),this.bindTo(this.form,"address:city:blur",function(e,a){t.validateField(e,"address:street",e.fields.address.editor.form.fields.street)})),this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e){var t=e.fields.additionalOptions,a=this;t.getValue().addReceiver.addToAddressBook?(t.$el.find(".add-to-trusted-list").fadeIn(),a.model.set("canAddToBasketDT",!1),a.toggleAddToBasket(e)):"undefined"!=typeof t.getValue().addReceiver.addToAddressBook&&(t.$el.find(".add-to-trusted-list").fadeOut(function(){$(this).find("span.checkbox-wrapper").removeClass("checked")}),a.model.set("canAddToBasketDT",!0),a.toggleAddToBasket(e))},this),this.bindTo(this.form,"repeatableTransfer:repeatRow:untilFurtherNotice:change",function(e){var t=this,a=t.form.getValue().repeatableTransfer.repeatRow.untilFurtherNotice,r=e.$el.find(".date-container-to");a?(r.css("opacity",.4),r.datepicker("disable"),r.find("input").prop("disabled",!0),$("[name=repeatableTransfer]").find(".transfer-counter").parent().hide()):(r.css("opacity",1),r.datepicker("enable"),r.find("input").prop("disabled",!1),$("[name=repeatableTransfer]").find(".transfer-counter").parent().show())}),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(e){a.toggleEmailFields(e)}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:change",function(e){this.hideListRemoveButton(e.fields.additionalOptions.editor.form.fields.sendConfirmationOptions.editor.items)}),this.bindTo(this.form,"seriesOfTransfers:lastItemRemoved",function(){this.toggleSeries()}),this.bindTo(this.form,"deliveryTime:change",_.debounce(function(e){var a=this,r=e.fields.additionalOptions.editor.form.fields,n=(r.sendConfirmation,r.sendConfirmationOptions,e.fields.date.$el.find(".date-picker-replacer")),i=e.fields.additionalOptions.$el.find(".header:first"),s=this.model.toJSON(),d=e.getValue("fromAccount"),c=!1,u=_.find(s.availableFromAccounts,function(e){return e.number==d});u&&(c=u.isCreditCard),i.find("label").css("position","relative"),"elixir"===e.getValue(["deliveryTime"])?(s.deactivateDateField||c||a.enableDatepicker(n),e.getValue().isSeriesOfTransfers||e.getValue().isRepeatableTransfer?a.model.set("canAddToBasketDT",!1):a.model.set("canAddToBasketDT",!0),void 0!=s.additionalOptions&&(s.additionalOptions.sendConfirmation=!1)):_.contains(["express","sorbnet"],e.getValue(["deliveryTime"]))&&(a.setCurrentDateAndDisableDatepicker(n),a.model.set("canAddToBasketDT",!1),"express"===e.getValue(["deliveryTime"])&&void 0!=s.additionalOptions&&(s.additionalOptions.sendConfirmation=!1)),a.toggleAddToBasket(e),a.toggleChangeAccountFeeForDomesticForm(e),l.userTypeSelect=e.getValue(["deliveryTime"]),a.toggleBlockResourcesForDomesticForm(a.form),a.handleFormElementsHideabilityForCZSK(),1==a.formLoaded&&(t.validateField(this.form,"title",this.form.fields.title),t.validateField(this.form,"deliveryTime",this.form.fields.deliveryTime));var m=e.getField("deliveryTime").getValue();o.validateLiveSearch(m),e.trigger("additionalOptions:change",e)},100)),Ebre.Entity.isCZSK()||this.bindTo(this.form,"amount:blur title:blur date:change seriesOfTransfers:refresh",function(e,t){function a(){return s[0].getValue().amount===l.amount&&s[0].getValue().title===l.title}var r,n,i=e.getValue(),o=this.model.toJSON(),s=e.fields.seriesOfTransfers.editor.items,l={amount:i.amount,title:i.title,date:i.date};return t?(1==s.length&&e.fields.seriesOfTransfers.editor.addItem(null,!0),r=o.isSeriesOfTransfers&&o.seriesOfTransfers&&a()?o.seriesOfTransfers[0]:l,s[0].setValue(r),s[0].editor.trigger("change"),1===s.length||(o.seriesOfTransfers&&a()&&o.seriesOfTransfers.length>=2?(n=o.seriesOfTransfers[1],s[1].setValue(n)):(n=s[0].getValue(),n.date.setMonth(n.date.getMonth()+1),s[1].setValue(n))),void this.triggerDatepicker()):void(o.isSeriesOfTransfers&&o.seriesOfTransfers&&_.each(s,function(e,t){itemData=o.seriesOfTransfers[t],s[t].setValue(itemData)}))}),this.bindTo(this.form,"seriesOfTransfers:add",function(e,t,a){var r=e.fields.seriesOfTransfers.editor.items;if(r.length>1){var n=new Date(r[r.length-2].getValue().date);n.setMonth(n.getMonth()+1),r[r.length-1].setValue({amount:r[r.length-2].getValue().amount,title:r[r.length-2].getValue().title,date:n})}if(this.elasticTextAreas(),this.triggerDatepicker(),this.checkCreditCard(),r.length)for(c in r){var i=r[c].$el.find("input.calendar-input");this.restrictKeybordInputByRegex(i,/[0-9\.\s]/)}Ebre.Common.setBehaviourForAmountInput(this.form.$el.find(".input-amount"))}),this.bindTo(this.form,"seriesOfTransfers:remove",function(e,t,a){this.triggerDatepicker(),this.checkCreditCard()}),this.bindTo(this.form,"seriesOfTransfers:item:change",function(e,t,a){var r=a.$el.closest(".transfer-row"),n=r.parent().children().index(r);0===n&&(e.fields.amount.setValue(a.getValue().amount),e.fields.title.setValue(a.getValue().title),e.fields.date.setValue(a.getValue().date))}),this.bindTo(this.form,"date:datepickerChangeTrigger seriesOfTransfers:item:date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"fromAccount:change",function(e,t){var a,r=this;r.checkSender(),a=r.checkCreditCard(!0),r.setCurrencyFromAccountCurrency(t),e.fields.fromAccount.$(".validation-text").text(""),e.fields.fromAccount.$el.first(".validation info").removeClass("validation info"),e.trigger("deliveryTime:change",e)}),this.bindTo(this.form,"toAccount:change",function(e,t){a.popupShown=!1}),this.bindTo(this.form,"toAccount:blur currencies:change",function(e,t){a.handleRestrictCCFromAccountForIban()}),this.bindToWithValidityCheck(this.form,"toAccount:blur amount:blur fromAccount:change date:change currencies:change",this.checkEnableTransferTypes,this,["amount","toAccount"]),this.bindTo(this.form,"currencies:change",function(e,t){var a=e.$el.find(".row-amount"),r=a.hasClass("info"),n=a.find(".validation-text").text();r&&n===I18n.t("transfer.forms.validation.currencyChanged")&&(a.removeClass("validation info"),a.find(".validation-text").text(""))}),this.bindTo(this.form,"isRepeatableTransfer:change",function(e,t){function a(){var e=r.form,t=e.getField("additionalOptions.sendConfirmation"),a=e.getField("additionalOptions.sendConfirmationOptions"),n=e.getField("isRepeatableTransfer").getValue();if(n){r.model.set("canAddToBasketDT",!1),r.toggleAddToBasket(e),t.editor.setValue(!1),t.$el.hide(),t.$("span").removeClass("checked"),a.$el.hide(),r.formTypeChangeSuggestion=null,r.checkSender();var i=r.$el.find(".hasDatepicker");if("undefined"!=i&&""!=i.val()&&10==i.val().length&&"undefined"==typeof r.model.get("repeatableTransfer")){var o=i.val().substr(6,4)+"/"+i.val().substr(3,2)+"/"+i.val().substr(0,2),s=new Date(o),l=new Date(o);l=new Date(l.setFullYear(l.getFullYear()+1)),e.getField("repeatableTransfer.calendars").setValue({dateFrom:s,dateTo:l}),e.trigger("repeatableTransfer:calendars:change"),e.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-from").datepicker("setDate",s);var d=$.datepicker.formatDate("dd.mm.yy",s);e.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-from").find("input").val(d),e.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-to").datepicker("setDate",l);var c=$.datepicker.formatDate("dd.mm.yy",l);e.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-to").find("input").val(c)}}else"express"===e.getValue(["deliveryTime"])?r.model.set("canAddToBasketDT",!1):r.model.set("canAddToBasketDT",!0),r.toggleAddToBasket(e),t.$el.show();e.getField("repeatableTransfer.repeatRow.untilFurtherNotice").getValue()?$("[name=repeatableTransfer]").find(".transfer-counter").parent().hide():$("[name=repeatableTransfer]").find(".transfer-counter").parent().show(),r.validator.validateField(e,"toAccount",e.getField("toAccount")),r.toggleBlockResourcesForDomesticForm(e),e.trigger("additionalOptions:change",e)}var r=this;t&&t.withoutServiceSideCheck?a():r.checkAllowedFromAccountsAndThen(a)}),this.bindTo(this.form,"isSeriesOfTransfers:change",function(e,t){function a(){var t,a=e.getField("seriesOfTransfers").editor.items,n=e.getField("additionalOptions.sendConfirmation"),i=e.getField("additionalOptions.sendConfirmationOptions"),o=e.getField("isSeriesOfTransfers").getValue(),s=e.getField("currency").$el,l=e.getField("currencies");if(o)r.model.set("canAddToBasketDT",!1),r.toggleAddToBasket(e),s.hide(),l.$el.hide(),n.editor.setValue(!1),n.$el.hide(),n.$("span").removeClass("checked"),i.$el.hide(),r.formTypeChangeSuggestion=null,r.checkSender();else{"express"===e.getValue(["deliveryTime"])?r.model.set("canAddToBasketDT",!1):r.model.set("canAddToBasketDT",!0),r.toggleAddToBasket(e),n.$el.show();var d=s.hasClass("active");if(s.toggle(d),l.$el.toggle(!d),a.length>1)for(t=a.length-1;t>0;t--)e.fields.seriesOfTransfers.editor.removeItem(a[t])}r.elasticTextAreas(),r.validator.validateField(e,"toAccount",e.getField("toAccount")),r.toggleBlockResourcesForDomesticForm(e),r.form.trigger("additionalOptions:change",e)}var r=this;t&&t.withoutServiceSideCheck?a():r.checkAllowedFromAccountsAndThen(a)}),this.bindTo(this.form,"repeatableTransfer:repeatRow:period:change",function(e,t){var e=arguments[0],t=arguments[arguments.length-1],a=e.fields.repeatableTransfer.editor.form.fields.repeatRow.editor.form.fields.value.$el.find("input");"l"==t.getValue()?a.prop("disabled",!0):a.removeAttr("disabled")}),this.bindTo(this.form,"additionalOptions:change",function(e,t){var a=!0;_.each(e.fields.additionalOptions.editor.form.fields,function(e){return!("none"!=e.$el.css("display")&&!e.$el.find("div[type=hidden]").length)||(a=!1,!1)}),a?e.fields.additionalOptions.$el.hide():e.fields.additionalOptions.$el.show()}),this.bindTo(this.form,"fromAccount:checkIfChanged",this.accountHasChanged,this),this.on("close",function(){window.form&&delete window.form,this.form&&(this.form.close(),delete this.form)}),!Ebre.Entity.isCZSK()&&void 0!==Ebre.Venezia.Adv){require([Ebre.Venezia.Adv.Urls.ScriptUrls.TransferMiniRtmInit],function(e){var t=i.get("isEdited")!==!0,a=$.Deferred();a.done(function(){t&&m()}),e(t,a)});var m=function(e,t){var a={amount:$("#amount").val(),recipient:$("#recipients-livesearch-query").val(),title:$("#title").val(),toAccount:$("#toAccount").val()||""};Ebre.Dispatcher.triggerHandler({type:"TransferDataChanged.TransferMiniRtm"},a)};this.bindTo(this.form,"toAccount:blur amount:blur title:blur",m)}this.bindTo(this.form,"additionalOptions:changeAccountFee:checkbox:change",function(e){var t=e.fields.additionalOptions;t.getValue().changeAccountFee.checkbox?(t.$("select").resetSS(),t.$(".change-account-fee").fadeIn()):t.$(".change-account-fee").fadeOut()})},checkOnSubmit:function(){return this.checkDomesticFromSubmitButton=!0,this.checkEnableTransferTypes()},checkEnableTransferTypes:function(e){var t,r=this,n=r.model.get("lastCheckedValues"),o=new $.Deferred,s=$(".row-available-currency").is(":visible")?r.$el.find("#form-select-currency-amount").val():r.$el.find(".row-currency span").text();if(this.checkServicePromise&&"pending"===this.checkServicePromise.state())return this.checkServicePromise;r.checkServicePromise=o.promise(),r.transferModeCheckVisibility();var d=r.form.getValue();d.toAccount=d.toAccount.replace(/\s/g,"");var c=this.model.get("useCache"),u=new a,m={},p=["fromAccount","toAccount","date","currencies","amount","isDefined","isTrusted"],f=0;_.each(p,function(e){(!c||"date"==e&&d[e]-n[e]!=0||"date"!=e&&d[e]&&d[e]!==n[e])&&(m[e]=d[e],n[e]=d[e],f++)}),void 0==m.currencies&&(t=r.model.get("currency")),r.form.getValue().isSeriesOfTransfers||r.form.getValue().isRepeatableTransfer?m.showOwnMessage=!1:m.showOwnMessage=!0,r.model.set("lastCheckedValues",n);var h=this.form.getField("deliveryTime").$el.find("input[value=sepa]").length>0;if(m.currency=m.currencies,Ebre.Entity.isCZSK()&&f>0&&(m.pepListsLoaded="undefined"!=typeof e&&e),f>0){for(var b=this.form.model.get("availableFromAccounts"),v=0;v<b.length;v++){var y=b[v];if(y.number===m.fromAccount){m.accountParams=y.accountParams;break}}u.fetch({loaderParent:null,data:m,success:function(){if("undefined"!=typeof r.form){var e=u.toJSON();if(e.available.transferModes&&_.isArray(e.available.transferModes.modes)){var a={};e.available.transferModes.modes.map(function(e){a[e.name]=e}),e.available.transferModes=a}if(e.available.calendar){var n=r.model.get("calendar");n.minDate=e.available.calendar.minDate,n.maxDate=e.available.calendar.maxDate,r.model.set("calendar",n)}e.available.isGlobusTransferOffHours&&(r.setDateToNextWorkingDay(),r.showNextWorkingDayInfo(),r.blockFundsForFutureTransfer(!0)),r.model.set("canAddToBasket",e.available.showAddToBasket),r.model.set("BIC",e.available.accountVerifyInfo.BIC),r.form.fields.BIC.setValue(e.available.accountVerifyInfo.BIC);var l=r.prepareDataForTransferModes(e.available.transferModes);r.form&&r.form.fields.deliveryTime.editor.$el.find("input:checked").length&&r.model.set("deliveryTime",[r.form.fields.deliveryTime.editor.$el.find("input:checked").val()]),r.form.fields.deliveryTime.editor.setOptions(l),r.transferModeCheckVisibility(l);var d=e.available.deliveryTime[0],c=r.model.get("deliveryTime")[0],m=_.contains(e.available.deliveryTime,"sepa")&&!h?"sepa":_.contains(e.available.deliveryTime,c)?c:d;r.form.fields.deliveryTime.editor.setValue(m),!Ebre.Entity.isSK()&&c!=m&&r.checkDomesticFromSubmitButton&&(e.available.modalBeforeSend={messageKey:"transfer.modal.transferTypeChanged",messageType:"info"}),r.checkDomesticFromSubmitButton=null,r.styleRadioPanels(),r.enableTransferTypes(e.available.deliveryTime);var p=e.available.transferModes,f={};_.each(p,function(t){null!=t&&_.contains(e.available.deliveryTime,t.name)&&(f[t.name]=p[t.name])}),r.form.fields.deliveryTimeUpdate.setValue(f),r.model.set("transferModes",f),r.tooltip(),r.model.set("availableCurrency",e.available.accountVerifyInfo.availableCurrency),i&&"undefined"!=i.get()&&i.get("formLoaded")&&i.getPopulatedModel().get("formData")&&i.updatePopulatedModel("availableCurrency",e.available.accountVerifyInfo.availableCurrency),r.model.set("currency",e.available.accountVerifyInfo.currency),r.form.fields.currency.setValue(e.available.accountVerifyInfo.currency),void 0!=t&&_.contains(e.available.accountVerifyInfo.availableCurrency,t)&&(r.model.set("currency",t),r.form.fields.currency.setValue(t)),r.checkAvailableCurrency(r.form),null!==s&&s!==r.model.get("currency")&&(r.$el.find(".row-amount").removeClass("error").removeClass("success").addClass("info"),r.$el.find(".row-amount .validation-text").text(Ebre.Extensions.format(I18n.t("transfer.forms.validation.currencyChangedConversion"),s,r.model.get("currency")))),r.form.fields.isFutureDate.setValue(e.available.accountVerifyInfo.isFutureDate||e.available.isGlobusTransferOffHours),r.toggleBlockResourcesForDomesticForm(r.form),r.rememberFormTypeChangeSuggestion(e),r.rememberModalMessage(e),r.model.set("deactivateDateField",e.available.deactivateDateField),r.checkCreditCard(),o.resolve(e),e.available.isGlobusTransferOffHours&&r.checkEnableTransferTypes()}},fail:function(e){o.reject();var t=$.parseJSON(e.responseText),a=["paym_SameAccount","paym_NoCurrencyTransferFromCreditCard","paym_InvalidAccountNo","addr_WrongIbanLenght"];if(_.contains(a,t.code)){var n=d.fromAccount+"|"+d.toAccount,i=null==t.title||""==t.title?t.message:t.title;l.accounts.invalidCouples[n]=!0,l.accounts.sameAccountsErrorText=i;var s=r.form.fields.toAccount.$el;s.addClass("validation error").removeClass("success"),s.find(".validation-text").text(i)}}})}else o.resolve();return r.checkServicePromise},blockFundsForFutureTransfer:function(e){var t=this,a=t.form.fields.additionalOptions.editor.form.fields.blockResources;a.editor.setValue(e),1==e?(a.$el.find("span").addClass("checked"),a.$el.show()):(a.$el.find("span").removeClass("checked"),a.$el.hide())},setDateToNextWorkingDay:function(){var e=this,t=e.getNextWorkingDay(e.form.fields.date.getValue());e.form.fields.date.setValue(t)},showNextWorkingDayInfo:function(){var e=this;e.$el.find(".row-date").removeClass("error").removeClass("success").addClass("validation").addClass("info"),e.$el.find(".row-date .validation-text").text(I18n.t("transfer.forms.validation.dateChanged"))},getNextWorkingDay:function(e){var t=this,a=e,r=-1,n=t.model.get("calendar");do{a.setDate(a.getDate()+1);do r++;while(r<n.unavailableDates.length&&n.unavailableDates[r].getTime()<a.getTime())}while(r<n.unavailableDates.length&&n.unavailableDates[r].getTime()===a.getTime());return a.getTime()>n.maxDate.getTime()?n.unavailableDates.length&&n.unavailableDates[n.unavailableDates.length-1].getTime()!==n.maxDate.getTime()?n.maxDate:t.getLastWorkingDayBefore(n.maxDate):a},getLastWorkingDayBefore:function(e){var t=this,a=t.model.get("calendar"),r=e,n=a.unavailableDates.length;do{r.setDate(r.getDate()-1);do n--;while(n>=0&&a.unavailableDates[n].getTime()>r.getTime())}while(n>=0&&a.unavailableDates[n].getTime()===r.getTime());return r},toggleEmailFields:function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;e.getValue().isSeriesOfTransfers||e.getValue().isRepeatableTransfer||(a.getValue()?r.$el.slideDown():r.$el.slideUp())},enableTransferTypes:function(e){var t=this,a=t.form.fields.deliveryTime,r=a.getValue();a.$(".radio-panel").hide(),_.each(e,function(e){a.$("[value="+e+"]").closest(".radio-panel").show()}),a.$(".radio-panel").removeClass("selected").find(".radio-wrapper").removeClass("checked");var n;_.indexOf(e,r)==-1?(this.form.setValue({deliveryTime:e[0]}),n=a.$("[value="+e[0]+"]")):(this.form.setValue({deliveryTime:r}),n=a.$("[value="+r+"]")),n&&(n.parent().addClass("checked"),n.parents(".radio-panel").addClass("selected"),this.form.trigger("deliveryTime:change",this.form))},standingOrderPeriodConstraints:function(){function e(e){var t=$(e.currentTarget).val(),a=/^\d*$/g,r=t+String.fromCharCode(e.charCode);if(e.charCode&&!a.test(r))return e.preventDefault()}function t(e,t){var r=e.val();r===u.lastDay?(o.attr("disabled",!0),o.attr("required",!1),o.attr("value","1")):r===u.day?(o.attr("disabled",!1),o.attr("required",!0),o.val()<7&&o.attr("value","7")):(o.attr("disabled",!1),o.attr("required",!0)),o.trigger("blur"),a(s,r)}function a(e,t){if(!c.is(":checked")){t||(t=e.val());var a=1,n=o.val(),i=$(".date-container-from").datepicker("getDate"),s=$(".date-container-to").datepicker("getDate");_.isDate(i)||(i=r.form.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-from").datepicker("getDate")),_.isDate(s)||(s=r.form.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-to").datepicker("getDate")),0<n&&t!=u.lastDay?t==u.year?(a=(s.getFullYear()-i.getFullYear())/n,0<=s.getDate()-i.getDate()&&0<=s.getMonth()-i.getMonth()&&a++):t===u.month?(a=(s.getMonth()-i.getMonth()+12*(s.getFullYear()-i.getFullYear()))/n,(0==s.getDate()-i.getDate()||0<(s.getDate()-i.getDate())/Math.abs(s.getDate()-i.getDate()))&&a++):t===u.week?a=1+(s-i)/(6048e5*n):t===u.day&&(a=1+(s-i)/(864e5*n)):t===u.lastDay&&(a=s.getFullYear()-i.getFullYear()==0&&s.getMonth()-i.getMonth()==0?s.getDate()==new Date(s.getFullYear(),s.getMonth()+1,0).getDate()?1:0:s.getDate()==new Date(s.getFullYear(),s.getMonth()+1,0).getDate()?1+(s.getMonth()-i.getMonth()+12*(s.getFullYear()-i.getFullYear())):s.getMonth()-i.getMonth()+12*(s.getFullYear()-i.getFullYear())),d.text(Math.floor(a))}}var r=this,n=r.form,i=this.form.$el.find(".row-standing-orders .row-period"),o=i.find(".counter"),s=i.find("#form-select-period"),l=i.next(".row-calendars").find('[name="dateFrom"]'),d=i.siblings(".row-summary").find(".transfer-counter"),c=i.find('[name="untilFurtherNotice"]'),u={day:"d",week:"t",month:"m",year:"r",lastDay:"k"};s.change(function(){t(s,r)}),o.change(function(){a(s)}),s.trigger("change"),o.keypress(function(t){e(t)}),c.change(function(){a(s)}),l.change(function(){a(s)}),n.on("repeatableTransfer:calendars:change",function(){a(s)}),c.change(function(){a(s)})},transferModeCheckVisibility:function(e){var t=this.form,a=t.fields.isSeriesOfTransfers.getValue()||!1,r=t.fields.isRepeatableTransfer.getValue()||!1,n=t.fields.date.editor.$el.parents(".fields").find(".validation-icon");a||r||"undefined"!=typeof e&&(null===e||!e.length)?(n.hide(),t.fields.deliveryTime.$el.hide()):(n.show(),Ebre.Entity.isSK()||t.fields.deliveryTime.$el.show()),this.handleFormElementsHideabilityForCZSK()},onRender:function(){var e=this;this.$el.find("#form-container").html(this.form.el),this.styleSelects(),this.styleSelectsDefault(),this.styleCheckbox(),this.styleRadioPanels(),this.styleRadioButtons(),this.triggerDatepicker(),Ebre.Entity.isCZSK()||this.initializeSlidingAddress(),this.bindTo(this,"effects:done",function(){!e.model.get("recipientName")&&_.contains(["phone","mobile","domestic"],e.model.get("formType"))||(o.isFormLocked()?e.form.$el.find("input, radio, select, textarea, a").attr("disabled","disabled").attr("tabIndex",-1).removeClass("validation error"):e.setFocusOnInput("toAccount","amount"),Ebre.Wizard.trigger("layout:gotoStep",2)),this.tooltip(),this.generateSeriesAndRecurrentTooltip(),this.slidingTabs(),this.elasticTextAreas(),$("#transfer-container input[type=text]:visible").on("blur",this.detectAdditionalInputCreation),$("#transfer-container *").on("blur mousemove",function(e){e.stopImmediatePropagation()})},this),this.initializeRepeatableCalendars(),this.initializeCurrencies(),this.toggleAddToBasket(this.form),this.checkAdditionalOptions(this.form),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#amount")),this.model.get("isSeriesOfTransfers")&&this.model.get("isSeriesOfTransfers").length>1&&this.hideElementsForSeriesOfTransfers()},detectAdditionalInputCreation:function(){$(".row-toAccount input").length>1&&!Ebre.PaymNotifySent&&($.ajax({url:"/Errors/Notify/m"}),Ebre.PaymNotifySent=!0)},hideElementsForSeriesOfTransfers:function(){var e=this.form.fields.additionalOptions.editor.form.fields.sendConfirmation,t=this.form.fields.additionalOptions.editor.form.fields.sendConfirmationOptions;e.editor.setValue(!1),e.$el.find("span").removeClass("checked"),e.$el.hide(),t.$el.hide(),this.form.fields.currency.$el.hide();var a=this.form.fields.additionalOptions.editor.form.fields.blockResources;a.editor.setValue(!1),a.$el.find("span").removeClass("checked"),a.$el.hide(),this.transferModeCheckVisibility()},checkAdditionalOptions:function(e){var t=e.getValue().isRepeatableTransfer,a=e.getValue().isSeriesOfTransfers;t&&e.trigger("isRepeatableTransfer:change",this.form),a&&e.trigger("isSeriesOfTransfers:change",this.form)},adjustAdditionalOptionsFees:function(){this.model.get("additionalOptions").changeAccountFee||this.form.getField("additionalOptions.changeAccountFee.select").setValue(this.form.getField("fromAccount").getValue()),this.form.getField("additionalOptions.changeAccountFee.checkbox").getValue()&&this.$el.find(".change-account-fee").show()},onShow:function(){this.handleRestrictCCFromAccountForIban(),this.generateSenderSelect(),this.styleRadioPanels(),this.form.trigger("seriesOfTransfers:refresh",this.form),this.checkAvailableCurrency(this.form),this.form.trigger("fromAccount:checkIfChanged",this.form),this.checkAmount(),this.form.trigger("repeatableTransfer:repeatRow:untilFurtherNotice:change",this.form),
this.form.trigger("deliveryTime:change",this.form),$(".row-period").html+='<div class="validation-text"></div>',this.standingOrderPeriodConstraints(),this.form.fields.additionalOptions.getValue().addReceiver.addToAddressBook&&this.form.$el.find(".add-to-trusted-list").fadeIn(),this.toggleBlockResourcesForDomesticForm(this.form),this.toggleEmailFields(this.form),this.adjustAdditionalOptionsFees(),this.checkCreditCard(),this.formLoaded=!0},checkAmount:function(){if(this.model.get("amount")){var e=this.verifyAmount(this.model.get("amount"));this.form.fields.amount.setValue(e)}},accountHasChanged:function(e){var t=e.model.toJSON().changedFromAcc,a=e.model.toJSON().srcAccChangeToTemplate;if(t){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccCorrected"));var r=this.model.get("defaultData");r.changedFromAcc=!1,this.model.set("defaultData",r)}if(!t&&a){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccChangedToTemplate"));var r=this.model.get("defaultData");r.srcAccChangeToTemplate=!1,this.model.set("defaultData",r)}},getPeriodTypes:function(e){var t=[];return _.each(e,function(e,a){t.push({val:e.value,label:e.label})}),t},checkIsAccountAllowed:function(e,t){var a=!1;return _.each(e,function(e){if(e.number===t)return a=!0}),a},initializeRepeatableCalendars:function(){if(!this.model.get("repeatableTransfer")){var e=this.model.get("calendar"),t=new Date(e.minDate),a=new Date(t.setFullYear(e.minDate.getFullYear()+1));this.form.getField("repeatableTransfer.calendars").setValue({dateFrom:e.minDate,dateTo:a}),this.form.trigger("repeatableTransfer:calendars:change"),this.form.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-to").datepicker("setDate",a);var r=$.datepicker.formatDate("dd.mm.yy",a);this.form.fields.repeatableTransfer.getField("calendars").$el.find(".date-container-to").find("input").val(r)}},checkAllowedFromAccountsAndThen:function(e){var t=this,a=t.form,n=a.getValue(),i={isDefined:a.model.get("isDefined"),isSeries:n.isSeriesOfTransfers||!1,formType:a.model.get("formType"),isRepeatable:n.isRepeatableTransfer||!1,templateId:n.templateId,oldAccount:n.fromAccount},o=new r;o.fetch({loaderParent:t.getLoaderParamSelector(),data:i,success:function(){var r=o.toJSON(),n=a.fields.fromAccount,i=n.getValue();n.editor.setOptions(t.getFormAccount(r.availableFromAccounts)),a.model.set("availableFromAccounts",r.availableFromAccounts),t.checkIsAccountAllowed(r.availableFromAccounts,i)?(n.editor.setValue(i),n.$el.removeClass("validation info")):t.displayValidationMessage(n,I18n.t("errors.fromAccNotAllowed")),n.editor.$el.resetSS(),e(),t.handleRestrictCCFromAccountForIban()}})},setFromAccount:function(e){var t=e.get("fromAccount");if(e.get("availableFromAccounts").length){var a=_.find(e.get("availableFromAccounts"),function(e){return e.number===t});"undefined"==typeof a&&e.set("fromAccount",e.get("availableFromAccounts")[0].number)}},getCurrentFormData:function(){var e={amount:void 0!=this.form.fields.amount?this.form.fields.amount.getValue():null,title:void 0!=this.form.fields.title?this.form.fields.title.getValue():null,toAccount:void 0!=this.form.fields.toAccount?this.form.fields.toAccount.getValue():null,fromAccount:void 0!=this.form.fields.fromAccount?this.form.fields.fromAccount.getValue():null,address:void 0!=this.form.fields.address?this.form.fields.address.getValue():null};return e},setCurrencyFromAccountCurrency:function(e){var t=this,a=_.find(this.model.get("defaultData").availableFromAccounts,function(t){return t.number==e.getValue()}),r=this.form.getField("currencies").editor.$el,n=r.val()||$(".row-currency span[name=currency]").text()||null;_.contains(t.model.get("availableCurrency"),a.currency)&&null!==n&&n!==a.currency&&(r.val(a.currency).trigger("liszt:updated"),_.defer(function(){t.$el.find(".row-amount").removeClass("error").removeClass("success").addClass("validation info"),t.$el.find(".row-amount .validation-text").text(I18n.t("transfer.forms.validation.currencyChanged"))}))},handleSymbolAndReferenceHideability:function(e){var t=this,a=this.form.getField("symbols"),r=$(a.getField("KS").editor.el).add(a.getField("VS").editor.el).add(a.getField("SS").editor.el),n=$(this.form.getField("referenceSymbol").editor.el),i=$(this.form.getField("toAccount").editor.el);e&&i.val(this.form.getField("toAccount").getValue());var o=Ebre.Entity.isCZ()?/^([0-9]{0,6})-{0,1}([0-9]{10})\/([0-9]{4})$/:Ebre.Entity.isSK()?/^SK/i:null,s=this.form.getField("toAccount").getValue().match(o);if(e)n.on("focus",function(){i.val().match(o)?n.css("cursor","not-allowed").attr("readonly",!0).val():t._emptyElements(r)&&(r.attr("readonly",!0),t.handleReferenceHideability(),$.each(r,function(){$(this).parents(".row").removeClass("validation error").find(".validation-text").text("")}))}).on("blur",function(){_.contains(r,$(document.activeElement))||null==i.val().match(o)&&""!=i.val()||!t._emptyElements(r)||""!=n.val()||r.css("cursor","text").attr("readonly",!1)}).on("keyup",function(){""!=$(this).val()?(r.css("cursor","not-allowed"),n.css("cursor","text")):r.css("cursor","text")}),r.on("focus",function(){""!=n.val()||null==i.val().match(o)&&""!=i.val()||(r.attr("readonly",!1),n.attr("readonly",!0),n.parents(".row").removeClass("error").find(".validation-text").text(""))}).on("blur",function(){n!=$(document.activeElement)&&""==n.val()&&t._emptyElements(r)&&!i.val().match(o)&&t.handleReferenceHideability()}).on("keyup",function(){t._emptyElements(r)?n.css("cursor","text"):(n.css("cursor","not-allowed"),s&&r.css("cursor","text"))}),i.on("keyup paste blur",function(){var e=t.form.fields.date.$el.find(".date-picker-replacer");_.defer(function(){i.val().length>1&&(null!=i.val().match(o)||""==i.val()?t.enableDatepicker(e):t.setCurrentDateAndDisableDatepicker(e))})}),""!=i.val()&&s?(t.handleReferenceHideability(),t.handleCountryHideability(t.form.getField("toAccount"),o),r.css("cursor","text").attr("readonly",!1)):""==i.val()||s||(r.css("cursor","not-allowed").attr("readonly",!0),t.$el.find(".row-date .uiDateInput").show(),t.model.set("canAddToBasketDT",!0)),t.handleCountryHideability(t.form.getField("toAccount"),o);else{if(""!=i.val()&&i.val().length>1){var s=i.val().match(o),l=t.form.fields.date.$el.find(".date-picker-replacer");return void(""==i.val()||s?(""!=i.val()&&s||""==i.val())&&(r.css("cursor","text").attr("readonly",!1),t.handleReferenceHideability(),t.handleCountryHideability(t.form.getField("toAccount"),o),t.enableDatepicker(l)):(r.css("cursor","not-allowed").attr("readonly",!0).val(""),t.handleReferenceHideability(),t.handleCountryHideability(t.form.getField("toAccount"),o),t.model.set("canAddToBasketDT",!0),1==t.model.get("addToBasket")&&1==t.model.get("canAddToBasketDT")&&1==t.model.get("canAddToBasketCC")&&t.form.fields.submitButtons.editor.form.fields.addToBasket.$el.show(),t.$el.find(".row-date .uiDateInput").show(),$.each(r,function(){$(this).parents(".row").removeClass("validation error").find(".validation-text").text("")}),t.formLoaded&&t.setCurrentDateAndDisableDatepicker(l)))}t.handleReferenceHideability()}},handleFormElementsHideabilityForCZSK:function(){Ebre.Entity.isCZSK()&&(this.handleSymbolAndReferenceHideability(!1),this.handleConfirmationOptionsHideabilityForCZSK())},handleConfirmationOptionsHideabilityForCZSK:function(){var e=this.form,t=e.getField("additionalOptions.sendConfirmation"),a=e.getField("additionalOptions.sendConfirmationOptions");t.editor.setValue(!1),t.$el.hide(),t.$("span").removeClass("checked"),a.$el.hide()},handleCountryHideability:function(e,t){var a=this.$el.find("#countries"),r=null!==e.getValue().match(t);Ebre.Entity.isSK()&&r||!Ebre.Entity.isSK()&&"sepa"!=this.form.getValue(["deliveryTime"])?(a.attr("disabled",!0),a.val("")):a.attr("disabled",!1),a.trigger("liszt:updated")},handleReferenceHideability:function(){var e=this,t=this.form.getField("isSeriesOfTransfers").getValue()||!1,a=this.form.getField("isRepeatableTransfer").getValue()||!1;Ebre.Entity.isSK()||(_.contains(["swift_sha","swift_own","elixir"],e.form.getValue(["deliveryTime"]))||t||a?e.form.$el.find("#referenceSymbol").css("cursor","not-allowed").attr("readonly",!0).val(""):"sepa"!==e.form.getValue(["deliveryTime"])&&t&&a||e.form.$el.find("#referenceSymbol").css("cursor","text").attr("readonly",!1))},showHideSerieAndRepeatableTabs:function(e){var t=this,a=t.form.fields.date.$el.find(".date-picker-replacer");e?t.setCurrentDateAndDisableDatepicker(a):t.enableDatepicker(a)},setSepaCountries:function(e){var t=this.form.$("#countries");$.browser.mobile&&Modernizr.touch?this.form.fields.address.getField("receiverCountryCode").editor.setOptions(this.mapDictionariesToOptions(e,t.data("placeholder"))):this.form.fields.address.getField("receiverCountryCode").editor.setOptions(this.mapDictionariesToOptions(e,!0)),t.trigger("liszt:updated")},_emptyElements:function(e){var t=!0;return $.each(e,function(){if(""!=$(this).val())return t=!1,!1}),t},handleRestrictCCFromAccountForIban:function(){var e=Ebre.Entity.isCZSK()?Ebre.Entity.isCZ()?"CZ":"SK":"PL",t={PL:/^(?!PL)[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/,CZ:/^(?!CZ)[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/,SK:/^(?!SK)[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/},a=this.form.getField("toAccount").getValue(),r=this.getDomesticCurrency(),n=this.form.getField("currencies").getValue()||this.form.getField("currency").getValue(),i=t[e].test(a.replace(/\s/g,"")),o=$.trim(a).match(/^([A-Z]{2})/i)||null,s=!1,l=this.form.fields.fromAccount.getValue(),d=this.model,c=this;(a&&i&&o&&e!=o&&_.contains(d.get("EOGCountries"),o[0].toUpperCase())||!i&&n!=r)&&(s=!0);var u=c.getFormAccount(d.get("availableFromAccounts"),s),m=_.find(u,function(e){return e.val==l});this.form.fields.fromAccount.editor.setOptions(u),"undefined"!=typeof m?c.form.fields.fromAccount.setValue(l):("undefined"!=typeof _.find(u,function(e){return e.val==d.get("fromAccount")})?c.form.fields.fromAccount.setValue(c.model.get("fromAccount")):c.form.fields.fromAccount.setValue(u[0].val),_.defer(function(){c.form.fields.fromAccount.$el.addClass("validation info");var e=i?I18n.t("transfer.forms.validation.fromAccountChanged"):I18n.t("transfer.forms.validation.fromAccountChangedWrongCurrency");c.form.fields.fromAccount.$(".validation-text").text(e)})),this.form.fields.fromAccount.editor.$el.trigger("liszt:updated")},toggleBlockResourcesForDomesticForm:function(e){var t=e.getValue(),a=e.getField("additionalOptions.blockResources"),r=t.isFutureDate===!0,n=t.isSeriesOfTransfers===!0||t.isRepeatableTransfer===!0,i=_.contains(["swift_own","swift_sha"],e.getValue(["deliveryTime"])),o=r&&!n||!n&&i;o?a.$el.toggle(!0):(a.$el.toggle(!1),a.editor.setValue(!1),a.$("span").removeClass("checked"))},toggleChangeAccountFeeForDomesticForm:function(e){var t=e.getField("additionalOptions.changeAccountFee.checkbox"),a=_.contains(["swift_sha","swift_own"],e.getValue(["deliveryTime"]))&&!(e.getValue("isSeriesOfTransfers")||e.getValue("isRepeatableTransfer"));a?(e.$el.find(".row-change-account-fee").show(),t.$el.toggle(!0)):(e.$el.find(".row-change-account-fee").hide(),t.$el.toggle(!1),t.$("span").removeClass("checked"),t.setValue(!1),e.trigger("additionalOptions:changeAccountFee:checkbox:change",e),e.$(".change-account-fee").hide())}});return d}),define("transfer/js/views/forms/schemes/splitdomestic-schema",[],function(){function e(e){return{isFutureDate:{type:"Hidden"},addToBasket:{type:"Hidden"},lastCheckedValues:{type:"Hidden"},dtmsg:{type:"Hidden"},changedFromAcc:{type:"Hidden"},srcAccChangeToTemplate:{type:"Hidden"},deliveryTimeUpdate:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},isDefined:{type:"Hidden"},formType:{type:"Hidden"},deactivateDateField:{type:"Hidden"},isTrusted:{type:"Hidden"},perfToken:{type:"Hidden"},BIC:{type:"Hidden"},priceStr:{type:"Hidden"},fromAccount:{title:I18n.t("transfer.domestic.fromAccount"),type:"SplitSelect",editorClass:"beautify-select select-long",options:e.availableFromAccounts,editorAttrs:e.isFromBasket?{disabled:"disabled"}:{placeholder:I18n.t("transfer.domestic.accountSourceNumber")}},sender:{title:I18n.t("transfer.domestic.sender"),type:"Select",editorClass:"beautify-select select-medium",editorAttrs:{id:"form-select-sender"},fieldClass:"hide",options:[]},senderName:{type:"Hidden"},toAccount:{type:e.isDefined||e.performed||e.isFromBasket?"SimpleTextValue":"Text",title:I18n.t("transfer.domestic.toAccount"),editorClass:"extralong",editorAttrs:{id:"toAccount",maxlength:38,placeholder:I18n.t("transfer.split.placeholders.toAccount")},_params:{tooltip:I18n.t("transfer.domestic.tooltips.toAccountTooltipSplit")}},address:{title:I18n.t("transfer.domestic.address"),type:"MultipleFields",template:"address",fieldClass:"row-wrapper two-lines",subSchema:{street:{template:"fieldsRowWithoutHeader",title:I18n.t("transfer.domestic.placeholders.address"),fieldClass:"fields-row",editorClass:"long optional",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.address"),maxlength:35}},city:{editorClass:"long optional",fieldClass:"fields-row",title:I18n.t("transfer.domestic.placeholders.city"),template:"fieldsRowWithoutHeader",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.city"),maxlength:35}}}},idType:{title:I18n.t("transfer.split.idType"),type:"MultipleFields",editorLabelFor:"form-select-id-type",subSchema:{type:{title:I18n.t("transfer.split.idType"),type:"Select",fieldClass:"row-inner-left",editorClass:"beautify-select fl",editorAttrs:{id:"form-select-id-type"},template:"fieldAlone",options:e.idTypesDict},series:{title:I18n.t("transfer.split.idNumber"),editorClass:"short",fieldClass:"row-inner-right",editorAttrs:{maxlength:14,id:"idTypeSeries"},template:"labelBeforeInput"}}},amount:{title:I18n.t("transfer.split.grossAmount"),type:"MultipleFields",editorLabelFor:"grossAmountInner",fieldClass:"row-amountAndVat",subSchema:{grossAmount:{template:"innerAmountWithCurrency",fieldClass:"row-inner-left",editorClass:"short",editorAttrs:{id:"grossAmountInner"}},vatAmount:{title:I18n.t("transfer.split.vatAmount"),template:"innerAmountWithCurrencyAndLabelBeforeInput",fieldClass:"row-inner-right",editorClass:"short",editorAttrs:{id:"vatAmount"}}}},title:{title:I18n.t("transfer.split.invoiceNumber"),type:"MultipleFields",subSchema:{invoiceNumber:{title:I18n.t("transfer.split.invoiceNumber"),type:"TextArea",fieldClass:"row-inner-left",template:"fieldAlone",editorClass:"short single-row expanding",editorAttrs:{maxlength:35,id:"invoiceNumber"}},title:{title:I18n.t("transfer.domestic.title"),type:"TextArea",fieldClass:"row-inner-right",editorClass:"short single-row expanding",template:"labelBeforeInput",editorAttrs:{maxlength:33,id:"title"}}}},date:{type:"uiDateInput",title:I18n.t("transfer.domestic.deliveryDate"),template:"deliveryTimeDateNonRecurrentWithLabel",editorAttrs:{id:"uiDateInput"},fieldClass:"row-additional-options",editorClass:"style-tab",minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},isSeriesOfTransfers:{type:"Hidden"},seriesOfTransfers:{type:"List",template:"fieldAlone",listTemplate:"seriesOfTransfers",itemType:"MultipleFields",listItemTemplate:"seriesOfTransfersItem",fieldClass:"series-container expand-group tab",itemsLimit:e.itemsLimit,subSchema:{amount:{title:"Kwota",editorClass:"input-amount",template:"seriesOfTransfersAmount",editorAttrs:{maxlength:13}},title:{title:"Tytu",type:"TextArea",template:"inputWithHiddenLabel",editorClass:"input-title extralong single-row expanding",editorAttrs:{maxlength:140}},date:{title:"Data",type:"uiDate",template:"onlyDateInput",fieldClass:"series",emptyDate:!0,minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min"),_params:{enabledInput:!0}}}},deliveryTime:{title:I18n.t("transfer.domestic.deliveryTime.title"),type:"DeliveryTimeSelect",template:"DeliveryTimeRow",fieldClass:"row-delivery-time",options:e.transferModes,_params:{tooltip:I18n.t("transfer.domestic.tooltips.deliveryTime"),rowSubDesc1:I18n.t("transfer.domestic.deliveryTime.rowSubDesc1"),rowSubDesc2:I18n.t("transfer.domestic.deliveryTime.rowSubDesc2")}},additionalOptions:{title:I18n.t("transfer.domestic.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.domestic.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources hide"},sendConfirmation:{title:I18n.t("transfer.domestic.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-send-confirmation"},sendConfirmationOptions:{type:"List",template:"additionalOptionsListWrapper",listTemplate:"sendTransferConfirmationOptions",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"send-confirmation-options hide",editorClass:"short",itemsLimit:2,editorAttrs:{maxlength:40,"aria-label":"E-mail"}},addReceiver:{type:e.isDefined?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",fieldClass:"row-add-receiver",subSchema:{addToAddressBook:{title:I18n.t("transfer.domestic.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"}}},changeAccountFee:{type:"MultipleFields",template:"fieldsRowWithoutHeader",fieldClass:"row-change-account-fee hide",subSchema:{checkbox:{title:I18n.t("transfer.abroad.label.changeAccountFee"),type:"Checkbox",template:"additionalOptionsCheckboxNested"},select:{type:"Select",template:"fieldAlone",title:I18n.t("transfer.abroad.label.changeAccountFee"),fieldClass:"change-account-fee fields-row flclr hide",editorClass:"beautify-select",options:e.availableFromAccountsForFees}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.abroad.button.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.abroad.button.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["changedFromAcc","srcAccChangeToTemplate","deliveryTimeUpdate","templateId","isDefined","formType","recipientName","fromAccount","sender","toAccount","address","idType","amount","title","date","seriesOfTransfers","deliveryTime","additionalOptions","submitButtons","isSeriesOfTransfers","lastCheckedValues","addToBasket","isFutureDate","deactivateDateField","isTrusted","BIC","priceStr"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/logic/split-editors",[],function(){var e={};return _.extend(e,{isAccountVatCompliant:function(e,t){var a=_.find(t,function(t){var a=t.number===e;return a===!1&&t.relatedAccount&&(a=t.relatedAccount.number===e),a});return!!a&&a.isVatCompliant},invalidateSplitSelectFromAccount:function(e,t){Ebre.Venezia.ProfileContext.IsFirm&&e.fields.fromAccount.$("select")&&this.invalidateSplitSelect(e,"fromAccount",e.fields.fromAccount.getValue(),e.model.toJSON().availableFromAccounts,t)},invalidateSplitSelectToAccount:function(e){Ebre.Venezia.ProfileContext.IsFirm&&e.fields.toAccount.$("select")&&this.invalidateSplitSelect(e,"toAccount",e.fields.toAccount.getValue(),e.model.toJSON().availableToAccounts)},renderSplitSelfSelects:function(e){this.renderSplitSelectFromAccount(e),this.renderSplitSelectToAccount(e)},renderSplitSelectFromAccount:function(e){this.displaySplitSelectSecondLine(e,"fromAccount")},renderSplitSelectToAccount:function(e){this.displaySplitSelectSecondLine(e,"toAccount")},invalidateSplitSelect:function(e,t,a,r,n){var i=$(".row-"+t+" .newListSelected");if(i){var o=i.children(".selectedTxt"),s=this.isAccountVatCompliant(a,r),l=e.$(".row-"+t).closest(".info");e.$(".row-"+t).css("background-color");s?(i.addClass("double-line-split-select"),o.addClass("double-line-split-select"),$(".row.row-"+t+" .scroll-pane").addClass("vat-account"),void 0!==n&&(e.$(".row-"+t).addClass("validation info"),e.$(".row-"+t+" .validation-text").html(I18n.t("transfer.forms.validation.fromAccountVatInfo")),l.animate())):(l&&(l.removeClass("info"),l.find(".validation-text").text("")),i.removeClass("double-line-split-select"),o.removeClass("double-line-split-select"),$(".row.row-"+t+" .scroll-pane").removeClass("vat-account"))}},displaySplitSelectSecondLine:function(e,t){var a=$(".row-"+t+" .newListSelected"),r=a.children(".selectedTxt");a.addClass("double-line-split-select"),r.addClass("double-line-split-select"),$(".row.row-"+t+" .scroll-pane").addClass("vat-account")},checkIsVatExceeded:function(e,t,a,r,n){t=t.replace(/ /g,"");var i=_.find(n,function(e){return r===e.number}),o=this.isAccountVatCompliant(r,n);o&&""!==a&&""!==t&&parseFloat(i.relatedAccount.balance)<parseFloat(t)&&i.isVatCompliant&&this.vatExceededMessage(e,!1)},checkIsVatExceededUS:function(e,t,a){if(a){var r=e.model.attributes.availableFromAccounts;t=t.replace(/ /g,"");var n=e.fields.fromAccount.getValue(),i=_.find(r,function(e){return n===e.number}),o=this.isAccountVatCompliant(n,r);o&&""!==t&&parseFloat(i.relatedAccount.balance)<parseFloat(t)&&i.isVatCompliant&&this.vatExceededMessage(e,!0)}},vatExceededMessage:function(e,t){e.$(".row-fromAccount").addClass("validation info"),e.$(".row-fromAccount .validation-text").html(I18n.t("transfer.forms.validation.fromAccountVatExceeded"));var a=e.$(".row-fromAccount").css("background-color"),r=e.$(".row-fromAccount").closest(".info");setTimeout(function(){r.animate({backgroundColor:a},1500,function(){r.attr("style",r.attr("style").replace(/background-color:[^\;]+;/,"")),t?r.find(".validation-text").html(I18n.t("transfer.forms.validation.fromAccountVatInfo")):(r.removeClass("info"),r.find(".validation-text").text(""))})},18500)}}),e}),define("transfer/js/models/nmb-transfer-split-data-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.SplitDataCheckService(a)}});return e}),define("transfer/js/views/forms/splitdomestic",["./_generic","./schemes/splitdomestic-schema","../../logic/split-editors","../../logic/livesearch-common",nmbPaths.global.js+"validator","../../logic/local-validators","../../models/nmb-transfer-split-data-check-service","../../models/transfer-wizard"],function(e,t,a,r,n,i,o,s){var l={accounts:{invalidCouples:{}}},d=e.extend({getFormSchema:function(){return t.getSchema({calendar:this.model.get("calendar"),unavailableDates:this.model.get("calendar").unavailableDates,itemsLimit:this.model.get("itemsLimit"),availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableFromAccountsForFees:this.getFormAccount(this.model.get("availableFromAccounts"),!0),isDefined:this.model.get("isDefined"),transferModes:this.prepareDataForTransferModes(this.model.get("transferModes")),isTrusted:this.model.get("isTrusted"),performed:!!this.model.get("performed"),isFromBasket:this.model.get("isFromBasket"),idTypesDict:this.getPaymentTypes(this.model.get("idTypesDict"))})},events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddress","focus textarea.single-row.expanding":"elasticTextAreas"})},initialize:function(){var a=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","splitdomestic");var r=Backbone.Model.extend({schema:this.getFormSchema(),defaults:a.model.toJSON(),rules:a.getFormRules()}),n=new r;this.form=new Backbone.Form({model:n,fieldsets:t.fieldsets}).render(),this.setupBindings(),this.toggleAddToBasket(this.form)},onRender:function(){var e=this;this.$el.find("#form-container").html(this.form.el),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.styleCheckboxPanels(),this.triggerDatepicker(),this.initializeSlidingAddress(),this.toggleBlockResourcesForDomesticForm(this.form),this.toggleEmailFields(this.form),this.bindTo(this,"effects:done",function(){!e.model.get("recipientName")&&_.contains(["phone","mobile","domestic","splitdomestic"],e.model.get("formType"))||(r.isFormLocked()?e.form.$el.find("input, radio, select, textarea, a").attr("disabled","disabled").attr("tabIndex",-1).removeClass("validation error"):e.setFocusOnInput("toAccount","amount"),Ebre.Wizard.trigger("layout:gotoStep",2)),a.invalidateSplitSelectFromAccount(this.form),this.tooltip(),this.generateSeriesAndRecurrentTooltip(),this.elasticTextAreas()},this),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("input[name='grossAmount']")),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("input[name='vatAmount']"),12)},onShow:function(){this.generateSenderSelect(),this.form.trigger("additionalOptions:addReceiver:addToAddressBook:change",this.form),this.vatAmountChanged(this.form),this.form.trigger("deliveryTime:change",this.form)},selectedAccountHasChanged:function(e){a.invalidateSplitSelectFromAccount(e),a.checkIsVatExceeded(e,e.fields.amount.getValue().vatAmount,e.fields.amount.getValue().grossAmount,e.fields.fromAccount.getValue(),e.model.attributes.availableFromAccounts)},getFormRules:function(){function e(){var e=t.form.getValue(),a=($.trim(e.toAccount).match(/^([A-Z]{2})/i)||null,{});a["amount:grossAmount"]=["requiredMany","amountFilter","amountAddZero",{name:"amount",params:["PLN",!1,!1]}],a["amount:vatAmount"]=["requiredMany","amountFilter","amountAddZero",{name:"maxAmount",params:[9999999999.99]},{name:"remote",params:[i.splitVatAmount,t.form]}],a.toAccount=["required","trim"],a.toAccount.push({name:"remote",params:[i.removePLCountryCode]}),a.toAccount.push("accountNRBnotAbroad"),a.toAccount.push("accountNRB"),a["title:invoiceNumber"]=["requiredMany","elixir","trim",{name:"maxLength",params:[35]},{name:"remote",params:[i.splitInvoiceNumber]}],a["title:title"]=["requiredMany","elixir","trim",{name:"maxLength",params:[33]},{name:"remote",params:[i.splitTitle]}],a["address:street"]=["elixir"],a["address:city"]=["elixir"];var r={N:["required","trim","nip"],O:["required","elixir","trim",{name:"maxLength",params:[14]},{name:"remote",params:[i.splitIdNumber]}]};return r.hasOwnProperty(e.idType.type)&&(a["idType:series"]=r[e.idType.type]),t.model.get("currentDateMockingEnabled")?a.date=["required",{name:"remote",params:[i.checkDateFormat]}]:a.date=["required",{name:"remote",params:[i.checkDateFormat]},"dateNotPast"],e.additionalOptions.sendConfirmation&&(a["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),a}var t=this;return e},updateSenderData:function(){""!==this.form.$(".row-idType input[name=series]").val()&&this.$el.find("#idTypeSeries").blur()},setupBindings:function(){var e=this;e.bindOnBlurValidation(["idType:series","amount:grossAmount","amount:vatAmount","title:invoiceNumber","title:title","toAccount","date","additionalOptions:sendConfirmationOptions:item","address:street","address:city"]),this.bindTo(this.form,"fromAccount:change",this.selectedAccountHasChanged,this),this.bindTo(this.form,"idType:type:change",this.updateSenderData,this),this.bindTo(this.form,"amount:vatAmount:blur",this.vatAmountChanged,this),this.bindTo(this.form,"amount:grossAmount:blur",function(e){a.checkIsVatExceeded(e,e.fields.amount.getValue().vatAmount,e.fields.amount.getValue().grossAmount,e.fields.fromAccount.getValue(),e.model.attributes.availableFromAccounts),""!==e.$("input[name=vatAmount]").val()&&this.$el.find("#vatAmount").blur()},this),this.bindTo(this.form,"deliveryTime:change",_.debounce(function(e){var t=this,a=e.fields.additionalOptions.editor.form.fields,n=(a.sendConfirmation,a.sendConfirmationOptions,e.fields.date.$el.find(".date-picker-replacer")),i=e.fields.additionalOptions.$el.find(".header:first"),o=this.model.toJSON(),s=e.getValue("fromAccount"),d=!1,c=_.find(o.availableFromAccounts,function(e){return e.number==s});c&&(d=c.isCreditCard),i.find("label").css("position","relative"),"elixir"===e.getValue(["deliveryTime"])?(o.deactivateDateField||d||t.enableDatepicker(n),e.getValue().isSeriesOfTransfers||e.getValue().isRepeatableTransfer?t.model.set("canAddToBasketDT",!1):t.model.set("canAddToBasketDT",!0),void 0!=o.additionalOptions&&(o.additionalOptions.sendConfirmation=!1)):_.contains(["express","sorbnet"],e.getValue(["deliveryTime"]))&&(t.setCurrentDateAndDisableDatepicker(n),t.model.set("canAddToBasketDT",!1),"express"===e.getValue(["deliveryTime"])&&void 0!=o.additionalOptions&&(o.additionalOptions.sendConfirmation=!1)),t.toggleAddToBasket(e),t.toggleChangeAccountFeeForDomesticForm(e),l.userTypeSelect=e.getValue(["deliveryTime"]),t.toggleBlockResourcesForDomesticForm(t.form),1==t.formLoaded&&(Valid.validateField(this.form,"title",this.form.fields.title),Valid.validateField(this.form,"deliveryTime",this.form.fields.deliveryTime));var u=e.getField("deliveryTime").getValue();r.validateLiveSearch(u),e.trigger("additionalOptions:change",e)},100)),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(t){e.toggleEmailFields(t)}),this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e){var t=e.fields.additionalOptions,a=this,r=t.getValue().addReceiver;r.addToAddressBook?(a.model.set("canAddToBasket",!1),a.toggleAddToBasket(e)):"undefined"!=typeof r.addToAddressBook&&(a.model.set("canAddToBasket",!0),a.toggleAddToBasket(e))},this),this.bindToWithValidityCheck(this.form,"toAccount:blur amount:grossAmount:blur fromAccount:change date:change currencies:change",this.checkEnableTransferTypes,this,["amount:grossAmount","toAccount"]),this.on("close",function(){window.form&&delete window.form,this.form&&(this.form.close(),delete this.form)})},vatAmountChanged:function(e){a.checkIsVatExceeded(e,e.fields.amount.getValue().vatAmount,e.fields.amount.getValue().grossAmount,e.fields.fromAccount.getValue(),e.model.attributes.availableFromAccounts)},enableTransferTypes:function(e){var t=this,a=t.form.fields.deliveryTime,r=a.getValue();a.$(".radio-panel").hide(),_.each(e,function(e){a.$("[value="+e+"]").closest(".radio-panel").show()}),a.$(".radio-panel").removeClass("selected").find(".radio-wrapper").removeClass("checked");var n;_.indexOf(e,r)==-1?(this.form.setValue({deliveryTime:e[0]}),n=a.$("[value="+e[0]+"]")):(this.form.setValue({deliveryTime:r}),n=a.$("[value="+r+"]")),n&&(n.parent().addClass("checked"),n.parents(".radio-panel").addClass("selected"),this.form.trigger("deliveryTime:change",this.form))},checkEnableTransferTypes:function(e){var t,a=this,r=a.model.get("lastCheckedValues"),n=new $.Deferred;$(".row-available-currency").is(":visible")?a.$el.find("#form-select-currency-amount").val():a.$el.find(".row-currency span").text();if(this.checkServicePromise&&"pending"===this.checkServicePromise.state())return this.checkServicePromise;a.checkServicePromise=n.promise(),a.transferModeCheckVisibility();var i=a.form.getValue();i.toAccount=i.toAccount.replace(/\s/g,"");var s=this.model.get("useCache"),d=new o,c={},u=["fromAccount","toAccount","date","currencies","amount","isDefined","isTrusted"],m=0;_.each(u,function(e){(!s||"date"==e&&i[e]-r[e]!=0||"date"!=e&&i[e]&&i[e]!==r[e])&&(c[e]=i[e],r[e]=i[e],m++)}),void 0==c.currencies&&(t=a.model.get("currency")),a.form.getValue().isSeriesOfTransfers||a.form.getValue().isRepeatableTransfer?c.showOwnMessage=!1:c.showOwnMessage=!0,a.model.set("lastCheckedValues",r);var p=this.form.getField("deliveryTime").$el.find("input[value=sepa]").length>0;if(c.currency=c.currencies,m>0){for(var f=this.form.model.get("availableFromAccounts"),h=0;h<f.length;h++){
var b=f[h];if(b.number===c.fromAccount){c.accountParams=b.accountParams;break}}d.fetch({loaderParent:null,data:c,success:function(){if("undefined"!=typeof a.form){var e=d.toJSON();if(e.available.transferModes&&_.isArray(e.available.transferModes.modes)){var t={};e.available.transferModes.modes.map(function(e){t[e.name]=e}),e.available.transferModes=t}if(e.available.calendar){var r=a.model.get("calendar");r.minDate=e.available.calendar.minDate,r.maxDate=e.available.calendar.maxDate,a.model.set("calendar",r)}e.available.isGlobusTransferOffHours&&(a.setDateToNextWorkingDay(),a.showNextWorkingDayInfo(),a.blockFundsForFutureTransfer(!0)),a.model.set("canAddToBasket",e.available.showAddToBasket),a.model.set("BIC",e.available.accountVerifyInfo.bic),a.form.fields.BIC.setValue(e.available.accountVerifyInfo.bic);var i=a.prepareDataForTransferModes(e.available.transferModes);a.form&&a.form.fields.deliveryTime.editor.$el.find("input:checked").length&&a.model.set("deliveryTime",[a.form.fields.deliveryTime.editor.$el.find("input:checked").val()]),a.form.fields.deliveryTime.editor.setOptions(i),a.transferModeCheckVisibility(i);var o=e.available.deliveryTime[0],s=a.model.get("deliveryTime")[0],l=_.contains(e.available.deliveryTime,"sepa")&&!p?"sepa":_.contains(e.available.deliveryTime,s)?s:o;a.form.fields.deliveryTime.editor.setValue(l),!Ebre.Entity.isSK()&&s!=l&&a.checkDomesticFromSubmitButton&&(e.available.modalBeforeSend={messageKey:"transfer.modal.transferTypeChanged",messageType:"info"}),a.checkDomesticFromSubmitButton=null,a.styleRadioPanels(),a.enableTransferTypes(e.available.deliveryTime);var c=e.available.transferModes,u={};_.each(c,function(t){null!=t&&_.contains(e.available.deliveryTime,t.name)&&(u[t.name]=c[t.name])}),a.form.fields.deliveryTimeUpdate.setValue(u),a.model.set("transferModes",u),a.tooltip(),a.checkSender(e.available.accountCoowners),a.form.fields.isFutureDate.setValue(e.available.accountVerifyInfo.isFutureDate||e.available.isGlobusTransferOffHours),a.toggleBlockResourcesForDomesticForm(a.form),a.rememberFormTypeChangeSuggestion(e),a.rememberModalMessage(e),a.model.set("deactivateDateField",e.available.deactivateDateField),a.checkCreditCard(),n.resolve(e),e.available.isGlobusTransferOffHours&&a.checkEnableTransferTypes()}},fail:function(e){n.reject();var t=$.parseJSON(e.responseText),r=["paym_SameAccount","paym_NoCurrencyTransferFromCreditCard","paym_InvalidAccountNo","addr_WrongIbanLenght"];if(_.contains(r,t.code)){var o=i.fromAccount+"|"+i.toAccount,s=null==t.title||""==t.title?t.message:t.title;l.accounts.invalidCouples[o]=!0,l.accounts.sameAccountsErrorText=s;var d=a.form.fields.toAccount.$el;d.addClass("validation error").removeClass("success"),d.find(".validation-text").text(s)}}})}else n.resolve();return a.checkServicePromise},checkSender:function(e){var t=this.model.toJSON(),a=this.form.getValue(),r=a.fromAccount,n=t.availableFromAccounts,i=(this.form.fields.sender,_.find(n,function(e){return r===e.number}));if(i){var o=e;i.coowners=o.coowners,i.activeCoownerId=o.activeCoownerId,"mobile"!=this.model.get("formType")&&"facebook"!=this.model.get("formType")&&this.generateSenderSelect()}},toggleBlockResourcesForDomesticForm:function(e){var t=e.getValue(),a=e.getField("additionalOptions.blockResources"),r=1==t.isFutureDate;r?a.$el.toggle(!0):(a.$el.toggle(!1),a.editor.setValue(!1),a.$("span").removeClass("checked"))},checkOnSubmit:function(){return this.checkDomesticFromSubmitButton=!0,this.checkEnableTransferTypes()},transferModeCheckVisibility:function(e){var t=this.form,a=!1,r=!1,n=t.fields.date.editor.$el.parents(".fields").find(".validation-icon");a||r||"undefined"!=typeof e&&(null===e||!e.length)?(n.hide(),t.fields.deliveryTime.$el.hide()):(n.show(),Ebre.Entity.isSK()||t.fields.deliveryTime.$el.show())},blockFundsForFutureTransfer:function(e){var t=this,a=t.form.fields.additionalOptions.editor.form.fields.blockResources;a.editor.setValue(e),1==e?(a.$el.find("span").addClass("checked"),a.$el.show()):(a.$el.find("span").removeClass("checked"),a.$el.hide())},setDateToNextWorkingDay:function(){var e=this,t=e.getNextWorkingDay(e.form.fields.date.getValue());e.form.fields.date.setValue(t)},showNextWorkingDayInfo:function(){var e=this;e.$el.find(".row-date").removeClass("error").removeClass("success").addClass("validation").addClass("info"),e.$el.find(".row-date .validation-text").text(I18n.t("transfer.forms.validation.dateChanged"))},getNextWorkingDay:function(e){var t=this,a=e,r=-1,n=t.model.get("calendar");do{a.setDate(a.getDate()+1);do r++;while(r<n.unavailableDates.length&&n.unavailableDates[r].getTime()<a.getTime())}while(r<n.unavailableDates.length&&n.unavailableDates[r].getTime()===a.getTime());return a.getTime()>n.maxDate.getTime()?n.unavailableDates.length&&n.unavailableDates[n.unavailableDates.length-1].getTime()!==n.maxDate.getTime()?n.maxDate:t.getLastWorkingDayBefore(n.maxDate):a},getLastWorkingDayBefore:function(e){var t=this,a=t.model.get("calendar"),r=e,n=a.unavailableDates.length;do{r.setDate(r.getDate()-1);do n--;while(n>=0&&a.unavailableDates[n].getTime()>r.getTime())}while(n>=0&&a.unavailableDates[n].getTime()===r.getTime());return r},toggleEmailFields:function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;e.getValue().isSeriesOfTransfers||e.getValue().isRepeatableTransfer||(a.getValue()?r.$el.slideDown():r.$el.slideUp())},toggleChangeAccountFeeForDomesticForm:function(e){var t=e.getField("additionalOptions.changeAccountFee.checkbox"),a=_.contains(["swift_sha","swift_own"],e.getValue(["deliveryTime"]))&&!(e.getValue("isSeriesOfTransfers")||e.getValue("isRepeatableTransfer"));a?(e.$el.find(".row-change-account-fee").show(),t.$el.toggle(!0)):(e.$el.find(".row-change-account-fee").hide(),t.$el.toggle(!1),t.$("span").removeClass("checked"),t.setValue(!1),e.trigger("additionalOptions:changeAccountFee:checkbox:change",e),e.$(".change-account-fee").hide())}});return d}),define("transfer/js/views/forms/schemes/domestic_cz-schema",["./domestic-schema"],function(e){function t(t){var a=e.getSchema(t);return a.seriesOfTransfers={type:"Hidden"},a.additionalOptions.subSchema.sendConfirmation={type:"Hidden"},a.deliveryTime.fieldClass="row-delivery-time",a.date.template="deliveryTimeDateCZSK",a.title.editorAttrs.maxlength=105,a.address.subSchema=_.extend(a.address.subSchema,{receiverCountryCode:{type:"Select",editorClass:"chzn-select select-mini long",template:"fieldsRowWithoutHeader",options:[],editorAttrs:{id:"countries","data-placeholder":I18n.t("transfer.domestic.placeholders.country")}}}),schema=_.extend(a,{symbols:{type:"MultipleFields",template:"fieldsRowWithoutHeader",subSchema:{KS:{title:I18n.t("transfer.domestic.placeholders.symbcon"),template:"field",editorAttrs:{maxlength:4}},VS:{title:I18n.t("transfer.domestic.placeholders.symbvar"),template:"field",editorAttrs:{maxlength:10}},SS:{title:I18n.t("transfer.domestic.placeholders.symbspc"),template:"field",editorAttrs:{maxlength:10}}}},referenceSymbol:{title:I18n.t("transfer.domestic.referenceSymbol"),template:"field",editorClass:"long",editorAttrs:{id:"referenceSymbol",maxlength:35}},pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets[0];a.splice(a.indexOf("title")+1,0,"pep"),a.splice(a.indexOf("currencies")+1,0,"symbols"),a.splice(a.indexOf("symbols")+1,0,"referenceSymbol");var r=a;return{fieldsets:[r],getSchema:t}}),define("transfer/js/views/forms/domestic_cz",["./_generic","./domestic","./schemes/domestic_cz-schema","../../models/transfer-wizard","../../logic/local-validators","../../logic/livesearch-common"],function(e,t,a,r,n,i){var o={incomeSourceDict:[],paymentPurposeDict:[],sepaCountries:[],enablePEP:null,accounts:{invalidCouples:{}}},s=t.extend({getRules:function(){function e(){function e(){var e=$.trim(a.toAccount.replace(/\s/g,""));return/^([0-9]{0,6}-{1}|)([0-9]{1,10})\/([0-9]{4})$/.test(e)}if("undefined"==typeof t.form)return{};var a=t.form.getValue(),r=a.toAccount.match(/^([A-Z]{2})/i)||null,i={};if(i.amount=["required",{name:"amount",params:[t.form.getValue().currencies,!1,!1]}],i.toAccount=["required"],e())i.toAccount.push({name:"remote",params:[n.formatBbanCzPrefix]}),i.toAccount.push("accountBbanCZ"),t.validationFromSubmitButton&&i.toAccount.push({name:"remote",params:[n.forbidBbanCzTransferInForeignCurrency,t.form]});else if(r&&r.length){var o=_.contains(t.model.get("EOGCountries"),r[0].toUpperCase());i.toAccount.push({name:"accountNRBabroad",params:[r[0],o,!0]}),i.toAccount.push({name:"remote",params:[n.forbidIbanForSeriesAndRepeatable,t.form]})}return a.isSeriesOfTransfers&&(i["seriesOfTransfers:{d}:amount"]=["required",{name:"amount",params:[a.currency,!1,!1]}],i["seriesOfTransfers:{d}:title"]=["required","elixir",{name:"maxLength",params:[105]},"trim"]),a.isRepeatableTransfer&&(i["repeatableTransfer:repeatRow:value"]=["required",{name:"integerRange",params:"d"===a.repeatableTransfer.repeatRow.period?[7,360]:[1,99]}]),a.additionalOptions.sendConfirmation&&(i["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),i.date=["required",{name:"remote",params:[n.checkDateFormat]},"dateNotPast"],i.title=["required","trim"],i.title.push({name:"remote",params:[n.stripSlashes]}),i.title.push("certis"),i.title.push({name:"maxLength",params:[105]}),i["symbols:KS"]=["digits"],i["symbols:VS"]=["digits"],i["symbols:SS"]=["digits"],i.referenceSymbol=[{name:"filterInternationalChars",params:[!0]},{name:"remote",params:[n.stripSlashes]}],$(".row-pep").is(":visible")&&(i["pep:purposes"]=["required"],i["pep:incsour"]=["required"]),i}var t=this;return e},initialize:function(){var e=this;t.prototype.initialize.apply(this,_.toArray(arguments)),this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(t){e.validator.validateField(this.form,"pep:incsour",t.getField("pep.incsour")),e.validator.validateField(this.form,"pep:purposes",t.getField("pep.purposes"))}),this.bindTo(this.form,"toAccount:change",function(t,a){e.handleFormElementsHideabilityForCZSK(!1)}),this.bindOnBlurValidation(["toAccount","date","symbols:KS","symbols:VS","symbols:SS","referenceSymbol"]),o.paymentPurposeDict=this.model.get("paymentPurposeDict"),o.incomeSourceDict=this.model.get("incomeSourceDict"),o.enablePEP=this.model.get("enablePEP"),o.sepaCountries=this.model.get("sepaReceiverCountries").length?this.model.get("sepaReceiverCountries"):o.sepaCountries,this.setIncomeSource(o.incomeSourceDict),this.setPaymentPurpose(o.paymentPurposeDict),this.checkToEnablePep(e.form),this.initPasteCZBBANformat(),this.setSepaCountries(o.sepaCountries),this.model.get("isDefined")&&e.handleSymbolAndReferenceHideability(!1)},onRender:function(){t.prototype.onRender.apply(this,_.toArray(arguments)),this.handleSymbolAndReferenceHideability(!0),this.bindTo(this,"effects:done",function(){this.chosen(),this.initExpandableFields(),i.isFormLocked()||this.initFocusedPlaceholders(this.$el.find("#toAccount"),!0)},this)},onShow:function(){var e=this;t.prototype.onShow.apply(this,_.toArray(arguments)),_.defer(function(){e.handleAdditionalOptionsIfEmpty()})},getFormSchema:function(){return a.getSchema({calendar:this.model.get("calendar"),unavailableDates:this.model.get("calendar").unavailableDates,itemsLimit:this.model.get("itemsLimit"),availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableFromAccountsForFees:this.getFormAccount(this.model.get("availableFromAccounts"),!0),soPeriodTypes:this.getPeriodTypes(this.model.get("soPeriodTypes")),isDefined:this.model.get("isDefined"),transferModes:this.prepareDataForTransferModes(this.model.get("transferModes")),isTrusted:this.model.get("isTrusted"),performed:!!this.model.get("performed"),isFromBasket:this.model.get("isFromBasket")})},checkToEnablePep:function(e){var t=this,a=e.fields.amount.getValue().replace(/\s/g,""),r=e.fields.currency.getValue(),n=this.model.get("thresholds");if(void 0!==n&&n.length)var i=_.find(n,function(e,t){return e.id==r}),o=i.name;var s=!!("undefined"!=typeof o&&parseFloat(a)>=parseFloat(o)||this.model.get("enablePEP"));return s?t.form.$(".row-pep").show():(t.form.$(".row-pep").hide(),e.getField("pep").getField("purposes").setValue(""),e.getField("pep").getField("incsour").setValue(""),$("#incsour,#purposes").trigger("liszt:updated")),s},checkSender:function(){var t=this,a=e.prototype.checkSender.apply(this),n=a.pipe(function(e){var a=new $.Deferred;return e?(t.model.set("enablePEP",e.enablePEP),r.get("formLoaded").get("formData").incomeSourceDict=t.model.get("incomeSourceDict"),r.get("formLoaded").get("formData").paymentPurposeDict=t.model.get("paymentPurposeDict"),t.checkToEnablePep(t.form)?(t.form.$(".row-pep").is(":visible")||(t.setIncomeSource(t.model.get("incomeSourceDict")),t.setPaymentPurpose(t.model.get("paymentPurposeDict"))),t.form.$(".row-pep").show(),o.enablePEP=!0,t.validator.validateForm(t.form),a.reject()):(t.form.$(".row-pep").hide(),t.form.fields.pep.getField("purposes").setValue(""),t.form.fields.pep.getField("incsour").setValue(""),o.enablePEP=!1,a.resolve())):a.resolve(),a.promise()});return n},initPasteCZBBANformat:function(){var e=this.form.fields.toAccount.editor.$el,t=/^([0-9]{0,6}-{1}|)([0-9]{1,10})\/([0-9]{4})$/;e.on("paste",function(e){var a=$.trim("undefined"!=typeof e.originalEvent.clipboardData?e.originalEvent.clipboardData.getData("Text"):window.clipboardData.getData("Text"));if(t.test(a)){e.preventDefault();var r=a.match(t);r[1]=r[1].replace("-",""),r[1]=Array(6-String(r[1]).length+1).join("0")+r[1],r[2]=Array(10-String(r[2]).length+1).join("0")+r[2],$(this).val(r[1]+"-"+r[2]+"/"+r[3])}})},checkEnableTransferTypes:function(){var e=this,a=o.incomeSourceDict.length>0&&o.paymentPurposeDict.length>0?[!0]:[!1],n=t.prototype.checkEnableTransferTypes.apply(this,a),i=n.pipe(function(t){var a=new $.Deferred;return t?(t=t.available,r.get("formLoaded").get("formData").incomeSourceDict=e.model.get("incomeSourceDict"),r.get("formLoaded").get("formData").paymentPurposeDict=e.model.get("paymentPurposeDict"),e.checkToEnablePep(e.form)?(e.form.$(".row-pep").is(":visible")||(e.setIncomeSource(e.model.get("incomeSourceDict")),e.setPaymentPurpose(e.model.get("paymentPurposeDict"))),e.form.$(".row-pep").show(),o.enablePEP=!0,e.validator.validateForm(e.form),a.reject()):(e.form.$(".row-pep").hide(),e.form.fields.pep.getField("purposes").setValue(""),e.form.fields.pep.getField("incsour").setValue(""),o.enablePEP=!1,a.resolve())):a.resolve(),a.promise()});return i},getCurrentFormData:function(){var e=s.__super__.getCurrentFormData.call(this);return e.KS=this.form.fields.symbols.getField("KS").getValue(),e.VS=this.form.fields.symbols.getField("VS").getValue(),e.SS=this.form.fields.symbols.getField("SS").getValue(),e}});return s}),define("transfer/js/views/forms/schemes/domestic_sk-schema",["./domestic-schema"],function(e){function t(t){var a=e.getSchema(t);return a.seriesOfTransfers={type:"Hidden"},a.additionalOptions.subSchema.sendConfirmation={type:"Hidden"},a.deliveryTime.fieldClass="row-delivery-time hide",a.date.template="deliveryTimeDateCZSK",a.toAccount.title=I18n.t("transfer.domestic.toAccountIBAN"),a.toAccount._params.tooltip=I18n.t("transfer.domestic.tooltips.toAccountTooltipSK"),a.title.editorAttrs.maxlength=105,a.address.subSchema=_.extend(a.address.subSchema,{receiverCountryCode:{type:"Select",editorClass:"chzn-select select-mini long",template:"fieldsRowWithoutHeader",options:[],editorAttrs:{id:"countries","data-placeholder":I18n.t("transfer.domestic.placeholders.country")}}}),schema=_.extend(a,{symbols:{type:"MultipleFields",template:"fieldsRowWithoutHeader",_params:{expandText:I18n.t("transfer.domestic.symbols.expandSymbols"),collapseText:I18n.t("transfer.domestic.symbols.collapseSymbols")},subSchema:{KS:{title:I18n.t("transfer.domestic.placeholders.symbcon"),template:"field",editorAttrs:{maxlength:4}},VS:{title:I18n.t("transfer.domestic.placeholders.symbvar"),template:"field",editorAttrs:{maxlength:10}},SS:{title:I18n.t("transfer.domestic.placeholders.symbspc"),template:"field",editorAttrs:{maxlength:10}}}},referenceSymbol:{title:I18n.t("transfer.domestic.referenceSymbol"),template:"field",editorClass:"long",editorAttrs:{id:"referenceSymbol",maxlength:35}},pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets[0];a.splice(a.indexOf("title")+1,0,"pep"),a.splice(a.indexOf("currencies")+1,0,"symbols"),a.splice(a.indexOf("symbols")+1,0,"referenceSymbol");var r=a;return{fieldsets:[r],getSchema:t}}),define("transfer/js/views/forms/domestic_sk",["./_generic","./domestic","./schemes/domestic_sk-schema","../../models/transfer-wizard","../../logic/local-validators","../../logic/livesearch-common"],function(e,t,a,r,n,i){var o={incomeSourceDict:[],paymentPurposeDict:[],sepaCountries:[],enablePEP:null,blockedBankAccounts:[],accounts:{invalidCouples:{}}},s=t.extend({getRules:function(){function e(){if("undefined"==typeof t.form)return{};var e=t.form.getValue(),a=e.toAccount.match(/^([A-Z]{2})/i),r={};if(r.amount=["required",{name:"amount",params:[t.form.getValue().currencies,!1,!1]}],r.toAccount=["required",{name:"remote",params:[n.removeDashes]},{name:"remote",params:[n.checkIsSepaBankBlocked,o.blockedBankAccounts]}],""!=e.toAccount&&a&&a.length){var i=_.contains(t.model.get("EOGCountries"),e.toAccount.match(/^([A-Z]{2})/i)[0].toUpperCase());r.toAccount.splice(3,0,{name:"accountNRBabroad",params:[a[0],i,!0]}),r.toAccount.push({name:"remote",params:[n.forbidNotSkIbanForSeriesAndRepeatable,t.form]})}return e.isSeriesOfTransfers&&(r["seriesOfTransfers:{d}:amount"]=["required",{name:"amount",params:[e.currency,!1,!1]}],r["seriesOfTransfers:{d}:title"]=["required","elixir",{name:"maxLength",params:[105]},"trim"]),e.isRepeatableTransfer&&(r["repeatableTransfer:repeatRow:value"]=["required",{name:"integerRange",params:"d"==e.repeatableTransfer.repeatRow.period?[7,360]:[1,99]}]),e.additionalOptions.sendConfirmation&&(r["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),r.date=["required",{name:"remote",params:[n.checkDateFormat]},"dateNotPast"],r.title=["required","trim",{name:"filterInternationalChars",params:[!0]},{name:"remote",params:[n.stripSlashes]},{name:"maxLength",params:[105]}],r["symbols:KS"]=["digits"],r["symbols:VS"]=["digits"],r["symbols:SS"]=["digits"],r.referenceSymbol=[{name:"filterInternationalChars",params:[!0]},{name:"remote",params:[n.stripSlashes]}],$(".row-pep").is(":visible")&&(r["pep:purposes"]=["required"],r["pep:incsour"]=["required"]),r}var t=this;return e},initialize:function(){var e=this;t.prototype.initialize.apply(this,_.toArray(arguments)),this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(t,a){e.validator.validateField(this.form,"pep:incsour",t.getField("pep.incsour")),e.validator.validateField(this.form,"pep:purposes",t.getField("pep.purposes"))}),this.bindTo(this.form,"toAccount:change",function(t,a){e.handleFormElementsHideabilityForCZSK()}),this.bindOnBlurValidation(["toAccount","date","symbols:KS","symbols:VS","symbols:SS","referenceSymbol"]),o.paymentPurposeDict=this.model.get("paymentPurposeDict"),o.incomeSourceDict=this.model.get("incomeSourceDict"),o.sepaCountries=this.model.get("sepaReceiverCountries").length?this.model.get("sepaReceiverCountries"):o.sepaCountries,o.enablePEP=this.model.get("enablePEP"),this.setIncomeSource(o.incomeSourceDict),this.setPaymentPurpose(o.paymentPurposeDict),this.checkToEnablePep(e.form),this.setSepaCountries(o.sepaCountries),this.model.get("isDefined")&&e.handleSymbolAndReferenceHideability(!1)},onRender:function(){t.prototype.onRender.apply(this,_.toArray(arguments)),this.handleSymbolAndReferenceHideability(!0),this.bindTo(this,"effects:done",function(){this.chosen(),this.handleAddressHideability(),i.isFormLocked()||this.initFocusedPlaceholders($("input#toAccount"),!0)})},getFormSchema:function(){return a.getSchema({calendar:this.model.get("calendar"),unavailableDates:this.model.get("calendar").unavailableDates,itemsLimit:this.model.get("itemsLimit"),availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableFromAccountsForFees:this.getFormAccount(this.model.get("availableFromAccounts"),!0),soPeriodTypes:this.getPeriodTypes(this.model.get("soPeriodTypes")),isDefined:this.model.get("isDefined"),transferModes:this.prepareDataForTransferModes(this.model.get("transferModes")),isTrusted:this.model.get("isTrusted"),performed:!!this.model.get("performed"),isFromBasket:this.model.get("isFromBasket")})},checkToEnablePep:function(e){var t=this,a=(e.fields.amount.getValue().replace(/\s/g,""),e.fields.currency.getValue()),r=this.model.get("thresholds");if(void 0!==r&&r.length){var n=_.find(r,function(e,t){return e.id==a});n.name}var i=!!this.model.get("enablePEP");return i?t.form.$(".row-pep").show():(t.form.$(".row-pep").hide(),e.getField("pep").getField("purposes").setValue(""),e.getField("pep").getField("incsour").setValue(""),$("#incsour,#purposes").trigger("liszt:updated")),i},checkSender:function(){thisView=this;var t=e.prototype.checkSender.apply(this);return checkSenderDeferrerCZSK=t.pipe(function(e){var t=new $.Deferred;return e?(thisView.model.set("enablePEP",e.enablePEP),r.get("formLoaded").get("formData").incomeSourceDict=thisView.model.get("incomeSourceDict"),r.get("formLoaded").get("formData").paymentPurposeDict=thisView.model.get("paymentPurposeDict"),thisView.checkToEnablePep(thisView.form)?(thisView.form.$(".row-pep").is(":visible")||(thisView.setIncomeSource(thisView.model.get("incomeSourceDict")),thisView.setPaymentPurpose(thisView.model.get("paymentPurposeDict"))),thisView.form.$(".row-pep").show(),o.enablePEP=!0,thisView.validator.validateForm(thisView.form),t.reject()):(thisView.form.$(".row-pep").hide(),thisView.form.fields.pep.getField("purposes").setValue(""),thisView.form.fields.pep.getField("incsour").setValue(""),o.enablePEP=!1,t.resolve())):t.resolve(),t.promise()}),checkSenderDeferrerCZSK},checkEnableTransferTypes:function(){thisView=this;var e=o.incomeSourceDict.length>0&&o.paymentPurposeDict.length>0?[!0]:[!1],a=t.prototype.checkEnableTransferTypes.apply(this,e);return checkDomesticDeferrerCZSK=a.pipe(function(e){var t=new $.Deferred;return e?(e=e.available,r.get("formLoaded").get("formData").incomeSourceDict=thisView.model.get("incomeSourceDict"),r.get("formLoaded").get("formData").paymentPurposeDict=thisView.model.get("paymentPurposeDict"),e.accountVerifyInfo.blockFlag||!e.accountVerifyInfo.isSEPAAvailable?(o.blockedBankAccounts.push(thisView.form.getValue("toAccount")),o.blockedBankAccounts=_.uniq(o.blockedBankAccounts)):o.blockedBankAccounts=_.without(o.blockedBankAccounts,thisView.form.getValue("toAccount")),thisView.validator.validateField(thisView.form,"toAccount",thisView.form.fields.toAccount),thisView.checkToEnablePep(thisView.form)?(thisView.form.$(".row-pep").is(":visible")||(thisView.setIncomeSource(thisView.model.get("incomeSourceDict")),thisView.setPaymentPurpose(thisView.model.get("paymentPurposeDict"))),thisView.form.$(".row-pep").show(),o.enablePEP=!0,thisView.validator.validateForm(thisView.form),t.reject()):(thisView.form.$(".row-pep").hide(),thisView.form.fields.pep.getField("purposes").setValue(""),thisView.form.fields.pep.getField("incsour").setValue(""),o.enablePEP=!1,t.resolve())):t.resolve(),t.promise()}),checkDomesticDeferrerCZSK},getCurrentFormData:function(){var e=s.__super__.getCurrentFormData.call(this);return e.KS=this.form.fields.symbols.getField("KS").getValue(),e.VS=this.form.fields.symbols.getField("VS").getValue(),e.SS=this.form.fields.symbols.getField("SS").getValue(),e},handleAddressHideability:function(){""==this.form.getField("address").getField("street").getValue()&&""==this.form.getField("address").getField("city").getValue()||(this.$el.find(".address-expander span.btn-mini").addClass("expanded").text("-"),this.$el.find("#addressExpanderLabel").text(I18n.t("transfer.hideAddress")),this.$el.find(".row-address").show())}});return s}),define("transfer/js/views/forms/schemes/facebook-schema",[],function(){function e(e){return{templateId:{type:"Hidden"},isDefined:{type:"Hidden"},recipientName:{type:"Hidden"},recipientId:{type:"Hidden"},p2pName:{type:"Hidden"},p2pId:{type:"Hidden"},formType:{type:"Hidden"},amount:{title:I18n.t("transfer.facebook.amount"),template:"amount",editorAttrs:{id:"amount"}},currency:{type:"SimpleTextValue",template:"fieldAlone",fieldClass:"row-currency"},title:{title:I18n.t("transfer.facebook.title"),type:"TextArea",editorClass:"extralong single-row expanding",editorAttrs:{maxlength:140}},fromAccount:{title:I18n.t("transfer.facebook.fromAccount"),options:e.fromAccountOptions,type:"Select",editorClass:"beautify-select select-long"},addToAddressBook:{type:"Checkbox",title:e.isTransferDefined?I18n.t("transfer.p2p.checkboxes.addTemplate"):I18n.t("transfer.p2p.checkboxes.addToAddressBook"),template:"standaloneCheckbox",_params:{tooltip:e.isTransferDefined?I18n.t("transfer.p2p.checkboxes.addTemplateTooltip"):""}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.buttons.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},cancel:{text:I18n.t("transfer.buttons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["templateId","isDefined","recipientName","recipientId","p2pName","p2pId","amount","currency","title","fromAccount","addToAddressBook","submitButtons"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/views/forms/facebook",["./_generic","./schemes/facebook-schema","../dialogs/facebook-settings-warning","../../app"],function(e,t,a,r){var n=e.extend({tagName:"section",className:"form-view",events:function(){return _.extend({},e.prototype.events,{"focus textarea.single-row.expanding":"elasticTextAreas"})},getFormSchema:function(){return t.getSchema({isTransferDefined:this.model.get("isDefined"),fromAccountOptions:this.getFormAccount(this.model.get("availableFromAccounts"))})},getDefaults:function(){var e=this.model.toJSON();return e.recipientName=e.recipientName||"FacebookRecipientName",e.title=e.title||I18n.t("transfer.facebook.defaultTitle"),e},getRules:function(){function e(){var e={};return e.amount=["required",{name:"amount",params:[t.form.getValue().currencies,!1,!1]},{name:"maxAmount",params:[r,a.get("currency")]}],e.title=["trim","elixir","not_empty",{name:"maxLength",params:[140]}],e}var t=this,a=this.model,r=this.model.get("amountLimit");return e},initialize:function(){var n=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","facebook");var i=Backbone.Model.extend({schema:n.getFormSchema(),defaults:n.getDefaults(),rules:n.getRules()}),o=new i,s=new Backbone.Form({model:o,fieldsets:t.fieldsets});this.form=s,n.bindOnBlurValidation(["amount","title"]),this.bindTo(this.form,"fromAccount:change",function(e,t){var a=this;a.checkSender()});var l=this.model,d=new $.Deferred,c=new $.Deferred;n.checkServicePromise=c.promise(),r.getP2PAppData(d.resolve),d.done(function(e){if(e.installed)c.resolve();else{var t=new a({model:new Backbone.Model({amountLimit:l.get("amountLimit"),cancelEvent:"transfer:new",cancelEventData:{transferType:"base",recipientName:l.get("p2pName"),definedRecipientId:l.get("recipientId")}})});t.render(),t.$el.hide(),$("#transfer-container").append(t.$el),t.$el.fadeIn(200),c.reject()}}),s.render(),n.preventSubmitByEnterOnTouchDevices(s)},onRender:function(){this.$el.find("#form-container").html(this.form.el),this.bindTo(this,"effects:done",function(){this.styleSelects(),this.styleCheckbox(),this.setFocusOnInput("amount",""),this.tooltip()}),this.bindTo(this,"fading:done",function(){this.elasticTextAreas(),this.$el.find("input:not([autocomplete]):visible:first").trigger("focus")},this),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#amount"))}});return n}),define("transfer/js/views/forms/schemes/facebook_czsk-schema",["./facebook-schema"],function(e){function t(t){var a=e.getSchema(t);return a.title.editorAttrs.maxlength=105,schema=_.extend(a,{pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets[0],r=a.splice(a.indexOf("fromAccount")+1,0,"pep");return{fieldsets:[r],getSchema:t}}),define("transfer/js/models/nmb-transfer-p2p-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.P2PCheckService(a)}});return e}),define("transfer/js/views/forms/facebook_czsk",["./facebook","./schemes/facebook_czsk-schema",nmbPaths.global.js+"validator","../../models/nmb-transfer-p2p-check-service","../../models/transfer-wizard"],function(e,t,a,r,n){var i=e.extend({getFormSchema:function(){return t.getSchema({isTransferDefined:this.model.get("isDefined"),fromAccountOptions:this.getFormAccount(this.model.get("availableFromAccounts"))})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(e,t){a.validateField(this.form,"pep:incsour",e.getField("pep.incsour")),a.validateField(this.form,"pep:purposes",e.getField("pep.purposes"))}),this.bindTo(this.form,"fromAccount:change",this.checkP2P);var r=this.form.model.constructor.prototype.rules();this.form.model.constructor.prototype.rules=function(){return r.title=["trim",Ebre.Entity.isCZ()===!0?"certis":"sips","not_empty",{name:"maxLength",params:[105]}],t.form.$(".row-pep").is(":visible")?(r["pep:purposes"]=["required"],r["pep:incsour"]=["required"]):(r["pep:purposes"]=[],r["pep:incsour"]=[]),r};var n=this.model.get("incomeSourceDict").length>0&&this.model.get("paymentPurposeDict").length>0;this.model.set("pepListsLoaded",n),this.activatePEPFields(this.model.get("showPEP"))},onRender:function(){e.prototype.onRender.apply(this,_.toArray(arguments)),this.bindTo(this,"effects:done",function(){this.chosen()})},activatePEPFields:function(e){var t=this;e?t.form.$(".row-pep").is(":visible")||(t.form.$(".row-pep").show(),this.model.get("incomeSourceDict").length>0&&this.model.get("paymentPurposeDict").length>0&&(this.setIncomeSource(this.model.get("incomeSourceDict")),this.setPaymentPurpose(this.model.get("paymentPurposeDict")))):t.model.get("showPEP")||(t.form.$(".row-pep").hide(),t.form.getField("pep").getField("purposes").setValue(""),t.form.getField("pep").getField("incsour").setValue(""),
$("#incsour,#purposes").trigger("liszt:updated"))},checkP2P:function(){var e=new $.Deferred,t=this;t.checkServicePromise=e.promise();var a=new r,i=t.form.getValue(),o={pepListsLoaded:t.model.get("pepListsLoaded"),fromAccount:i.fromAccount.replace(/\s/g,"")};return a.fetch({loaderParent:null,data:o,success:function(){var r=a.toJSON();null!=r.incomeSourceDict&&null!=r.paymentPurposeDict&&(t.model.set("incomeSourceDict",r.incomeSourceDict),n.updatePopulatedModel("incomeSourceDict",r.incomeSourceDict),t.model.set("paymentPurposeDict",r.paymentPurposeDict),n.updatePopulatedModel("paymentPurposeDict",r.paymentPurposeDict),t.model.set("pepListsLoaded",!0)),n.updatePopulatedModel("showPEP",r.enablePEP),t.model.set("showPEP",r.enablePEP),t.activatePEPFields(r.enablePEP),e.resolve(r)},fail:function(t){e.reject()}}),t.checkServicePromise}});return i}),define("transfer/js/views/forms/schemes/mobile-schema",[],function(){function e(e){return{p2pTemplateId:{type:"Hidden"},isDefined:{type:"Hidden"},recipientName:{type:"Hidden"},recipientId:{type:"Hidden"},phoneNumber:{type:e.p2pTemplateId?"SimpleTextValue":"Text",title:I18n.t("transfer.mobile.phoneNumber"),editorClass:"shorter",editorAttrs:{maxlength:13}},amount:{title:I18n.t("transfer.mobile.amount"),template:"amount",editorClass:"shorter",editorAttrs:{id:"amount"}},currency:{type:"SimpleTextValue",template:"fieldAloneNoLabel",fieldClass:"row-currency"},title:{title:I18n.t("transfer.mobile.title"),type:"TextArea",editorClass:"extralong single-row expanding",editorAttrs:{maxlength:140}},fromAccount:{title:I18n.t("transfer.mobile.fromAccount"),options:e.fromAccountOptions,type:"Select",editorClass:"beautify-select select-long"},addToAddressBook:{type:e.isMyContact&&!e.p2pTemplateId?"Hidden":"Checkbox",title:e.p2pTemplateId?I18n.t("transfer.p2p.checkboxes.addTemplate"):I18n.t("transfer.p2p.checkboxes.addToAddressBook"),template:"standaloneCheckbox",_params:{tooltip:e.p2pTemplateId?I18n.t("transfer.p2p.checkboxes.addTemplateTooltip"):""}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.buttons.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},cancel:{text:I18n.t("transfer.buttons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["p2pTemplateId","isDefined","recipientName","recipientId","phoneNumber","amount","currency","title","fromAccount","addToAddressBook","submitButtons"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/views/forms/mobile",["./_generic","./schemes/mobile-schema"],function(e,t){var a=e.extend({tagName:"section",className:"form-view",events:function(){return _.extend({},e.prototype.events,{"focus textarea.single-row.expanding":"elasticTextAreas"})},getFormSchema:function(){return t.getSchema({isTransferDefined:this.model.get("isDefined"),p2pTemplateId:this.model.get("p2pTemplateId"),fromAccountOptions:this.getFormAccount(this.model.get("availableFromAccounts")),isMyContact:this.model.get("isMyContact")})},getDefaults:function(){var e=this.model.toJSON();return e.title=e.title||I18n.t("transfer.mobile.defaultTitle"),"undefined"==typeof e.phoneNumber&&"string"==typeof e.p2pTemplateId&&(e.phoneNumber=e.p2pTemplateId),e},getRules:function(){function e(){var e=t.form.getValue(),r={};return r.amount=["required",{name:"amount",params:[t.form.getValue().currencies,!1,!1]},{name:"maxAmount",params:[a,t.model.get("currency")]}],r.title=["trim","elixir","not_empty",{name:"maxLength",params:[140]}],e.isDefined||(r.phoneNumber=["required","phoneNumber"]),r}var t=this,a=this.model.get("amountLimit");return e},initialize:function(){var a=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","mobile");var r=Backbone.Model.extend({schema:a.getFormSchema(),defaults:a.getDefaults(),rules:a.getRules()}),n=new r,i=new Backbone.Form({model:n,fieldsets:t.fieldsets});this.form=i,a.bindOnBlurValidation(["amount","title","phoneNumber"]),this.bindTo(this.form,"fromAccount:change",function(){var e=this;e.checkSender()}),i.render(),a.preventSubmitByEnterOnTouchDevices(i)},onRender:function(){this.bindTo(this,"effects:done",function(){this.$el.find("#form-container").html(this.form.el),this.styleCheckbox(),this.styleSelects(),this.form.model.attributes.recipientName.replace(/[^a-z0-9]/gi,"").length>1&&this.setFocusOnInput(),this.allowOnlyNumbersOnInput(this.form.fields.phoneNumber.$("input"),9),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#amount")),this.tooltip()})}});return a}),define("transfer/js/views/forms/schemes/mobile_czsk-schema",["./mobile-schema"],function(e){function t(t){var a=e.getSchema(t);return a.title.editorAttrs.maxlength=105,Ebre.Entity.isSK()&&(a.phoneNumber.template=t.p2pTemplateId?"SimpleTextPrefixPhone":"TextPrefixPhone",a.phoneNumber._params={prefix:"+421"}),schema=_.extend(a,{pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets[0],r=a.splice(a.indexOf("fromAccount")+1,0,"pep");return{fieldsets:[r],getSchema:t}}),define("transfer/js/views/forms/mobile_czsk",["./mobile","./schemes/mobile_czsk-schema",nmbPaths.global.js+"validator","../../models/nmb-transfer-p2p-check-service","../../models/transfer-wizard"],function(e,t,a,r,n){var i=e.extend({initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(e,t){a.validateField(this.form,"pep:incsour",e.getField("pep.incsour")),a.validateField(this.form,"pep:purposes",e.getField("pep.purposes"))}),this.bindTo(this.form,"fromAccount:change",this.checkP2P);var r=this.form.model.constructor.prototype.rules();r.title=["trim",Ebre.Entity.isCZ()===!0?"certis":"sips","not_empty",{name:"maxLength",params:[105]}],this.form.model.constructor.prototype.rules=function(){return t.form.$(".row-pep").is(":visible")?(r["pep:purposes"]=["required"],r["pep:incsour"]=["required"]):(r["pep:purposes"]=[],r["pep:incsour"]=[]),r};var n=this.model.get("incomeSourceDict").length>0&&this.model.get("paymentPurposeDict").length>0;this.model.set("pepListsLoaded",n),this.activatePEPFields(this.model.get("showPEP"))},getFormSchema:function(){return t.getSchema({isTransferDefined:this.model.get("isDefined"),p2pTemplateId:this.model.get("p2pTemplateId"),fromAccountOptions:this.getFormAccount(this.model.get("availableFromAccounts")),isMyContact:this.model.get("isMyContact")})},onRender:function(){e.prototype.onRender.apply(this,_.toArray(arguments)),this.bindTo(this,"effects:done",function(){this.chosen()})},activatePEPFields:function(e){var t=this;e?t.form.$(".row-pep").is(":visible")||(t.form.$(".row-pep").show(),this.model.get("incomeSourceDict").length>0&&this.model.get("paymentPurposeDict").length>0&&(this.setIncomeSource(this.model.get("incomeSourceDict")),this.setPaymentPurpose(this.model.get("paymentPurposeDict")))):t.model.get("showPEP")||(t.form.$(".row-pep").hide(),t.form.getField("pep").getField("purposes").setValue(""),t.form.getField("pep").getField("incsour").setValue(""),$("#incsour,#purposes").trigger("liszt:updated"))},checkP2P:function(){var e=new $.Deferred,t=this;t.checkServicePromise=e.promise();var a=new r,i=t.form.getValue(),o={pepListsLoaded:t.model.get("pepListsLoaded"),fromAccount:i.fromAccount.replace(/\s/g,"")};return a.fetch({loaderParent:null,data:o,success:function(){var r=a.toJSON();null!=r.incomeSourceDict&&null!=r.paymentPurposeDict&&(t.model.set("incomeSourceDict",r.incomeSourceDict),n.updatePopulatedModel("incomeSourceDict",r.incomeSourceDict),t.model.set("paymentPurposeDict",r.paymentPurposeDict),n.updatePopulatedModel("paymentPurposeDict",r.paymentPurposeDict),t.model.set("pepListsLoaded",!0)),n.updatePopulatedModel("showPEP",r.enablePEP),t.model.set("showPEP",r.enablePEP),t.activatePEPFields(r.enablePEP),e.resolve(r)},fail:function(t){e.reject()}}),t.checkServicePromise}});return i}),define("transfer/js/models/nmb-transfer-cost-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.transfer.getTransferCosts(a)}});return e}),define("transfer/js/models/nmb-own-cost-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.OwnCheckService(a)}});return e}),define("transfer/js/views/forms/schemes/own-schema",[],function(){function e(e){return{addToBasket:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},formType:{type:"Hidden"},fromAccount:{title:I18n.t("transfer.domestic.fromAccount"),type:"Select",editorClass:"beautify-select select-long",options:e.availableFromAccounts,_params:{info:""},editorAttrs:e.isFromBasket?{disabled:"disabled"}:{}},toAccount:{title:I18n.t("transfer.domestic.toAccount"),type:"Select",editorClass:"beautify-select select-long",options:e.availableToAccounts,_params:{info:""},editorAttrs:e.isFromBasket?{disabled:"disabled"}:{"data-placeholder":I18n.t("transfer.forms.chosen.choose")}},amount:{title:I18n.t("transfer.domestic.amount"),template:"amount",editorAttrs:{id:"amount"}},currency:{type:"SimpleTextValue",template:"fieldAloneNoLabel",fieldClass:"row-currency"},currencies:{type:"Select",template:"fieldAlone",fieldClass:"row row-available-currency",editorClass:"beautify-select select-short",editorAttrs:{id:"form-select-currency-amount"},options:[]},title:{title:I18n.t("transfer.domestic.title"),type:"TextArea",fieldClass:"validation",editorClass:"extralong single-row expanding",editorAttrs:{maxlength:140}},date:{type:"uiDateInput",template:"deliveryTimeDateAlone",editorLabelFor:"uiDateInput",title:I18n.t("transfer.domestic.deliveryDate"),editorAttrs:{id:"uiDateInput"},fieldClass:"row-additional-options",editorClass:"style-tab",minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.calendar.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},dateNow:{type:"SimpleDate",template:"noHeader",editorClass:"static-date"},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.abroad.button.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.abroad.button.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=["fromAccount","toAccount","amount","currency","currencies","title","date","dateNow","submitButtons","addToBasket","templateId","recipientName","formType"];return{fieldsets:[t],getSchema:e}}),define("transfer/js/views/forms/own",["./_generic","../../models/nmb-transfer-cost-service","../../models/nmb-own-cost-service","../../models/transfer-wizard","./schemes/own-schema"],function(e,t,a,r,n){var i=e.extend({tagName:"section",className:"form-view",events:function(){return _.extend({},e.prototype.events,{"focus textarea.single-row.expanding":"elasticTextAreas"})},getDefaults:function(){var e=this.model.toJSON();return e},getFormSchema:function(){return n.getSchema({availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableToAccounts:this.getFormAccount(this.model.get("availableToAccounts")),calendar:this.model.get("calendar"),isFromBasket:this.model.get("isFromBasket")})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","own");var a=this.model.get("calendar"),r=[];_.each(a.unavailableDates,function(e){r.push($.datepicker.formatDate("yy/mm/dd",new Date(e)))});var i=Backbone.Model.extend({schema:t.getFormSchema(),defaults:t.getDefaults(),rules:function(){var e={fromAccount:["required"],amount:["required","amountAddZero"],title:["elixir","not_empty",{name:"maxLength",params:[140]}],date:["required"]};return"undefined"!=typeof t.form&&e.amount.push({name:"amount",params:[t.form.getValue().currencies,!1,!1]}),e}}),o=new i;this.form=new Backbone.Form({model:o,fieldsets:n.fieldsets}).render(),this.preventSubmitByEnterOnTouchDevices(this.form),t.bindOnBlurValidation(["fromAccount","amount","currency","availableCurrency","title","date","dateNow"]),window.form=this.form,this.bindTo(this.form,"date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"fromAccount:change",function(e){this.getAvailableToAccounts(e),this.getAvailableCurrencies(e),this.showProperCalendarForAvailableCurrencies(),this.checkCreditCard(),this.toggleAddToBasket(e)}),this.bindTo(this.form,"toAccount:change",function(e){this.getAvailableCurrencies(e),this.showProperCalendarForAvailableCurrencies()}),this.bindTo(this.form,"availableCurrency:change",function(e){e.fields.currency.setValue(e.fields.availableCurrency.getValue())})},getAvailableCurrencies:function(){var e=this,t=form.getValue(),a=_.find(this.model.get("availableFromAccounts"),function(e){return e.number===t.fromAccount})||null,r=_.find(this.model.get("availableToAccounts"),function(e){return e.number===t.toAccount})||null,n=[];a&&n.push(a.currency),r&&n.push(r.currency),n=_.uniq(n),e.model.set("availableCurrency",n),e.model.set("currency",n[0]),e.checkAvailableCurrency(form)},showProperCalendarForAvailableCurrencies:function(){var e=this,t=_.find(e.model.get("availableCurrency"),function(t){return t!=e.model.get("currency")});t?(e.form.getField("date").setValue(form.getField("dateNow").getValue()),$(".row-date").hide(),$(".row-dateNow").show()):(e.form.getField("date").$el.find(".content").html(e.form.getField("date").$("input").val()),$(".row-date").show(),$(".row-dateNow").hide())},getAvailableToAccounts:function(e){var t=this,n=e.getValue(),i={fromAccount:n.fromAccount,toAccount:n.toAccount},o=new a;o.fetch({loaderParent:t.getLoaderParamSelector(),data:i,accountParams:_.find(this.model.get("availableFromAccounts"),function(e){return e.number===n.fromAccount}).accountParams||null,success:function(){var e=o.toJSON(),a=e.availableToAccounts;if(Ebre.Entity.isPL()||Ebre.Entity.isOF()||(t.model.set("enablePEP",e.enablePEP),e.enablePEP&&e.incomeSourceDict.length&&e.paymentPurposeDict.length?(t.setIncomeSource(e.incomeSourceDict),t.model.set("incomeSourceDict",e.incomeSourceDict),t.setPaymentPurpose(e.paymentPurposeDict),t.model.set("paymentPurposeDict",e.paymentPurposeDict),t.form.$(".row-pep").show()):t.form.$(".row-pep").hide(),r.get("formLoaded").get("formData").enablePEP=e.enablePEP,r.get("formLoaded").get("formData").incomeSourceDict=e.incomeSourceDict,r.get("formLoaded").get("formData").paymentPurposeDict=e.paymentPurposeDict),a){var n;null!=_.find(a,function(e){return e.number==i.toAccount})?(t.$(".row-toAccount").removeClass("validation info"),t.$(".row-toAccount .validation-text").text(""),n=i.toAccount):(n=a[_.first(a).number!==i.toAccount?0:1].number,t.$(".row-toAccount").addClass("validation info"),t.$(".row-toAccount .validation-text").text(I18n.t("transfer.forms.validation.toAccountChanged"))),t.model.set("availableToAccounts",a),t.reloadAvailableToAccounts(n),r.updatePopulatedModel("availableToAccounts",a)}}})},reloadAvailableToAccounts:function(e){var t=this.form,a=t.fields.toAccount,r=this.getFormAccount(this.model.get("availableToAccounts"));a.editor.setOptions(r),e&&a.editor.setValue(e),t.fields.toAccount.$el.find("select").trigger("liszt:updated"),t.trigger("toAccount:change",this.form,a)},isStillAvailable:function(e,t){return _.each(t,function(t){if(t.number==e)return!0}),!1},onRender:function(){this.bindTo(this,"effects:done",function(){this.setFocusOnInput("amount",""),this.showProperCalendarForAvailableCurrencies()}),this.$el.find("#form-container").html(this.form.el),this.tooltip(),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.triggerDatepicker(),this.initializeCurrencies(),this.form.trigger("toAccount:change",this.form),this.toggleAddToBasket(this.form),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#amount"))}});return i}),define("transfer/js/views/forms/schemes/own_czsk-schema",["./own-schema"],function(e){function t(t){var a=e.getSchema(t);return a.title.editorAttrs.maxlength=105,schema=_.extend(a,{pep:{title:I18n.t("transfer.domestic.pepLabel"),type:"MultipleFields",template:"pepCZSZ",fieldClass:"row-wrapper",subSchema:{purposes:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"purposes-field",options:[],editorAttrs:{id:"purposes","data-placeholder":I18n.t("transfer.domestic.placeholders.choosePurpose")}},incsour:{type:"Select",editorClass:"chzn-select select-mini",template:"fieldAlone",fieldClass:"incsour-field",options:[],editorAttrs:{id:"incsour","data-placeholder":I18n.t("transfer.domestic.placeholders.chooseIncsour")}}}}}),schema}var a=e.fieldsets[0],r=a.splice(a.indexOf("title")+1,0,"pep");return{fieldsets:[r],getSchema:t}}),define("transfer/js/views/forms/own_czsk",["./own","./schemes/own_czsk-schema",nmbPaths.global.js+"validator"],function(e,t,a){var r={incomeSourceDict:[],paymentPurposeDict:[],enablePEP:""},n=e.extend({events:function(){var t=e.prototype.events.apply(this,_.toArray(arguments));return _.extend({},t,{})},getFormSchema:function(){return t.getSchema({availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableToAccounts:this.getFormAccount(this.model.get("availableToAccounts")),calendar:this.model.get("calendar"),isFromBasket:this.model.get("isFromBasket")})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments));var n=this.form.model.constructor.prototype.rules();if(this.form.model.constructor.prototype.rules=function(){return n.title=[Ebre.Entity.isCZ()===!0?"certis":"sips","not_empty",{name:"maxLength",params:[105]}],t.checkToEnablePep(t.form)?(n["pep:purposes"]=["required"],n["pep:incsour"]=["required"]):(n["pep:purposes"]=[],n["pep:incsour"]=[]),n},this.bindTo(this.form,"pep:purposes:change pep:incsour:change",function(e,t){a.validateField(this.form,"pep:incsour",e.getField("pep.incsour")),a.validateField(this.form,"pep:purposes",e.getField("pep.purposes"))}),this.bindTo(this.form,"amount:blur currencies:change",function(e){var a=t.checkToEnablePep(e);a?t.form.$(".row-pep").show():t.form.$(".row-pep").hide()}),this.model.get("incomeSourceDict").length){r.incomeSourceDict=this.model.get("incomeSourceDict"),this.setIncomeSource(r.incomeSourceDict);var i=this.model.get("activeIncomeSource");i&&t.form.fields.pep.getField("incsour").setValue(i)}if(this.model.get("paymentPurposeDict").length){r.paymentPurposeDict=this.model.get("paymentPurposeDict"),this.setPaymentPurpose(r.paymentPurposeDict);var o=this.model.get("activePaymentPurpose");o&&t.form.fields.pep.getField("purposes").setValue(o)}this.model.get("enablePEP")&&t.form.$(".row-pep").show()},onRender:function(){thisView=this,e.prototype.onRender.apply(this,_.toArray(arguments)),thisView.form.$(".row-pep").toggle(thisView.checkToEnablePep(thisView.form)),this.bindTo(this,"effects:done",function(){this.chosen()})},checkToEnablePep:function(e){var t=this,a=e.fields.amount.getValue().replace(/\s/g,""),r=e.fields.currency.getValue();if(this.model.get("thresholds").length)var n=_.find(this.model.get("thresholds"),function(e,t){return e.id==r}),i=n.name;var o=!!("undefined"!=typeof i&&parseFloat(a)>=parseFloat(i)&&!Ebre.Entity.isSK()||this.model.get("enablePEP"));return o?t.form.$(".row-pep").show():(t.form.$(".row-pep").hide(),e.getField("pep").getField("purposes").setValue(""),e.getField("pep").getField("incsour").setValue(""),$("#incsour,#purposes").trigger("liszt:updated")),o}});return n}),define("transfer/js/views/forms/schemes/us-schema",[],function(){function e(e){var t={type:"Hidden",subSchema:{taskId:{type:"Hidden"},redirectedFromAutomaticTaxPaymentTask:{type:"Hidden"},taxType:{type:"Hidden"}}},a={type:"Hidden",subSchema:{taskId:{type:"Hidden"},redirectedFromAutomaticTaxPaymentTask:{type:"Hidden"},taxType:{type:"Hidden"}}};return e.isTransferDefined?t:a}function t(e){var t={title:I18n.t("transfer.us.taxAuthoritySymbol.title"),type:"MultipleFields",subSchema:{authoritySymbol:{type:"MultipleFields",template:"fieldAloneNoLabel",subSchema:{symbol:{type:"SimpleTextValue",template:"fieldAloneNoLabel"},toAnother:{type:"Hidden"}}},authorityCity:{type:"MultipleFields",template:"fieldAloneNoLabel",subSchema:{city:{type:"Hidden"}}},authorityName:{type:"MultipleFields",template:"fieldAloneNoLabel",subSchema:{label:{type:"SimpleTextValue",template:"fieldAloneNoLabel"},name:{type:"Hidden"}}},account:{type:"SimpleTextValue",template:"fieldAloneNoLabel"}}},a={type:"MultipleFields",template:"fieldAloneNoLabel",subSchema:{authoritySymbol:{title:I18n.t("transfer.us.taxAuthoritySymbol.title"),type:"MultipleFields",template:"fieldsPanelWithHeader",fieldClass:"row-tax-office-symbol",subSchema:{symbol:{title:I18n.t("transfer.us.taxAuthoritySymbol.symbol"),type:"Select",options:[{val:"",label:""}],editorClass:"chzn-select chzn-select-short chzn-loop-img",template:"taxAuthoritySymbol",editorLabelFor:"authority-symbol-input",editorAttrs:{id:"authority-symbol-input",placeholder:I18n.t("transfer.us.placeholder.symbol"),"data-placeholder":I18n.t("transfer.us.placeholder.symbol")},_params:{tooltip:I18n.t("transfer.us.tooltips.taxAuthoritySymbol")}},accType:{template:"fieldAlone",fieldClass:"hide",editorLabelFor:"accType-symbol-input",editorAttrs:{id:"accType-symbol-input"}},toAnother:{title:I18n.t("transfer.us.taxAuthoritySymbol.toAnother"),type:"Checkbox",template:"taxAuthorityToAnother"}}},authorityCity:{type:"MultipleFields",template:"fieldsPanel",subSchema:{city:{title:I18n.t("transfer.us.taxAuthorityCity"),type:"Select",template:"fieldsPanelNoLoupe",fieldClass:"authority-city-default",options:[],editorClass:"chzn-select chzn-loop-img chzn-select-long select-medium",editorAttrs:{autocomplete:"off",placeholder:I18n.t("transfer.us.placeholder.city"),"data-placeholder":I18n.t("transfer.us.placeholder.city")}}}},authorityAccountNumberCustom:{type:"MultipleFields",template:"fieldsPanel",fieldClass:"hide",subSchema:{accountNumber:{title:"Numer rachunku",template:"labelBeforeInput",fieldClass:"authority-account-number-custom extralong",editorAttrs:{placeholder:I18n.t("transfer.us.placeholder.custAcc"),maxlength:38}}}},authorityName:{type:"MultipleFields",template:"fieldsPanel",subSchema:{name:{title:I18n.t("transfer.us.taxAuthorityName"),type:"Select",template:"labelBeforeInput",fieldClass:"authority-name-default",editorClass:"beautify-select select-medium",editorAttrs:{id:"form-select-tax-office-name",placeholder:I18n.t("transfer.us.placeholder.name"),maxlength:140},options:[]},label:{type:"Hidden"}}},authorityNameCustom:{type:"MultipleFields",template:"fieldsPanel",fieldClass:"hide",subSchema:{name:{title:"Nazwa organu podatkowego",template:"labelBeforeInput",fieldClass:"authority-name-custom extralong",editorAttrs:{placeholder:I18n.t("transfer.us.placeholder.custName"),maxlength:64}}}},account:{type:"Hidden"}}};return e.isTransferDefined?t:a}function a(a){return{addToBasket:{type:"Hidden"},templateId:{type:"Hidden"},formType:{type:"Hidden"},recipientName:{type:"Hidden"},userIdTypeValues:{type:"Hidden"},isSeriesOfTransfers:{type:"Hidden"},isDefined:{type:"Hidden"},isAddToAddressDisabled:{type:"Hidden"},taxAuthority:t(a),tasksCenterData:e(a),amount:{title:I18n.t("transfer.us.amount"),template:"amount",editorClass:"short"},currency:{type:"SimpleTextValue",template:"fieldAloneNoLabel",fieldClass:"row-currency"},fromAccount:{title:I18n.t("transfer.us.fromAccount"),type:Ebre.Venezia.ProfileContext.IsFirm?"SplitSelect":"Select",editorClass:"beautify-select select-long",options:a.fromAccountOptions,editorAttrs:a.isFromBasket?{disabled:"disabled"}:{}},sender:{title:"Nadawca",type:"Select",editorClass:"beautify-select",editorAttrs:{id:"form-select-sender"},options:[]},nameAndAddress:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"MultipleFields",title:I18n.t("transfer.zus.addresField"),template:"expandableFields",fieldClass:"row-wrapper",_params:{expandText:I18n.t("transfer.zus.expandAddress"),collapseText:I18n.t("transfer.zus.collapseAddress")},subSchema:{name:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.name")}},street:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.address")}},city:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.city")}}}},idType:{title:I18n.t("transfer.us.idType.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",subSchema:{type:{title:"Identyfikator",type:"Select",editorClass:"beautify-select fl",editorAttrs:{id:"form-select-id-type"},template:"fieldAlone",options:a.idTypesDict},series:{title:I18n.t("transfer.us.idType.series"),editorClass:"extrashort",editorAttrs:{maxlength:20},template:"labelBeforeInput"}}},period:{title:I18n.t("transfer.us.period.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-declaration-data",subSchema:{currentValue:{title:I18n.t("transfer.us.period.subSchema"),editorClass:"form-input-month",template:"fieldAlone",maxlength:2},currentPeriod:{title:I18n.t("transfer.us.period.period"),type:"Select",editorClass:"beautify-select fl",editorAttrs:{id:"form-select-period"},template:"fieldAlone",options:a.currentPeriodOptions},currentMonth:{title:I18n.t("transfer.us.period.month"),editorClass:"form-input-month",template:"labelBeforeInput",maxlength:2},currentYear:{title:I18n.t("transfer.us.period.year"),fieldClass:"form-input-year-wrapper",editorClass:"form-input-year",template:"labelBeforeInput"}}},commitmentId:{title:I18n.t("transfer.us.commitmentId"),fieldClass:"two-lines",_params:{tooltip:I18n.t("transfer.us.tooltips.commitmentId"),maxlength:40},editorAttrs:{maxlength:40}},date:{type:"uiDateInput",template:"onlyDateInputNonRecurent",fieldClass:"row-additional-options",editorClass:"style-tab",title:I18n.t("transfer.domestic.deliveryDate"),editorAttrs:{id:"uiDateInput"},minDate:a.calendar.minDate,maxDate:a.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:a.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},additionalOptions:{title:I18n.t("transfer.us.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.us.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources hide"},sendConfirmation:{title:I18n.t("transfer.domestic.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-send-confirmation"},sendConfirmationOptions:{type:"List",template:"additionalOptionsListWrapper",listTemplate:"sendTransferConfirmationOptions",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"send-confirmation-options hide",editorClass:"short",itemsLimit:2,fixEditorsCode:!0,editorAttrs:{maxlength:40,"aria-label":"E-mail"}},addReceiver:{type:a.isTransferDefined||a.isAddToAddressDisabled?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",subSchema:{addToAddressBook:{title:I18n.t("transfer.domestic.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.us.submitButtons.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:a.canAddToBasket?"AnchorButton":"Hidden",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.us.submitButtons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var r=[["templateId","isDefined","isAddToAddressDisabled","formType","recipientName","userIdTypeValues","taxAuthority","tasksCenterData","amount","currency","fromAccount","sender"],["nameAndAddress","idType"],["period","commitmentId","date"],["additionalOptions","submitButtons","isSeriesOfTransfers","addToBasket"]];return{fieldsets:r,getSchema:a}}),define("transfer/js/collections/us_symbols",[],function(){return Backbone.Collection.extend({model:Backbone.Model,sync:function(e,t,a){"read"===e&&nmbServices.getUsSymbols(a)},visibleFilter:function(e){var t=new RegExp(e,"i");this.each(function(e){e.set("visible",t.test(e.get("formName")))}),$(".us-symbols-view").show()}})}),define("text!transfer/templates/forms/us_cities.html",[],function(){return'<div class="scroll-pane">\r\n    <ul class="newList us-cities" style="position: relative;">\r\n\r\n    </ul>\r\n</div>\r\n'}),define("text!transfer/templates/forms/us_city.html",[],function(){return"{{ name }}\r\n"}),define("transfer/js/views/forms/us_city",["../../app","text!../../../templates/forms/us_city.html"],function(e,t){return Backbone.Marionette.ItemView.extend({template:t,tagName:"li",className:"us-city",events:{click:"choose"},initialize:function(){this.bindTo(this.model,"change:visible",this.toggleView,this)},toggleView:function(){this.$el.toggle(this.model.get("visible"))},choose:function(){$('input[name="city"]').attr("value",this.model.get("name")).attr("data-id",this.model.get("id")),$(".us-cities-view").hide(),$(".row-authorityCity").addClass("complete"),this.trigger("chose")}})}),define("transfer/js/views/forms/us_cities",["../../app","text!../../../templates/forms/us_cities.html","./us_city"],function(e,t,a){return Backbone.Marionette.CompositeView.extend({template:t,itemView:a,className:"us-cities-view",itemViewContainer:".us-cities",enableScrollPane:function(){var e=this,t=e.$(".scroll-pane");t.bind("jsp-initialised",function(e,t){var a=$(this),r=$(this).find(".newList.us-cities"),n=260,i=r.height();n>=i&&(n=i),a.css({height:n+"px",background:"#fff",top:"22px",bottom:"auto","z-index":"1000"})}).jScrollPane({showArrows:!1,hideFocus:!0,autoReinitialise:!0,verticalDragMaxHeight:"68",horizontalGutter:0}).css({height:"238px",top:"22px",bottom:"auto","z-index":"1000"})},onRender:function(){this.enableScrollPane()}})}),define("transfer/js/collections/us_cities",[],function(){return Backbone.Collection.extend({model:Backbone.Model,sync:function(e,t,a){"read"===e&&nmbServices.getUsCities({success:a.success,error:a.error})},visibleFilter:function(e){if(""==e)return $(".us-cities-view").hide(),void $(".row-authorityCity").removeClass("complete");var t=new RegExp(e,"i");this.each(function(e){e.set("visible",t.test(e.get("name")))}),$(".us-cities-view").show()}})}),define("text!transfer/templates/forms/us_name.html",[],function(){return'<option value="{{ taxAccount }}" >{{ taxAuthorityName }}</option>\r\n';
}),define("transfer/js/views/forms/us_name",["../../app","text!../../../templates/forms/us_name.html"],function(e,t){return Backbone.Marionette.ItemView.extend({template:t})}),define("transfer/js/views/forms/us_names",["../../app","./us_name"],function(e,t){return Backbone.Marionette.CollectionView.extend({itemView:t,tagName:"select"})}),define("transfer/js/collections/us_names",[],function(){return Backbone.Collection.extend({model:Backbone.Model,sync:function(e,t,a){"read"===e&&nmbServices.getUs({id:a.id,success:a.success,error:a.error})}})}),define("transfer/js/models/nmb-transfer-us-check-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.UsCheckService(a)}});return e}),define("transfer/js/views/forms/us",["./_generic","./schemes/us-schema","../../collections/us_symbols","./us_cities","../../collections/us_cities","./us_names","../../collections/us_names","../../models/nmb-transfer-us-check-service",nmbPaths.global.js+"validator","../../logic/local-validators","../../logic/split-editors"],function(e,t,a,r,n,i,o,s,l,d,c){var u={formInputMonthVal:"",formInputYearVal:"",validator:null},m=e.extend({tagName:"section",className:"form-view",blockForm:!1,firstOpen:!0,events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddressZusOrUs","focus textarea.single-row.expanding":"elasticTextAreas"})},initialize:function(){var a=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","us");var r=Backbone.Model.extend({schema:a.getFormSchema(),defaults:a.getDefaults(),rules:a.getFormRulesFunction()}),n=new r;this.form=new Backbone.Form({model:n,fieldsets:t.fieldsets}),this.form.render(),this.model.get("isInvalid")&&Ebre.Common.createErrorMessage({message:this.model.get("errorMessage")}),this.fetchSymbolsAndCities(),this.setCoownersForCurrentAccount(),this.setupBindings(),this.preventSubmitByEnterOnTouchDevices(this.form)},fetchSymbolsAndCities:function(){var e=this,t=new a;e.usSymbolsCollection=$.Deferred(),t.fetch({loaderParent:e.getLoaderParamSelector(),success:function(){e.usSymbolsCollection.resolve(t)}});var r=new n;e.usCitiesCollection=$.Deferred(),r.fetch({loaderParent:e.getLoaderParamSelector(),success:function(){e.usCitiesCollection.resolve(r)}})},onRender:function(){function e(e){return{alias:e}}var t=this;this.renderForm(this.$("#form-container"),this.form.el);var a=t.model.get("additionalOptions:sendConfirmationOptions");if(a){var r=a.map(e);t.model.set("additionalOptions:sendConfirmationOptions",r)}},onShow:function(){this.triggerFieldsToSetThem(),this.generateSenderSelect(),this.setupTaxAuthorityField(),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("input[name='amount']")),this.checkAmountUs(),this.bindTo(this,"fading:done",function(){}),this.handleCustomFields("authorityAccountNumberCustom","accountNumber"),this.handleCustomFields("authorityNameCustom","name"),this.bindTo(this,"effects:done",function(){var e=this.form.$el.find(".row-authoritySymbol a.chzn-single");e.length?e[0].focus():this.setFocusOnInput("amount",""),this.initExpandableFields({collapsedOnStart:!0});var t=this.checkIfCurrentSymbolIsVatValiable();c.invalidateSplitSelectFromAccount(this.form,t)})},renderForm:function(e,t){e.html(t),this.handleSymbolsList(),this.handleCitiesList(),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.chosen(),this.triggerDatepicker(),this.tooltip(),this.$("input[placeholder],textarea[placeholder]").placeholder(),null===u.validator&&(u.validator=this.model.get("period").validator)},getFormSchema:function(){var e=this,a=this.model.get("calendar"),r=[];_.each(a.unavailableDates,function(e){r.push($.datepicker.formatDate("yy/mm/dd",new Date(e)))});var n=this.model.get("tasksCenterData"),i={isTransferDefined:(e.model.get("isDefined")||e.model.get("executionFromExternalModule"))&&!e.model.get("isInvalid")&&!e.model.get("showTaxAuthorityEditControls"),isAddToAddressDisabled:e.model.get("isAddToAddressDisabled"),canAddToBasket:this.model.get("canAddToBasket"),fromAccountOptions:e.getFormAccount(e.model.get("availableFromAccounts")),calendar:a,unavailableDates:r,idTypesDict:this.getPaymentTypes(this.model.get("idTypesDict")),currentPeriodOptions:_.map(e.model.get("period").validator||u.validator,function(e,t){return{label:I18n.t("transfer.us.period.value."+e.period),val:e.period}}),isFromBasket:this.model.get("isFromBasket")};return n&&(i.tasksCenterData={taskId:n.taskId,redirectedFromAutomaticTaxPaymentTask:n.redirectedFromAutomaticTaxPaymentTask,taxType:n.taxType}),t.getSchema(i)},getDefaults:function(){var e=this.model.toJSON();return!e.isDefined&&!e.executionFromExternalModule||e.requiresPP||_.each(["currentValue","currentMonth","currentYear"],function(e){this[e]=""},e.period),e},getFormRulesFunction:function(){function e(){var e=t.form.getValue(),a={amount:["required","amountFilter","amountAddZero",{name:"maxAmount",params:[1e6]}]};a["authorityName:name"]=["required"],a.commitmentId=["elixir","trim"],a.period=["dateManual"],t.model.get("currentDateMockingEnabled")?a.date=["required",{name:"remote",params:[d.checkDateFormat]}]:a.date=["required",{name:"remote",params:[d.checkDateFormat]},"dateNotPast"];var r={P:["required","trim","pesel",{name:"exactLength",params:[11]}],2:["required","trim","elixir",{name:"maxLength",params:[14]}],1:["required","trim","idNumber"],R:["required","trim","regon"],3:["required","trim","elixir"],N:["required","nip"]};e.isDefined||(e.taxAuthority.authoritySymbol.toAnother?(a["taxAuthority:authorityAccountNumberCustom:accountNumber"]=["required","accountNRB","accountInternal"],a["taxAuthority:authorityNameCustom:name"]=["required","trim","elixir"],a["taxAuthority:authoritySymbol:symbol"]=[],a["taxAuthority:authorityCity:city"]=[],a["taxAuthority:authorityName:name"]=[]):(a["taxAuthority:authoritySymbol:symbol"]=["required"],a["taxAuthority:authorityCity:city"]=["required"],a["taxAuthority:authorityName:name"]=["required"],a["taxAuthority:authorityAccountNumberCustom:accountNumber"]=[],a["taxAuthority:authorityNameCustom:name"]=[]));var n=t.getCurrentSymbolModel(),i=n?new Date(n.get("beDate")).getFullYear():1994,o=n?new Date(n.get("enDate")).getFullYear():2099;a["period:currentYear"]=["required","integer",{name:"integerRange",params:[i,o]}],a["period:currentValue"]="R"===e.period.currentPeriod?[]:["required",{name:"periodWithMonth",params:[e.period.currentValue,e.period.currentMonth,e.period.currentPeriod,e.period.currentYear]}],"J"==e.period.currentPeriod||"D"==e.period.currentPeriod?a["period:currentMonth"]=["required",{name:"periodWithMonth",params:[e.period.currentValue,e.period.currentMonth,e.period.currentPeriod,e.period.currentYear]}]:a["period:currentMonth"]=[];var s=t.getRequiresPP();if(s||("R"==e.period.currentPeriod&&""==e.period.currentYear&&(a["period:currentYear"]=["integer",{name:"integerRange",params:[i,o]}]),"D"!=e.period.currentPeriod&&"J"!=e.period.currentPeriod||""!=e.period.currentYear||""!=e.period.currentValue||""!=e.period.currentMonth||(a["period:currentValue"]=[{name:"periodWithMonth",params:[e.period.currentValue,e.period.currentMonth,e.period.currentPeriod,e.period.currentYear]}],a["period:currentMonth"]=[{name:"periodWithMonth",params:[e.period.currentValue,e.period.currentMonth,e.period.currentPeriod,e.period.currentYear]}],a["period:currentYear"]=["integer",{name:"integerRange",params:[i,o]}]),"K"!=e.period.currentPeriod&&"M"!=e.period.currentPeriod&&"P"!=e.period.currentPeriod||""!=e.period.currentYear||""!=e.period.currentValue||(a["period:currentValue"]=[{name:"periodWithMonth",params:[e.period.currentValue,e.period.currentMonth,e.period.currentPeriod,e.period.currentYear]}],a["period:currentYear"]=["integer",{name:"integerRange",params:[i,o]}])),r.hasOwnProperty(e.idType.type)&&(a["idType:series"]=r[e.idType.type]),e.additionalOptions.sendConfirmation&&(a["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),9999==o){var l=_.find(a["period:currentYear"],function(e){return"integerRange"==e.name});if(l)var c=new Date(n.get("beDate"));l.params.push({message:I18n.t("errors.minimumDateUs",{min:[c.getDate(),c.getMonth()+1,c.getFullYear()].join("")})})}return a["nameAndAddress:name"]=["required","trim","elixir",{name:"maxLength",params:[70]}],a["nameAndAddress:street"]=["required","trim","elixir",{name:"maxLength",params:[35]}],a["nameAndAddress:city"]=["required","trim","elixir",{name:"maxLength",params:[35]}],a}var t=this;return e},setupBindings:function(){function e(){var e=t.getCurrentSymbolModel(),a=e&&e.get("accType"),r=$.trim($('div[name="authorityCity"] [name="city"]').val());if(a&&r){var n=new o;n.fetch({loaderParent:t.getLoaderParamSelector(),id:{symbolId:a,cityId:r},success:function(){var e,t=$(".row-authorityName"),a=t.find("#form-select-tax-office-name"),r=t.find("#form_select_tax_office_name_chzn");0!=n.length?(e=new i({collection:n}),e.render(),r.show(),a.html(e.$el.find("option")).resetSS(),t.removeClass("validation error").addClass("validation success complete").find(".fields > .validation-text").hide()):(r.hide(),a.empty().resetSS(),t.removeClass("complete success validation error").addClass("validation error").find(".fields > .validation-text").html(I18n.t("transfer.us.noTaxAuthorityBranches")).show())}})}}var t=this;t.bindOnBlurValidation(["amount","taxAuthority:authoritySymbol:symbol","taxAuthority:authorityCity:city","taxAuthority:authorityName:name","taxAuthority:authorityNameCustom:name","period:currentYear","period:currentValue","period:currentMonth","commitmentId","idType:series","additionalOptions:sendConfirmationOptions:item","nameAndAddress:name","nameAndAddress:street","nameAndAddress:city"]),this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e,t){var a=this.form.fields.additionalOptions,r=this;a.getValue().addReceiver.addToAddressBook?(a.$el.find(".add-to-trusted-list").fadeIn(),r.model.set("canAddToBasket",!1),r.toggleAddToBasket(e)):"undefined"!=typeof a.getValue().addReceiver.addToAddressBook&&(a.$el.find(".add-to-trusted-list").fadeOut(),r.model.set("canAddToBasket",!0),r.toggleAddToBasket(e))},this),this.bindTo(this.form,"taxAuthority:authoritySymbol:change taxAuthority:authorityCity:change",e),this.bindTo(this.form,"taxAuthority:authorityCity:change",function(e){e.$el.find(".row-authorityCity").removeClass("validation error").addClass("success complete").find(".fields > .validation-text").hide()}),this.bindTo(this.form,"taxAuthority:authoritySymbol:change",function(e){e.$el.find(".row-authoritySymbol").removeClass("validation error").addClass("success complete").find(".fields > .validation-text").hide(),this.setPeriodAvailability();var t=this.checkIfCurrentSymbolIsVatValiable();c.invalidateSplitSelectFromAccount(this.form,t)}),this.bindTo(this.form,"taxAuthority:authorityName:name:change",function(e,t){e.$el.find(".row-authorityName").addClass("complete")},this),this.bindTo(this.form,"taxAuthority:authoritySymbol:toAnother:change",function(e,a){var r=this.form.fields.taxAuthority.$el,n=r.find("#authority-symbol-input"),i=r.find(".authority-city-default").closest(".row"),o=r.find(".authority-account-number-custom").closest(".row"),s=r.find(".authority-name-default").closest(".row"),l=r.find(".authority-name-custom").closest(".row"),d=$("#form-select-tax-office-name");t.blockForm=!1,t.checkServicePromise=null,this.form.fields.taxAuthority.getValue().authoritySymbol.toAnother?(n.val(""),n.attr("disabled",!0).trigger("liszt:updated"),n.closest(".row").addClass("complete"),i.hide().find("select").val("").trigger("liszt:updated"),i.removeClass("complete success"),s.hide(),o.show(),l.show(),t.$el.find(".authority-account-number-custom input").blur()):(d.html(""),d.resetSS(),this.$el.find(".row-authorityName").removeClass("success complete error"),n.attr("disabled",!1).trigger("liszt:updated"),n.closest(".row").removeClass("complete"),i.show(),s.show(),o.hide(),l.hide(),firstInpt=this.form.$el.find(".row-authoritySymbol a.chzn-single"),firstInpt.length&&firstInpt[0].focus())},this),this.bindTo(this.form,"taxAuthority:authorityAccountNumberCustom:accountNumber:focus",function(e,t){this.$el.find(".authority-account-number-custom").closest(".row").removeClass("complete")},this),this.bindTo(this.form,"taxAuthority:authorityAccountNumberCustom:accountNumber:blur",function(e,a){var r=this,n=a.getValue().authorityAccountNumberCustom.accountNumber,i=a.getValue().authoritySymbol.toAnother;l.validateField(e,"taxAuthority:authorityAccountNumberCustom:accountNumber",e.getField("taxAuthority.authorityAccountNumberCustom.accountNumber")).done(function(){var e=t.$(".row-authorityAccountNumberCustom").hasClass("error");if(!e)if(n.length>0){var a=new $.Deferred,o=new s;r.checkServicePromise=a.promise(),o.fetch({loaderParent:t.getLoaderParamSelector(),accNo:n,otherTaxAuth:i,success:function(){var e=o.toJSON().us;if(r.blockForm=!1,e.otherTaxCheckedAndUSaccSet)r.blockForm=!0,$(".row-authorityAccountNumberCustom").removeClass("validation success complete"),$(".row-authorityAccountNumberCustom").addClass("validation error"),$(".row-authorityAccountNumberCustom > .fields > .validation-text").html("Podany numer rachunku jest rachunkiem Urzdu Skarbowego. Zarejestruj przelew do US."),a.reject();else if(e.isInternal||e.wrongNumber){var t=e.isInternal?"Przelew do innego organu podatkowego musi by przelewem zewntrznym":"Niepoprawny numer rachunku";$(".row-authorityAccountNumberCustom").removeClass("validation error").addClass("validation error"),r.$el.find(".authority-account-number-custom").closest(".row").removeClass("complete"),$(".row-authorityAccountNumberCustom > .fields > .validation-text").html(t),a.reject()}else $(".row-authorityAccountNumberCustom").removeClass("validation error"),$(".row-authorityAccountNumberCustom").addClass("validation success complete"),r.$el.find(".authority-account-number-custom").closest(".row").addClass("complete"),a.resolve();a.resolve()}})}else this.$el.find(".authority-account-number-custom").closest(".row").removeClass("complete")})},this),this.bindTo(this.form,"taxAuthority:authorityNameCustom:name:focus",function(e,t){this.$el.find(".authority-name-custom").closest(".row").removeClass("complete")},this),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;a.getValue()?r.$el.slideDown():r.$el.slideUp()}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:change",function(e){this.hideListRemoveButton(e.fields.additionalOptions.editor.form.fields.sendConfirmationOptions.editor.items)}),this.bindTo(this.form,"taxAuthority:authorityNameCustom:name:blur",function(e,t){t.getValue().authorityNameCustom.name.length>0?this.$el.find(".authority-name-custom").closest(".row").addClass("complete"):this.$el.find(".authority-name-custom").closest(".row").removeClass("complete")},this),this.bindTo(this.form,"taxAuthority:authoritySymbol:symbol:change taxAuthority:authorityCity:city:change",function(e,t,a,r){var n=r.getValue(),i=r.$el.closest(".row-fields-panel");i.toggleClass("complete",!!n)}),this.bindTo(this.form,"period:currentPeriod:change",function(e,t,a){var r=a.getValue()||this.model.get("period").currentPeriod,n=this.model.get("period").validator||u.validator,i=_.find(n,function(e){return e.period===r}),o=e.fields.period.editor.form.fields.currentValue,s=e.fields.period.editor.form.fields.currentMonth,l=e.fields.period.editor.form.fields.currentYear;o.$el.toggle(!("valueVisible"in i)||i.valueVisible),s.$el.toggle(!("valueMonth"in i)||i.valueMonth),$(".row-period .validation-text").html(""),$(".row-period").removeClass("error"),o.getValue()&&e.trigger("period:currentValue:blur",e,o),s.getValue()&&e.trigger("period:currentMonth:blur",e,s),l.getValue()&&e.trigger("period:currentYear:blur",e,l)}),this.bindTo(this.form,"period:currentValue:blur",function(e,t,a){e.trigger("period:currentMonth:blur",e,e.fields.period.editor.form.fields.currentMonth)}),this.bindTo(this.form,"fromAccount:change",function(e){var a;a=this.checkSender(),a.done(function(e){t.coowners=e.coowners,t.firstOpen||t.updateSenderData(),t.firstOpen=!1}),this.checkCreditCard(),this.toggleAddToBasket(this.form);var r=this.checkIfCurrentSymbolIsVatValiable();c.invalidateSplitSelectFromAccount(this.form,r),c.checkIsVatExceededUS(this.form,this.form.fields.amount.getValue(),this.checkIfCurrentSymbolIsVatValiable())}),this.bindTo(this.form,"date:change",function(e){this.toggleBlockResources(e)}),this.bindTo(this.form,"sender:change",function(){this.updateSenderData()},this),this.bindTo(this.form,"date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"idType:type:change",this.updateSenderData,this),this.bindTo(this.form,"amount:blur",this.amountChanged,this)},amountChanged:function(e){c.checkIsVatExceededUS(this.form,this.form.fields.amount.getValue(),this.checkIfCurrentSymbolIsVatValiable())},setCoownersForCurrentAccount:function(){var e=this.form.getField("fromAccount").getValue();this.coowners=_.find(this.model.get("defaultData").availableFromAccounts,function(t){return t.number==e}).coowners},handleSymbolsList:function(){var e=this;e.usSymbolsCollection.done(function(t){var a=e.form,r=a.getField("taxAuthority.authoritySymbol.symbol.symbol"),n=[{label:"",val:""}];t.each(function(e){n.push({label:e.get("formName"),val:e.get("formName")})}),"function"==typeof r.editor.setOptions&&(r.editor.setOptions(n),a.$(".chzn-select").trigger("liszt:updated"))})},handleCitiesList:function(){var e=this;e.usCitiesCollection.done(function(t){var a=e.form,r=a.getField("taxAuthority.authorityCity.city"),n=[{label:"",val:""}];t.each(function(e){n.push({label:e.get("name"),val:e.get("name")})}),"function"==typeof r.editor.setOptions&&(r.editor.setOptions(n),a.$(".chzn-select").trigger("liszt:updated"))}),this.bindTo(this.form,"taxAuthority:authorityCity:city:change",function(e,t){var a,r=t.getValue().authorityCity.city;r||(a=$("#form-select-tax-office-name"),a.html(""),a.resetSS(),this.$el.find(".row-authorityName").removeClass("success complete"))})},handleCustomFields:function(e,t){var a=this.form,r=a.fields.taxAuthority.schema.subSchema,n=function(e,t){t.value&&t.$el.closest(".row-"+e).addClass("success complete")};r[e]&&n(e,a.getField("taxAuthority."+e+"."+t))},checkAmountUs:function(){var e=this.model.get("amount");if(0===Number(e))this.model.set("amount",null),this.form.fields.amount.setValue(null);else if(e){var t=this.verifyAmount(e);this.form.fields.amount.setValue(t)}},periodInfo:function(){var e=this.getRequiresPP();if(!e){var t=$("#form-select-period").val();if("R"==t)if(""==$("input[name=currentYear]").val()){var a=$(".row-declaration-data");a.removeClass("error"),a.addClass("validation info"),$(".row-declaration-data .validation-text").html("Wybrano pusty okres rozliczeniowy.")}else $(".row-declaration-data").hasClass("error")&&$(".row-declaration-data .validation-text:not(contains('"+I18n.t("errors.emptyPeriodAvailable")+"'))").append(I18n.t("errors.emptyPeriodAvailable"));if("D"==t||"J"==t)if(""==$("input[name=currentYear]").val()&&""==$("input[name=currentValue]").val()&&""==$("input[name=currentMonth]").val()){var a=$(".row-declaration-data");a.removeClass("error"),a.addClass("validation info"),$(".row-declaration-data .validation-text").html("Wybrano pusty okres rozliczeniowy.")}else l.validateField(this.form,"period:currentValue",this.form.getField("period.currentValue")),l.validateField(this.form,"period:currentMonth",this.form.getField("period.currentMonth")),$(".row-declaration-data").hasClass("error")&&$(".row-declaration-data .validation-text:not(:contains('"+I18n.t("errors.emptyPeriodAvailable")+"'))").append(I18n.t("errors.emptyPeriodAvailable"));if("K"==t||"M"==t||"P"==t)if(""==$("input[name=currentValue]").val()&&""==$("input[name=currentYear]").val()){var a=$(".row-declaration-data");a.removeClass("error"),a.addClass("validation info"),$(".row-declaration-data .validation-text").html("Wybrano pusty okres rozliczeniowy.")}else $(".row-declaration-data").hasClass("error")&&$(".row-declaration-data .validation-text:not(:contains('"+I18n.t("errors.emptyPeriodAvailable")+"'))").append(I18n.t("errors.emptyPeriodAvailable"))}},triggerFieldsToSetThem:function(){this.form.trigger("taxAuthority:authoritySymbol:toAnother:change"),this.form.trigger("additionalOptions:addReceiver:addToAddressBook:change",this.form),this.form.trigger("date:change",this.form),this.form.trigger("additionalOptions:sendConfirmation:change",this.form),this.form.trigger("additionalOptions:sendConfirmationOptions:change",this.form),this.form.trigger("idType:type:change",this.form),this.form.$(".row-idType input[name=series]").val(this.model.get("idType").series),this.form.trigger("period:currentPeriod:change",this.form,null,this.form.fields.period.editor.form.fields.currentPeriod)},getCurrentSymbolModel:function(){var e=this,t=null;return e.usSymbolsCollection.done(function(e){var a=$("#authority-symbol-input").val();t=e.find(function(e){return e.get("formName")===a})}),t},checkIfCurrentSymbolIsVatValiable:function(){var e=this.getCurrentSymbolModel(),t=!1;return e&&(t=e.get("isVatCompliant")),t},getRequiresPP:function(){var e,t,a=this,r=this.model;return r.get("isDefined")||r.get("executionFromExternalModule")?e=r.get("requiresPP"):(t=a.getCurrentSymbolModel(),e=t&&t.get("requiresPP")),e},setupTaxAuthorityField:function(){var e=this,t=this.model;this.usSymbolsCollection.done(function(a){var r=t.get("taxAuthority"),n=null;if(n=r&&r.authoritySymbol?a.find(function(e){return e.get("formName")===r.authoritySymbol.symbol}):e.getCurrentSymbolModel(),null!=t.get("taxAuthority")&&n){e.$el.find(".row-authoritySymbol, .row-authorityCity, .row-authorityName").addClass("complete");var s=n&&n.get("accType"),l=$.trim($('div[name="authorityCity"] [name="city"]').val())||r.authorityCity.city;if(s&&""!=l){var d=e.model.attributes.taxAuthority.authorityName.name||r.authorityName.name,c=new o;c.fetch({loaderParent:e.getLoaderParamSelector(),id:{symbolId:s,cityId:l},success:function(){var t=new i({collection:c});t.render();var a=e.form.$("#form-select-tax-office-name");a.html(t.$el.find("option")),a.resetSS(),a.getSetSSValue(d)}})}else e.$(".row-authorityCity, .row-authorityName").removeClass("complete")}})},setPeriodAvailability:function(){var e=this.getRequiresPP(),t=this.$el.find(".row-period input.form-input-year"),a=this.$el.find(".row-period input.form-input-month"),r=this.$el.find(".row-period select"),n=!$("#authority-symbol-input").val()&&!$('input[name="toAnother"]').get(0).checked,i=new Date;e&&!n?(a.val(u.formInputMonthVal||a.val()||i.getMonth()),t.val(u.formInputYearVal||t.val()||i.getFullYear()),u.formInputMonthVal="",u.formInputYearVal="",a.trigger("blur"),t.trigger("blur")):(u.formInputYearVal=t.val()||u.formInputYearVal,u.formInputMonthVal=a.val()||u.formInputMonthVal,this.$el.find('input[name="currentValue"], .form-input-month, .form-input-year').val("").closest(".row").removeClass("validation error success info").find(".validation-text").text("")),n&&(a.val(i.getMonth()),t.val(i.getFullYear()),a.trigger("blur"),t.trigger("blur")),a.trigger("liszt:updated"),r.trigger("liszt:updated")},submitTransfer:function(){var t=this;return e.prototype.submitTransfer.apply(t,_.toArray(arguments)),this.blockForm?($(".row-authorityAccountNumberCustom").removeClass("validation success complete"),$(".row-authorityAccountNumberCustom").addClass("validation error"),$(".row-authorityAccountNumberCustom > .fields > .validation-text").html("Podany numer rachunku jest rachunkiem Urzdu Skarbowego. Zarejestruj przelew do US."),!1):void _.defer(function(){var e=t.$el.find(".row-nameAndAddress").find(".validation.error"),a=t.$el.find(".generic-expander");e.length&&!a.hasClass("expanded")&&a.click()})}});return m}),define("transfer/js/logic/validator.rules",[nmbPaths.global.js+"validators/account-nrb",nmbPaths.global.js+"validators/account-nrb-abroad",nmbPaths.global.js+"validators/account-nrb-not-abroad",nmbPaths.global.js+"validators/amount",nmbPaths.global.js+"validators/string-max-length",nmbPaths.global.js+"validators/string-exact-length",nmbPaths.global.js+"validators/account-number-czsk",nmbPaths.global.js+"validators/account-prefix-czsk",nmbPaths.global.js+"validators/account-internal",nmbPaths.global.js+"validators/digits",nmbPaths.global.js+"validators/account-bban-cz","./local-validators"],function(e,t,a,r,n,i,o,s,l,d,c,u){var m=function(e,t){return{error:!0,message:e,field:t[0],params:t}};return{none:{fn:function(e,t){return!0}},length:{fn:function(e,t,a){}},remote:{deferred:!0,fn:function(e,t,a){if(!a)throw"missing deferredProvider for remote validator, pass a function that returns a deferred as parameter for this validator.";return a.apply(e,arguments)}},required:{fn:function(e,t){return!(!t||t.match(/^\s+$/))||m(I18n.t("errors.emptyValue"),arguments)}},integer:{fn:function(e,t){if(!t)return!0;var a=parseInt(t,10),r=Number(t);return!isNaN(r)&&r%1===0&&a===r||m(I18n.t("errors.notInteger"),arguments)}},positive:{fn:function(e,t){return!t||(!!t.match(/^\s*(\+)?([\d\.,]+)\s*$/)||m(I18n.t("errors.notPositive"),arguments))}},negative:{fn:function(e,t){return!t||(!t.match(/^\s*(\+)?([\d\.,]+)\s*$/)||m(I18n.t("errors.notNegative"),arguments))}},decimal:{fn:function(e,t){return!t||(!!t.match(/^\s*(\+|-)?([\d\.,]+)\s*$/)||m(I18n.t("errors.notDecimal"),arguments))}},datetime:{fn:function(e,t){throw"Not Implemented"}},email:{fn:function(e,t){if(!t)return!0;t=$.trim(t);var a=40,r=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return!(!t.match(r)||t.length>a)||m(I18n.t("errors.email"),arguments)}},phoneNumber:{fn:function(e,t){return!!t.replace(/\s/g,"").match(/^[0-9]{9}$/)||m(I18n.t("errors.phoneNumber"),arguments)}},bic:{fn:function(e,t){return 8==t.length||11==t.length||m(I18n.t("errors.bic"),arguments)}},accountNrb:{fn:function(t,a){if(!a)return!0;var r=Array.prototype.slice.call(arguments,1);r[0]=t.val();var n=e.apply({setValue:function(e){t.val(e)}},r);return!n.error||(n.field=t,n)}},accountNrbAbroad:{fn:function(e,a){if(!a)return!0;var r=Array.prototype.slice.call(arguments,1),n=t.apply({setValue:function(t){e.val(t)}},r);return!n.error||(n.field=e,n)}},accountZus:{fn:function(e,t){if(!t)return!0;var a=u.accountZus.apply({setValue:function(t){e.val(t)}},[t]);return!a.error||m(a.message,arguments)}},bic:{fn:function(e,t){return!t||(t=$.trim(t.toUpperCase()),!!t.match(/^[a-zA-Z]{6,6}[a-zA-Z2-9][a-nA-Np-zP-Z0-9]([a-zA-Z0-9]{3,3}){0,1}$|^BREXPLPW/)||m(I18n.t("errors.bic"),arguments))}},money:{fn:function(e,t,a){if(!t)return!0;a=$.extend({currency:"PLN",minValue:0,maxValue:1e9-1,isAbroad:!1,country:"",allowEmptyString:!0,allowZero:!1},a||{}),a.country&&(a.country=a.country.toUpperCase()),a.currency&&(a.currency=a.currency.toUpperCase());var n=r.apply({setValue:function(t){e.val(t)}},[t,null,a.allowZero,a.allowEmptyString]);if(n.error)return n.field=e,n.message||(n.message=I18n.t("errors.amount")),n;if(a.isAbroad&&_.contains(["PL","POLSKA"],a.country)&&"PLN"==a.currency)return m(I18n.t("errors.noPLNforPL"),arguments);var i=Ebre.Extensions.toNumber(t," ",",").valueOf();return a.maxValue&&i>a.maxValue?m(I18n.t("errors.maxAmount",{max:I18n.l("currency",a.maxValue),currency:a.currency}),arguments):!(a.minValue&&i<a.minValue)||m(I18n.t("errors.minAmount",{min:I18n.l("currency",a.minValue),currency:a.currency}),arguments)}},maxLength:{fn:function(e,t,a){var r=n.apply({setValue:function(t){e.val(t)}},[t,a]);return!r.error||m(r.message,arguments)}},exactLength:{fn:function(e,t,a,r){if(!t)return!0;var n=i.apply({setValue:function(t){e.val(t)}},[t,a,r]);return!n.error||m(n.message,arguments)}},accountNumberCZSK:{fn:function(e,t){if(!t||!document.hasFocus())return!0;t=t.replace(/\s/g,""),t=Array(10-String(t).length+1).join("0")+t,e.val(t);var a=o.apply({setValue:function(t){e.val(t)}},[t]);return!a.error||m(a.message,arguments)}},accountPrefixCZSK:{fn:function(e,t){if(!t||!document.hasFocus())return!0;t=t.replace(/\s/g,""),t=Array(6-String(t).length+1).join("0")+t,e.val(t);var a=s.apply({setValue:function(t){e.val(t)}},[t]);return!a.error||m(a.message,arguments)}},accountInternal:{fn:function(e,t){if(!t)return!0;var a=Array.prototype.slice.call(arguments,1),r=l.apply({setValue:function(t){e.val(t)}},a);return!r.error||m(r.message,arguments)}},digits:{fn:function(e,t){var a=d.apply({setValue:function(t){e.val(t)}},[t]);return!a.error||m(a.message,arguments)}},isSKIban:{fn:function(e,t){return!IBAN.isValid(t)||"SK"==t.replace(/\s/g,"").toUpperCase().substr(0,2)||m(I18n.t("info.notIbanSkDomestic"),arguments)}},removePLCountryCode:{fn:function(e,t){var a=u.removePLCountryCode.apply({setValue:function(t){e.val(t)}},[t]);return!a.error||m(a.message,arguments)}},isIbanFormat:{fn:function(e,t){return!t||(correctFormat=/^[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/.test(t.replace(/\s/g,"")),!!correctFormat||m(I18n.t("errors.accountNRBabroadInsideEOG"),arguments))}},accountBbanCZ:{fn:function(e,t){var a=c.apply({setValue:function(t){e.val(t)}},[e.val()]);return!a.error||m(a.message,arguments)}},formatBbanCzPrefix:{fn:function(e,t){u.formatBbanCzPrefix.apply({setValue:function(t){e.val(t)}},[e.val()]);return!0}},accountNRBnotAbroad:{fn:function(e,t){var r=a.apply({setValue:function(t){e.val(t)}},[e.val()]);return!r.error||m(r.message,arguments)}}}}),define("transfer/js/company/views/forms/schemes/one-zus-schema",[],function(){function e(e){return{addToBasket:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},formType:{type:"Hidden"},fromAccount:{title:I18n.t("transfer.zus.fromAccount"),type:"Select",editorClass:"beautify-select select-long",options:e.availableFromAccounts,editorAttrs:e.isFromBasket?{disabled:"disabled"}:{required:"required"}},toAccount:{type:e.isDefined||e.performed||e.isFromBasket?"SimpleTextValue":"Text",title:I18n.t("transfer.domestic.toAccount"),editorClass:"extralong",editorAttrs:{id:"toAccount",maxlength:38,placeholder:I18n.t("transfer.zus.toAccount")},_params:{tooltip:I18n.t("transfer.zus.toAccountTooltip")}},totalWrapper:{title:I18n.t("transfer.zus.total"),type:"MultipleFields",template:"zusFieldWithCurrency",text:"",editorClass:"fl zus-total-wrapper",subSchema:{total:{title:"",editorClass:"input-amount zus-transfer-total-content",template:"zusTotalField"},checkbox:{type:"Checkbox",title:I18n.t("transfer.zus.showContribution"),editorClass:"total-checkbox",template:"zusNewTotalCheckbox"}}},selectZus:{title:I18n.t("transfer.zus.selectZus"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-zus-transfer-types",subSchema:{social:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half one-half-small oneZus",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.social")}},content:{title:I18n.t("transfer.step2.zus.title.social"),help:e.socialAcc,editorClass:"input-amount",template:"zusAccountContent"}}},health:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half one-half-small oneZus",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.health")}},content:{title:I18n.t("transfer.step2.zus.title.health"),help:e.healthAcc,editorClass:"input-amount",template:"zusAccountContent"}}},fgsp:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half one-half-small oneZus",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.fgsp")}},content:{title:I18n.t("transfer.step2.zus.title.fgsp"),help:e.fgspAcc,editorClass:"input-amount",template:"zusAccountContent"
}}},pension:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half one-half-small oneZus",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.pension")}},content:{title:I18n.t("transfer.step2.zus.title.pension"),help:e.pensionAcc,editorClass:"input-amount",template:"zusAccountContent"}}}}},title:{title:I18n.t("transfer.domestic.title"),type:"TextArea",editorClass:"extralong single-row expanding title-wrapper",editorAttrs:{maxlength:140,id:"title"}},date:{type:"uiDateInput",title:I18n.t("transfer.domestic.deliveryDate"),template:"zusDeliveryTimeDate",editorAttrs:{id:"uiDateInput"},fieldClass:"row-one-zus-date",editorClass:"style-tab",minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},transferMode:{title:I18n.t("transfer.domestic.deliveryTime.title"),type:"DeliveryTimeSelect",template:"DeliveryTimeRow",fieldClass:"row-delivery-time",options:e.transferModes,_params:{tooltip:I18n.t("transfer.domestic.tooltips.deliveryTime"),rowSubDesc1:I18n.t("transfer.domestic.deliveryTime.rowSubDesc1"),rowSubDesc2:I18n.t("transfer.domestic.deliveryTime.rowSubDesc2")}},additionalOptions:{title:I18n.t("transfer.zus.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.zus.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources"},sendConfirmation:{title:I18n.t("transfer.domestic.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-send-confirmation"},sendConfirmationOptions:{type:"List",template:"additionalOptionsListWrapper",listTemplate:"sendTransferConfirmationOptions",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"send-confirmation-options hide",editorClass:"short",itemsLimit:2,fixEditorsCode:!0,editorAttrs:{maxlength:40,"aria-label":"E-mail"}},addReceiver:{type:e.isDefined||e.isAddToAddressDisabled?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",subSchema:{addToAddressBook:{title:I18n.t("transfer.domestic.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"},addToTrustedList:{title:I18n.t("transfer.addToTrustedList"),type:"Checkbox",template:"additionalOptionsCheckboxInline",fieldClass:"add-to-trusted-list"}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.buttons.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:e.canAddToBasket?"AnchorButton":"Hidden",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.buttons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["addToBasket","templateId","recipientName","formType","fromAccount","toAccount","totalWrapper","selectZus","title","date","transferMode"],["additionalOptions","submitButtons"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/company/views/forms/onezus",["../../../views/forms/_generic",nmbPaths.global.js+"validators/amount",nmbPaths.global.js+"validator","../../../logic/validator.rules","./schemes/one-zus-schema","../../../logic/local-validators"],function(e,t,a,r,n,i){"use stapp";var o=e.extend({tagName:"section",className:"form-view",firstOpen:!0,events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddressZusOrUs","focus textarea.single-row.expanding":"elasticTextAreas"})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments));this.model.get("selectZus");this.model.set("formType","onezus"),this.coowners=null;var t=this;rules=function(){function e(e){return{name:"maxLength",params:[e]}}var a,r,n=t.form.getValue(),o="sepa"===n.deliveryTime;switch(n.deliveryTime){case"express":a="bluemedia",r=129;break;case"swift_sha":case"swift_own":case"sepa":a={name:"filterInternationalChars",params:[o]},r=Ebre.Entity.isCZSK()&&t.form.$(".row-pep").is(":visible")?105:140;break;default:a="elixir",r=140}var s={name:"amount",params:[!1,!0,!0]},l={fromAccount:["required"],toAccount:["required","accountNRB",{name:"remote",params:[i.accountZus]}],"nameWrapper:name":["required","trim",{name:"filterInternationalChars",params:[!1]},e(64)],"totalWrapper:total":["required","trim",s],title:["required",a,{name:"maxLength",params:[r]},"trim"],date:["required",{name:"remote",params:[i.checkDateFormat]},"dateNotPast"]};return n.additionalOptions.sendConfirmation&&(l["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),l};var a=Backbone.Model.extend({schema:n.getSchema({title:this.model.get("title"),calendar:this.model.get("calendar"),unavailableDates:this.model.get("calendar").unavailableDates,availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),availableFromAccountsForFees:this.getFormAccount(this.model.get("availableFromAccounts"),!0),canAddToBasket:this.model.get("canAddToBasket"),transferModes:this.prepareDataForTransferModes(this.model.get("transferModes")),performed:!!this.model.get("performed"),isTrusted:this.model.get("isTrusted"),isDefined:this.model.get("isDefined"),isAddToAddressDisabled:this.model.get("isAddToAddressDisabled"),isFromBasket:this.model.get("isFromBasket")}),rules:rules,defaults:t.model.toJSON()}),r=new a;this.form=new Backbone.Form({model:r,fieldsets:n.fieldsets}).render(),this.model.get("isInvalid")&&Ebre.Common.createErrorMessage({message:this.model.get("errorMessage")}),this.preventSubmitByEnterOnTouchDevices(this.form),t.bindOnBlurValidation(["additionalOptions:sendConfirmationOptions:item","toAccount","totalWrapper:total"]),this.bindTo(this.form,"selectZus:social:content:blur selectZus:health:content:blur selectZus:fgsp:content:blur selectZus:pension:content:blur",function(e,a,r){var n=a.getValue(),i=0,o=[],s=[];for(var l in n)if(value=n[l],value.content.length>0){var d=e.getField("selectZus."+l+".checkbox").getValue();d&&i>0&&(i-=1)}else i+=1;$.when.apply(null,s).done(function(){o.length&&(t.turnOffOnBlurValidation(),t.$el.find(".row-selectZus").removeClass("success").addClass("error").find(".validation-text").html(o.join("<br/>")))})}),this.bindTo(this.form,"transferMode:change",_.debounce(function(e){var t=this,a=e.fields.additionalOptions.editor.form.fields,r=(a.sendConfirmation,a.sendConfirmationOptions,e.fields.date.$el.find(".date-picker-replacer")),n=e.fields.additionalOptions.$el.find(".header:first"),i=this.model.toJSON(),o=e.getValue("fromAccount"),s=!1,l=_.find(i.availableFromAccounts,function(e){return e.number==o});l&&(s=l.isCreditCard),n.find("label").css("position","relative"),"elixir"===e.getValue(["transferMode"])?(i.deactivateDateField||s||t.enableDatepicker(r),e.getValue().isSeriesOfTransfers||e.getValue().isRepeatableTransfer?t.model.set("canAddToBasketDT",!1):t.model.set("canAddToBasketDT",!0),void 0!=i.additionalOptions&&(i.additionalOptions.sendConfirmation=!1)):_.contains(["express","sorbnet"],e.getValue(["transferMode"]))&&(t.setCurrentDateAndDisableDatepicker(r),t.model.set("canAddToBasketDT",!1),"express"===e.getValue(["transferMode"])&&void 0!=i.additionalOptions&&(i.additionalOptions.sendConfirmation=!1)),t.toggleAddToBasket(e),1==t.formLoaded&&(Valid.validateField(this.form,"title",this.form.fields.title),Valid.validateField(this.form,"transferMode",this.form.fields.transferMode)),e.trigger("additionalOptions:change",e)},100)),this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e,t){var a=this.form.fields.additionalOptions,r=this;a.getValue().addReceiver.addToAddressBook?(a.$el.find(".add-to-trusted-list").fadeIn(),r.model.set("canAddToBasket",!1),r.toggleAddToBasket(e)):"undefined"!=typeof a.getValue().addReceiver.addToAddressBook&&(a.$el.find(".add-to-trusted-list").fadeOut(),r.model.set("canAddToBasket",!0),r.toggleAddToBasket(e),a.editor.form.fields.addReceiver&&a.editor.form.fields.addReceiver.schema&&a.editor.form.fields.addReceiver.schema.subschema&&a.editor.form.fields.addReceiver.schema.subschema.addToTrustedList&&a.editor.form.fields.addReceiver.schema.subschema.addToTrustedList.setValue(!1))},this),this.bindTo(this.form,"fromAccount:change",function(e,t){t&&t.$el.parents(".row-fromAccount").removeClass("validation"),this.updateCostInformation(this.form.getValue(["fromAccount"])),this.checkCreditCard(),this.toggleAddToBasket(this.form)}),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;a.getValue()?r.$el.slideDown():r.$el.slideUp()}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:change",function(e){this.hideListRemoveButton(e.fields.additionalOptions.editor.form.fields.sendConfirmationOptions.editor.items)}),this.bindTo(this.form,"date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"date:change",function(e){this.toggleBlockResources(e),this.toggleTransferSendDateText(e)}),this.bindTo(this.form,"fromAccount:checkIfChanged",this.accountHasChanged,this)},sumZus:function(){function e(){var e=$(this),n=0;t.find(".checkbox-panel").each(function(){var t=$(this).find("input[type=checkbox]");if($(this).hasClass("selected")&&e.attr("id")!=t.attr("id")||e.attr("id")==t.attr("id")&&e.prop("checked")===!0){var a=$(this).find("input[type=text]").val().replace(",",".").replace(/\s/gi,"");isFinite(a)&&(n+=parseFloat(a||0,10))}}),a.text(I18n.l("currency",n)),r&&null!=n&&(r.value=I18n.l("currency",n))}var t=this.$el.find(".row-selectZus"),a=this.$el.find(".row-total-wrapper"),r=this.$el.find(".zus-transfer-total-content");r&&r.length>0&&(r=r[0]),t.on("change keyup","input",e)},cleanZusFields:function(){var e=this.$el.find(".zus-transfer-total-content"),t=this.$el.find(".row-selectZus");e.on("change",function(e){function a(){$(this);t.find(".checkbox-panel").each(function(){var e=$(this).find("input[type=checkbox]");$(this).removeClass("selected").removeClass("checked");var t=$(this).find(".checkbox-wrapper"),a=$(this).find("input[type=text]");a[0].value="",e[0].checked=!1,t.removeClass("checked")})}a()})},onRender:function(){function e(e){return 0==e.length?e:e.indexOf(",")==-1?e+=",00":e.indexOf(",")==e.length-2?e+="0":e}function t(){var t=r.find("input[type=text]"),a=t.val().replace(".",",").replace(/\s/gi,"");t[0].value=e(a)}function a(e){return{alias:e}}this.$el.find("#form-container").html(this.form.el),this.tooltip(),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.styleCheckboxPanels(),this.triggerDatepicker(),this.initFormZusNew();var r=this.$el.find(".zus-total-wrapper");this.$el.find(".oneZus");r.on("change","input",t);var n=this.model.get("templateId"),i=this.model.get("toAccount");if(n||""!==i){var o=this.$el.find("#toAccount");o[0].disabled=!0,o.addClass("zus-trusted-acount")}var s=this.$el.find(".radio-panel");s.addClass("selected");var l=this.$el.find(".radio-wrapper");if(l[0].click(),l.addClass("checked"),l.length>0){var d=this.model.get("transferModes"),c=d[0];this.form.model.set("transferMode",c),this.model.set("transferMode",c)}var u=this.$el.find(".calendar-trigger");u.addClass("calendar-trigger-fixed");var m=this.model.get("templateId");m?this.form.fields.additionalOptions.editor.form.fields.addReceiver.$el.hide():this.form.fields.additionalOptions.editor.form.fields.addReceiver.$el.show(),this.bindTo(this,"effects:done",function(){var e=this.form.$el.find('.title-wrapper input[name="content"][value!=""]:first');e.length>0?e.click():this.form.$el.find('.title-wrapper input[name="content"]:first').click(),this.initExpandableFields({collapsedOnStart:!0}),this.onBlurRulesZusNew()},this);var p=this.model.get("additionalOptions").sendConfirmationOptions;if(p){var f=p.map(a);if(this.model.set("additionalOptions:sendConfirmationOptions",f),f.length>0){var h=this.form.$el.find(".row-send-confirmation .checkbox-wrapper");h.addClass("checked");var b=this.form.fields.additionalOptions.editor.form.fields,v=b.sendConfirmation;v.setValue(!0);var y=this.form.$el.find(".row-sendConfirmationOptions.send-confirmation-options");y.show()}}},onBlurRulesZusNew:function(){var e=this,t=this.form.fields;this.bindOnBlurValidation(["toAccount","title","date","zus-total-wrapper:total","selectZus:social:content","selectZus:health:content","selectZus:fgsp:content","selectZus:pension:content"]);var r=e.$el.find(".row-selectZus"),n=this.$el.find(".zus-total"),i=this.$el.find(".zus-transfer-total-content"),o="zus-input-disabled";_.each({"totalWrapper:checkbox:change":{path:"totalWrapper:total",field:t.totalWrapper.editor.form.fields.total}},function(t,a){e.bindTo(e.form,a,function(t){var a=_.toArray(arguments).pop().getValue(),s=e.form.$el.find(".zus-transfer-total-content");a&&r?(r.show(),n.addClass("checked"),i[0].disabled=!0,i.addClass(o)):(r.hide(),n.removeClass("checked"),i[0].disabled=!1,s.hasClass(o)&&s.removeClass(o))})}),_.each({"selectZus:social:checkbox:change":{path:"selectZus:social:content",field:t.selectZus.editor.form.fields.social.editor.form.fields.content},"selectZus:health:checkbox:change":{path:"selectZus:health:content",field:t.selectZus.editor.form.fields.health.editor.form.fields.content},"selectZus:fgsp:checkbox:change":{path:"selectZus:fgsp:content",field:t.selectZus.editor.form.fields.fgsp.editor.form.fields.content},"selectZus:pension:checkbox:change":{path:"selectZus:pension:content",field:t.selectZus.editor.form.fields.pension.editor.form.fields.content}},function(t,r){e.bindTo(e.form,r,function(e){var r=_.toArray(arguments).pop().getValue();r?(a.validateField(e,t.path,t.field),t.field.$el.find("input").focus()):t.field.$el.find("input").val("")})}),_.each({"selectZus:social:content:blur":{path:"selectZus:social:content",field:t.selectZus.editor.form.fields.social.editor.form.fields.checkbox},"selectZus:health:content:blur":{path:"selectZus:health:content",field:t.selectZus.editor.form.fields.health.editor.form.fields.checkbox},"selectZus:fgsp:content:blur":{path:"selectZus:fgsp:content",field:t.selectZus.editor.form.fields.fgsp.editor.form.fields.checkbox},"selectZus:pension:content:blur":{path:"selectZus:pension:content",field:t.selectZus.editor.form.fields.pension.editor.form.fields.checkbox}},function(t,a){e.bindTo(e.form,a,function(a){e.sumZus();var r=_.toArray(arguments).pop();""!==r.getValue().replace(/\s+/g,"")&&(t.field.$el.parents(".checkbox-panel").addClass("selected"),t.field.$el.find(".checkbox-wrapper").addClass("checked"),t.field.$el.find("input[type=checkbox]").prop("checked",!0),e.$(".row-selectZus").closest(".row").removeClass("validation error success info").find(".validation-text").last().text("")),setTimeout(function(){r.getValue()||(t.field.$el.parents(".checkbox-panel").removeClass("selected"),t.field.$el.find(".checkbox-wrapper").removeClass("checked"),t.field.setValue(!1))},100)})})},onShow:function(){this.form.trigger("additionalOptions:addReceiver:addToAddressBook:change",this.form),this.form.trigger("toAccount:change"),this.form.trigger("fromAccount:change"),this.form.trigger("fromAccount:checkIfChanged",this.form),this.form.trigger("date:change",this.form),this.form.trigger("additionalOptions:sendConfirmation:change",this.form),this.form.trigger("additionalOptions:sendConfirmationOptions:change",this.form),this.setTabIndex(),this.model.get("isDefined")||this.form.trigger("idType:type:change",this.form),this.checkAmountZus(),this.sumZus(),this.cleanZusFields(),this.form.trigger("totalWrapper:total:change");var e=!1,t=this.$el.find(".row-selectZus"),a=this.$el.find(".zus-total");if(t.find(".checkbox-panel").each(function(){var t=$(this).find("input[type=checkbox]"),a=$(this).find(".checkbox-wrapper"),r=$(this).find("input[type=text]");""!==r[0].value&&(a.addClass("checked"),t[0].checked=!0,$(this).addClass("selected").addClass("checked"),e=!0)}),e){var r="zus-input-disabled",n=this.$el.find(".zus-transfer-total-content");n[0].disabled=!0,n.addClass(r),t.show(),a.addClass("checked");var i=this.$el.find(".row-toAccount");i.addClass("validation info");var o=i.find(".validation-text");o[0].textContent=I18n.t("toAccountInfo"),this.sumZus()}else this.sumZus(),t.hide();var s=this.$el.find(".title-wrapper");""===s[0].value&&(s[0].value=I18n.t("transfer.zus.defaultPrefixTitle")),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find(".input-amount")),this.formatAccount(this.form)},formatAccount:function(e){var t=e.model.get("toAccount");if(t.length){for(var a=1,r=0;a<=5;a++,r++)t=[t.slice(0,2+4*a+r)," ",t.slice(2+4*a+r)].join("");t=[t.slice(0,2)," ",t.slice(2)].join(""),e.model.set("toAccount",t),e.fields.toAccount.editor.setValue(t)}},checkAmountZus:function(){var e={health:{content:this.model.get("amount1")},social:{content:this.model.get("amount2")},pension:{content:this.model.get("amount3")},fgsp:{content:this.model.get("amount4")}},t=!1;e.health.content&&(e.health.content=this.verifyAmount(e.health.content),t=!0),e.social.content&&(e.social.content=this.verifyAmount(e.social.content),t=!0),e.pension.content&&(e.pension.content=this.verifyAmount(e.pension.content),t=!0),e.fgsp.content&&(e.fgsp.content=this.verifyAmount(e.fgsp.content),t=!0),this.form.fields.selectZus.setValue(e);var a=this.model.get("amount");a&&(a=""+a,a.length>0&&(a=a.replace(".",","),a.indexOf(",")<0&&(a+=",00"))),this.form.fields.totalWrapper.setValue({total:a,checkbox:t}),this.styleCheckboxPanels()},setTabIndex:function(){var e=1;$('input[id*="selectZus"][type="text"]').each(function(){var t=$(this);t.attr("tabindex",e),e++})},accountHasChanged:function(e){var t=e.model.toJSON().changedFromAcc,a=e.model.toJSON().srcAccChangeToTemplate;if(t){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccCorrected"));var r=this.model.get("defaultData");r.changedFromAcc=!1,this.model.set("defaultData",r)}if(!t&&a){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccChangedToTemplate"));var r=this.model.get("defaultData");r.srcAccChangeToTemplate=!1,this.model.set("defaultData",r)}},submitTransfer:function(){function t(){var e=["selectZus:social","selectZus:health","selectZus:fgsp","selectZus:pension"],t=[];for(var i in e){var o=r.form.getField(e[i].replace(/:/g,".")+".checkbox").getValue();if(o){var s=a.validateField(r.form,e[i]+":content",r.form.getField(e[i].replace(/:/gi,".")+".content")).done(function(){var e=r.$el.find(".row-selectZus.error .validation-text").text();""==e||_.findWhere(n,function(e){})||n.push(e)});t.push(s)}}return t}var r=this,n=[];e.prototype.submitTransfer.apply(r,_.toArray(arguments));var i=t();$.when.apply(null,i).done(function(){n.length&&r.$el.find(".row-selectZus").removeClass("success").addClass("error").find(".validation-text").html(n.join("<br/>"))})}});return o}),define("transfer/js/views/forms/schemes/zus-schema",[],function(){function e(e){return{addToBasket:{type:"Hidden"},formType:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},userIdTypeValues:{type:"Hidden"},isSeriesOfTransfers:{type:"Hidden"},isDefined:{type:"Hidden"},changedFromAcc:{type:"Hidden"},srcAccChangeToTemplate:{type:"Hidden"},selectZus:{title:I18n.t("transfer.zus.selectZus"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-zus-transfer-types",subSchema:{social:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.social")+" "+I18n.t("transfer.step2.zus.title.accountNumberLabel")+e.socialAcc}},content:{title:I18n.t("transfer.step2.zus.title.social"),help:e.socialAcc,editorClass:"input-amount",template:"zusAccountContent"}}},health:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.health")+" "+I18n.t("transfer.step2.zus.title.accountNumberLabel")+e.healthAcc}},content:{title:I18n.t("transfer.step2.zus.title.health"),help:e.healthAcc,editorClass:"input-amount",template:"zusAccountContent"}}},fgsp:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.fgsp")+" "+I18n.t("transfer.step2.zus.title.accountNumberLabel")+e.fgspAcc}},content:{title:I18n.t("transfer.step2.zus.title.fgsp"),help:e.fgspAcc,editorClass:"input-amount",template:"zusAccountContent"}}},pension:{type:"MultipleFields",template:"fieldAloneNoLabel",fieldClass:"checkbox-panel one-half",subSchema:{checkbox:{type:"Checkbox",template:"zusAccountCheckbox",editorAttrs:{"aria-label":I18n.t("transfer.step2.zus.title.pension")+" "+I18n.t("transfer.step2.zus.title.accountNumberLabel")+e.pensionAcc}},content:{title:I18n.t("transfer.step2.zus.title.pension"),help:e.pensionAcc,editorClass:"input-amount",template:"zusAccountContent"}}}}},total:{title:I18n.t("transfer.zus.total"),type:"SimpleTextValue",template:"zusFieldWithCurrency",text:"",editorClass:"fl strong"},fromAccount:{title:I18n.t("transfer.zus.fromAccount"),type:"Select",editorClass:"beautify-select select-long",options:e.availableFromAccounts,editorAttrs:e.isFromBasket?{disabled:"disabled"}:{}},sender:{title:"Nadawca",type:"Select",editorClass:"beautify-select select-medium",editorAttrs:{id:"form-select-sender"},options:[]},nameAndAddress:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"MultipleFields",title:I18n.t("transfer.zus.addresField"),template:"expandableFields",fieldClass:"row-wrapper",_params:{expandText:I18n.t("transfer.zus.expandAddress"),collapseText:I18n.t("transfer.zus.collapseAddress")},subSchema:{name:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.name"),maxlength:70}},street:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.address"),maxlength:35}},city:{type:Ebre.Venezia.ProfileContext.IsIndividual?"Hidden":"Text",editorAttrs:{placeholder:I18n.t("transfer.domestic.placeholders.city"),maxlength:35}}}},nip:{title:I18n.t("transfer.zus.nip"),editorClass:"short",editorAttrs:{maxlength:20}},idType:{title:I18n.t("transfer.zus.idType"),type:"MultipleFields",editorLabelFor:"form-select-id-type",subSchema:{type:{title:"Identyfikator",type:"Select",editorClass:"beautify-select fl",editorAttrs:{id:"form-select-id-type"},template:"fieldAlone",options:e.idTypesDict},series:{title:I18n.t("transfer.zus.series"),editorClass:"extrashort",editorAttrs:{maxlength:20},template:"labelBeforeInput"}}},declaration:{title:I18n.t("transfer.zus.declaration.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",subSchema:{month:{title:I18n.t("transfer.zus.declaration.month"),editorClass:"form-input-month",template:"labelBeforeInput",editorAttrs:{maxlength:2}},year:{title:I18n.t("transfer.zus.declaration.year"),editorClass:"form-input-year",template:"labelBeforeInput",editorAttrs:{maxlength:4}},number:{title:I18n.t("transfer.zus.declaration.number"),editorClass:"for-input-declaration-number",template:"labelBeforeInput",editorAttrs:{maxlength:2}}}},paymentType:{title:I18n.t("transfer.zus.paymentType"),type:"Select",editorClass:"beautify-select",editorAttrs:{id:"form-select-zus-transfer-type"},options:e.availablePaymentTypes},decisionNumber:{title:I18n.t("transfer.zus.decisionNumber"),editorClass:"short",editorAttrs:{maxlength:15}},date:{type:"uiDateInput",template:"onlyDateInputNonRecurent",fieldClass:"row-additional-options",editorClass:"style-tab",title:I18n.t("transfer.domestic.deliveryDate"),editorAttrs:{id:"uiDateInput"},minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.calendar.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},additionalOptions:{title:I18n.t("transfer.zus.additionalOptions.title"),type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"row-wrapper additional-options-wrapper",subSchema:{blockResources:{title:I18n.t("transfer.zus.additionalOptions.blockResources"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-block-resources hide"},sendConfirmation:{title:I18n.t("transfer.domestic.additionalOptions.sendConfirmation"),type:"Checkbox",template:"additionalOptionsCheckbox",fieldClass:"row-send-confirmation"},sendConfirmationOptions:{type:"List",template:"additionalOptionsListWrapper",listTemplate:"sendTransferConfirmationOptions",listItemTemplate:"sendTransferConfirmationItem",fieldClass:"send-confirmation-options hide",editorClass:"short",itemsLimit:2,editorAttrs:{maxlength:40,"aria-label":"E-mail"}},addReceiver:{type:e.isDefined||e.isAddToAddressDisabled?"Hidden":"MultipleFields",template:"fieldsRowWithoutHeader",subSchema:{addToAddressBook:{title:I18n.t("transfer.domestic.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline"},addToTrustedList:{title:I18n.t("transfer.addToTrustedList"),type:"Checkbox",template:"additionalOptionsCheckboxInline",fieldClass:"add-to-trusted-list"}}}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.buttons.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:e.canAddToBasket?"AnchorButton":"Hidden",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.buttons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["changedFromAcc","srcAccChangeToTemplate","templateId","isDefined","formType","recipientName","selectZus","total","fromAccount","sender"],["nameAndAddress","idType","nip"],["userIdTypeValues","declaration","paymentType","decisionNumber","date"],["additionalOptions","submitButtons","isSeriesOfTransfers","addToBasket"]];return{fieldsets:t,getSchema:e}}),define("transfer/js/views/forms/zus",["./_generic",nmbPaths.global.js+"validators/amount",nmbPaths.global.js+"validator","./schemes/zus-schema","../../logic/local-validators"],function(e,t,a,r,n){"use stapp";var i=e.extend({tagName:"section",className:"form-view",firstOpen:!0,events:function(){return _.extend({},e.prototype.events,{"click .address-expander":"slidingAddressZusOrUs","focus textarea.single-row.expanding":"elasticTextAreas"})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments));var i=this.model.get("selectZus"),o=i.social.accountNumber,s=i.fgsp.accountNumber,l=i.health.accountNumber,d=i.pension.accountNumber;this.model.set("formType","zus");var c=this.model.get("calendar");this.model.set("isNipDirty",!1);var u=[];_.each(c.unavailableDates,function(e){u.push($.datepicker.formatDate("yy/mm/dd",new Date(e)))}),this.coowners=null;var m=Backbone.Model.extend({schema:r.getSchema({availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts")),idTypesDict:this.getPaymentTypes(this.model.get("idTypesDict")),availablePaymentTypes:this.getPaymentTypes(this.model.get("availablePaymentTypes")),calendar:this.model.get("calendar"),isDefined:this.model.get("isDefined"),isAddToAddressDisabled:this.model.get("isAddToAddressDisabled"),canAddToBasket:this.model.get("canAddToBasket"),socialAcc:o,healthAcc:l,fgspAcc:s,pensionAcc:d,isFromBasket:this.model.get("isFromBasket")}),defaults:t.model.toJSON(),rules:function(){var e=t.form.getValue(),a={nip:["nip"]};t.model.get("currentDateMockingEnabled")?a.date=["required",{name:"remote",params:[n.checkDateFormat]}]:a.date=["required",{name:"remote",params:[n.checkDateFormat]},"dateNotPast"];var r={P:["required","pesel"],2:["required","trim","elixir",{name:"maxLength",params:[14]}],1:["required","idNumber"],R:["required","regon"]};r.hasOwnProperty(e.idType.type)&&(a["idType:series"]=r[e.idType.type]);var i=0;return _.each(e.selectZus,function(e,t){e.checkbox&&(a["selectZus:"+t+":content"]=["required",{name:"amount",params:[null,!1,!1]},{name:"maxAmount",params:[1e6]}],i++)}),0===i&&(a["selectZus:social:checkbox"]=["required"]),e.additionalOptions.sendConfirmation&&(a["additionalOptions:sendConfirmationOptions:{d}"]=["required","email","trim"]),function(){var r=t.model.get("availablePaymentTypes").types,n=e.paymentType,i=_.find(r,function(e,t){return e.type===n});i.year&&(a["declaration:year"]=["required","numeric","integer",{name:"integerRange",params:[1999,2099]}]),i.month&&(a["declaration:month"]=["required","numeric","integer",{name:"integerRange",params:[1,12]}]),i.declarationNo&&(a["declaration:number"]=["required","numeric","integer",{name:"integerRange",params:[1,99]}],"S"!=n&&"M"!=n&&(a["declaration:number"]=["required","numeric","integer",{name:"integerRange",params:[1,99]},{name:"allowedValues",params:[["1","01","40","51","70","80"]]}])),a.decisionNumber=i.decisionNo?["required","elixir"]:[]}(),a["nameAndAddress:name"]=["required","trim","elixir",{name:"maxLength",params:[70]}],a["nameAndAddress:street"]=["required","trim","elixir",{name:"maxLength",params:[35]}],a["nameAndAddress:city"]=["required","trim","elixir",{name:"maxLength",params:[35]}],a}}),p=new m;this.form=new Backbone.Form({model:p,fieldsets:r.fieldsets}).render(),this.model.get("isInvalid")&&Ebre.Common.createErrorMessage({message:this.model.get("errorMessage")}),this.preventSubmitByEnterOnTouchDevices(this.form),t.bindOnBlurValidation(["declaration:year","declaration:month","declaration:number","nip","idType:series","decisionNumber","additionalOptions:sendConfirmationOptions:item","nameAndAddress:name","nameAndAddress:street","nameAndAddress:city"]),this.bindTo(this.form,"selectZus:social:content:blur selectZus:health:content:blur selectZus:fgsp:content:blur selectZus:pension:content:blur",function(e,r,n){var i=r.getValue(),o=0,s=[],l=[];for(var d in i)if(value=i[d],value.content.length>0){var c=e.getField("selectZus."+d+".checkbox").getValue();if(c){var u=a.validateField(e,"selectZus:"+d+":content",e.getField("selectZus."+d+".content")).done(function(){var e=t.$el.find(".row-selectZus.error .validation-text").text();""==e||_.find(s,function(t){return t==e})||s.push(e)});l.push(u)}}else o+=1;4==o&&e.fields.selectZus.$el.addClass("validation error").find(".validation-text").html(I18n.t("transfer.zus.errors.must_be_at_least_one")).show(),$.when.apply(null,l).done(function(){s.length&&(t.turnOffOnBlurValidation(),t.$el.find(".row-selectZus").removeClass("success").addClass("error").find(".validation-text").html(s.join("<br/>")))})}),this.bindTo(this.form,"additionalOptions:addReceiver:addToAddressBook:change",function(e,t){var a=this.form.fields.additionalOptions,r=this;a.getValue().addReceiver.addToAddressBook?(a.$el.find(".add-to-trusted-list").fadeIn(),r.model.set("canAddToBasket",!1),r.toggleAddToBasket(e)):"undefined"!=typeof a.getValue().addReceiver.addToAddressBook&&(a.$el.find(".add-to-trusted-list").fadeOut(),r.model.set("canAddToBasket",!0),r.toggleAddToBasket(e),
a.editor.form.fields.addReceiver.editor.form.fields.addToTrustedList.setValue(!1))},this),this.bindTo(this.form,"fromAccount:change",function(e,t){var a,r=this;t&&t.$el.parents(".row-fromAccount").removeClass("validation"),a=this.checkSender(),a.done(function(e){r.coowners=e.coowners,r.firstOpen||r.updateSenderData(),r.firstOpen=!1}),this.checkCreditCard(),this.toggleAddToBasket(this.form)}),this.bindTo(this.form,"additionalOptions:sendConfirmation:change",function(e){var t=e.fields.additionalOptions.editor.form.fields,a=t.sendConfirmation,r=t.sendConfirmationOptions;a.getValue()?r.$el.slideDown():r.$el.slideUp()}),this.bindTo(this.form,"additionalOptions:sendConfirmationOptions:change",function(e){this.hideListRemoveButton(e.fields.additionalOptions.editor.form.fields.sendConfirmationOptions.editor.items)}),this.form.on("sender:change",function(e,t){this.updateSenderData()},this),this.form.on("nip:change",function(){this.model.set("isNipDirty",!0)}),this.bindTo(this.form,"date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"paymentType:change",function(e,t){this.checkZusPaymentTypes(),e&&a.validateField(e,"declaration:number",e.fields.declaration.editor.form.fields.number)}),this.bindTo(this.form,"date:change",function(e){this.toggleBlockResources(e)}),this.bindTo(this.form,"fromAccount:checkIfChanged",this.accountHasChanged,this),this.bindTo(this.form,"idType:type:change",this.updateSenderData,this)},checkZusPaymentTypes:function(){var e=this.model.toJSON(),t=this.form.fields,a=t.paymentType,r=e.availablePaymentTypes,n=(a.$("select"),t.declaration.editor.form.fields);e.paymentType||(a.setValue(r.activeType),this.model.set("paymentType",r.activeType)),_.map(r.types,function(e){e.type==a.getValue()&&_.map(e,function(e,a){"month"==a?e?n.month.$el.show():n.month.$el.hide():"year"==a?e?n.year.$el.show():n.year.$el.hide():"declarationNo"==a?e?n.number.$el.show():n.number.$el.hide():"decisionNo"==a&&(e?t.decisionNumber.$el.show():(t.decisionNumber.$el.hide(),t.decisionNumber.$el.find('[name="decisionNumber"]').val("")))})})},sumZus:function(){function e(){var e=0;t.find(".checkbox-panel.selected").each(function(){var t=$(this).find("input[type=text]").val().replace(",",".").replace(/\s/g,"");isFinite(t)&&(e+=parseFloat(t||0,10))}),a.text(I18n.l("currency",e))}var t=this.$(".row-selectZus"),a=t.next(".row").find('[name="total"]');t.on("change keyup","input",e),e()},onRender:function(){this.$el.find("#form-container").html(this.form.el),this.tooltip(),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.styleCheckboxPanels(),this.sumZus(),this.triggerDatepicker();var e=this.model.get("templateId");e?this.form.fields.additionalOptions.editor.form.fields.addReceiver.$el.hide():this.form.fields.additionalOptions.editor.form.fields.addReceiver.$el.show(),this.bindTo(this,"effects:done",function(){var e=this.form.$el.find('.row-selectZus input[name="content"][value!=""]:first');e.length>0?e.click():this.form.$el.find('.row-selectZus input[name="content"]:first').click(),this.initExpandableFields({collapsedOnStart:!0})},this)},onShow:function(){this.form.trigger("additionalOptions:addReceiver:addToAddressBook:change",this.form),this.form.trigger("fromAccount:change"),this.form.trigger("fromAccount:checkIfChanged",this.form),this.form.trigger("paymentType:change"),this.form.trigger("date:change",this.form),this.form.trigger("additionalOptions:sendConfirmation:change",this.form),this.form.trigger("additionalOptions:sendConfirmationOptions:change",this.form),this.setTabIndex(),this.model.get("isDefined")||this.form.trigger("idType:type:change",this.form),this.form.$(".row-idType input[name=series]").val(this.model.get("idType").series),this.checkAmountZus(),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find(".input-amount"))},checkAmountZus:function(){var e=this.model.get("selectZus");e.health.content&&(e.health.content=this.verifyAmount(e.health.content)),e.social.content&&(e.social.content=this.verifyAmount(e.social.content)),e.pension.content&&(e.pension.content=this.verifyAmount(e.pension.content)),e.fgsp.content&&(e.fgsp.content=this.verifyAmount(e.fgsp.content)),this.form.fields.selectZus.setValue(e),this.styleCheckboxPanels()},setTabIndex:function(){var e=1;$('input[id*="selectZus"][type="text"]').each(function(){var t=$(this);t.attr("tabindex",e),e++})},accountHasChanged:function(e){var t=e.model.toJSON().changedFromAcc,a=e.model.toJSON().srcAccChangeToTemplate;if(t){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccCorrected"));var r=this.model.get("defaultData");r.changedFromAcc=!1,this.model.set("defaultData",r)}if(!t&&a){this.displayValidationMessage(e.fields.fromAccount,I18n.t("errors.fromAccChangedToTemplate"));var r=this.model.get("defaultData");r.srcAccChangeToTemplate=!1,this.model.set("defaultData",r)}},submitTransfer:function(){function t(){var e=["selectZus:social","selectZus:health","selectZus:fgsp","selectZus:pension"],t=[];for(var i in e){var o=r.form.getField(e[i].replace(/:/g,".")+".checkbox").getValue();if(o){var s=a.validateField(r.form,e[i]+":content",r.form.getField(e[i].replace(/:/gi,".")+".content")).done(function(){var e=r.$el.find(".row-selectZus.error .validation-text").text();""==e||_.findWhere(n,function(e){})||n.push(e)});t.push(s)}}return t}var r=this,n=[];e.prototype.submitTransfer.apply(r,_.toArray(arguments));var i=t();$.when.apply(null,i).done(function(){n.length&&r.$el.find(".row-selectZus").removeClass("success").addClass("error").find(".validation-text").html(n.join("<br/>"))}),_.defer(function(){var e=r.$el.find(".row-nameAndAddress").find(".validation.error"),t=r.$el.find(".generic-expander");e.length&&!t.hasClass("expanded")&&t.click()})}});return i}),define("transfer/js/views/forms/schemes/phone-schema",[],function(){function e(e){return{formType:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},userIdTypeValues:{type:"Hidden"},isDefined:{type:"Hidden"},predefinedName:{type:"Hidden"},recipientId:{type:"Hidden"},isRecognized:{type:"Hidden"},operatorPrompt:{type:"Hidden"},selectedOperatorId:{type:"Hidden"},phoneNumber:{type:e.isDefined?"SimpleTextValue":"Text",title:I18n.t("transfer.phone.phoneNumber"),editorClass:"shorter",editorAttrs:{id:"phoneNumber",placeholder:I18n.t("transfer.phone.numberPlaceholderEmpty"),autocomplete:"off"},_params:{tooltip:" "}},operatorId:{type:"Select",title:I18n.t("transfer.phone.operator"),editorClass:"beautify-select operator chzn-select-short",options:e.operators,fieldClass:"hide",_params:{tooltip:I18n.t("transfer.phone.operatorTooltip")}},convertToPeriodic:{type:"uiDate",template:"phoneChargeConvertToPeriodic",fieldClass:"row-additional-options",editorClass:"style-tab"},amount:{title:I18n.t("transfer.phone.amount"),template:"amountWithCurrency",editorClass:"shorter",fieldClass:"",editorAttrs:{id:"amount",placeholder:I18n.t("transfer.phone.amountPlaceholderEmpty")}},amountSelect:{type:"Select",title:I18n.t("transfer.phone.amount"),options:[],fieldClass:"hide",editorClass:"beautify-select chzn-select-short"},fromAccount:{title:I18n.t("transfer.phone.fromAccount"),options:e.availableFromAccounts,type:"Select",editorClass:"beautify-select select-long"},addToAddressBookOptions:{title:"",type:"MultipleFields",template:"fieldWithLegendAsLabel",fieldClass:"fields-row row-wrapper additional-options-wrapper",subSchema:{addToAddressBook:{title:I18n.t("transfer.phone.additionalOptions.addReceiver"),type:"Checkbox",template:"additionalOptionsCheckboxInline",fieldClass:"fields-row add-to-addressbook-voip"}}},addToSMSCharge:{type:"Checkbox",title:I18n.t("transfer.phone.additionalOptions.activateRechargeSMS"),template:"standaloneCheckbox",editorClass:"sms-charge",_params:{tooltip:"Pomoc"}},agreements:{title:I18n.t("transfer.phone.additionalOptions.agreements"),type:"MultipleFields",template:"fieldWithLegendAsLabel",subSchema:{agreement2:{type:"Checkbox",title:I18n.t("transfer.phone.additionalOptions.agreement2",{regulationsFileLink:e.regulationsFileLink}),template:"additionalOptionsCheckbox"},agreement1:{type:"Checkbox",title:I18n.t("transfer.phone.additionalOptions.agreement1"),template:"additionalOptionsCheckbox"},agreement3:{type:"Checkbox",title:I18n.t("transfer.phone.additionalOptions.agreement3"),template:"additionalOptionsCheckbox"},dataAdministratorInfo:{type:"SimpleTextValue",editorClass:"dataAdministratorInfo",text:I18n.t("transfer.phone.additionalOptions.dataAdministratorInfo"),template:"fieldAloneNoLabel"}}},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.buttons.submitPhoneCharge"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient long",fieldClass:"fl"},cancel:{text:I18n.t("transfer.buttons.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=[["templateId","isDefined","predefinedName","formType","recipientName","recipientId","fromAccount","phoneNumber","operatorId","convertToPeriodic","isRecognized"],["amount","amountSelect"],["agreements","operatorPrompt","selectedOperatorId"],["addToSMSCharge","addToAddressBookOptions","submitButtons"]];if(Ebre.Entity.isOF()){var a=t[3].indexOf("addToSMSCharge");t[3].splice(a,1)}return{fieldsets:t,getSchema:e}}),define("transfer/js/models/nmb-phone-charge-check",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.checkPhoneChargeNetworkOperator(a)}});return e}),define("transfer/js/views/forms/phone",["./_generic",nmbPaths.global.js+"validator","../../app","./schemes/phone-schema","../../models/nmb-phone-charge-check"],function(e,t,a,r,n){var i=e.extend({tagName:"section",className:"form-view",events:function(){return _.extend({},e.prototype.events,{"focus textarea.single-row.expanding":"elasticTextAreas","click a.convertToPeriodicPhoneCharge-trigger":"redirectToPeriodicPhoneCharge"})},getOperatorById:function(e,t){var a;return _.each(t,function(t,r){a||t.OperatorData.cOperatorID!==e||(a=t)}),a},getOperators:function(e){var t=[];return _.each(e,function(e,a){t.push({val:e.OperatorData.cOperatorID,label:e.OperatorData.cOperatorLiteral})}),t},parseAmountsToSelect:function(e){var t=[];return _.each(e,function(e,a){t.push({val:e.cValue,label:e.cLiteral})}),t},initialize:function(){var a=this;e.prototype.initialize.apply(this,_.toArray(arguments));var n=this.model,i=a.model.toJSON();i.phoneNumber=i.phoneNumber||i.phone;var o=Backbone.Model.extend({schema:r.getSchema({isDefined:a.model.get("isDefined"),operators:a.getOperators(a.model.get("operators")),availableFromAccounts:a.getFormAccount(a.model.get("availableFromAccounts")),regulationsFileLink:a.model.get("regulationsFileLink")}),defaults:i,rules:function(){function e(){return r}var t={};$("#amount").is(":visible")&&(t.amount=["required",{name:"amount",params:["",!1,!1]},"amountFilter"]),t.phoneNumber=["required"];var r=a.getOperatorById(a.getCurrentOperatorId(),this.get("operators"));return r&&(r.OperatorData.cTransferAmountValMax&&$("#amount").is(":visible")&&t.amount.push({name:"maxAmount",params:[r.OperatorData.cTransferAmountValMax,"PLN"]}),r.OperatorData.cTransferAmountValMin&&$("#amount").is(":visible")&&t.amount.push({name:"minAmount",params:[r.OperatorData.cTransferAmountValMin,"PLN"]}),ValidatorDecimals=function(t){var a=$.Deferred(),r=e(),n=r.OperatorData.iTransferAmountFieldLenMinAC;switch(n){case 0:var i=new RegExp(/\d+[,\.]00?$/).test(t),o=I18n.t("transfer.forms.validation.amountNoDecimal");break;case 1:var i=new RegExp(/\d+[,\.]\d0?$/).test(t),o=I18n.t("transfer.forms.validation.amountOneDecimal")}return i?a.resolve({}):a.resolve({error:!0,message:o})},"undefined"!=typeof t.amount&&t.amount.push({name:"remote",params:[ValidatorDecimals]}),0==r.OperatorData.cTransferDescrFieldType&&t.phoneNumber.push("numeric"),1==r.OperatorData.cTransferDescrFieldType&&t.phoneNumber.push("alphanumeric"),2==r.OperatorData.cTransferDescrFieldType&&t.phoneNumber.push("phoneNumber")),t["agreements:agreement1"]=["required"],t["agreements:agreement2"]=["required"],t["agreements:agreement3"]=["required"],t}}),s=new o;this.form=new Backbone.Form({model:s,fieldsets:r.fieldsets}).render(),this.preventSubmitByEnterOnTouchDevices(this.form),this.form.$el.find(".row-amountSelect").hide(),a.bindOnBlurValidation(["amount","phoneNumber"]),this.form.on("operatorId:change",function(e,r){a.handleOperatorChange(a.getOperatorById(r.getValue(),a.model.get("operators"))),$("#phoneNumber").val().length>0&&t.validateField(e,"phoneNumber",this.form.fields.phoneNumber),$("#amount").val().length>0&&t.validateField(e,"amount",this.form.fields.amount)},this),this.form.on("phoneNumber:change",function(){a.form.model.set("selectedOperatorId",""),a.checkPhoneOperator()}),this.form.on("phoneNumber:blur",function(){a.form.fields.amountSelect.$el.is(":visible")&&a.form.fields.amountSelect.$el.trigger("liszt:updated")}),this.form.on("operatorId:change",function(){a.removeOperationInfo()}),this.form.on("addToAddressBookOptions:addToAddressBook:change",function(e,t){a.addToTrustedVisibility(e)}),this.form.on("fromAccount:change",function(e,t){nmbServices.AddToSMSCharkgeCountForPhoneCharge({loaderParent:a.getLoaderParamSelector(),fromAccount:t.getValue(),accountParams:_.find(this.model.get("availableFromAccounts"),function(t){return t.number===e.getValue().fromAccount}).accountParams||null,success:function(e){if(n.set("availableNumber",e),e){var t=a.getOperatorById($(".operator").val(),a.model.get("operators"));t.OperatorData.bSMSChargeAllowed&&e>0?$(".row-addToSMSCharge").show():$(".row-addToSMSCharge").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1)}else $(".row-addToSMSCharge").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1)},error:function(e,t){$(".row-addToSMSCharge").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1),Ebre.Proxy.HandleDefaultError(e,t)}})},this)},manageVoip:function(){if("phone"===this.model.get("formType"))this.allowOnlyNumbersOnInput(this.form.fields.phoneNumber.$("input"),9);else{this.form.fields.phoneNumber.$("input").off("keydown"),this.form.fields.phoneNumber.$("input").attr("maxlength","70"),this.form.fields.operatorId.$el.show();var e=this.form.fields.operatorId.getValue();this.handleOperatorChange(this.getOperatorById(e,this.model.get("operators")))}},addToAddressBookVisibility:function(){var e=$.map(a.main.currentView.$("a[data-transferid]"),function(e){return $(e).attr("data-transferid")}),t=this.form.fields.phoneNumber.getValue().split(" ").join(""),r=$.inArray(t,e)==-1&&9==t.length;r&&this.model.get("canAddToAddressBook")?this.form.fields.addToAddressBookOptions.$("input").first().closest("div").removeClass("hide"):(this.form.fields.addToAddressBookOptions.$("input").first().closest("div").addClass("hide"),this.form.fields.addToAddressBookOptions.$("input").prop("checked",!1),this.form.fields.addToAddressBookOptions.$("input").closest("span").removeClass("checked")),this.addToTrustedVisibility()},addToTrustedVisibility:function(e){var t=this.form.fields.addToAddressBookOptions;if(1==t.getValue().addToAddressBook)t.$el.find(".add-to-trusted-list").fadeIn();else{var a=this.form.fields.addToAddressBookOptions.$("input[name='addToTrustedList']");t.$el.find(".add-to-trusted-list").fadeOut(function(){}),a.prop("checked",!1)}},handleOperatorChange:function(e){if(e){if(this.$(".row-amount label:first").html(e.OperatorData.cTransferAmountFieldName),this.$(".row-amountSelect label").html(e.OperatorData.cTransferAmountFieldName),this.$("div[class*='row-phoneNumber'] label:first").html(e.OperatorData.cTransferDescrFieldName),e.OperatorData.cTransferDescrAnnoucement?(this.$("div[class*='row-phoneNumber'] span[rel='tooltip']").data("originalTitle",e.OperatorData.cTransferDescrAnnoucement),this.$("div[class*='row-phoneNumber'] span[rel='tooltip']").show(),this.$("div[class*='row-phoneNumber'] span[rel='tooltip']").attr({style:""})):this.$("div[class*='row-phoneNumber'] span[rel='tooltip']").hide(),e.OperatorData.bSMSChargeAllowed&&this.model.attributes.availableNumber>0?this.form.$el.find(".row-addToSMSCharge").show():this.form.$el.find(".row-addToSMSCharge").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1),e.OperatorData.cTransferAmountValMin&&e.OperatorData.cTransferAmountValMax)var t=I18n.t("transfer.phone.amountPlaceholder",{from:e.OperatorData.cTransferAmountValMin,to:e.OperatorData.cTransferAmountValMax});else if(e.OperatorData.cTransferAmountValMax)var t=I18n.t("transfer.phone.amountPlaceholderFromZero",{to:e.OperatorData.cTransferAmountValMax});else var t=I18n.t("transfer.phone.amountPlaceholderEmpty");$(".row-amount input").attr("placeholder",t),this.initFocusedPlaceholders($(".row-amount input"),!1),e.Amounts&&e.Amounts.length>0?(this.form.fields.amountSelect.editor.setOptions(this.parseAmountsToSelect(e.Amounts)),this.form.$el.find(".row-amountSelect select").resetSS(),this.form.$el.find(".row-amount").hide(),this.form.$el.find(".row-amountSelect").show(),this.form.$el.find(".chzn-search label").remove()):(this.form.$el.find(".row-amountSelect").hide(),this.form.$el.find(".row-amount").show()),this.addAdvertise(e)}else{this.removeAdvertise();var t=I18n.t("transfer.phone.amountPlaceholderEmpty");this.$(".row-amount input").attr("placeholder",t),this.initFocusedPlaceholders($(".row-amount input"),!1),this.form.$el.find(".row-addToSMSCharge").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1),this.form.$el.find(".row-amountSelect select").resetSS(),this.form.$el.find(".row-amountSelect").hide(),this.form.$el.find(".row-amount").show()}},removeAdvertise:function(){var e=this.form.$el.find("#phoneAdvertise");e&&e.parent().remove()},addAdvertise:function(e){e&&(this.removeAdvertise(),e.ContentCacheAdvertisment&&(adv=$('<fieldset><div id="phoneAdvertise"><div class="adImg"><img></img></div><p class="adText"></p></div></fieldset>'),adv.find(".adImg img").attr("src",Ebre.Modules.Payments.Transfer.PhoneChargeService.PhoneChargeOperatorImageUrl+e.OperatorData.cOperatorID.toLowerCase()),adv.find("p.adText").empty().append(e.ContentCacheAdvertisment),this.form.$el.find("fieldset:first").after(adv)))},setOperatorSelectPlaceholder:function(){var e=this.$('select[name="operatorId"]'),t=e.children(":first"),a=t.text();a&&e.attr("data-placeholder",a)},onRender:function(){this.handleCanAddToAddressBook(),this.form.$el.find('.row-amount a[rel="tooltip"]').hide(),this.form.$el.find(".row-amountSelect").hide(),this.form.$el.find('.row-amountSelect a[rel="tooltip"]').hide(),this.form.$el.find('.row-phoneNumber a[rel="tooltip"]').hide();var e=this.model.attributes.allowSMSChargeMessage;this.form.$el.find('.row-addToSMSCharge a[rel="tooltip"]').attr("data-original-title",e),this.$el.find("#form-container").html(this.form.el),this.setOperatorSelectPlaceholder(),this.styleSelects(),this.styleCheckbox(),this.tooltip(),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#amount")),this.bindTo(this,"effects:done",function(){this.form.fields.amountSelect.$el.is(":visible")?t.form.fields.amountSelect.$(".chzn-single").focus():(this.initFocusedPlaceholders(this.$el.find("input[placeholder!='']")),null!==this.model.get("recipientName")&&null!==this.model.get("recipientId")&&this.$el.find("input:not([autocomplete]):visible:first").trigger("focus"))}),void 0!==this.form.fields.phoneNumber.getValue()&&""!==this.form.fields.phoneNumber.getValue()&&1==this.form.fields.isRecognized.getValue()&&this.checkPhoneOperator(),this.checkPhoneOperatorSucess(),this.addToTrustedVisibility(this.form),this.manageVoip(),this.updatePhoneFormat(),this.$("#phoneNumber").after("<div id='phoneChargeLoader' class='loader'></div>");var t=this;this.focusAmountIfRecipientIsValid(t),t.form.fields.operatorId.$(".chzn-single").focus(function(e){e.preventDefault()}),t.form.fields.amountSelect.$(".chzn-single").focus(function(e){e.preventDefault()}),t.form.fields.operatorId.$(".scroll-pane").on("focus",function(){"text"!=event.srcElement.type&&t.focusAmountIfRecipientIsValid(t)}),t.form.fields.amountSelect.$(".scroll-pane").on("focus",function(){"text"!=event.srcElement.type&&t.isRecipientValid(t.form.model.attributes.recipientName)&&t.form.fields.addToSMSCharge.$("input").focus()}),t.form.fields.phoneNumber.$("input").on("blur",function(){0==t.form.fields.operatorId.$el.hasClass("hide")&&(t.form.fields.operatorId.$(".chzn-single").focus(),t.form.fields.operatorId.$(".chzn-disabled").length>0&&t.form.fields.amountSelect.$(".chzn-single").focus())})},focusAmountIfRecipientIsValid:function(e){e.isRecipientValid(e.form.model.attributes.recipientName)?e.form.fields.amount.$("input").focus():e.form.$el.find("input, radio, select, textarea, a").attr("disabled","disabled").attr("tabIndex",-1).removeClass("validation error")},isRecipientValid:function(e){return null!=e&&e.replace(/[^a-z0-9]/gi,"").length>1},updatePhoneFormat:function(){if(this.model.get("isDefined")){var e=Ebre.Common.formatNumber(this.form.fields.phoneNumber.getValue()," ","","0",!1).replace(".00","");this.form.fields.phoneNumber.setValue(e)}},handleCanAddToAddressBook:function(){this.model.get("canAddToAddressBook")?this.form.$el.find(".row-addToAddressBookOptions").show():this.form.$el.find(".row-addToAddressBookOptions").hide().find(".checkbox-wrapper").removeClass("checked").find("input").prop("checked",!1)},hideloader:function(){$("#phoneChargeLoader").fadeOut()},showloader:function(){$("#phoneChargeLoader").fadeIn()},checkPhoneOperatorSucess:function(){var e=this;if(""!=e.form.fields.phoneNumber.getValue()){var t=this.form.fields.operatorId.getValue();e.form.fields.operatorId.$("select").trigger("liszt:updated"),e.handleOperatorChange(e.getOperatorById(t,e.model.get("operators"))),e.form.fields.phoneNumber.$el.removeClass("row-phoneNumber"),e.form.fields.phoneNumber.$el.addClass("row-phoneNumber-hidden"),e.form.fields.amountSelect.$(".chzn-container").removeClass("chzn-container-active"),e.form.fields.operatorId.$el.removeClass("hide"),e.addToAddressBookVisibility()}},checkPhoneOperator:function(e){if("phone"==this.model.get("formType")){var t=this,a=t.form.fields.phoneNumber.getValue(),r=$.trim(a).replace(/[^\d]/gi,"");9===r.length?(t.showloader(),phoneChargeCheckNetwrork=new n,$.deffered,phoneChargeCheckNetwrork.fetch({loaderParent:null,data:{input:r},success:function(){t.hideloader();var a,r=phoneChargeCheckNetwrork.toJSON();r.NetworkOperator?(a=r.NetworkOperator,t.removeOperationInfo(),t.form.fields.isRecognized.setValue(!0),t.form.fields.operatorPrompt.setValue(r.NetworkOperator)):(a=t.form.fields.operatorId.schema.options[0].val,t.addOperatorInfo(),t.form.fields.isRecognized.setValue(!1)),t.form.model.get("selectedOperatorId")&&(a=t.form.model.get("selectedOperatorId")),t.form.fields.operatorId.$("select").val(a),t.checkPhoneOperatorSucess(),t.isRecipientValid(t.form.model.attributes.recipientName)&&t.setTabIndex(),void 0!==e&&e.resolve()},error:function(){t.form.fields.operatorId.$el.removeClass("hide")}})):(t.form.fields.operatorId.$el.addClass("hide"),t.form.fields.phoneNumber.$el.addClass("row-phoneNumber"),t.form.fields.phoneNumber.$el.removeClass("row-phoneNumber-hidden"),t.handleOperatorChange(null)),t.addToAddressBookVisibility()}},setTabIndex:function(){var e=this;void 0!==e.form.fields.operatorId.$("select").attr("disabled")&&e.form.fields.phoneNumber.$("input").blur(function(){e.form.fields.amount.$el.is(":visible")&&void 0!==e.form.fields.operatorId.$("select").attr("disabled")&&e.form.fields.amount.$("input").focus()})},submitTransfer:function(){var e=this.form;this.performSubmit(function(e){a.trigger("transfer:submit",{form:e})},e)},performSubmit:function(e,a){var r=this.getOperatorById($(".operator").val(),this.model.get("operators"));"undefined"!=typeof r&&(r.Amounts&&r.Amounts.length>0&&a.fields.amount.editor.setValue(parseInt(a.fields.amountSelect.editor.getValue(),10)),a.fields.predefinedName.editor.setValue(a.fields.recipientName.editor.getValue()),a.fields.selectedOperatorId.editor.setValue(r.OperatorData.cOperatorID)),$.when.apply($,t.validateForm(a)).then(function(){var r=t.checkStatus(a);$.isEmptyObject(r)&&e(a)})},redirectToPeriodicPhoneCharge:function(e){e.preventDefault();var t=this.form;this.performSubmit(function(e){$(".voip-transfer > ul.options-list > li.new-transfer-voip").is(":visible")?nmbServices.redirectToPeriodicPhoneCharge({phoneNumber:"",phoneType:"",operatorId:"",RecipientId:e.fields.recipientId.getValue(),RecipientName:e.fields.recipientName.getValue(),fromAccount:e.fields.fromAccount.getValue(),amount:e.fields.amount.getValue(),amountSelect:e.fields.amountSelect.getValue()}):nmbServices.redirectToPeriodicPhoneCharge({phoneNumber:e.fields.phoneNumber.getValue().split(" ").join(""),phoneType:$("li.active > a.defined-transfer-link > span:visible").text().split(" ")[0],operatorId:e.fields.operatorId.getValue(),RecipientId:e.fields.recipientId.getValue(),RecipientName:e.fields.recipientName.getValue(),fromAccount:e.fields.fromAccount.getValue(),amount:e.fields.amount.getValue(),amountSelect:e.fields.amountSelect.getValue()})},t)},setOperatorInfoVisibility:function(){var e=this;"voip"!=this.model.get("formType")&&e.form.fields.operatorId.$("select").is(":visible")&&void 0==e.form.fields.operatorId.$("select").attr("disabled")?e.addOperatorInfo():e.removeOperationInfo()},addOperatorInfo:function(){var e=this.$(".row-operatorId");return e.length?void e.addClass("validation info").find(".validation-text").text(I18n.t("transfer.phone.operatorNotRecognized")):void this.on("render",function(){this.$(".row-operatorId").addClass("validation info"),this.$(".row-operatorId .validation-text").text(I18n.t("transfer.phone.operatorNotRecognized"))})},removeOperationInfo:function(){thisView=this,thisView.$(".row-operatorId").removeClass("validation info"),thisView.$(".row-operatorId .validation-text").text("")},getCurrentFormData:function(){var e={amount:this.form.fields.amount.getValue(),phone:this.form.fields.phoneNumber.getValue(),fromAccount:this.form.fields.fromAccount.getValue(),operatorId:this.form.fields.operatorId.getValue(),amountSelect:this.form.fields.amountSelect.getValue()};return e},getCurrentOperatorId:function(){var e=this.$el.find(".operator");return""!=e.val()&&null!=e.val()||this.$el.find(".operator option:first").attr("selected","selected"),e.val()}});return i}),define("transfer/js/models/nmb-own-split-cost-service",[],function(){var e=Backbone.Model.extend({sync:function(e,t,a){"read"===e&&nmbServices.SplitSelfCheckService(a)}});return e}),define("transfer/js/views/forms/schemes/splitown-schema",[],function(){function e(e){return{addToBasket:{type:"Hidden"},templateId:{type:"Hidden"},recipientName:{type:"Hidden"},formType:{type:"Hidden"},dateNow:{type:"Hidden"},fromAccount:{title:I18n.t("transfer.domestic.fromAccount"),type:"SplitSelect",editorClass:"beautify-select select-long",options:e.availableFromAccounts,_params:{info:""},editorAttrs:e.isFromBasket?{disabled:"disabled"}:{}},toAccount:{title:I18n.t("transfer.domestic.toAccount"),type:"SplitSelect",editorClass:"beautify-select select-long",options:e.availableToAccounts,_params:{info:""},editorAttrs:e.isFromBasket?{disabled:"disabled"}:{"data-placeholder":I18n.t("transfer.forms.chosen.choose")}},idType:{title:I18n.t("transfer.split.ownerNIP"),type:"MultipleFields",editorLabelFor:"form-select-id-type",subSchema:{type:{type:"Hidden"},series:{title:"",editorClass:"short",fieldClass:"row-inner-left",editorAttrs:{maxlength:14,id:"idTypeSeries",readonly:"readonly"},template:"labelBeforeInput"}}},amount:{title:I18n.t("transfer.split.vatAmount"),template:"amount",editorAttrs:{id:"amount"},type:"MultipleFields",editorLabelFor:"grossAmountInner",fieldClass:"row-amountAndVat",subSchema:{vatAmount:{title:"",template:"innerAmountWithCurrencyAndLabelBeforeInput",fieldClass:"row-inner-left",editorClass:"short",editorAttrs:{id:"vatAmount"}}}},title:{title:I18n.t("transfer.split.invoiceNumber"),type:"MultipleFields",subSchema:{invoiceNumber:{title:I18n.t("transfer.split.ownerNIP"),fieldClass:"row-inner-left",template:"fieldAlone",editorClass:"short single-row expanding",editorAttrs:{id:"invoiceNumber",maxlength:35,readonly:"readonly"}},title:{title:I18n.t("transfer.domestic.title"),type:"TextArea",fieldClass:"row-inner-right",editorClass:"short single-row expanding",template:"labelBeforeInput",editorAttrs:{maxlength:33,id:"title"}}}},date:{type:"uiDateInput",template:"deliveryTimeDateAlone",editorLabelFor:"uiDateInput",title:I18n.t("transfer.domestic.deliveryDate"),editorAttrs:{id:"uiDateInput"},fieldClass:"row-additional-options",editorClass:"style-tab",minDate:e.calendar.minDate,maxDate:e.calendar.maxDate,monthNames:I18n.t("date.calendar_month_names"),unavailableDates:e.calendar.unavailableDates,days:I18n.t("date.day_names"),unavailableDays:I18n.t("date.day_holidays"),dayNamesMin:I18n.t("date.abbr_day_names_min")},submitButtons:{type:"MultipleFields",template:"buttons",fieldClass:"row action-buttons",subSchema:{submit:{text:I18n.t("transfer.abroad.button.submit"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"save-form btn-red-gradient",fieldClass:"fl"},addToBasket:{text:I18n.t("transfer.buttons.addToBasket"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"addToBasket btn-gray-gradient",fieldClass:"fl",editorAttrs:{rel:"tooltip","data-original-title":I18n.t("transfer.basketTooltip")}},cancel:{text:I18n.t("transfer.abroad.button.cancel"),type:"AnchorButton",template:"fieldAloneNoLabel",editorClass:"cancel-form btn-gray-gradient",fieldClass:"fl"}}}}}var t=["fromAccount","toAccount","idType","amount","title","date","dateNow","submitButtons","addToBasket","templateId","recipientName","formType"];return{fieldsets:[t],getSchema:e}}),define("transfer/js/views/forms/splitown",["./_generic","../../models/nmb-transfer-cost-service","../../models/nmb-own-split-cost-service","../../models/transfer-wizard","./schemes/splitown-schema","../../logic/local-validators","../../logic/split-editors"],function(e,t,a,r,n,i,o){var s=e.extend({tagName:"section",className:"form-view",events:function(){return _.extend({},e.prototype.events,{"focus textarea.single-row.expanding":"elasticTextAreas"})},getDefaults:function(){var e=this.model.toJSON();return e},getFormSchema:function(){return n.getSchema({availableFromAccounts:this.getFormAccount(this.model.get("availableFromAccounts"),!1,"splitown"),availableToAccounts:this.getFormAccount(this.model.get("availableToAccounts"),!1,"splitown"),calendar:this.model.get("calendar"),isFromBasket:this.model.get("isFromBasket")})},initialize:function(){var t=this;e.prototype.initialize.apply(this,_.toArray(arguments)),this.model.set("formType","splitown");var a=this.model.get("calendar"),r=[];_.each(a.unavailableDates,function(e){r.push($.datepicker.formatDate("yy/mm/dd",new Date(e)))});var i=Backbone.Model.extend({schema:t.getFormSchema(),defaults:t.getDefaults(),rules:t.getFormRules()}),s=new i;this.form=new Backbone.Form({model:s,fieldsets:n.fieldsets}).render(),this.preventSubmitByEnterOnTouchDevices(this.form),t.bindOnBlurValidation(["fromAccount","amount:vatAmount","title:title","date","dateNow"]),window.form=this.form,this.bindTo(this.form,"date:datepickerChangeTrigger",function(e,t){this.triggerDatepicker(t)}),this.bindTo(this.form,"fromAccount:change",function(e){this.getAvailableToAccounts(e),this.checkCreditCard(),this.toggleAddToBasket(e)}),this.bindTo(this.form,"toAccount:change",function(e){o.renderSplitSelfSelects(e)}),o.renderSplitSelfSelects(form)},getFormRules:function(){function e(){var e=(t.form.getValue(),{});return e.fromAccount=["required"],e["title:title"]=["required","elixir","trim",{name:"maxLength",params:[33]},{name:"remote",params:[i.splitTitle]
}],e.date=["required"],e["amount:vatAmount"]=["required","amountFilter","amountAddZero",{name:"amount",params:["PLN",!1,!1]}],e}var t=this;return e},getAvailableToAccounts:function(e){var t=this,n=e.getValue(),i={fromAccount:n.fromAccount,toAccount:n.toAccount},s=new a;s.fetch({loaderParent:t.getLoaderParamSelector(),data:i,accountParams:_.find(this.model.get("availableFromAccounts"),function(e){return e.number===n.fromAccount}).accountParams||null,success:function(){var a=s.toJSON(),n=a.availableToAccounts;if(Ebre.Entity.isPL()||Ebre.Entity.isOF()||(t.model.set("enablePEP",a.enablePEP),a.enablePEP&&a.incomeSourceDict.length&&a.paymentPurposeDict.length?(t.setIncomeSource(a.incomeSourceDict),t.model.set("incomeSourceDict",a.incomeSourceDict),t.setPaymentPurpose(a.paymentPurposeDict),t.model.set("paymentPurposeDict",a.paymentPurposeDict),t.form.$(".row-pep").show()):t.form.$(".row-pep").hide(),r.get("formLoaded").get("formData").enablePEP=a.enablePEP,r.get("formLoaded").get("formData").incomeSourceDict=a.incomeSourceDict,r.get("formLoaded").get("formData").paymentPurposeDict=a.paymentPurposeDict),n){var l;null!=_.find(n,function(e){return e.number==i.toAccount})?(t.$(".row-toAccount").removeClass("validation info"),t.$(".row-toAccount .validation-text").text(""),l=i.toAccount):(l=n[_.first(n).number!==i.toAccount?0:1].number,t.$(".row-toAccount").addClass("validation info"),t.$(".row-toAccount .validation-text").text(I18n.t("transfer.forms.validation.toAccountChanged"))),t.model.set("availableToAccounts",n),t.reloadAvailableToAccounts(l),r.updatePopulatedModel("availableToAccounts",n)}o.renderSplitSelfSelects(e)}})},reloadAvailableToAccounts:function(e){var t=this.form,a=t.fields.toAccount,r=this.getFormAccount(this.model.get("availableToAccounts"),!1,"splitown");a.editor.setOptions(r),e&&a.editor.setValue(e),t.fields.toAccount.$el.find("select").trigger("liszt:updated"),t.trigger("toAccount:change",this.form,a)},isStillAvailable:function(e,t){return _.each(t,function(t){if(t.number==e)return!0}),!1},onRender:function(){this.bindTo(this,"effects:done",function(){this.setFocusOnInput("amount",""),o.renderSplitSelfSelects(this.form)}),this.$el.find("#form-container").html(this.form.el),this.tooltip(),this.styleSelects(),this.styleCheckbox(),this.styleRadioPanels(),this.triggerDatepicker(),this.form.trigger("toAccount:change",this.form),this.toggleAddToBasket(this.form),Ebre.Common.setBehaviourForAmountInput(this.form.$el.find("#vatAmount"))}});return s});